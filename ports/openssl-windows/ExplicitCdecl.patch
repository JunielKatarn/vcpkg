diff --git a/apps/openssl.c b/apps/openssl.c
index 9648f35b02..f2e2fc5676 100644
--- a/apps/openssl.c
+++ b/apps/openssl.c
@@ -116,7 +116,7 @@ static char *make_config_name(void)
     return p;
 }
 
-int main(int argc, char *argv[])
+int __cdecl main(int argc, char *argv[])
 {
     FUNCTION f, *fp;
     LHASH_OF(FUNCTION) *prog = NULL;
@@ -630,7 +630,7 @@ static void list_pkey_meth(void)
     }
 }
 
-static int function_cmp(const FUNCTION * a, const FUNCTION * b)
+static int __cdecl function_cmp(const FUNCTION * a, const FUNCTION * b)
 {
     return strncmp(a->name, b->name, 8);
 }
@@ -640,7 +640,7 @@ static unsigned long function_hash(const FUNCTION * a)
     return OPENSSL_LH_strhash(a->name);
 }
 
-static int SortFnByName(const void *_f1, const void *_f2)
+static int __cdecl SortFnByName(const void *_f1, const void *_f2)
 {
     const FUNCTION *f1 = _f1;
     const FUNCTION *f2 = _f2;
diff --git a/apps/req.c b/apps/req.c
index f9d6fba109..56e3603a99 100644
--- a/apps/req.c
+++ b/apps/req.c
@@ -158,7 +158,7 @@ static unsigned long ext_name_hash(const OPENSSL_STRING *a)
     return OPENSSL_LH_strhash((const char *)a);
 }
 
-static int ext_name_cmp(const OPENSSL_STRING *a, const OPENSSL_STRING *b)
+static int __cdecl ext_name_cmp(const OPENSSL_STRING *a, const OPENSSL_STRING *b)
 {
     return strcmp((const char *)a, (const char *)b);
 }
diff --git a/apps/s_apps.h b/apps/s_apps.h
index f94e659e71..dc524c1bce 100644
--- a/apps/s_apps.h
+++ b/apps/s_apps.h
@@ -33,7 +33,7 @@ int init_client(int *sock, const char *host, const char *port,
                 int family, int type, int protocol);
 int should_retry(int i);
 
-long bio_dump_callback(BIO *bio, int cmd, const char *argp,
+long __cdecl bio_dump_callback(BIO *bio, int cmd, const char *argp,
                        int argi, long argl, long ret);
 
 void apps_ssl_info_callback(const SSL *s, int where, int ret);
diff --git a/apps/s_cb.c b/apps/s_cb.c
index 5dc1d03f28..a4c7143506 100644
--- a/apps/s_cb.c
+++ b/apps/s_cb.c
@@ -429,7 +429,7 @@ int ssl_print_tmp_key(BIO *out, SSL *s)
     return 1;
 }
 
-long bio_dump_callback(BIO *bio, int cmd, const char *argp,
+long __cdecl bio_dump_callback(BIO *bio, int cmd, const char *argp,
                        int argi, long argl, long ret)
 {
     BIO *out;
diff --git a/apps/win32_init.c b/apps/win32_init.c
index df4bff41a2..b8436cc54f 100644
--- a/apps/win32_init.c
+++ b/apps/win32_init.c
@@ -18,7 +18,7 @@ static UINT saved_cp;
 static int newargc;
 static char **newargv;
 
-static void cleanup(void)
+static void __cdecl cleanup(void)
 {
     int i;
 
diff --git a/crypto/aes/aes_cbc.c b/crypto/aes/aes_cbc.c
index 342841fc4f..01061c06f4 100644
--- a/crypto/aes/aes_cbc.c
+++ b/crypto/aes/aes_cbc.c
@@ -10,7 +10,7 @@
 #include <openssl/aes.h>
 #include <openssl/modes.h>
 
-void AES_cbc_encrypt(const unsigned char *in, unsigned char *out,
+void __cdecl AES_cbc_encrypt(const unsigned char *in, unsigned char *out,
                      size_t len, const AES_KEY *key,
                      unsigned char *ivec, const int enc)
 {
diff --git a/crypto/aes/aes_cfb.c b/crypto/aes/aes_cfb.c
index f010e3c4ea..c0e0fd4f13 100644
--- a/crypto/aes/aes_cfb.c
+++ b/crypto/aes/aes_cfb.c
@@ -16,7 +16,7 @@
  * used is contained in *num;
  */
 
-void AES_cfb128_encrypt(const unsigned char *in, unsigned char *out,
+void __cdecl AES_cfb128_encrypt(const unsigned char *in, unsigned char *out,
                         size_t length, const AES_KEY *key,
                         unsigned char *ivec, int *num, const int enc)
 {
@@ -26,7 +26,7 @@ void AES_cfb128_encrypt(const unsigned char *in, unsigned char *out,
 }
 
 /* N.B. This expects the input to be packed, MS bit first */
-void AES_cfb1_encrypt(const unsigned char *in, unsigned char *out,
+void __cdecl AES_cfb1_encrypt(const unsigned char *in, unsigned char *out,
                       size_t length, const AES_KEY *key,
                       unsigned char *ivec, int *num, const int enc)
 {
@@ -34,7 +34,7 @@ void AES_cfb1_encrypt(const unsigned char *in, unsigned char *out,
                             (block128_f) AES_encrypt);
 }
 
-void AES_cfb8_encrypt(const unsigned char *in, unsigned char *out,
+void __cdecl AES_cfb8_encrypt(const unsigned char *in, unsigned char *out,
                       size_t length, const AES_KEY *key,
                       unsigned char *ivec, int *num, const int enc)
 {
diff --git a/crypto/aes/aes_core.c b/crypto/aes/aes_core.c
index f1f11fd8de..8f7d611751 100644
--- a/crypto/aes/aes_core.c
+++ b/crypto/aes/aes_core.c
@@ -629,7 +629,7 @@ static const u32 rcon[] = {
 /**
  * Expand the cipher key into the encryption key schedule.
  */
-int AES_set_encrypt_key(const unsigned char *userKey, const int bits,
+int __cdecl AES_set_encrypt_key(const unsigned char *userKey, const int bits,
                         AES_KEY *key)
 {
 
@@ -731,7 +731,7 @@ int AES_set_encrypt_key(const unsigned char *userKey, const int bits,
 /**
  * Expand the cipher key into the decryption key schedule.
  */
-int AES_set_decrypt_key(const unsigned char *userKey, const int bits,
+int __cdecl AES_set_decrypt_key(const unsigned char *userKey, const int bits,
                         AES_KEY *key)
 {
 
@@ -784,7 +784,7 @@ int AES_set_decrypt_key(const unsigned char *userKey, const int bits,
  * Encrypt a single block
  * in and out can overlap
  */
-void AES_encrypt(const unsigned char *in, unsigned char *out,
+void __cdecl AES_encrypt(const unsigned char *in, unsigned char *out,
                  const AES_KEY *key) {
 
     const u32 *rk;
@@ -975,7 +975,7 @@ void AES_encrypt(const unsigned char *in, unsigned char *out,
  * Decrypt a single block
  * in and out can overlap
  */
-void AES_decrypt(const unsigned char *in, unsigned char *out,
+void __cdecl AES_decrypt(const unsigned char *in, unsigned char *out,
                  const AES_KEY *key)
 {
 
@@ -1208,7 +1208,7 @@ static const u32 rcon[] = {
 /**
  * Expand the cipher key into the encryption key schedule.
  */
-int AES_set_encrypt_key(const unsigned char *userKey, const int bits,
+int __cdecl AES_set_encrypt_key(const unsigned char *userKey, const int bits,
                         AES_KEY *key)
 {
     u32 *rk;
@@ -1309,7 +1309,7 @@ int AES_set_encrypt_key(const unsigned char *userKey, const int bits,
 /**
  * Expand the cipher key into the decryption key schedule.
  */
-int AES_set_decrypt_key(const unsigned char *userKey, const int bits,
+int __cdecl AES_set_decrypt_key(const unsigned char *userKey, const int bits,
                         AES_KEY *key)
 {
 
diff --git a/crypto/aes/aes_ecb.c b/crypto/aes/aes_ecb.c
index 29bfc1ad66..fa432af6d3 100644
--- a/crypto/aes/aes_ecb.c
+++ b/crypto/aes/aes_ecb.c
@@ -12,7 +12,7 @@
 #include <openssl/aes.h>
 #include "aes_locl.h"
 
-void AES_ecb_encrypt(const unsigned char *in, unsigned char *out,
+void __cdecl AES_ecb_encrypt(const unsigned char *in, unsigned char *out,
                      const AES_KEY *key, const int enc)
 {
 
diff --git a/crypto/aes/aes_ige.c b/crypto/aes/aes_ige.c
index 75f796cf3b..f46b21a191 100644
--- a/crypto/aes/aes_ige.c
+++ b/crypto/aes/aes_ige.c
@@ -34,7 +34,7 @@ typedef struct {
 
 /* N.B. The IV for this mode is _twice_ the block size */
 
-void AES_ige_encrypt(const unsigned char *in, unsigned char *out,
+void __cdecl AES_ige_encrypt(const unsigned char *in, unsigned char *out,
                      size_t length, const AES_KEY *key,
                      unsigned char *ivec, const int enc)
 {
@@ -166,7 +166,7 @@ void AES_ige_encrypt(const unsigned char *in, unsigned char *out,
 
 /* N.B. The IV for this mode is _four times_ the block size */
 
-void AES_bi_ige_encrypt(const unsigned char *in, unsigned char *out,
+void __cdecl AES_bi_ige_encrypt(const unsigned char *in, unsigned char *out,
                         size_t length, const AES_KEY *key,
                         const AES_KEY *key2, const unsigned char *ivec,
                         const int enc)
diff --git a/crypto/aes/aes_misc.c b/crypto/aes/aes_misc.c
index 7403c84f82..59c4c04e2f 100644
--- a/crypto/aes/aes_misc.c
+++ b/crypto/aes/aes_misc.c
@@ -11,7 +11,7 @@
 #include <openssl/aes.h>
 #include "aes_locl.h"
 
-const char *AES_options(void)
+const char * __cdecl AES_options(void)
 {
 #ifdef FULL_UNROLL
     return "aes(full)";
diff --git a/crypto/aes/aes_ofb.c b/crypto/aes/aes_ofb.c
index 215b53858e..8b0686d37d 100644
--- a/crypto/aes/aes_ofb.c
+++ b/crypto/aes/aes_ofb.c
@@ -10,7 +10,7 @@
 #include <openssl/aes.h>
 #include <openssl/modes.h>
 
-void AES_ofb128_encrypt(const unsigned char *in, unsigned char *out,
+void __cdecl AES_ofb128_encrypt(const unsigned char *in, unsigned char *out,
                         size_t length, const AES_KEY *key,
                         unsigned char *ivec, int *num)
 {
diff --git a/crypto/aes/aes_wrap.c b/crypto/aes/aes_wrap.c
index cae0b21229..d9932d89d0 100644
--- a/crypto/aes/aes_wrap.c
+++ b/crypto/aes/aes_wrap.c
@@ -11,14 +11,14 @@
 #include <openssl/aes.h>
 #include <openssl/modes.h>
 
-int AES_wrap_key(AES_KEY *key, const unsigned char *iv,
+int __cdecl AES_wrap_key(AES_KEY *key, const unsigned char *iv,
                  unsigned char *out,
                  const unsigned char *in, unsigned int inlen)
 {
     return CRYPTO_128_wrap(key, iv, out, in, inlen, (block128_f) AES_encrypt);
 }
 
-int AES_unwrap_key(AES_KEY *key, const unsigned char *iv,
+int __cdecl AES_unwrap_key(AES_KEY *key, const unsigned char *iv,
                    unsigned char *out,
                    const unsigned char *in, unsigned int inlen)
 {
diff --git a/crypto/aes/aes_x86core.c b/crypto/aes/aes_x86core.c
index 1b660d716d..f7b176169a 100644
--- a/crypto/aes/aes_x86core.c
+++ b/crypto/aes/aes_x86core.c
@@ -471,7 +471,7 @@ static const u32 rcon[] = {
 /**
  * Expand the cipher key into the encryption key schedule.
  */
-int AES_set_encrypt_key(const unsigned char *userKey, const int bits,
+int __cdecl AES_set_encrypt_key(const unsigned char *userKey, const int bits,
                         AES_KEY *key)
 {
 
@@ -573,7 +573,7 @@ int AES_set_encrypt_key(const unsigned char *userKey, const int bits,
 /**
  * Expand the cipher key into the decryption key schedule.
  */
-int AES_set_decrypt_key(const unsigned char *userKey, const int bits,
+int __cdecl AES_set_decrypt_key(const unsigned char *userKey, const int bits,
                         AES_KEY *key)
 {
 
@@ -655,7 +655,7 @@ int AES_set_decrypt_key(const unsigned char *userKey, const int bits,
  * Encrypt a single block
  * in and out can overlap
  */
-void AES_encrypt(const unsigned char *in, unsigned char *out,
+void __cdecl AES_encrypt(const unsigned char *in, unsigned char *out,
                  const AES_KEY *key)
 {
 
@@ -869,7 +869,7 @@ void AES_encrypt(const unsigned char *in, unsigned char *out,
  * Decrypt a single block
  * in and out can overlap
  */
-void AES_decrypt(const unsigned char *in, unsigned char *out,
+void __cdecl AES_decrypt(const unsigned char *in, unsigned char *out,
                  const AES_KEY *key)
 {
 
diff --git a/crypto/asn1/a_bitstr.c b/crypto/asn1/a_bitstr.c
index bffbd160a2..7f8e703c1a 100644
--- a/crypto/asn1/a_bitstr.c
+++ b/crypto/asn1/a_bitstr.c
@@ -13,7 +13,7 @@
 #include <openssl/asn1.h>
 #include "asn1_locl.h"
 
-int ASN1_BIT_STRING_set(ASN1_BIT_STRING *x, unsigned char *d, int len)
+int __cdecl ASN1_BIT_STRING_set(ASN1_BIT_STRING *x, unsigned char *d, int len)
 {
     return ASN1_STRING_set(x, d, len);
 }
@@ -143,7 +143,7 @@ ASN1_BIT_STRING *c2i_ASN1_BIT_STRING(ASN1_BIT_STRING **a,
 /*
  * These next 2 functions from Goetz Babin-Ebell.
  */
-int ASN1_BIT_STRING_set_bit(ASN1_BIT_STRING *a, int n, int value)
+int __cdecl ASN1_BIT_STRING_set_bit(ASN1_BIT_STRING *a, int n, int value)
 {
     int w, v, iv;
     unsigned char *c;
@@ -178,7 +178,7 @@ int ASN1_BIT_STRING_set_bit(ASN1_BIT_STRING *a, int n, int value)
     return 1;
 }
 
-int ASN1_BIT_STRING_get_bit(const ASN1_BIT_STRING *a, int n)
+int __cdecl ASN1_BIT_STRING_get_bit(const ASN1_BIT_STRING *a, int n)
 {
     int w, v;
 
@@ -195,7 +195,7 @@ int ASN1_BIT_STRING_get_bit(const ASN1_BIT_STRING *a, int n)
  * which is not specified in 'flags', 1 otherwise.
  * 'len' is the length of 'flags'.
  */
-int ASN1_BIT_STRING_check(const ASN1_BIT_STRING *a,
+int __cdecl ASN1_BIT_STRING_check(const ASN1_BIT_STRING *a,
                           const unsigned char *flags, int flags_len)
 {
     int i, ok;
diff --git a/crypto/asn1/a_d2i_fp.c b/crypto/asn1/a_d2i_fp.c
index a1a17901b8..15072e3787 100644
--- a/crypto/asn1/a_d2i_fp.c
+++ b/crypto/asn1/a_d2i_fp.c
@@ -18,7 +18,7 @@
 #ifndef NO_OLD_ASN1
 # ifndef OPENSSL_NO_STDIO
 
-void *ASN1_d2i_fp(void *(*xnew) (void), d2i_of_void *d2i, FILE *in, void **x)
+void * __cdecl ASN1_d2i_fp(void *(__cdecl *xnew) (void), d2i_of_void *d2i, FILE *in, void **x)
 {
     BIO *b;
     void *ret;
@@ -34,7 +34,7 @@ void *ASN1_d2i_fp(void *(*xnew) (void), d2i_of_void *d2i, FILE *in, void **x)
 }
 # endif
 
-void *ASN1_d2i_bio(void *(*xnew) (void), d2i_of_void *d2i, BIO *in, void **x)
+void * __cdecl ASN1_d2i_bio(void * (__cdecl *xnew) (void), d2i_of_void *d2i, BIO *in, void **x)
 {
     BUF_MEM *b = NULL;
     const unsigned char *p;
@@ -54,7 +54,7 @@ void *ASN1_d2i_bio(void *(*xnew) (void), d2i_of_void *d2i, BIO *in, void **x)
 
 #endif
 
-void *ASN1_item_d2i_bio(const ASN1_ITEM *it, BIO *in, void *x)
+void * __cdecl ASN1_item_d2i_bio(const ASN1_ITEM *it, BIO *in, void *x)
 {
     BUF_MEM *b = NULL;
     const unsigned char *p;
@@ -73,7 +73,7 @@ void *ASN1_item_d2i_bio(const ASN1_ITEM *it, BIO *in, void *x)
 }
 
 #ifndef OPENSSL_NO_STDIO
-void *ASN1_item_d2i_fp(const ASN1_ITEM *it, FILE *in, void *x)
+void * __cdecl ASN1_item_d2i_fp(const ASN1_ITEM *it, FILE *in, void *x)
 {
     BIO *b;
     char *ret;
diff --git a/crypto/asn1/a_dup.c b/crypto/asn1/a_dup.c
index 50af6b0006..a9ae2ba142 100644
--- a/crypto/asn1/a_dup.c
+++ b/crypto/asn1/a_dup.c
@@ -13,7 +13,7 @@
 
 #ifndef NO_OLD_ASN1
 
-void *ASN1_dup(i2d_of_void *i2d, d2i_of_void *d2i, void *x)
+void * __cdecl ASN1_dup(i2d_of_void *i2d, d2i_of_void *d2i, void *x)
 {
     unsigned char *b, *p;
     const unsigned char *p2;
@@ -46,7 +46,7 @@ void *ASN1_dup(i2d_of_void *i2d, d2i_of_void *d2i, void *x)
  * decode.
  */
 
-void *ASN1_item_dup(const ASN1_ITEM *it, void *x)
+void * __cdecl ASN1_item_dup(const ASN1_ITEM *it, void *x)
 {
     unsigned char *b = NULL;
     const unsigned char *p;
diff --git a/crypto/asn1/a_gentm.c b/crypto/asn1/a_gentm.c
index d3878d6e57..bd1ea790e2 100644
--- a/crypto/asn1/a_gentm.c
+++ b/crypto/asn1/a_gentm.c
@@ -26,12 +26,12 @@ int asn1_generalizedtime_to_tm(struct tm *tm, const ASN1_GENERALIZEDTIME *d)
     return asn1_time_to_tm(tm, d);
 }
 
-int ASN1_GENERALIZEDTIME_check(const ASN1_GENERALIZEDTIME *d)
+int __cdecl ASN1_GENERALIZEDTIME_check(const ASN1_GENERALIZEDTIME *d)
 {
     return asn1_generalizedtime_to_tm(NULL, d);
 }
 
-int ASN1_GENERALIZEDTIME_set_string(ASN1_GENERALIZEDTIME *s, const char *str)
+int __cdecl ASN1_GENERALIZEDTIME_set_string(ASN1_GENERALIZEDTIME *s, const char *str)
 {
     ASN1_GENERALIZEDTIME t;
 
@@ -49,13 +49,13 @@ int ASN1_GENERALIZEDTIME_set_string(ASN1_GENERALIZEDTIME *s, const char *str)
     return 1;
 }
 
-ASN1_GENERALIZEDTIME *ASN1_GENERALIZEDTIME_set(ASN1_GENERALIZEDTIME *s,
+ASN1_GENERALIZEDTIME * __cdecl ASN1_GENERALIZEDTIME_set(ASN1_GENERALIZEDTIME *s,
                                                time_t t)
 {
     return ASN1_GENERALIZEDTIME_adj(s, t, 0, 0);
 }
 
-ASN1_GENERALIZEDTIME *ASN1_GENERALIZEDTIME_adj(ASN1_GENERALIZEDTIME *s,
+ASN1_GENERALIZEDTIME * __cdecl ASN1_GENERALIZEDTIME_adj(ASN1_GENERALIZEDTIME *s,
                                                time_t t, int offset_day,
                                                long offset_sec)
 {
@@ -74,7 +74,7 @@ ASN1_GENERALIZEDTIME *ASN1_GENERALIZEDTIME_adj(ASN1_GENERALIZEDTIME *s,
     return asn1_time_from_tm(s, ts, V_ASN1_GENERALIZEDTIME);
 }
 
-int ASN1_GENERALIZEDTIME_print(BIO *bp, const ASN1_GENERALIZEDTIME *tm)
+int __cdecl ASN1_GENERALIZEDTIME_print(BIO *bp, const ASN1_GENERALIZEDTIME *tm)
 {
     if (tm->type != V_ASN1_GENERALIZEDTIME)
         return 0;
diff --git a/crypto/asn1/a_i2d_fp.c b/crypto/asn1/a_i2d_fp.c
index 980c65a25d..fe553ffe6c 100644
--- a/crypto/asn1/a_i2d_fp.c
+++ b/crypto/asn1/a_i2d_fp.c
@@ -15,7 +15,7 @@
 #ifndef NO_OLD_ASN1
 
 # ifndef OPENSSL_NO_STDIO
-int ASN1_i2d_fp(i2d_of_void *i2d, FILE *out, void *x)
+int __cdecl ASN1_i2d_fp(i2d_of_void *i2d, FILE *out, void *x)
 {
     BIO *b;
     int ret;
@@ -31,7 +31,7 @@ int ASN1_i2d_fp(i2d_of_void *i2d, FILE *out, void *x)
 }
 # endif
 
-int ASN1_i2d_bio(i2d_of_void *i2d, BIO *out, unsigned char *x)
+int __cdecl ASN1_i2d_bio(i2d_of_void *i2d, BIO *out, unsigned char *x)
 {
     char *b;
     unsigned char *p;
@@ -68,7 +68,7 @@ int ASN1_i2d_bio(i2d_of_void *i2d, BIO *out, unsigned char *x)
 #endif
 
 #ifndef OPENSSL_NO_STDIO
-int ASN1_item_i2d_fp(const ASN1_ITEM *it, FILE *out, void *x)
+int __cdecl ASN1_item_i2d_fp(const ASN1_ITEM *it, FILE *out, void *x)
 {
     BIO *b;
     int ret;
@@ -84,7 +84,7 @@ int ASN1_item_i2d_fp(const ASN1_ITEM *it, FILE *out, void *x)
 }
 #endif
 
-int ASN1_item_i2d_bio(const ASN1_ITEM *it, BIO *out, void *x)
+int __cdecl ASN1_item_i2d_bio(const ASN1_ITEM *it, BIO *out, void *x)
 {
     unsigned char *b = NULL;
     int i, j = 0, n, ret = 1;
diff --git a/crypto/asn1/a_int.c b/crypto/asn1/a_int.c
index 70a45cb3cc..4386180ac0 100644
--- a/crypto/asn1/a_int.c
+++ b/crypto/asn1/a_int.c
@@ -15,12 +15,12 @@
 #include <openssl/bn.h>
 #include "asn1_locl.h"
 
-ASN1_INTEGER *ASN1_INTEGER_dup(const ASN1_INTEGER *x)
+ASN1_INTEGER * __cdecl ASN1_INTEGER_dup(const ASN1_INTEGER *x)
 {
     return ASN1_STRING_dup(x);
 }
 
-int ASN1_INTEGER_cmp(const ASN1_INTEGER *x, const ASN1_INTEGER *y)
+int __cdecl ASN1_INTEGER_cmp(const ASN1_INTEGER *x, const ASN1_INTEGER *y)
 {
     int neg, ret;
     /* Compare signs */
@@ -384,7 +384,7 @@ static int asn1_string_set_uint64(ASN1_STRING *a, uint64_t r, int itype)
  * set as negative (it doesn't add a padding zero).
  */
 
-ASN1_INTEGER *d2i_ASN1_UINTEGER(ASN1_INTEGER **a, const unsigned char **pp,
+ASN1_INTEGER * __cdecl d2i_ASN1_UINTEGER(ASN1_INTEGER **a, const unsigned char **pp,
                                 long length)
 {
     ASN1_INTEGER *ret = NULL;
@@ -510,32 +510,32 @@ static BIGNUM *asn1_string_to_bn(const ASN1_INTEGER *ai, BIGNUM *bn,
     return ret;
 }
 
-int ASN1_INTEGER_get_int64(int64_t *pr, const ASN1_INTEGER *a)
+int __cdecl ASN1_INTEGER_get_int64(int64_t *pr, const ASN1_INTEGER *a)
 {
     return asn1_string_get_int64(pr, a, V_ASN1_INTEGER);
 }
 
-int ASN1_INTEGER_set_int64(ASN1_INTEGER *a, int64_t r)
+int __cdecl ASN1_INTEGER_set_int64(ASN1_INTEGER *a, int64_t r)
 {
     return asn1_string_set_int64(a, r, V_ASN1_INTEGER);
 }
 
-int ASN1_INTEGER_get_uint64(uint64_t *pr, const ASN1_INTEGER *a)
+int __cdecl ASN1_INTEGER_get_uint64(uint64_t *pr, const ASN1_INTEGER *a)
 {
     return asn1_string_get_uint64(pr, a, V_ASN1_INTEGER);
 }
 
-int ASN1_INTEGER_set_uint64(ASN1_INTEGER *a, uint64_t r)
+int __cdecl ASN1_INTEGER_set_uint64(ASN1_INTEGER *a, uint64_t r)
 {
     return asn1_string_set_uint64(a, r, V_ASN1_INTEGER);
 }
 
-int ASN1_INTEGER_set(ASN1_INTEGER *a, long v)
+int __cdecl ASN1_INTEGER_set(ASN1_INTEGER *a, long v)
 {
     return ASN1_INTEGER_set_int64(a, v);
 }
 
-long ASN1_INTEGER_get(const ASN1_INTEGER *a)
+long __cdecl ASN1_INTEGER_get(const ASN1_INTEGER *a)
 {
     int i;
     int64_t r;
@@ -549,32 +549,32 @@ long ASN1_INTEGER_get(const ASN1_INTEGER *a)
     return (long)r;
 }
 
-ASN1_INTEGER *BN_to_ASN1_INTEGER(const BIGNUM *bn, ASN1_INTEGER *ai)
+ASN1_INTEGER * __cdecl BN_to_ASN1_INTEGER(const BIGNUM *bn, ASN1_INTEGER *ai)
 {
     return bn_to_asn1_string(bn, ai, V_ASN1_INTEGER);
 }
 
-BIGNUM *ASN1_INTEGER_to_BN(const ASN1_INTEGER *ai, BIGNUM *bn)
+BIGNUM * __cdecl ASN1_INTEGER_to_BN(const ASN1_INTEGER *ai, BIGNUM *bn)
 {
     return asn1_string_to_bn(ai, bn, V_ASN1_INTEGER);
 }
 
-int ASN1_ENUMERATED_get_int64(int64_t *pr, const ASN1_ENUMERATED *a)
+int __cdecl ASN1_ENUMERATED_get_int64(int64_t *pr, const ASN1_ENUMERATED *a)
 {
     return asn1_string_get_int64(pr, a, V_ASN1_ENUMERATED);
 }
 
-int ASN1_ENUMERATED_set_int64(ASN1_ENUMERATED *a, int64_t r)
+int __cdecl ASN1_ENUMERATED_set_int64(ASN1_ENUMERATED *a, int64_t r)
 {
     return asn1_string_set_int64(a, r, V_ASN1_ENUMERATED);
 }
 
-int ASN1_ENUMERATED_set(ASN1_ENUMERATED *a, long v)
+int __cdecl ASN1_ENUMERATED_set(ASN1_ENUMERATED *a, long v)
 {
     return ASN1_ENUMERATED_set_int64(a, v);
 }
 
-long ASN1_ENUMERATED_get(const ASN1_ENUMERATED *a)
+long __cdecl ASN1_ENUMERATED_get(const ASN1_ENUMERATED *a)
 {
     int i;
     int64_t r;
@@ -592,12 +592,12 @@ long ASN1_ENUMERATED_get(const ASN1_ENUMERATED *a)
     return (long)r;
 }
 
-ASN1_ENUMERATED *BN_to_ASN1_ENUMERATED(const BIGNUM *bn, ASN1_ENUMERATED *ai)
+ASN1_ENUMERATED * __cdecl BN_to_ASN1_ENUMERATED(const BIGNUM *bn, ASN1_ENUMERATED *ai)
 {
     return bn_to_asn1_string(bn, ai, V_ASN1_ENUMERATED);
 }
 
-BIGNUM *ASN1_ENUMERATED_to_BN(const ASN1_ENUMERATED *ai, BIGNUM *bn)
+BIGNUM * __cdecl ASN1_ENUMERATED_to_BN(const ASN1_ENUMERATED *ai, BIGNUM *bn)
 {
     return asn1_string_to_bn(ai, bn, V_ASN1_ENUMERATED);
 }
diff --git a/crypto/asn1/a_mbstr.c b/crypto/asn1/a_mbstr.c
index 949fe6c161..5023259261 100644
--- a/crypto/asn1/a_mbstr.c
+++ b/crypto/asn1/a_mbstr.c
@@ -32,13 +32,13 @@ static int cpy_utf8(unsigned long value, void *arg);
  * size limits too.
  */
 
-int ASN1_mbstring_copy(ASN1_STRING **out, const unsigned char *in, int len,
+int __cdecl ASN1_mbstring_copy(ASN1_STRING **out, const unsigned char *in, int len,
                        int inform, unsigned long mask)
 {
     return ASN1_mbstring_ncopy(out, in, len, inform, mask, 0, 0);
 }
 
-int ASN1_mbstring_ncopy(ASN1_STRING **out, const unsigned char *in, int len,
+int __cdecl ASN1_mbstring_ncopy(ASN1_STRING **out, const unsigned char *in, int len,
                         int inform, unsigned long mask,
                         long minsize, long maxsize)
 {
diff --git a/crypto/asn1/a_object.c b/crypto/asn1/a_object.c
index 5e1424a806..54f8e51525 100644
--- a/crypto/asn1/a_object.c
+++ b/crypto/asn1/a_object.c
@@ -18,7 +18,7 @@
 #include "internal/asn1_int.h"
 #include "asn1_locl.h"
 
-int i2d_ASN1_OBJECT(const ASN1_OBJECT *a, unsigned char **pp)
+int __cdecl i2d_ASN1_OBJECT(const ASN1_OBJECT *a, unsigned char **pp)
 {
     unsigned char *p, *allocated = NULL;
     int objsize;
@@ -50,7 +50,7 @@ int i2d_ASN1_OBJECT(const ASN1_OBJECT *a, unsigned char **pp)
     return objsize;
 }
 
-int a2d_ASN1_OBJECT(unsigned char *out, int olen, const char *buf, int num)
+int __cdecl a2d_ASN1_OBJECT(unsigned char *out, int olen, const char *buf, int num)
 {
     int i, first, len = 0, c, use_bn;
     char ftmp[24], *tmp = ftmp;
@@ -177,12 +177,12 @@ int a2d_ASN1_OBJECT(unsigned char *out, int olen, const char *buf, int num)
     return 0;
 }
 
-int i2t_ASN1_OBJECT(char *buf, int buf_len, const ASN1_OBJECT *a)
+int __cdecl i2t_ASN1_OBJECT(char *buf, int buf_len, const ASN1_OBJECT *a)
 {
     return OBJ_obj2txt(buf, buf_len, a, 0);
 }
 
-int i2a_ASN1_OBJECT(BIO *bp, const ASN1_OBJECT *a)
+int __cdecl i2a_ASN1_OBJECT(BIO *bp, const ASN1_OBJECT *a)
 {
     char buf[80], *p = buf;
     int i;
@@ -208,7 +208,7 @@ int i2a_ASN1_OBJECT(BIO *bp, const ASN1_OBJECT *a)
     return i;
 }
 
-ASN1_OBJECT *d2i_ASN1_OBJECT(ASN1_OBJECT **a, const unsigned char **pp,
+ASN1_OBJECT * __cdecl d2i_ASN1_OBJECT(ASN1_OBJECT **a, const unsigned char **pp,
                              long length)
 {
     const unsigned char *p;
@@ -332,7 +332,7 @@ ASN1_OBJECT *c2i_ASN1_OBJECT(ASN1_OBJECT **a, const unsigned char **pp,
     return NULL;
 }
 
-ASN1_OBJECT *ASN1_OBJECT_new(void)
+ASN1_OBJECT * __cdecl ASN1_OBJECT_new(void)
 {
     ASN1_OBJECT *ret;
 
@@ -345,7 +345,7 @@ ASN1_OBJECT *ASN1_OBJECT_new(void)
     return ret;
 }
 
-void ASN1_OBJECT_free(ASN1_OBJECT *a)
+void __cdecl ASN1_OBJECT_free(ASN1_OBJECT *a)
 {
     if (a == NULL)
         return;
@@ -367,7 +367,7 @@ void ASN1_OBJECT_free(ASN1_OBJECT *a)
         OPENSSL_free(a);
 }
 
-ASN1_OBJECT *ASN1_OBJECT_create(int nid, unsigned char *data, int len,
+ASN1_OBJECT * __cdecl ASN1_OBJECT_create(int nid, unsigned char *data, int len,
                                 const char *sn, const char *ln)
 {
     ASN1_OBJECT o;
diff --git a/crypto/asn1/a_octet.c b/crypto/asn1/a_octet.c
index 2e1205caea..3ee70e8745 100644
--- a/crypto/asn1/a_octet.c
+++ b/crypto/asn1/a_octet.c
@@ -11,18 +11,18 @@
 #include "internal/cryptlib.h"
 #include <openssl/asn1.h>
 
-ASN1_OCTET_STRING *ASN1_OCTET_STRING_dup(const ASN1_OCTET_STRING *x)
+ASN1_OCTET_STRING * __cdecl ASN1_OCTET_STRING_dup(const ASN1_OCTET_STRING *x)
 {
     return ASN1_STRING_dup(x);
 }
 
-int ASN1_OCTET_STRING_cmp(const ASN1_OCTET_STRING *a,
+int __cdecl ASN1_OCTET_STRING_cmp(const ASN1_OCTET_STRING *a,
                           const ASN1_OCTET_STRING *b)
 {
     return ASN1_STRING_cmp(a, b);
 }
 
-int ASN1_OCTET_STRING_set(ASN1_OCTET_STRING *x, const unsigned char *d,
+int __cdecl ASN1_OCTET_STRING_set(ASN1_OCTET_STRING *x, const unsigned char *d,
                           int len)
 {
     return ASN1_STRING_set(x, d, len);
diff --git a/crypto/asn1/a_print.c b/crypto/asn1/a_print.c
index 8a373d9da9..f25605a0a3 100644
--- a/crypto/asn1/a_print.c
+++ b/crypto/asn1/a_print.c
@@ -12,7 +12,7 @@
 #include "internal/cryptlib.h"
 #include <openssl/asn1.h>
 
-int ASN1_PRINTABLE_type(const unsigned char *s, int len)
+int __cdecl ASN1_PRINTABLE_type(const unsigned char *s, int len)
 {
     int c;
     int ia5 = 0;
@@ -37,7 +37,7 @@ int ASN1_PRINTABLE_type(const unsigned char *s, int len)
     return V_ASN1_PRINTABLESTRING;
 }
 
-int ASN1_UNIVERSALSTRING_to_string(ASN1_UNIVERSALSTRING *s)
+int __cdecl ASN1_UNIVERSALSTRING_to_string(ASN1_UNIVERSALSTRING *s)
 {
     int i;
     unsigned char *p;
@@ -65,7 +65,7 @@ int ASN1_UNIVERSALSTRING_to_string(ASN1_UNIVERSALSTRING *s)
     return 1;
 }
 
-int ASN1_STRING_print(BIO *bp, const ASN1_STRING *v)
+int __cdecl ASN1_STRING_print(BIO *bp, const ASN1_STRING *v)
 {
     int i, n;
     char buf[80];
diff --git a/crypto/asn1/a_strex.c b/crypto/asn1/a_strex.c
index ea4dd1c5b1..9667e77e02 100644
--- a/crypto/asn1/a_strex.c
+++ b/crypto/asn1/a_strex.c
@@ -583,13 +583,13 @@ int X509_NAME_print_ex_fp(FILE *fp, const X509_NAME *nm, int indent,
 }
 #endif
 
-int ASN1_STRING_print_ex(BIO *out, const ASN1_STRING *str, unsigned long flags)
+int __cdecl ASN1_STRING_print_ex(BIO *out, const ASN1_STRING *str, unsigned long flags)
 {
     return do_print_ex(send_bio_chars, out, flags, str);
 }
 
 #ifndef OPENSSL_NO_STDIO
-int ASN1_STRING_print_ex_fp(FILE *fp, const ASN1_STRING *str, unsigned long flags)
+int __cdecl ASN1_STRING_print_ex_fp(FILE *fp, const ASN1_STRING *str, unsigned long flags)
 {
     return do_print_ex(send_fp_chars, fp, flags, str);
 }
@@ -600,7 +600,7 @@ int ASN1_STRING_print_ex_fp(FILE *fp, const ASN1_STRING *str, unsigned long flag
  * in output string or a negative error code
  */
 
-int ASN1_STRING_to_UTF8(unsigned char **out, const ASN1_STRING *in)
+int __cdecl ASN1_STRING_to_UTF8(unsigned char **out, const ASN1_STRING *in)
 {
     ASN1_STRING stmp, *str = &stmp;
     int mbflag, type, ret;
diff --git a/crypto/asn1/a_strnid.c b/crypto/asn1/a_strnid.c
index f19a9de647..712b31a65f 100644
--- a/crypto/asn1/a_strnid.c
+++ b/crypto/asn1/a_strnid.c
@@ -13,8 +13,8 @@
 #include <openssl/objects.h>
 
 static STACK_OF(ASN1_STRING_TABLE) *stable = NULL;
-static void st_free(ASN1_STRING_TABLE *tbl);
-static int sk_table_cmp(const ASN1_STRING_TABLE *const *a,
+static void __cdecl st_free(ASN1_STRING_TABLE *tbl);
+static int __cdecl sk_table_cmp(const ASN1_STRING_TABLE *const *a,
                         const ASN1_STRING_TABLE *const *b);
 
 /*
@@ -25,12 +25,12 @@ static int sk_table_cmp(const ASN1_STRING_TABLE *const *a,
 
 static unsigned long global_mask = B_ASN1_UTF8STRING;
 
-void ASN1_STRING_set_default_mask(unsigned long mask)
+void __cdecl ASN1_STRING_set_default_mask(unsigned long mask)
 {
     global_mask = mask;
 }
 
-unsigned long ASN1_STRING_get_default_mask(void)
+unsigned long __cdecl ASN1_STRING_get_default_mask(void)
 {
     return global_mask;
 }
@@ -45,7 +45,7 @@ unsigned long ASN1_STRING_get_default_mask(void)
  * default:   the default value, Printable, T61, BMP.
  */
 
-int ASN1_STRING_set_default_mask_asc(const char *p)
+int __cdecl ASN1_STRING_set_default_mask_asc(const char *p)
 {
     unsigned long mask;
     char *end;
@@ -76,7 +76,7 @@ int ASN1_STRING_set_default_mask_asc(const char *p)
  * a corresponding OID. For example certificates and certificate requests.
  */
 
-ASN1_STRING *ASN1_STRING_set_by_NID(ASN1_STRING **out,
+ASN1_STRING * __cdecl ASN1_STRING_set_by_NID(ASN1_STRING **out,
                                     const unsigned char *in, int inlen,
                                     int inform, int nid)
 {
@@ -109,7 +109,7 @@ ASN1_STRING *ASN1_STRING_set_by_NID(ASN1_STRING **out,
 
 #include "tbl_standard.h"
 
-static int sk_table_cmp(const ASN1_STRING_TABLE *const *a,
+static int __cdecl sk_table_cmp(const ASN1_STRING_TABLE *const *a,
                         const ASN1_STRING_TABLE *const *b)
 {
     return (*a)->nid - (*b)->nid;
@@ -117,14 +117,14 @@ static int sk_table_cmp(const ASN1_STRING_TABLE *const *a,
 
 DECLARE_OBJ_BSEARCH_CMP_FN(ASN1_STRING_TABLE, ASN1_STRING_TABLE, table);
 
-static int table_cmp(const ASN1_STRING_TABLE *a, const ASN1_STRING_TABLE *b)
+static int __cdecl table_cmp(const ASN1_STRING_TABLE *a, const ASN1_STRING_TABLE *b)
 {
     return a->nid - b->nid;
 }
 
 IMPLEMENT_OBJ_BSEARCH_CMP_FN(ASN1_STRING_TABLE, ASN1_STRING_TABLE, table);
 
-ASN1_STRING_TABLE *ASN1_STRING_TABLE_get(int nid)
+ASN1_STRING_TABLE * __cdecl ASN1_STRING_TABLE_get(int nid)
 {
     int idx;
     ASN1_STRING_TABLE fnd;
@@ -179,7 +179,7 @@ static ASN1_STRING_TABLE *stable_get(int nid)
     return rv;
 }
 
-int ASN1_STRING_TABLE_add(int nid,
+int __cdecl ASN1_STRING_TABLE_add(int nid,
                           long minsize, long maxsize, unsigned long mask,
                           unsigned long flags)
 {
@@ -201,7 +201,7 @@ int ASN1_STRING_TABLE_add(int nid,
     return 1;
 }
 
-void ASN1_STRING_TABLE_cleanup(void)
+void __cdecl ASN1_STRING_TABLE_cleanup(void)
 {
     STACK_OF(ASN1_STRING_TABLE) *tmp;
 
@@ -212,7 +212,7 @@ void ASN1_STRING_TABLE_cleanup(void)
     sk_ASN1_STRING_TABLE_pop_free(tmp, st_free);
 }
 
-static void st_free(ASN1_STRING_TABLE *tbl)
+static void __cdecl st_free(ASN1_STRING_TABLE *tbl)
 {
     if (tbl->flags & STABLE_FLAGS_MALLOC)
         OPENSSL_free(tbl);
diff --git a/crypto/asn1/a_time.c b/crypto/asn1/a_time.c
index c36dd95001..bca171433a 100644
--- a/crypto/asn1/a_time.c
+++ b/crypto/asn1/a_time.c
@@ -314,12 +314,12 @@ ASN1_TIME *asn1_time_from_tm(ASN1_TIME *s, struct tm *ts, int type)
     return NULL;
 }
 
-ASN1_TIME *ASN1_TIME_set(ASN1_TIME *s, time_t t)
+ASN1_TIME * __cdecl ASN1_TIME_set(ASN1_TIME *s, time_t t)
 {
     return ASN1_TIME_adj(s, t, 0, 0);
 }
 
-ASN1_TIME *ASN1_TIME_adj(ASN1_TIME *s, time_t t,
+ASN1_TIME * __cdecl ASN1_TIME_adj(ASN1_TIME *s, time_t t,
                          int offset_day, long offset_sec)
 {
     struct tm *ts;
@@ -337,7 +337,7 @@ ASN1_TIME *ASN1_TIME_adj(ASN1_TIME *s, time_t t,
     return asn1_time_from_tm(s, ts, V_ASN1_UNDEF);
 }
 
-int ASN1_TIME_check(const ASN1_TIME *t)
+int __cdecl ASN1_TIME_check(const ASN1_TIME *t)
 {
     if (t->type == V_ASN1_GENERALIZEDTIME)
         return ASN1_GENERALIZEDTIME_check(t);
@@ -347,7 +347,7 @@ int ASN1_TIME_check(const ASN1_TIME *t)
 }
 
 /* Convert an ASN1_TIME structure to GeneralizedTime */
-ASN1_GENERALIZEDTIME *ASN1_TIME_to_generalizedtime(const ASN1_TIME *t,
+ASN1_GENERALIZEDTIME * __cdecl ASN1_TIME_to_generalizedtime(const ASN1_TIME *t,
                                                    ASN1_GENERALIZEDTIME **out)
 {
     ASN1_GENERALIZEDTIME *ret = NULL;
@@ -367,7 +367,7 @@ ASN1_GENERALIZEDTIME *ASN1_TIME_to_generalizedtime(const ASN1_TIME *t,
     return ret;
 }
 
-int ASN1_TIME_set_string(ASN1_TIME *s, const char *str)
+int __cdecl ASN1_TIME_set_string(ASN1_TIME *s, const char *str)
 {
     /* Try UTC, if that fails, try GENERALIZED */
     if (ASN1_UTCTIME_set_string(s, str))
@@ -375,7 +375,7 @@ int ASN1_TIME_set_string(ASN1_TIME *s, const char *str)
     return ASN1_GENERALIZEDTIME_set_string(s, str);
 }
 
-int ASN1_TIME_set_string_X509(ASN1_TIME *s, const char *str)
+int __cdecl ASN1_TIME_set_string_X509(ASN1_TIME *s, const char *str)
 {
     ASN1_TIME t;
     struct tm tm;
@@ -434,7 +434,7 @@ out:
     return rv;
 }
 
-int ASN1_TIME_to_tm(const ASN1_TIME *s, struct tm *tm)
+int __cdecl ASN1_TIME_to_tm(const ASN1_TIME *s, struct tm *tm)
 {
     if (s == NULL) {
         time_t now_t;
@@ -449,7 +449,7 @@ int ASN1_TIME_to_tm(const ASN1_TIME *s, struct tm *tm)
     return asn1_time_to_tm(tm, s);
 }
 
-int ASN1_TIME_diff(int *pday, int *psec,
+int __cdecl ASN1_TIME_diff(int *pday, int *psec,
                    const ASN1_TIME *from, const ASN1_TIME *to)
 {
     struct tm tm_from, tm_to;
@@ -466,7 +466,7 @@ static const char _asn1_mon[12][4] = {
     "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"
 };
 
-int ASN1_TIME_print(BIO *bp, const ASN1_TIME *tm)
+int __cdecl ASN1_TIME_print(BIO *bp, const ASN1_TIME *tm)
 {
     char *v;
     int gmt = 0, l;
@@ -513,7 +513,7 @@ int ASN1_TIME_print(BIO *bp, const ASN1_TIME *tm)
     return 0;
 }
 
-int ASN1_TIME_cmp_time_t(const ASN1_TIME *s, time_t t)
+int __cdecl ASN1_TIME_cmp_time_t(const ASN1_TIME *s, time_t t)
 {
     struct tm stm, ttm;
     int day, sec;
@@ -534,7 +534,7 @@ int ASN1_TIME_cmp_time_t(const ASN1_TIME *s, time_t t)
     return 0;
 }
 
-int ASN1_TIME_normalize(ASN1_TIME *t)
+int __cdecl ASN1_TIME_normalize(ASN1_TIME *t)
 {
     struct tm tm;
 
@@ -544,7 +544,7 @@ int ASN1_TIME_normalize(ASN1_TIME *t)
     return asn1_time_from_tm(t, &tm, V_ASN1_UNDEF) != NULL;
 }
 
-int ASN1_TIME_compare(const ASN1_TIME *a, const ASN1_TIME *b)
+int __cdecl ASN1_TIME_compare(const ASN1_TIME *a, const ASN1_TIME *b)
 {
     int day, sec;
 
diff --git a/crypto/asn1/a_type.c b/crypto/asn1/a_type.c
index 732328e050..51f4490837 100644
--- a/crypto/asn1/a_type.c
+++ b/crypto/asn1/a_type.c
@@ -13,7 +13,7 @@
 #include <openssl/objects.h>
 #include "asn1_locl.h"
 
-int ASN1_TYPE_get(const ASN1_TYPE *a)
+int __cdecl ASN1_TYPE_get(const ASN1_TYPE *a)
 {
     if (a->type == V_ASN1_BOOLEAN
             || a->type == V_ASN1_NULL
@@ -23,7 +23,7 @@ int ASN1_TYPE_get(const ASN1_TYPE *a)
         return 0;
 }
 
-void ASN1_TYPE_set(ASN1_TYPE *a, int type, void *value)
+void __cdecl ASN1_TYPE_set(ASN1_TYPE *a, int type, void *value)
 {
     if (a->type != V_ASN1_BOOLEAN
             && a->type != V_ASN1_NULL
@@ -38,7 +38,7 @@ void ASN1_TYPE_set(ASN1_TYPE *a, int type, void *value)
         a->value.ptr = value;
 }
 
-int ASN1_TYPE_set1(ASN1_TYPE *a, int type, const void *value)
+int __cdecl ASN1_TYPE_set1(ASN1_TYPE *a, int type, const void *value)
 {
     if (!value || (type == V_ASN1_BOOLEAN)) {
         void *p = (void *)value;
@@ -60,7 +60,7 @@ int ASN1_TYPE_set1(ASN1_TYPE *a, int type, const void *value)
 }
 
 /* Returns 0 if they are equal, != 0 otherwise. */
-int ASN1_TYPE_cmp(const ASN1_TYPE *a, const ASN1_TYPE *b)
+int __cdecl ASN1_TYPE_cmp(const ASN1_TYPE *a, const ASN1_TYPE *b)
 {
     int result = -1;
 
@@ -106,7 +106,7 @@ int ASN1_TYPE_cmp(const ASN1_TYPE *a, const ASN1_TYPE *b)
     return result;
 }
 
-ASN1_TYPE *ASN1_TYPE_pack_sequence(const ASN1_ITEM *it, void *s, ASN1_TYPE **t)
+ASN1_TYPE * __cdecl ASN1_TYPE_pack_sequence(const ASN1_ITEM *it, void *s, ASN1_TYPE **t)
 {
     ASN1_OCTET_STRING *oct;
     ASN1_TYPE *rt;
@@ -130,7 +130,7 @@ ASN1_TYPE *ASN1_TYPE_pack_sequence(const ASN1_ITEM *it, void *s, ASN1_TYPE **t)
     return rt;
 }
 
-void *ASN1_TYPE_unpack_sequence(const ASN1_ITEM *it, const ASN1_TYPE *t)
+void * __cdecl ASN1_TYPE_unpack_sequence(const ASN1_ITEM *it, const ASN1_TYPE *t)
 {
     if (t == NULL || t->type != V_ASN1_SEQUENCE || t->value.sequence == NULL)
         return NULL;
diff --git a/crypto/asn1/a_utctm.c b/crypto/asn1/a_utctm.c
index b224991aa3..c5284ad11c 100644
--- a/crypto/asn1/a_utctm.c
+++ b/crypto/asn1/a_utctm.c
@@ -22,13 +22,13 @@ int asn1_utctime_to_tm(struct tm *tm, const ASN1_UTCTIME *d)
     return asn1_time_to_tm(tm, d);
 }
 
-int ASN1_UTCTIME_check(const ASN1_UTCTIME *d)
+int __cdecl ASN1_UTCTIME_check(const ASN1_UTCTIME *d)
 {
     return asn1_utctime_to_tm(NULL, d);
 }
 
 /* Sets the string via simple copy without cleaning it up */
-int ASN1_UTCTIME_set_string(ASN1_UTCTIME *s, const char *str)
+int __cdecl ASN1_UTCTIME_set_string(ASN1_UTCTIME *s, const char *str)
 {
     ASN1_UTCTIME t;
 
@@ -46,12 +46,12 @@ int ASN1_UTCTIME_set_string(ASN1_UTCTIME *s, const char *str)
     return 1;
 }
 
-ASN1_UTCTIME *ASN1_UTCTIME_set(ASN1_UTCTIME *s, time_t t)
+ASN1_UTCTIME * __cdecl ASN1_UTCTIME_set(ASN1_UTCTIME *s, time_t t)
 {
     return ASN1_UTCTIME_adj(s, t, 0, 0);
 }
 
-ASN1_UTCTIME *ASN1_UTCTIME_adj(ASN1_UTCTIME *s, time_t t,
+ASN1_UTCTIME * __cdecl ASN1_UTCTIME_adj(ASN1_UTCTIME *s, time_t t,
                                int offset_day, long offset_sec)
 {
     struct tm *ts;
@@ -69,7 +69,7 @@ ASN1_UTCTIME *ASN1_UTCTIME_adj(ASN1_UTCTIME *s, time_t t,
     return asn1_time_from_tm(s, ts, V_ASN1_UTCTIME);
 }
 
-int ASN1_UTCTIME_cmp_time_t(const ASN1_UTCTIME *s, time_t t)
+int __cdecl ASN1_UTCTIME_cmp_time_t(const ASN1_UTCTIME *s, time_t t)
 {
     struct tm stm, ttm;
     int day, sec;
@@ -90,7 +90,7 @@ int ASN1_UTCTIME_cmp_time_t(const ASN1_UTCTIME *s, time_t t)
     return 0;
 }
 
-int ASN1_UTCTIME_print(BIO *bp, const ASN1_UTCTIME *tm)
+int __cdecl ASN1_UTCTIME_print(BIO *bp, const ASN1_UTCTIME *tm)
 {
     if (tm->type != V_ASN1_UTCTIME)
         return 0;
diff --git a/crypto/asn1/a_utf8.c b/crypto/asn1/a_utf8.c
index e2dc09f6ae..1f8508f7a6 100644
--- a/crypto/asn1/a_utf8.c
+++ b/crypto/asn1/a_utf8.c
@@ -24,7 +24,7 @@
  * -4 = character encoded incorrectly (not minimal length).
  */
 
-int UTF8_getc(const unsigned char *str, int len, unsigned long *val)
+int __cdecl UTF8_getc(const unsigned char *str, int len, unsigned long *val)
 {
     const unsigned char *p;
     unsigned long value;
@@ -121,7 +121,7 @@ int UTF8_getc(const unsigned char *str, int len, unsigned long *val)
  * most 6 characters.
  */
 
-int UTF8_putc(unsigned char *str, int len, unsigned long value)
+int __cdecl UTF8_putc(unsigned char *str, int len, unsigned long value)
 {
     if (!str)
         len = 6;                /* Maximum we will need */
diff --git a/crypto/asn1/ameth_lib.c b/crypto/asn1/ameth_lib.c
index d7d270dbb5..f6f6f9dfa3 100644
--- a/crypto/asn1/ameth_lib.c
+++ b/crypto/asn1/ameth_lib.c
@@ -18,13 +18,13 @@
 
 #include "standard_methods.h"
 
-typedef int sk_cmp_fn_type(const char *const *a, const char *const *b);
+typedef int __cdecl sk_cmp_fn_type(const char *const *a, const char *const *b);
 static STACK_OF(EVP_PKEY_ASN1_METHOD) *app_methods = NULL;
 
 DECLARE_OBJ_BSEARCH_CMP_FN(const EVP_PKEY_ASN1_METHOD *,
                            const EVP_PKEY_ASN1_METHOD *, ameth);
 
-static int ameth_cmp(const EVP_PKEY_ASN1_METHOD *const *a,
+static int __cdecl ameth_cmp(const EVP_PKEY_ASN1_METHOD *const *a,
                      const EVP_PKEY_ASN1_METHOD *const *b)
 {
     return ((*a)->pkey_id - (*b)->pkey_id);
@@ -33,7 +33,7 @@ static int ameth_cmp(const EVP_PKEY_ASN1_METHOD *const *a,
 IMPLEMENT_OBJ_BSEARCH_CMP_FN(const EVP_PKEY_ASN1_METHOD *,
                              const EVP_PKEY_ASN1_METHOD *, ameth);
 
-int EVP_PKEY_asn1_get_count(void)
+int __cdecl EVP_PKEY_asn1_get_count(void)
 {
     int num = OSSL_NELEM(standard_methods);
     if (app_methods)
@@ -41,7 +41,7 @@ int EVP_PKEY_asn1_get_count(void)
     return num;
 }
 
-const EVP_PKEY_ASN1_METHOD *EVP_PKEY_asn1_get0(int idx)
+const EVP_PKEY_ASN1_METHOD * __cdecl EVP_PKEY_asn1_get0(int idx)
 {
     int num = OSSL_NELEM(standard_methods);
     if (idx < 0)
@@ -75,7 +75,7 @@ static const EVP_PKEY_ASN1_METHOD *pkey_asn1_find(int type)
  * implementing 'type' or NULL if no engine implements it.
  */
 
-const EVP_PKEY_ASN1_METHOD *EVP_PKEY_asn1_find(ENGINE **pe, int type)
+const EVP_PKEY_ASN1_METHOD * __cdecl EVP_PKEY_asn1_find(ENGINE **pe, int type)
 {
     const EVP_PKEY_ASN1_METHOD *t;
 
@@ -100,7 +100,7 @@ const EVP_PKEY_ASN1_METHOD *EVP_PKEY_asn1_find(ENGINE **pe, int type)
     return t;
 }
 
-const EVP_PKEY_ASN1_METHOD *EVP_PKEY_asn1_find_str(ENGINE **pe,
+const EVP_PKEY_ASN1_METHOD * __cdecl EVP_PKEY_asn1_find_str(ENGINE **pe,
                                                    const char *str, int len)
 {
     int i;
@@ -136,7 +136,7 @@ const EVP_PKEY_ASN1_METHOD *EVP_PKEY_asn1_find_str(ENGINE **pe,
     return NULL;
 }
 
-int EVP_PKEY_asn1_add0(const EVP_PKEY_ASN1_METHOD *ameth)
+int __cdecl EVP_PKEY_asn1_add0(const EVP_PKEY_ASN1_METHOD *ameth)
 {
     EVP_PKEY_ASN1_METHOD tmp = { 0, };
 
@@ -175,7 +175,7 @@ int EVP_PKEY_asn1_add0(const EVP_PKEY_ASN1_METHOD *ameth)
     return 1;
 }
 
-int EVP_PKEY_asn1_add_alias(int to, int from)
+int __cdecl EVP_PKEY_asn1_add_alias(int to, int from)
 {
     EVP_PKEY_ASN1_METHOD *ameth;
     ameth = EVP_PKEY_asn1_new(from, ASN1_PKEY_ALIAS, NULL, NULL);
@@ -189,7 +189,7 @@ int EVP_PKEY_asn1_add_alias(int to, int from)
     return 1;
 }
 
-int EVP_PKEY_asn1_get0_info(int *ppkey_id, int *ppkey_base_id,
+int __cdecl EVP_PKEY_asn1_get0_info(int *ppkey_id, int *ppkey_base_id,
                             int *ppkey_flags, const char **pinfo,
                             const char **ppem_str,
                             const EVP_PKEY_ASN1_METHOD *ameth)
@@ -209,12 +209,12 @@ int EVP_PKEY_asn1_get0_info(int *ppkey_id, int *ppkey_base_id,
     return 1;
 }
 
-const EVP_PKEY_ASN1_METHOD *EVP_PKEY_get0_asn1(const EVP_PKEY *pkey)
+const EVP_PKEY_ASN1_METHOD * __cdecl EVP_PKEY_get0_asn1(const EVP_PKEY *pkey)
 {
     return pkey->ameth;
 }
 
-EVP_PKEY_ASN1_METHOD *EVP_PKEY_asn1_new(int id, int flags,
+EVP_PKEY_ASN1_METHOD * __cdecl EVP_PKEY_asn1_new(int id, int flags,
                                         const char *pem_str, const char *info)
 {
     EVP_PKEY_ASN1_METHOD *ameth = OPENSSL_zalloc(sizeof(*ameth));
@@ -246,7 +246,7 @@ EVP_PKEY_ASN1_METHOD *EVP_PKEY_asn1_new(int id, int flags,
 
 }
 
-void EVP_PKEY_asn1_copy(EVP_PKEY_ASN1_METHOD *dst,
+void __cdecl EVP_PKEY_asn1_copy(EVP_PKEY_ASN1_METHOD *dst,
                         const EVP_PKEY_ASN1_METHOD *src)
 {
 
@@ -284,7 +284,7 @@ void EVP_PKEY_asn1_copy(EVP_PKEY_ASN1_METHOD *dst,
 
 }
 
-void EVP_PKEY_asn1_free(EVP_PKEY_ASN1_METHOD *ameth)
+void __cdecl EVP_PKEY_asn1_free(EVP_PKEY_ASN1_METHOD *ameth)
 {
     if (ameth && (ameth->pkey_flags & ASN1_PKEY_DYNAMIC)) {
         OPENSSL_free(ameth->pem_str);
@@ -293,7 +293,7 @@ void EVP_PKEY_asn1_free(EVP_PKEY_ASN1_METHOD *ameth)
     }
 }
 
-void EVP_PKEY_asn1_set_public(EVP_PKEY_ASN1_METHOD *ameth,
+void __cdecl EVP_PKEY_asn1_set_public(EVP_PKEY_ASN1_METHOD *ameth,
                               int (*pub_decode) (EVP_PKEY *pk,
                                                  X509_PUBKEY *pub),
                               int (*pub_encode) (X509_PUBKEY *pub,
@@ -314,7 +314,7 @@ void EVP_PKEY_asn1_set_public(EVP_PKEY_ASN1_METHOD *ameth,
     ameth->pkey_bits = pkey_bits;
 }
 
-void EVP_PKEY_asn1_set_private(EVP_PKEY_ASN1_METHOD *ameth,
+void __cdecl EVP_PKEY_asn1_set_private(EVP_PKEY_ASN1_METHOD *ameth,
                                int (*priv_decode) (EVP_PKEY *pk,
                                                    const PKCS8_PRIV_KEY_INFO
                                                    *p8inf),
@@ -330,7 +330,7 @@ void EVP_PKEY_asn1_set_private(EVP_PKEY_ASN1_METHOD *ameth,
     ameth->priv_print = priv_print;
 }
 
-void EVP_PKEY_asn1_set_param(EVP_PKEY_ASN1_METHOD *ameth,
+void __cdecl EVP_PKEY_asn1_set_param(EVP_PKEY_ASN1_METHOD *ameth,
                              int (*param_decode) (EVP_PKEY *pkey,
                                                   const unsigned char **pder,
                                                   int derlen),
@@ -353,27 +353,27 @@ void EVP_PKEY_asn1_set_param(EVP_PKEY_ASN1_METHOD *ameth,
     ameth->param_print = param_print;
 }
 
-void EVP_PKEY_asn1_set_free(EVP_PKEY_ASN1_METHOD *ameth,
+void __cdecl EVP_PKEY_asn1_set_free(EVP_PKEY_ASN1_METHOD *ameth,
                             void (*pkey_free) (EVP_PKEY *pkey))
 {
     ameth->pkey_free = pkey_free;
 }
 
-void EVP_PKEY_asn1_set_ctrl(EVP_PKEY_ASN1_METHOD *ameth,
+void __cdecl EVP_PKEY_asn1_set_ctrl(EVP_PKEY_ASN1_METHOD *ameth,
                             int (*pkey_ctrl) (EVP_PKEY *pkey, int op,
                                               long arg1, void *arg2))
 {
     ameth->pkey_ctrl = pkey_ctrl;
 }
 
-void EVP_PKEY_asn1_set_security_bits(EVP_PKEY_ASN1_METHOD *ameth,
+void __cdecl EVP_PKEY_asn1_set_security_bits(EVP_PKEY_ASN1_METHOD *ameth,
                                      int (*pkey_security_bits) (const EVP_PKEY
                                                                 *pk))
 {
     ameth->pkey_security_bits = pkey_security_bits;
 }
 
-void EVP_PKEY_asn1_set_item(EVP_PKEY_ASN1_METHOD *ameth,
+void __cdecl EVP_PKEY_asn1_set_item(EVP_PKEY_ASN1_METHOD *ameth,
                             int (*item_verify) (EVP_MD_CTX *ctx,
                                                 const ASN1_ITEM *it,
                                                 void *asn,
@@ -391,7 +391,7 @@ void EVP_PKEY_asn1_set_item(EVP_PKEY_ASN1_METHOD *ameth,
     ameth->item_verify = item_verify;
 }
 
-void EVP_PKEY_asn1_set_siginf(EVP_PKEY_ASN1_METHOD *ameth,
+void __cdecl EVP_PKEY_asn1_set_siginf(EVP_PKEY_ASN1_METHOD *ameth,
                               int (*siginf_set) (X509_SIG_INFO *siginf,
                                                  const X509_ALGOR *alg,
                                                  const ASN1_STRING *sig))
@@ -399,25 +399,25 @@ void EVP_PKEY_asn1_set_siginf(EVP_PKEY_ASN1_METHOD *ameth,
     ameth->siginf_set = siginf_set;
 }
 
-void EVP_PKEY_asn1_set_check(EVP_PKEY_ASN1_METHOD *ameth,
+void __cdecl EVP_PKEY_asn1_set_check(EVP_PKEY_ASN1_METHOD *ameth,
                              int (*pkey_check) (const EVP_PKEY *pk))
 {
     ameth->pkey_check = pkey_check;
 }
 
-void EVP_PKEY_asn1_set_public_check(EVP_PKEY_ASN1_METHOD *ameth,
+void __cdecl EVP_PKEY_asn1_set_public_check(EVP_PKEY_ASN1_METHOD *ameth,
                                     int (*pkey_pub_check) (const EVP_PKEY *pk))
 {
     ameth->pkey_public_check = pkey_pub_check;
 }
 
-void EVP_PKEY_asn1_set_param_check(EVP_PKEY_ASN1_METHOD *ameth,
+void __cdecl EVP_PKEY_asn1_set_param_check(EVP_PKEY_ASN1_METHOD *ameth,
                                    int (*pkey_param_check) (const EVP_PKEY *pk))
 {
     ameth->pkey_param_check = pkey_param_check;
 }
 
-void EVP_PKEY_asn1_set_set_priv_key(EVP_PKEY_ASN1_METHOD *ameth,
+void __cdecl EVP_PKEY_asn1_set_set_priv_key(EVP_PKEY_ASN1_METHOD *ameth,
                                     int (*set_priv_key) (EVP_PKEY *pk,
                                                          const unsigned char
                                                             *priv,
@@ -426,7 +426,7 @@ void EVP_PKEY_asn1_set_set_priv_key(EVP_PKEY_ASN1_METHOD *ameth,
     ameth->set_priv_key = set_priv_key;
 }
 
-void EVP_PKEY_asn1_set_set_pub_key(EVP_PKEY_ASN1_METHOD *ameth,
+void __cdecl EVP_PKEY_asn1_set_set_pub_key(EVP_PKEY_ASN1_METHOD *ameth,
                                    int (*set_pub_key) (EVP_PKEY *pk,
                                                        const unsigned char *pub,
                                                        size_t len))
@@ -434,7 +434,7 @@ void EVP_PKEY_asn1_set_set_pub_key(EVP_PKEY_ASN1_METHOD *ameth,
     ameth->set_pub_key = set_pub_key;
 }
 
-void EVP_PKEY_asn1_set_get_priv_key(EVP_PKEY_ASN1_METHOD *ameth,
+void __cdecl EVP_PKEY_asn1_set_get_priv_key(EVP_PKEY_ASN1_METHOD *ameth,
                                     int (*get_priv_key) (const EVP_PKEY *pk,
                                                          unsigned char *priv,
                                                          size_t *len))
@@ -442,7 +442,7 @@ void EVP_PKEY_asn1_set_get_priv_key(EVP_PKEY_ASN1_METHOD *ameth,
     ameth->get_priv_key = get_priv_key;
 }
 
-void EVP_PKEY_asn1_set_get_pub_key(EVP_PKEY_ASN1_METHOD *ameth,
+void __cdecl EVP_PKEY_asn1_set_get_pub_key(EVP_PKEY_ASN1_METHOD *ameth,
                                    int (*get_pub_key) (const EVP_PKEY *pk,
                                                        unsigned char *pub,
                                                        size_t *len))
diff --git a/crypto/asn1/asn1_err.c b/crypto/asn1/asn1_err.c
index 613f9ae713..0e5c0d8562 100644
--- a/crypto/asn1/asn1_err.c
+++ b/crypto/asn1/asn1_err.c
@@ -338,7 +338,7 @@ static const ERR_STRING_DATA ASN1_str_reasons[] = {
 
 #endif
 
-int ERR_load_ASN1_strings(void)
+int __cdecl ERR_load_ASN1_strings(void)
 {
 #ifndef OPENSSL_NO_ERR
     if (ERR_func_error_string(ASN1_str_functs[0].error) == NULL) {
diff --git a/crypto/asn1/asn1_gen.c b/crypto/asn1/asn1_gen.c
index 493a693aa3..d1fa076297 100644
--- a/crypto/asn1/asn1_gen.c
+++ b/crypto/asn1/asn1_gen.c
@@ -75,7 +75,7 @@ static ASN1_TYPE *asn1_multi(int utype, const char *section, X509V3_CTX *cnf,
 static ASN1_TYPE *asn1_str2type(const char *str, int format, int utype);
 static int asn1_str2tag(const char *tagstr, int len);
 
-ASN1_TYPE *ASN1_generate_nconf(const char *str, CONF *nconf)
+ASN1_TYPE * __cdecl ASN1_generate_nconf(const char *str, CONF *nconf)
 {
     X509V3_CTX cnf;
 
@@ -86,7 +86,7 @@ ASN1_TYPE *ASN1_generate_nconf(const char *str, CONF *nconf)
     return ASN1_generate_v3(str, &cnf);
 }
 
-ASN1_TYPE *ASN1_generate_v3(const char *str, X509V3_CTX *cnf)
+ASN1_TYPE * __cdecl ASN1_generate_v3(const char *str, X509V3_CTX *cnf)
 {
     int err = 0;
     ASN1_TYPE *ret = generate_v3(str, cnf, 0, &err);
@@ -782,7 +782,7 @@ static int mask_cb(const char *elem, int len, void *arg)
     return 1;
 }
 
-int ASN1_str2mask(const char *str, unsigned long *pmask)
+int __cdecl ASN1_str2mask(const char *str, unsigned long *pmask)
 {
     *pmask = 0;
     return CONF_parse_list(str, '|', 1, mask_cb, pmask);
diff --git a/crypto/asn1/asn1_item_list.c b/crypto/asn1/asn1_item_list.c
index 9798192f4b..74c5f9f395 100644
--- a/crypto/asn1/asn1_item_list.c
+++ b/crypto/asn1/asn1_item_list.c
@@ -21,7 +21,7 @@
 
 #include "asn1_item_list.h"
 
-const ASN1_ITEM *ASN1_ITEM_lookup(const char *name)
+const ASN1_ITEM * __cdecl ASN1_ITEM_lookup(const char *name)
 {
     size_t i;
 
@@ -34,7 +34,7 @@ const ASN1_ITEM *ASN1_ITEM_lookup(const char *name)
     return NULL;
 }
 
-const ASN1_ITEM *ASN1_ITEM_get(size_t i)
+const ASN1_ITEM * __cdecl ASN1_ITEM_get(size_t i)
 {
     if (i >= OSSL_NELEM(asn1_item_list))
         return NULL;
diff --git a/crypto/asn1/asn1_lib.c b/crypto/asn1/asn1_lib.c
index 88c4b53918..a2d58d0074 100644
--- a/crypto/asn1/asn1_lib.c
+++ b/crypto/asn1/asn1_lib.c
@@ -31,17 +31,17 @@ static int _asn1_check_infinite_end(const unsigned char **p, long len)
     return 0;
 }
 
-int ASN1_check_infinite_end(unsigned char **p, long len)
+int __cdecl ASN1_check_infinite_end(unsigned char **p, long len)
 {
     return _asn1_check_infinite_end((const unsigned char **)p, len);
 }
 
-int ASN1_const_check_infinite_end(const unsigned char **p, long len)
+int __cdecl ASN1_const_check_infinite_end(const unsigned char **p, long len)
 {
     return _asn1_check_infinite_end(p, len);
 }
 
-int ASN1_get_object(const unsigned char **pp, long *plength, int *ptag,
+int __cdecl ASN1_get_object(const unsigned char **pp, long *plength, int *ptag,
                     int *pclass, long omax)
 {
     int i, ret;
@@ -152,7 +152,7 @@ static int asn1_get_length(const unsigned char **pp, int *inf, long *rl,
 /*
  * class 0 is constructed constructed == 2 for indefinite length constructed
  */
-void ASN1_put_object(unsigned char **pp, int constructed, int length, int tag,
+void __cdecl ASN1_put_object(unsigned char **pp, int constructed, int length, int tag,
                      int xclass)
 {
     unsigned char *p = *pp;
@@ -182,7 +182,7 @@ void ASN1_put_object(unsigned char **pp, int constructed, int length, int tag,
     *pp = p;
 }
 
-int ASN1_put_eoc(unsigned char **pp)
+int __cdecl ASN1_put_eoc(unsigned char **pp)
 {
     unsigned char *p = *pp;
     *p++ = 0;
@@ -212,7 +212,7 @@ static void asn1_put_length(unsigned char **pp, int length)
     *pp = p;
 }
 
-int ASN1_object_size(int constructed, int length, int tag)
+int __cdecl ASN1_object_size(int constructed, int length, int tag)
 {
     int ret = 1;
     if (length < 0)
@@ -240,7 +240,7 @@ int ASN1_object_size(int constructed, int length, int tag)
     return ret + length;
 }
 
-int ASN1_STRING_copy(ASN1_STRING *dst, const ASN1_STRING *str)
+int __cdecl ASN1_STRING_copy(ASN1_STRING *dst, const ASN1_STRING *str)
 {
     if (str == NULL)
         return 0;
@@ -253,7 +253,7 @@ int ASN1_STRING_copy(ASN1_STRING *dst, const ASN1_STRING *str)
     return 1;
 }
 
-ASN1_STRING *ASN1_STRING_dup(const ASN1_STRING *str)
+ASN1_STRING * __cdecl ASN1_STRING_dup(const ASN1_STRING *str)
 {
     ASN1_STRING *ret;
     if (!str)
@@ -268,7 +268,7 @@ ASN1_STRING *ASN1_STRING_dup(const ASN1_STRING *str)
     return ret;
 }
 
-int ASN1_STRING_set(ASN1_STRING *str, const void *_data, int len)
+int __cdecl ASN1_STRING_set(ASN1_STRING *str, const void *_data, int len)
 {
     unsigned char *c;
     const char *data = _data;
@@ -297,19 +297,19 @@ int ASN1_STRING_set(ASN1_STRING *str, const void *_data, int len)
     return 1;
 }
 
-void ASN1_STRING_set0(ASN1_STRING *str, void *data, int len)
+void __cdecl ASN1_STRING_set0(ASN1_STRING *str, void *data, int len)
 {
     OPENSSL_free(str->data);
     str->data = data;
     str->length = len;
 }
 
-ASN1_STRING *ASN1_STRING_new(void)
+ASN1_STRING * __cdecl ASN1_STRING_new(void)
 {
     return ASN1_STRING_type_new(V_ASN1_OCTET_STRING);
 }
 
-ASN1_STRING *ASN1_STRING_type_new(int type)
+ASN1_STRING * __cdecl ASN1_STRING_type_new(int type)
 {
     ASN1_STRING *ret;
 
@@ -332,14 +332,14 @@ void asn1_string_embed_free(ASN1_STRING *a, int embed)
         OPENSSL_free(a);
 }
 
-void ASN1_STRING_free(ASN1_STRING *a)
+void __cdecl ASN1_STRING_free(ASN1_STRING *a)
 {
     if (a == NULL)
         return;
     asn1_string_embed_free(a, a->flags & ASN1_STRING_FLAG_EMBED);
 }
 
-void ASN1_STRING_clear_free(ASN1_STRING *a)
+void __cdecl ASN1_STRING_clear_free(ASN1_STRING *a)
 {
     if (a == NULL)
         return;
@@ -348,7 +348,7 @@ void ASN1_STRING_clear_free(ASN1_STRING *a)
     ASN1_STRING_free(a);
 }
 
-int ASN1_STRING_cmp(const ASN1_STRING *a, const ASN1_STRING *b)
+int __cdecl ASN1_STRING_cmp(const ASN1_STRING *a, const ASN1_STRING *b)
 {
     int i;
 
@@ -363,22 +363,22 @@ int ASN1_STRING_cmp(const ASN1_STRING *a, const ASN1_STRING *b)
         return i;
 }
 
-int ASN1_STRING_length(const ASN1_STRING *x)
+int __cdecl ASN1_STRING_length(const ASN1_STRING *x)
 {
     return x->length;
 }
 
-void ASN1_STRING_length_set(ASN1_STRING *x, int len)
+void __cdecl ASN1_STRING_length_set(ASN1_STRING *x, int len)
 {
     x->length = len;
 }
 
-int ASN1_STRING_type(const ASN1_STRING *x)
+int __cdecl ASN1_STRING_type(const ASN1_STRING *x)
 {
     return x->type;
 }
 
-const unsigned char *ASN1_STRING_get0_data(const ASN1_STRING *x)
+const unsigned char * __cdecl ASN1_STRING_get0_data(const ASN1_STRING *x)
 {
     return x->data;
 }
diff --git a/crypto/asn1/asn1_par.c b/crypto/asn1/asn1_par.c
index 4b60c615de..2749b7f9fd 100644
--- a/crypto/asn1/asn1_par.c
+++ b/crypto/asn1/asn1_par.c
@@ -55,12 +55,12 @@ static int asn1_print_info(BIO *bp, int tag, int xclass, int constructed,
     return 0;
 }
 
-int ASN1_parse(BIO *bp, const unsigned char *pp, long len, int indent)
+int __cdecl ASN1_parse(BIO *bp, const unsigned char *pp, long len, int indent)
 {
     return asn1_parse2(bp, &pp, len, 0, 0, indent, 0);
 }
 
-int ASN1_parse_dump(BIO *bp, const unsigned char *pp, long len, int indent,
+int __cdecl ASN1_parse_dump(BIO *bp, const unsigned char *pp, long len, int indent,
                     int dump)
 {
     return asn1_parse2(bp, &pp, len, 0, 0, indent, dump);
@@ -345,7 +345,7 @@ static int asn1_parse2(BIO *bp, const unsigned char **pp, long length,
     return ret;
 }
 
-const char *ASN1_tag2str(int tag)
+const char * __cdecl ASN1_tag2str(int tag)
 {
     static const char *const tag2str[] = {
         /* 0-4 */
diff --git a/crypto/asn1/asn_mime.c b/crypto/asn1/asn_mime.c
index dfd5be6347..0604e1827a 100644
--- a/crypto/asn1/asn_mime.c
+++ b/crypto/asn1/asn_mime.c
@@ -47,24 +47,24 @@ static char *strip_end(char *name);
 static MIME_HEADER *mime_hdr_new(const char *name, const char *value);
 static int mime_hdr_addparam(MIME_HEADER *mhdr, const char *name, const char *value);
 static STACK_OF(MIME_HEADER) *mime_parse_hdr(BIO *bio);
-static int mime_hdr_cmp(const MIME_HEADER *const *a,
+static int __cdecl mime_hdr_cmp(const MIME_HEADER *const *a,
                         const MIME_HEADER *const *b);
-static int mime_param_cmp(const MIME_PARAM *const *a,
+static int __cdecl mime_param_cmp(const MIME_PARAM *const *a,
                           const MIME_PARAM *const *b);
-static void mime_param_free(MIME_PARAM *param);
+static void __cdecl mime_param_free(MIME_PARAM *param);
 static int mime_bound_check(char *line, int linelen, const char *bound, int blen);
 static int multi_split(BIO *bio, const char *bound, STACK_OF(BIO) **ret);
 static int strip_eol(char *linebuf, int *plen, int flags);
 static MIME_HEADER *mime_hdr_find(STACK_OF(MIME_HEADER) *hdrs, const char *name);
 static MIME_PARAM *mime_param_find(MIME_HEADER *hdr, const char *name);
-static void mime_hdr_free(MIME_HEADER *hdr);
+static void __cdecl mime_hdr_free(MIME_HEADER *hdr);
 
 #define MAX_SMLEN 1024
 #define mime_debug(x)           /* x */
 
 /* Output an ASN1 structure in BER format streaming if necessary */
 
-int i2d_ASN1_bio_stream(BIO *out, ASN1_VALUE *val, BIO *in, int flags,
+int __cdecl i2d_ASN1_bio_stream(BIO *out, ASN1_VALUE *val, BIO *in, int flags,
                         const ASN1_ITEM *it)
 {
     /* If streaming create stream BIO and copy all content through it */
@@ -118,7 +118,7 @@ static int B64_write_ASN1(BIO *out, ASN1_VALUE *val, BIO *in, int flags,
 
 /* Streaming ASN1 PEM write */
 
-int PEM_write_bio_ASN1_stream(BIO *out, ASN1_VALUE *val, BIO *in, int flags,
+int __cdecl PEM_write_bio_ASN1_stream(BIO *out, ASN1_VALUE *val, BIO *in, int flags,
                               const char *hdr, const ASN1_ITEM *it)
 {
     int r;
@@ -219,7 +219,7 @@ static int asn1_write_micalg(BIO *out, STACK_OF(X509_ALGOR) *mdalgs)
 
 /* SMIME sender */
 
-int SMIME_write_ASN1(BIO *bio, ASN1_VALUE *val, BIO *data, int flags,
+int __cdecl SMIME_write_ASN1(BIO *bio, ASN1_VALUE *val, BIO *data, int flags,
                      int ctype_nid, int econt_nid,
                      STACK_OF(X509_ALGOR) *mdalgs, const ASN1_ITEM *it)
 {
@@ -367,7 +367,7 @@ static int asn1_output_data(BIO *out, BIO *data, ASN1_VALUE *val, int flags,
  * opaque this is set to NULL
  */
 
-ASN1_VALUE *SMIME_read_ASN1(BIO *bio, BIO **bcont, const ASN1_ITEM *it)
+ASN1_VALUE * __cdecl SMIME_read_ASN1(BIO *bio, BIO **bcont, const ASN1_ITEM *it)
 {
     BIO *asnin;
     STACK_OF(MIME_HEADER) *headers = NULL;
@@ -475,7 +475,7 @@ ASN1_VALUE *SMIME_read_ASN1(BIO *bio, BIO **bcont, const ASN1_ITEM *it)
 }
 
 /* Copy text from one BIO to another making the output CRLF at EOL */
-int SMIME_crlf_copy(BIO *in, BIO *out, int flags)
+int __cdecl SMIME_crlf_copy(BIO *in, BIO *out, int flags)
 {
     BIO *bf;
     char eol;
@@ -522,7 +522,7 @@ int SMIME_crlf_copy(BIO *in, BIO *out, int flags)
 }
 
 /* Strip off headers if they are text/plain */
-int SMIME_text(BIO *in, BIO *out)
+int __cdecl SMIME_text(BIO *in, BIO *out)
 {
     char iobuf[4096];
     int len;
@@ -854,7 +854,7 @@ static int mime_hdr_addparam(MIME_HEADER *mhdr, const char *name, const char *va
     return 0;
 }
 
-static int mime_hdr_cmp(const MIME_HEADER *const *a,
+static int __cdecl mime_hdr_cmp(const MIME_HEADER *const *a,
                         const MIME_HEADER *const *b)
 {
     if (!(*a)->name || !(*b)->name)
@@ -863,7 +863,7 @@ static int mime_hdr_cmp(const MIME_HEADER *const *a,
     return strcmp((*a)->name, (*b)->name);
 }
 
-static int mime_param_cmp(const MIME_PARAM *const *a,
+static int __cdecl mime_param_cmp(const MIME_PARAM *const *a,
                           const MIME_PARAM *const *b)
 {
     if (!(*a)->param_name || !(*b)->param_name)
@@ -897,7 +897,7 @@ static MIME_PARAM *mime_param_find(MIME_HEADER *hdr, const char *name)
     return sk_MIME_PARAM_value(hdr->params, idx);
 }
 
-static void mime_hdr_free(MIME_HEADER *hdr)
+static void __cdecl mime_hdr_free(MIME_HEADER *hdr)
 {
     if (hdr == NULL)
         return;
@@ -908,7 +908,7 @@ static void mime_hdr_free(MIME_HEADER *hdr)
     OPENSSL_free(hdr);
 }
 
-static void mime_param_free(MIME_PARAM *param)
+static void __cdecl mime_param_free(MIME_PARAM *param)
 {
     OPENSSL_free(param->param_name);
     OPENSSL_free(param->param_value);
diff --git a/crypto/asn1/asn_moid.c b/crypto/asn1/asn_moid.c
index 68a01f3117..937722f0ce 100644
--- a/crypto/asn1/asn_moid.c
+++ b/crypto/asn1/asn_moid.c
@@ -46,7 +46,7 @@ static void oid_module_finish(CONF_IMODULE *md)
 {
 }
 
-void ASN1_add_oid_module(void)
+void __cdecl ASN1_add_oid_module(void)
 {
     CONF_module_add("oid_section", oid_module_init, oid_module_finish);
 }
diff --git a/crypto/asn1/asn_mstbl.c b/crypto/asn1/asn_mstbl.c
index ddcbcd07fe..6ee31f0cd2 100644
--- a/crypto/asn1/asn_mstbl.c
+++ b/crypto/asn1/asn_mstbl.c
@@ -44,7 +44,7 @@ static void stbl_module_finish(CONF_IMODULE *md)
     ASN1_STRING_TABLE_cleanup();
 }
 
-void ASN1_add_stable_module(void)
+void __cdecl ASN1_add_stable_module(void)
 {
     CONF_module_add("stbl_section", stbl_module_init, stbl_module_finish);
 }
diff --git a/crypto/asn1/asn_pack.c b/crypto/asn1/asn_pack.c
index 63bc306756..18866ccbc9 100644
--- a/crypto/asn1/asn_pack.c
+++ b/crypto/asn1/asn_pack.c
@@ -13,7 +13,7 @@
 
 /* ASN1 packing and unpacking functions */
 
-ASN1_STRING *ASN1_item_pack(void *obj, const ASN1_ITEM *it, ASN1_STRING **oct)
+ASN1_STRING * __cdecl ASN1_item_pack(void *obj, const ASN1_ITEM *it, ASN1_STRING **oct)
 {
     ASN1_STRING *octmp;
 
@@ -50,7 +50,7 @@ ASN1_STRING *ASN1_item_pack(void *obj, const ASN1_ITEM *it, ASN1_STRING **oct)
 
 /* Extract an ASN1 object from an ASN1_STRING */
 
-void *ASN1_item_unpack(const ASN1_STRING *oct, const ASN1_ITEM *it)
+void * __cdecl ASN1_item_unpack(const ASN1_STRING *oct, const ASN1_ITEM *it)
 {
     const unsigned char *p;
     void *ret;
diff --git a/crypto/asn1/bio_asn1.c b/crypto/asn1/bio_asn1.c
index 86ee566323..59024d8120 100644
--- a/crypto/asn1/bio_asn1.c
+++ b/crypto/asn1/bio_asn1.c
@@ -93,7 +93,7 @@ static const BIO_METHOD methods_asn1 = {
     asn1_bio_callback_ctrl,
 };
 
-const BIO_METHOD *BIO_f_asn1(void)
+const BIO_METHOD * __cdecl BIO_f_asn1(void)
 {
     return &methods_asn1;
 }
@@ -419,25 +419,25 @@ static int asn1_bio_get_ex(BIO *b, int cmd,
     return ret;
 }
 
-int BIO_asn1_set_prefix(BIO *b, asn1_ps_func *prefix,
+int __cdecl BIO_asn1_set_prefix(BIO *b, asn1_ps_func *prefix,
                         asn1_ps_func *prefix_free)
 {
     return asn1_bio_set_ex(b, BIO_C_SET_PREFIX, prefix, prefix_free);
 }
 
-int BIO_asn1_get_prefix(BIO *b, asn1_ps_func **pprefix,
+int __cdecl BIO_asn1_get_prefix(BIO *b, asn1_ps_func **pprefix,
                         asn1_ps_func **pprefix_free)
 {
     return asn1_bio_get_ex(b, BIO_C_GET_PREFIX, pprefix, pprefix_free);
 }
 
-int BIO_asn1_set_suffix(BIO *b, asn1_ps_func *suffix,
+int __cdecl BIO_asn1_set_suffix(BIO *b, asn1_ps_func *suffix,
                         asn1_ps_func *suffix_free)
 {
     return asn1_bio_set_ex(b, BIO_C_SET_SUFFIX, suffix, suffix_free);
 }
 
-int BIO_asn1_get_suffix(BIO *b, asn1_ps_func **psuffix,
+int __cdecl BIO_asn1_get_suffix(BIO *b, asn1_ps_func **psuffix,
                         asn1_ps_func **psuffix_free)
 {
     return asn1_bio_get_ex(b, BIO_C_GET_SUFFIX, psuffix, psuffix_free);
diff --git a/crypto/asn1/bio_ndef.c b/crypto/asn1/bio_ndef.c
index 6222c99074..431a499dcf 100644
--- a/crypto/asn1/bio_ndef.c
+++ b/crypto/asn1/bio_ndef.c
@@ -49,7 +49,7 @@ static int ndef_suffix(BIO *b, unsigned char **pbuf, int *plen, void *parg);
 static int ndef_suffix_free(BIO *b, unsigned char **pbuf, int *plen,
                             void *parg);
 
-BIO *BIO_new_NDEF(BIO *out, ASN1_VALUE *val, const ASN1_ITEM *it)
+BIO * __cdecl BIO_new_NDEF(BIO *out, ASN1_VALUE *val, const ASN1_ITEM *it)
 {
     NDEF_SUPPORT *ndef_aux = NULL;
     BIO *asn_bio = NULL;
diff --git a/crypto/asn1/d2i_pr.c b/crypto/asn1/d2i_pr.c
index aa0d6ad6ae..070ba42f4b 100644
--- a/crypto/asn1/d2i_pr.c
+++ b/crypto/asn1/d2i_pr.c
@@ -18,7 +18,7 @@
 #include "internal/asn1_int.h"
 #include "internal/evp_int.h"
 
-EVP_PKEY *d2i_PrivateKey(int type, EVP_PKEY **a, const unsigned char **pp,
+EVP_PKEY * __cdecl d2i_PrivateKey(int type, EVP_PKEY **a, const unsigned char **pp,
                          long length)
 {
     EVP_PKEY *ret;
@@ -76,7 +76,7 @@ EVP_PKEY *d2i_PrivateKey(int type, EVP_PKEY **a, const unsigned char **pp,
  * type
  */
 
-EVP_PKEY *d2i_AutoPrivateKey(EVP_PKEY **a, const unsigned char **pp,
+EVP_PKEY * __cdecl d2i_AutoPrivateKey(EVP_PKEY **a, const unsigned char **pp,
                              long length)
 {
     STACK_OF(ASN1_TYPE) *inkey;
diff --git a/crypto/asn1/d2i_pu.c b/crypto/asn1/d2i_pu.c
index 7bc16c7bce..6ebe84f288 100644
--- a/crypto/asn1/d2i_pu.c
+++ b/crypto/asn1/d2i_pu.c
@@ -19,7 +19,7 @@
 
 #include "internal/evp_int.h"
 
-EVP_PKEY *d2i_PublicKey(int type, EVP_PKEY **a, const unsigned char **pp,
+EVP_PKEY * __cdecl d2i_PublicKey(int type, EVP_PKEY **a, const unsigned char **pp,
                         long length)
 {
     EVP_PKEY *ret;
diff --git a/crypto/asn1/evp_asn1.c b/crypto/asn1/evp_asn1.c
index 895085a520..0dfb92e346 100644
--- a/crypto/asn1/evp_asn1.c
+++ b/crypto/asn1/evp_asn1.c
@@ -12,7 +12,7 @@
 #include <openssl/asn1.h>
 #include <openssl/asn1t.h>
 
-int ASN1_TYPE_set_octetstring(ASN1_TYPE *a, unsigned char *data, int len)
+int __cdecl ASN1_TYPE_set_octetstring(ASN1_TYPE *a, unsigned char *data, int len)
 {
     ASN1_STRING *os;
 
@@ -27,7 +27,7 @@ int ASN1_TYPE_set_octetstring(ASN1_TYPE *a, unsigned char *data, int len)
 }
 
 /* int max_len:  for returned value    */
-int ASN1_TYPE_get_octetstring(const ASN1_TYPE *a, unsigned char *data, int max_len)
+int __cdecl ASN1_TYPE_get_octetstring(const ASN1_TYPE *a, unsigned char *data, int max_len)
 {
     int ret, num;
     const unsigned char *p;
@@ -58,7 +58,7 @@ ASN1_SEQUENCE(asn1_int_oct) = {
 
 DECLARE_ASN1_ITEM(asn1_int_oct)
 
-int ASN1_TYPE_set_int_octetstring(ASN1_TYPE *a, long num, unsigned char *data,
+int __cdecl ASN1_TYPE_set_int_octetstring(ASN1_TYPE *a, long num, unsigned char *data,
                                   int len)
 {
     asn1_int_oct atmp;
@@ -80,7 +80,7 @@ int ASN1_TYPE_set_int_octetstring(ASN1_TYPE *a, long num, unsigned char *data,
  * we return the actual length...
  */
 /* int max_len:  for returned value    */
-int ASN1_TYPE_get_int_octetstring(const ASN1_TYPE *a, long *num,
+int __cdecl ASN1_TYPE_get_int_octetstring(const ASN1_TYPE *a, long *num,
                                   unsigned char *data, int max_len)
 {
     asn1_int_oct *atmp = NULL;
diff --git a/crypto/asn1/f_int.c b/crypto/asn1/f_int.c
index 6d6bddc651..bc7d6d73ea 100644
--- a/crypto/asn1/f_int.c
+++ b/crypto/asn1/f_int.c
@@ -13,7 +13,7 @@
 #include <openssl/buffer.h>
 #include <openssl/asn1.h>
 
-int i2a_ASN1_INTEGER(BIO *bp, const ASN1_INTEGER *a)
+int __cdecl i2a_ASN1_INTEGER(BIO *bp, const ASN1_INTEGER *a)
 {
     int i, n = 0;
     static const char *h = "0123456789ABCDEF";
@@ -51,7 +51,7 @@ int i2a_ASN1_INTEGER(BIO *bp, const ASN1_INTEGER *a)
     return -1;
 }
 
-int a2i_ASN1_INTEGER(BIO *bp, ASN1_INTEGER *bs, char *buf, int size)
+int __cdecl a2i_ASN1_INTEGER(BIO *bp, ASN1_INTEGER *bs, char *buf, int size)
 {
     int i, j, k, m, n, again, bufsize;
     unsigned char *s = NULL, *sp;
@@ -142,12 +142,12 @@ int a2i_ASN1_INTEGER(BIO *bp, ASN1_INTEGER *bs, char *buf, int size)
     return 0;
 }
 
-int i2a_ASN1_ENUMERATED(BIO *bp, const ASN1_ENUMERATED *a)
+int __cdecl i2a_ASN1_ENUMERATED(BIO *bp, const ASN1_ENUMERATED *a)
 {
     return i2a_ASN1_INTEGER(bp, a);
 }
 
-int a2i_ASN1_ENUMERATED(BIO *bp, ASN1_ENUMERATED *bs, char *buf, int size)
+int __cdecl a2i_ASN1_ENUMERATED(BIO *bp, ASN1_ENUMERATED *bs, char *buf, int size)
 {
     int rv = a2i_ASN1_INTEGER(bp, bs, buf, size);
     if (rv == 1)
diff --git a/crypto/asn1/f_string.c b/crypto/asn1/f_string.c
index f893489a67..68ee2f8324 100644
--- a/crypto/asn1/f_string.c
+++ b/crypto/asn1/f_string.c
@@ -13,7 +13,7 @@
 #include <openssl/buffer.h>
 #include <openssl/asn1.h>
 
-int i2a_ASN1_STRING(BIO *bp, const ASN1_STRING *a, int type)
+int __cdecl i2a_ASN1_STRING(BIO *bp, const ASN1_STRING *a, int type)
 {
     int i, n = 0;
     static const char *h = "0123456789ABCDEF";
@@ -45,7 +45,7 @@ int i2a_ASN1_STRING(BIO *bp, const ASN1_STRING *a, int type)
     return -1;
 }
 
-int a2i_ASN1_STRING(BIO *bp, ASN1_STRING *bs, char *buf, int size)
+int __cdecl a2i_ASN1_STRING(BIO *bp, ASN1_STRING *bs, char *buf, int size)
 {
     int i, j, k, m, n, again, bufsize;
     unsigned char *s = NULL, *sp;
diff --git a/crypto/asn1/i2d_pr.c b/crypto/asn1/i2d_pr.c
index 445b0c8425..748901dbc0 100644
--- a/crypto/asn1/i2d_pr.c
+++ b/crypto/asn1/i2d_pr.c
@@ -14,7 +14,7 @@
 #include "internal/asn1_int.h"
 #include "internal/evp_int.h"
 
-int i2d_PrivateKey(EVP_PKEY *a, unsigned char **pp)
+int __cdecl i2d_PrivateKey(EVP_PKEY *a, unsigned char **pp)
 {
     if (a->ameth && a->ameth->old_priv_encode) {
         return a->ameth->old_priv_encode(a, pp);
diff --git a/crypto/asn1/i2d_pu.c b/crypto/asn1/i2d_pu.c
index 8986c43cbe..a78958ab52 100644
--- a/crypto/asn1/i2d_pu.c
+++ b/crypto/asn1/i2d_pu.c
@@ -16,7 +16,7 @@
 #include <openssl/dsa.h>
 #include <openssl/ec.h>
 
-int i2d_PublicKey(EVP_PKEY *a, unsigned char **pp)
+int __cdecl i2d_PublicKey(EVP_PKEY *a, unsigned char **pp)
 {
     switch (EVP_PKEY_id(a)) {
 #ifndef OPENSSL_NO_RSA
diff --git a/crypto/asn1/p5_scrypt.c b/crypto/asn1/p5_scrypt.c
index 1491d96ec8..8cb9ce4fa3 100644
--- a/crypto/asn1/p5_scrypt.c
+++ b/crypto/asn1/p5_scrypt.c
@@ -209,7 +209,7 @@ static X509_ALGOR *pkcs5_scrypt_set(const unsigned char *salt, size_t saltlen,
     return NULL;
 }
 
-int PKCS5_v2_scrypt_keyivgen(EVP_CIPHER_CTX *ctx, const char *pass,
+int __cdecl PKCS5_v2_scrypt_keyivgen(EVP_CIPHER_CTX *ctx, const char *pass,
                              int passlen, ASN1_TYPE *param,
                              const EVP_CIPHER *c, const EVP_MD *md, int en_de)
 {
diff --git a/crypto/asn1/t_bitst.c b/crypto/asn1/t_bitst.c
index c0aeca4c78..0faad36e59 100644
--- a/crypto/asn1/t_bitst.c
+++ b/crypto/asn1/t_bitst.c
@@ -12,7 +12,7 @@
 #include <openssl/conf.h>
 #include <openssl/x509v3.h>
 
-int ASN1_BIT_STRING_name_print(BIO *out, ASN1_BIT_STRING *bs,
+int __cdecl ASN1_BIT_STRING_name_print(BIO *out, ASN1_BIT_STRING *bs,
                                BIT_STRING_BITNAME *tbl, int indent)
 {
     BIT_STRING_BITNAME *bnam;
@@ -30,7 +30,7 @@ int ASN1_BIT_STRING_name_print(BIO *out, ASN1_BIT_STRING *bs,
     return 1;
 }
 
-int ASN1_BIT_STRING_set_asc(ASN1_BIT_STRING *bs, const char *name, int value,
+int __cdecl ASN1_BIT_STRING_set_asc(ASN1_BIT_STRING *bs, const char *name, int value,
                             BIT_STRING_BITNAME *tbl)
 {
     int bitnum;
@@ -44,7 +44,7 @@ int ASN1_BIT_STRING_set_asc(ASN1_BIT_STRING *bs, const char *name, int value,
     return 1;
 }
 
-int ASN1_BIT_STRING_num_asc(const char *name, BIT_STRING_BITNAME *tbl)
+int __cdecl ASN1_BIT_STRING_num_asc(const char *name, BIT_STRING_BITNAME *tbl)
 {
     BIT_STRING_BITNAME *bnam;
     for (bnam = tbl; bnam->lname; bnam++) {
diff --git a/crypto/asn1/t_pkey.c b/crypto/asn1/t_pkey.c
index 3b2c9df891..ab3d27644d 100644
--- a/crypto/asn1/t_pkey.c
+++ b/crypto/asn1/t_pkey.c
@@ -18,7 +18,7 @@
 /* Maximum indent */
 #define ASN1_PRINT_MAX_INDENT 128
 
-int ASN1_buf_print(BIO *bp, const unsigned char *buf, size_t buflen, int indent)
+int __cdecl ASN1_buf_print(BIO *bp, const unsigned char *buf, size_t buflen, int indent)
 {
     size_t i;
 
@@ -42,7 +42,7 @@ int ASN1_buf_print(BIO *bp, const unsigned char *buf, size_t buflen, int indent)
     return 1;
 }
 
-int ASN1_bn_print(BIO *bp, const char *number, const BIGNUM *num,
+int __cdecl ASN1_bn_print(BIO *bp, const char *number, const BIGNUM *num,
                   unsigned char *ign, int indent)
 {
     int n, rv = 0;
diff --git a/crypto/asn1/tasn_dec.c b/crypto/asn1/tasn_dec.c
index c2a521ed51..1cf4f1067d 100644
--- a/crypto/asn1/tasn_dec.c
+++ b/crypto/asn1/tasn_dec.c
@@ -82,7 +82,7 @@ static const unsigned long tag2bit[32] = {
     B_ASN1_UNIVERSALSTRING, B_ASN1_UNKNOWN, B_ASN1_BMPSTRING, B_ASN1_UNKNOWN,
 };
 
-unsigned long ASN1_tag2bit(int tag)
+unsigned long __cdecl ASN1_tag2bit(int tag)
 {
     if ((tag < 0) || (tag > 30))
         return 0;
@@ -102,7 +102,7 @@ unsigned long ASN1_tag2bit(int tag)
  * this will simply be a special case.
  */
 
-ASN1_VALUE *ASN1_item_d2i(ASN1_VALUE **pval,
+ASN1_VALUE * __cdecl ASN1_item_d2i(ASN1_VALUE **pval,
                           const unsigned char **in, long len,
                           const ASN1_ITEM *it)
 {
@@ -116,7 +116,7 @@ ASN1_VALUE *ASN1_item_d2i(ASN1_VALUE **pval,
     return NULL;
 }
 
-int ASN1_item_ex_d2i(ASN1_VALUE **pval, const unsigned char **in, long len,
+int __cdecl ASN1_item_ex_d2i(ASN1_VALUE **pval, const unsigned char **in, long len,
                      const ASN1_ITEM *it,
                      int tag, int aclass, char opt, ASN1_TLC *ctx)
 {
diff --git a/crypto/asn1/tasn_enc.c b/crypto/asn1/tasn_enc.c
index 30be314ff9..67028de15d 100644
--- a/crypto/asn1/tasn_enc.c
+++ b/crypto/asn1/tasn_enc.c
@@ -33,13 +33,13 @@ static int asn1_ex_i2c(ASN1_VALUE **pval, unsigned char *cout, int *putype,
  * indefinite length constructed encoding, where appropriate
  */
 
-int ASN1_item_ndef_i2d(ASN1_VALUE *val, unsigned char **out,
+int __cdecl ASN1_item_ndef_i2d(ASN1_VALUE *val, unsigned char **out,
                        const ASN1_ITEM *it)
 {
     return asn1_item_flags_i2d(val, out, it, ASN1_TFLG_NDEF);
 }
 
-int ASN1_item_i2d(ASN1_VALUE *val, unsigned char **out, const ASN1_ITEM *it)
+int __cdecl ASN1_item_i2d(ASN1_VALUE *val, unsigned char **out, const ASN1_ITEM *it)
 {
     return asn1_item_flags_i2d(val, out, it, 0);
 }
@@ -79,7 +79,7 @@ static int asn1_item_flags_i2d(ASN1_VALUE *val, unsigned char **out,
  * performs the normal item handling: it can be used in external types.
  */
 
-int ASN1_item_ex_i2d(ASN1_VALUE **pval, unsigned char **out,
+int __cdecl ASN1_item_ex_i2d(ASN1_VALUE **pval, unsigned char **out,
                      const ASN1_ITEM *it, int tag, int aclass)
 {
     const ASN1_TEMPLATE *tt = NULL;
@@ -354,7 +354,7 @@ typedef struct {
     ASN1_VALUE *field;
 } DER_ENC;
 
-static int der_cmp(const void *a, const void *b)
+static int __cdecl der_cmp(const void *a, const void *b)
 {
     const DER_ENC *d1 = a, *d2 = b;
     int cmplen, i;
diff --git a/crypto/asn1/tasn_fre.c b/crypto/asn1/tasn_fre.c
index bbce489fe0..d59a6519cc 100644
--- a/crypto/asn1/tasn_fre.c
+++ b/crypto/asn1/tasn_fre.c
@@ -15,12 +15,12 @@
 
 /* Free up an ASN1 structure */
 
-void ASN1_item_free(ASN1_VALUE *val, const ASN1_ITEM *it)
+void __cdecl ASN1_item_free(ASN1_VALUE *val, const ASN1_ITEM *it)
 {
     asn1_item_embed_free(&val, it, 0);
 }
 
-void ASN1_item_ex_free(ASN1_VALUE **pval, const ASN1_ITEM *it)
+void __cdecl ASN1_item_ex_free(ASN1_VALUE **pval, const ASN1_ITEM *it)
 {
     asn1_item_embed_free(pval, it, 0);
 }
diff --git a/crypto/asn1/tasn_new.c b/crypto/asn1/tasn_new.c
index 6b8ea8ddd7..6c35cb2443 100644
--- a/crypto/asn1/tasn_new.c
+++ b/crypto/asn1/tasn_new.c
@@ -24,7 +24,7 @@ static int asn1_template_new(ASN1_VALUE **pval, const ASN1_TEMPLATE *tt);
 static void asn1_template_clear(ASN1_VALUE **pval, const ASN1_TEMPLATE *tt);
 static void asn1_primitive_clear(ASN1_VALUE **pval, const ASN1_ITEM *it);
 
-ASN1_VALUE *ASN1_item_new(const ASN1_ITEM *it)
+ASN1_VALUE * __cdecl ASN1_item_new(const ASN1_ITEM *it)
 {
     ASN1_VALUE *ret = NULL;
     if (ASN1_item_ex_new(&ret, it) > 0)
@@ -34,7 +34,7 @@ ASN1_VALUE *ASN1_item_new(const ASN1_ITEM *it)
 
 /* Allocate an ASN1 structure */
 
-int ASN1_item_ex_new(ASN1_VALUE **pval, const ASN1_ITEM *it)
+int __cdecl ASN1_item_ex_new(ASN1_VALUE **pval, const ASN1_ITEM *it)
 {
     return asn1_item_embed_new(pval, it, 0);
 }
diff --git a/crypto/asn1/tasn_prn.c b/crypto/asn1/tasn_prn.c
index 1fb66f1062..ca8babb602 100644
--- a/crypto/asn1/tasn_prn.c
+++ b/crypto/asn1/tasn_prn.c
@@ -32,7 +32,7 @@ static ASN1_PCTX default_pctx = {
     0                           /* str_flags */
 };
 
-ASN1_PCTX *ASN1_PCTX_new(void)
+ASN1_PCTX * __cdecl ASN1_PCTX_new(void)
 {
     ASN1_PCTX *ret;
 
@@ -44,57 +44,57 @@ ASN1_PCTX *ASN1_PCTX_new(void)
     return ret;
 }
 
-void ASN1_PCTX_free(ASN1_PCTX *p)
+void __cdecl ASN1_PCTX_free(ASN1_PCTX *p)
 {
     OPENSSL_free(p);
 }
 
-unsigned long ASN1_PCTX_get_flags(const ASN1_PCTX *p)
+unsigned long __cdecl ASN1_PCTX_get_flags(const ASN1_PCTX *p)
 {
     return p->flags;
 }
 
-void ASN1_PCTX_set_flags(ASN1_PCTX *p, unsigned long flags)
+void __cdecl ASN1_PCTX_set_flags(ASN1_PCTX *p, unsigned long flags)
 {
     p->flags = flags;
 }
 
-unsigned long ASN1_PCTX_get_nm_flags(const ASN1_PCTX *p)
+unsigned long __cdecl ASN1_PCTX_get_nm_flags(const ASN1_PCTX *p)
 {
     return p->nm_flags;
 }
 
-void ASN1_PCTX_set_nm_flags(ASN1_PCTX *p, unsigned long flags)
+void __cdecl ASN1_PCTX_set_nm_flags(ASN1_PCTX *p, unsigned long flags)
 {
     p->nm_flags = flags;
 }
 
-unsigned long ASN1_PCTX_get_cert_flags(const ASN1_PCTX *p)
+unsigned long __cdecl ASN1_PCTX_get_cert_flags(const ASN1_PCTX *p)
 {
     return p->cert_flags;
 }
 
-void ASN1_PCTX_set_cert_flags(ASN1_PCTX *p, unsigned long flags)
+void __cdecl ASN1_PCTX_set_cert_flags(ASN1_PCTX *p, unsigned long flags)
 {
     p->cert_flags = flags;
 }
 
-unsigned long ASN1_PCTX_get_oid_flags(const ASN1_PCTX *p)
+unsigned long __cdecl ASN1_PCTX_get_oid_flags(const ASN1_PCTX *p)
 {
     return p->oid_flags;
 }
 
-void ASN1_PCTX_set_oid_flags(ASN1_PCTX *p, unsigned long flags)
+void __cdecl ASN1_PCTX_set_oid_flags(ASN1_PCTX *p, unsigned long flags)
 {
     p->oid_flags = flags;
 }
 
-unsigned long ASN1_PCTX_get_str_flags(const ASN1_PCTX *p)
+unsigned long __cdecl ASN1_PCTX_get_str_flags(const ASN1_PCTX *p)
 {
     return p->str_flags;
 }
 
-void ASN1_PCTX_set_str_flags(ASN1_PCTX *p, unsigned long flags)
+void __cdecl ASN1_PCTX_set_str_flags(ASN1_PCTX *p, unsigned long flags)
 {
     p->str_flags = flags;
 }
@@ -118,7 +118,7 @@ static int asn1_print_fsname(BIO *out, int indent,
                              const char *fname, const char *sname,
                              const ASN1_PCTX *pctx);
 
-int ASN1_item_print(BIO *out, ASN1_VALUE *ifld, int indent,
+int __cdecl ASN1_item_print(BIO *out, ASN1_VALUE *ifld, int indent,
                     const ASN1_ITEM *it, const ASN1_PCTX *pctx)
 {
     const char *sname;
diff --git a/crypto/asn1/tasn_scn.c b/crypto/asn1/tasn_scn.c
index e1df2cfcae..312fc05033 100644
--- a/crypto/asn1/tasn_scn.c
+++ b/crypto/asn1/tasn_scn.c
@@ -22,7 +22,7 @@
  * passing details to a callback.
  */
 
-ASN1_SCTX *ASN1_SCTX_new(int (*scan_cb) (ASN1_SCTX *ctx))
+ASN1_SCTX * __cdecl ASN1_SCTX_new(int (*scan_cb) (ASN1_SCTX *ctx))
 {
     ASN1_SCTX *ret = OPENSSL_zalloc(sizeof(*ret));
 
@@ -34,32 +34,32 @@ ASN1_SCTX *ASN1_SCTX_new(int (*scan_cb) (ASN1_SCTX *ctx))
     return ret;
 }
 
-void ASN1_SCTX_free(ASN1_SCTX *p)
+void __cdecl ASN1_SCTX_free(ASN1_SCTX *p)
 {
     OPENSSL_free(p);
 }
 
-const ASN1_ITEM *ASN1_SCTX_get_item(ASN1_SCTX *p)
+const ASN1_ITEM * __cdecl ASN1_SCTX_get_item(ASN1_SCTX *p)
 {
     return p->it;
 }
 
-const ASN1_TEMPLATE *ASN1_SCTX_get_template(ASN1_SCTX *p)
+const ASN1_TEMPLATE * __cdecl ASN1_SCTX_get_template(ASN1_SCTX *p)
 {
     return p->tt;
 }
 
-unsigned long ASN1_SCTX_get_flags(ASN1_SCTX *p)
+unsigned long __cdecl ASN1_SCTX_get_flags(ASN1_SCTX *p)
 {
     return p->flags;
 }
 
-void ASN1_SCTX_set_app_data(ASN1_SCTX *p, void *data)
+void __cdecl ASN1_SCTX_set_app_data(ASN1_SCTX *p, void *data)
 {
     p->app_data = data;
 }
 
-void *ASN1_SCTX_get_app_data(ASN1_SCTX *p)
+void * __cdecl ASN1_SCTX_get_app_data(ASN1_SCTX *p)
 {
     return p->app_data;
 }
diff --git a/crypto/asn1/tasn_typ.c b/crypto/asn1/tasn_typ.c
index 98d9879014..727d912a49 100644
--- a/crypto/asn1/tasn_typ.c
+++ b/crypto/asn1/tasn_typ.c
@@ -16,11 +16,11 @@
 #define IMPLEMENT_ASN1_STRING_FUNCTIONS(sname) \
     IMPLEMENT_ASN1_TYPE(sname) \
     IMPLEMENT_ASN1_ENCODE_FUNCTIONS_fname(sname, sname, sname) \
-sname *sname##_new(void) \
+sname * __cdecl sname##_new(void) \
 { \
     return ASN1_STRING_type_new(V_##sname); \
 } \
-void sname##_free(sname *x) \
+void __cdecl sname##_free(sname *x) \
 { \
     ASN1_STRING_free(x); \
 }
diff --git a/crypto/asn1/x_info.c b/crypto/asn1/x_info.c
index 8d99f07c63..e9a5cbf7bc 100644
--- a/crypto/asn1/x_info.c
+++ b/crypto/asn1/x_info.c
@@ -26,7 +26,7 @@ X509_INFO *X509_INFO_new(void)
     return ret;
 }
 
-void X509_INFO_free(X509_INFO *x)
+void __cdecl X509_INFO_free(X509_INFO *x)
 {
     if (x == NULL)
         return;
diff --git a/crypto/async/arch/async_null.c b/crypto/async/arch/async_null.c
index 3eaf170f2e..642fcd3534 100644
--- a/crypto/async/arch/async_null.c
+++ b/crypto/async/arch/async_null.c
@@ -11,7 +11,7 @@
 #include "../async_locl.h"
 
 #ifdef ASYNC_NULL
-int ASYNC_is_capable(void)
+int __cdecl ASYNC_is_capable(void)
 {
     return 0;
 }
diff --git a/crypto/async/arch/async_posix.c b/crypto/async/arch/async_posix.c
index 02c342d3df..b91ee1a13b 100644
--- a/crypto/async/arch/async_posix.c
+++ b/crypto/async/arch/async_posix.c
@@ -17,7 +17,7 @@
 
 #define STACKSIZE       32768
 
-int ASYNC_is_capable(void)
+int __cdecl ASYNC_is_capable(void)
 {
     ucontext_t ctx;
 
diff --git a/crypto/async/arch/async_win.c b/crypto/async/arch/async_win.c
index 077d56ced0..d2f30908bd 100644
--- a/crypto/async/arch/async_win.c
+++ b/crypto/async/arch/async_win.c
@@ -15,7 +15,7 @@
 # include <windows.h>
 # include "internal/cryptlib.h"
 
-int ASYNC_is_capable(void)
+int __cdecl ASYNC_is_capable(void)
 {
     return 1;
 }
diff --git a/crypto/async/async.c b/crypto/async/async.c
index 1d83e4576f..92eaa6982c 100644
--- a/crypto/async/async.c
+++ b/crypto/async/async.c
@@ -164,7 +164,7 @@ void async_start_func(void)
     }
 }
 
-int ASYNC_start_job(ASYNC_JOB **job, ASYNC_WAIT_CTX *wctx, int *ret,
+int __cdecl ASYNC_start_job(ASYNC_JOB **job, ASYNC_WAIT_CTX *wctx, int *ret,
                     int (*func)(void *), void *args, size_t size)
 {
     async_ctx *ctx;
@@ -252,7 +252,7 @@ err:
     return ASYNC_ERR;
 }
 
-int ASYNC_pause_job(void)
+int __cdecl ASYNC_pause_job(void)
 {
     ASYNC_JOB *job;
     async_ctx *ctx = async_get_ctx();
@@ -313,7 +313,7 @@ void async_deinit(void)
     CRYPTO_THREAD_cleanup_local(&poolkey);
 }
 
-int ASYNC_init_thread(size_t max_size, size_t init_size)
+int __cdecl ASYNC_init_thread(size_t max_size, size_t init_size)
 {
     async_pool *pool;
     size_t curr_size = 0;
@@ -388,7 +388,7 @@ void async_delete_thread_state(void)
     async_ctx_free();
 }
 
-void ASYNC_cleanup_thread(void)
+void __cdecl ASYNC_cleanup_thread(void)
 {
     if (!OPENSSL_init_crypto(OPENSSL_INIT_ASYNC, NULL))
         return;
@@ -396,7 +396,7 @@ void ASYNC_cleanup_thread(void)
     async_delete_thread_state();
 }
 
-ASYNC_JOB *ASYNC_get_current_job(void)
+ASYNC_JOB * __cdecl ASYNC_get_current_job(void)
 {
     async_ctx *ctx;
 
@@ -410,12 +410,12 @@ ASYNC_JOB *ASYNC_get_current_job(void)
     return ctx->currjob;
 }
 
-ASYNC_WAIT_CTX *ASYNC_get_wait_ctx(ASYNC_JOB *job)
+ASYNC_WAIT_CTX * __cdecl ASYNC_get_wait_ctx(ASYNC_JOB *job)
 {
     return job->waitctx;
 }
 
-void ASYNC_block_pause(void)
+void __cdecl ASYNC_block_pause(void)
 {
     async_ctx *ctx;
 
@@ -432,7 +432,7 @@ void ASYNC_block_pause(void)
     ctx->blocked++;
 }
 
-void ASYNC_unblock_pause(void)
+void __cdecl ASYNC_unblock_pause(void)
 {
     async_ctx *ctx;
 
diff --git a/crypto/async/async_err.c b/crypto/async/async_err.c
index fd5527aae8..4b9144eadc 100644
--- a/crypto/async/async_err.c
+++ b/crypto/async/async_err.c
@@ -39,7 +39,7 @@ static const ERR_STRING_DATA ASYNC_str_reasons[] = {
 
 #endif
 
-int ERR_load_ASYNC_strings(void)
+int __cdecl ERR_load_ASYNC_strings(void)
 {
 #ifndef OPENSSL_NO_ERR
     if (ERR_func_error_string(ASYNC_str_functs[0].error) == NULL) {
diff --git a/crypto/async/async_wait.c b/crypto/async/async_wait.c
index b23e43e8c8..0ded29b180 100644
--- a/crypto/async/async_wait.c
+++ b/crypto/async/async_wait.c
@@ -12,12 +12,12 @@
 
 #include <openssl/err.h>
 
-ASYNC_WAIT_CTX *ASYNC_WAIT_CTX_new(void)
+ASYNC_WAIT_CTX * __cdecl ASYNC_WAIT_CTX_new(void)
 {
     return OPENSSL_zalloc(sizeof(ASYNC_WAIT_CTX));
 }
 
-void ASYNC_WAIT_CTX_free(ASYNC_WAIT_CTX *ctx)
+void __cdecl ASYNC_WAIT_CTX_free(ASYNC_WAIT_CTX *ctx)
 {
     struct fd_lookup_st *curr;
     struct fd_lookup_st *next;
@@ -40,7 +40,7 @@ void ASYNC_WAIT_CTX_free(ASYNC_WAIT_CTX *ctx)
 
     OPENSSL_free(ctx);
 }
-int ASYNC_WAIT_CTX_set_wait_fd(ASYNC_WAIT_CTX *ctx, const void *key,
+int __cdecl ASYNC_WAIT_CTX_set_wait_fd(ASYNC_WAIT_CTX *ctx, const void *key,
                                OSSL_ASYNC_FD fd, void *custom_data,
                                void (*cleanup)(ASYNC_WAIT_CTX *, const void *,
                                                OSSL_ASYNC_FD, void *))
@@ -63,7 +63,7 @@ int ASYNC_WAIT_CTX_set_wait_fd(ASYNC_WAIT_CTX *ctx, const void *key,
     return 1;
 }
 
-int ASYNC_WAIT_CTX_get_fd(ASYNC_WAIT_CTX *ctx, const void *key,
+int __cdecl ASYNC_WAIT_CTX_get_fd(ASYNC_WAIT_CTX *ctx, const void *key,
                           OSSL_ASYNC_FD *fd, void **custom_data)
 {
     struct fd_lookup_st *curr;
@@ -85,7 +85,7 @@ int ASYNC_WAIT_CTX_get_fd(ASYNC_WAIT_CTX *ctx, const void *key,
     return 0;
 }
 
-int ASYNC_WAIT_CTX_get_all_fds(ASYNC_WAIT_CTX *ctx, OSSL_ASYNC_FD *fd,
+int __cdecl ASYNC_WAIT_CTX_get_all_fds(ASYNC_WAIT_CTX *ctx, OSSL_ASYNC_FD *fd,
                                size_t *numfds)
 {
     struct fd_lookup_st *curr;
@@ -108,7 +108,7 @@ int ASYNC_WAIT_CTX_get_all_fds(ASYNC_WAIT_CTX *ctx, OSSL_ASYNC_FD *fd,
     return 1;
 }
 
-int ASYNC_WAIT_CTX_get_changed_fds(ASYNC_WAIT_CTX *ctx, OSSL_ASYNC_FD *addfd,
+int __cdecl ASYNC_WAIT_CTX_get_changed_fds(ASYNC_WAIT_CTX *ctx, OSSL_ASYNC_FD *addfd,
                                    size_t *numaddfds, OSSL_ASYNC_FD *delfd,
                                    size_t *numdelfds)
 {
@@ -137,7 +137,7 @@ int ASYNC_WAIT_CTX_get_changed_fds(ASYNC_WAIT_CTX *ctx, OSSL_ASYNC_FD *addfd,
     return 1;
 }
 
-int ASYNC_WAIT_CTX_clear_fd(ASYNC_WAIT_CTX *ctx, const void *key)
+int __cdecl ASYNC_WAIT_CTX_clear_fd(ASYNC_WAIT_CTX *ctx, const void *key)
 {
     struct fd_lookup_st *curr, *prev;
 
diff --git a/crypto/bf/bf_cfb64.c b/crypto/bf/bf_cfb64.c
index ce6e13b5a4..0779520ce2 100644
--- a/crypto/bf/bf_cfb64.c
+++ b/crypto/bf/bf_cfb64.c
@@ -16,7 +16,7 @@
  * used is contained in *num;
  */
 
-void BF_cfb64_encrypt(const unsigned char *in, unsigned char *out,
+void __cdecl BF_cfb64_encrypt(const unsigned char *in, unsigned char *out,
                       long length, const BF_KEY *schedule,
                       unsigned char *ivec, int *num, int encrypt)
 {
diff --git a/crypto/bf/bf_ecb.c b/crypto/bf/bf_ecb.c
index dc1becdbe4..c6800ddf33 100644
--- a/crypto/bf/bf_ecb.c
+++ b/crypto/bf/bf_ecb.c
@@ -17,12 +17,12 @@
  * SECURITY WORKSHOP, CAMBRIDGE, U.K., DECEMBER 9-11, 1993)
  */
 
-const char *BF_options(void)
+const char * __cdecl BF_options(void)
 {
     return "blowfish(ptr)";
 }
 
-void BF_ecb_encrypt(const unsigned char *in, unsigned char *out,
+void __cdecl BF_ecb_encrypt(const unsigned char *in, unsigned char *out,
                     const BF_KEY *key, int encrypt)
 {
     BF_LONG l, d[2];
diff --git a/crypto/bf/bf_enc.c b/crypto/bf/bf_enc.c
index 67c0d78aec..020ede1d18 100644
--- a/crypto/bf/bf_enc.c
+++ b/crypto/bf/bf_enc.c
@@ -21,7 +21,7 @@
 to modify the code.
 #endif
 
-void BF_encrypt(BF_LONG *data, const BF_KEY *key)
+void __cdecl BF_encrypt(BF_LONG *data, const BF_KEY *key)
 {
     register BF_LONG l, r;
     register const BF_LONG *p, *s;
@@ -60,7 +60,7 @@ void BF_encrypt(BF_LONG *data, const BF_KEY *key)
     data[0] = r & 0xffffffffU;
 }
 
-void BF_decrypt(BF_LONG *data, const BF_KEY *key)
+void __cdecl BF_decrypt(BF_LONG *data, const BF_KEY *key)
 {
     register BF_LONG l, r;
     register const BF_LONG *p, *s;
@@ -99,7 +99,7 @@ void BF_decrypt(BF_LONG *data, const BF_KEY *key)
     data[0] = r & 0xffffffffU;
 }
 
-void BF_cbc_encrypt(const unsigned char *in, unsigned char *out, long length,
+void __cdecl BF_cbc_encrypt(const unsigned char *in, unsigned char *out, long length,
                     const BF_KEY *schedule, unsigned char *ivec, int encrypt)
 {
     register BF_LONG tin0, tin1;
diff --git a/crypto/bf/bf_ofb64.c b/crypto/bf/bf_ofb64.c
index 6418217b30..36c49a5464 100644
--- a/crypto/bf/bf_ofb64.c
+++ b/crypto/bf/bf_ofb64.c
@@ -15,7 +15,7 @@
  * The extra state information to record how much of the 64bit block we have
  * used is contained in *num;
  */
-void BF_ofb64_encrypt(const unsigned char *in, unsigned char *out,
+void __cdecl BF_ofb64_encrypt(const unsigned char *in, unsigned char *out,
                       long length, const BF_KEY *schedule,
                       unsigned char *ivec, int *num)
 {
diff --git a/crypto/bf/bf_skey.c b/crypto/bf/bf_skey.c
index a4903a2a71..9855b47e0e 100644
--- a/crypto/bf/bf_skey.c
+++ b/crypto/bf/bf_skey.c
@@ -13,7 +13,7 @@
 #include "bf_locl.h"
 #include "bf_pi.h"
 
-void BF_set_key(BF_KEY *key, int len, const unsigned char *data)
+void __cdecl BF_set_key(BF_KEY *key, int len, const unsigned char *data)
 {
     int i;
     BF_LONG *p, ri, in[2];
diff --git a/crypto/bio/b_addr.c b/crypto/bio/b_addr.c
index dd5008e636..68a654319c 100644
--- a/crypto/bio/b_addr.c
+++ b/crypto/bio/b_addr.c
@@ -35,7 +35,7 @@ static CRYPTO_ONCE bio_lookup_init = CRYPTO_ONCE_STATIC_INIT;
  *
  */
 
-BIO_ADDR *BIO_ADDR_new(void)
+BIO_ADDR * __cdecl BIO_ADDR_new(void)
 {
     BIO_ADDR *ret = OPENSSL_zalloc(sizeof(*ret));
 
@@ -48,12 +48,12 @@ BIO_ADDR *BIO_ADDR_new(void)
     return ret;
 }
 
-void BIO_ADDR_free(BIO_ADDR *ap)
+void __cdecl BIO_ADDR_free(BIO_ADDR *ap)
 {
     OPENSSL_free(ap);
 }
 
-void BIO_ADDR_clear(BIO_ADDR *ap)
+void __cdecl BIO_ADDR_clear(BIO_ADDR *ap)
 {
     memset(ap, 0, sizeof(*ap));
     ap->sa.sa_family = AF_UNSPEC;
@@ -85,7 +85,7 @@ int BIO_ADDR_make(BIO_ADDR *ap, const struct sockaddr *sa)
     return 0;
 }
 
-int BIO_ADDR_rawmake(BIO_ADDR *ap, int family,
+int __cdecl BIO_ADDR_rawmake(BIO_ADDR *ap, int family,
                      const void *where, size_t wherelen,
                      unsigned short port)
 {
@@ -123,12 +123,12 @@ int BIO_ADDR_rawmake(BIO_ADDR *ap, int family,
     return 0;
 }
 
-int BIO_ADDR_family(const BIO_ADDR *ap)
+int __cdecl BIO_ADDR_family(const BIO_ADDR *ap)
 {
     return ap->sa.sa_family;
 }
 
-int BIO_ADDR_rawaddress(const BIO_ADDR *ap, void *p, size_t *l)
+int __cdecl BIO_ADDR_rawaddress(const BIO_ADDR *ap, void *p, size_t *l)
 {
     size_t len = 0;
     const void *addrptr = NULL;
@@ -162,7 +162,7 @@ int BIO_ADDR_rawaddress(const BIO_ADDR *ap, void *p, size_t *l)
     return 1;
 }
 
-unsigned short BIO_ADDR_rawport(const BIO_ADDR *ap)
+unsigned short __cdecl BIO_ADDR_rawport(const BIO_ADDR *ap)
 {
     if (ap->sa.sa_family == AF_INET)
         return ap->s_in.sin_port;
@@ -261,7 +261,7 @@ static int addr_strings(const BIO_ADDR *ap, int numeric,
     return 1;
 }
 
-char *BIO_ADDR_hostname_string(const BIO_ADDR *ap, int numeric)
+char * __cdecl BIO_ADDR_hostname_string(const BIO_ADDR *ap, int numeric)
 {
     char *hostname = NULL;
 
@@ -271,7 +271,7 @@ char *BIO_ADDR_hostname_string(const BIO_ADDR *ap, int numeric)
     return NULL;
 }
 
-char *BIO_ADDR_service_string(const BIO_ADDR *ap, int numeric)
+char * __cdecl BIO_ADDR_service_string(const BIO_ADDR *ap, int numeric)
 {
     char *service = NULL;
 
@@ -281,7 +281,7 @@ char *BIO_ADDR_service_string(const BIO_ADDR *ap, int numeric)
     return NULL;
 }
 
-char *BIO_ADDR_path_string(const BIO_ADDR *ap)
+char * __cdecl BIO_ADDR_path_string(const BIO_ADDR *ap)
 {
 #ifdef AF_UNIX
     if (ap->sa.sa_family == AF_UNIX)
@@ -338,28 +338,28 @@ socklen_t BIO_ADDR_sockaddr_size(const BIO_ADDR *ap)
  *
  */
 
-const BIO_ADDRINFO *BIO_ADDRINFO_next(const BIO_ADDRINFO *bai)
+const BIO_ADDRINFO * __cdecl BIO_ADDRINFO_next(const BIO_ADDRINFO *bai)
 {
     if (bai != NULL)
         return bai->bai_next;
     return NULL;
 }
 
-int BIO_ADDRINFO_family(const BIO_ADDRINFO *bai)
+int __cdecl BIO_ADDRINFO_family(const BIO_ADDRINFO *bai)
 {
     if (bai != NULL)
         return bai->bai_family;
     return 0;
 }
 
-int BIO_ADDRINFO_socktype(const BIO_ADDRINFO *bai)
+int __cdecl BIO_ADDRINFO_socktype(const BIO_ADDRINFO *bai)
 {
     if (bai != NULL)
         return bai->bai_socktype;
     return 0;
 }
 
-int BIO_ADDRINFO_protocol(const BIO_ADDRINFO *bai)
+int __cdecl BIO_ADDRINFO_protocol(const BIO_ADDRINFO *bai)
 {
     if (bai != NULL) {
         if (bai->bai_protocol != 0)
@@ -404,14 +404,14 @@ const struct sockaddr *BIO_ADDRINFO_sockaddr(const BIO_ADDRINFO *bai)
     return NULL;
 }
 
-const BIO_ADDR *BIO_ADDRINFO_address(const BIO_ADDRINFO *bai)
+const BIO_ADDR * __cdecl BIO_ADDRINFO_address(const BIO_ADDRINFO *bai)
 {
     if (bai != NULL)
         return (BIO_ADDR *)bai->bai_addr;
     return NULL;
 }
 
-void BIO_ADDRINFO_free(BIO_ADDRINFO *bai)
+void __cdecl BIO_ADDRINFO_free(BIO_ADDRINFO *bai)
 {
     if (bai == NULL)
         return;
@@ -464,7 +464,7 @@ void BIO_ADDRINFO_free(BIO_ADDRINFO *bai)
  * service              => *host untouched, *service = "service"
  *
  */
-int BIO_parse_hostserv(const char *hostserv, char **host, char **service,
+int __cdecl BIO_parse_hostserv(const char *hostserv, char **host, char **service,
                        enum BIO_hostserv_priorities hostserv_prio)
 {
     const char *h = NULL; size_t hl = 0;
@@ -609,7 +609,7 @@ DEFINE_RUN_ONCE_STATIC(do_bio_lookup_init)
     return bio_lookup_lock != NULL;
 }
 
-int BIO_lookup(const char *host, const char *service,
+int __cdecl BIO_lookup(const char *host, const char *service,
                enum BIO_lookup_type lookup_type,
                int family, int socktype, BIO_ADDRINFO **res)
 {
@@ -638,7 +638,7 @@ int BIO_lookup(const char *host, const char *service,
  *
  * The return value is 1 on success or 0 in case of error.
  */
-int BIO_lookup_ex(const char *host, const char *service, int lookup_type,
+int __cdecl BIO_lookup_ex(const char *host, const char *service, int lookup_type,
                   int family, int socktype, int protocol, BIO_ADDRINFO **res)
 {
     int ret = 0;                 /* Assume failure */
diff --git a/crypto/bio/b_dump.c b/crypto/bio/b_dump.c
index 0d06414e7d..b0d1c31ea0 100644
--- a/crypto/bio/b_dump.c
+++ b/crypto/bio/b_dump.c
@@ -19,13 +19,13 @@
 
 #define SPACE(buf, pos, n)   (sizeof(buf) - (pos) > (n))
 
-int BIO_dump_cb(int (*cb) (const void *data, size_t len, void *u),
+int __cdecl BIO_dump_cb(int (*cb) (const void *data, size_t len, void *u),
                 void *u, const char *s, int len)
 {
     return BIO_dump_indent_cb(cb, u, s, len, 0);
 }
 
-int BIO_dump_indent_cb(int (*cb) (const void *data, size_t len, void *u),
+int __cdecl BIO_dump_indent_cb(int (*cb) (const void *data, size_t len, void *u),
                        void *u, const char *s, int len, int indent)
 {
     int ret = 0;
@@ -96,12 +96,12 @@ static int write_fp(const void *data, size_t len, void *fp)
     return UP_fwrite(data, len, 1, fp);
 }
 
-int BIO_dump_fp(FILE *fp, const char *s, int len)
+int __cdecl BIO_dump_fp(FILE *fp, const char *s, int len)
 {
     return BIO_dump_cb(write_fp, fp, s, len);
 }
 
-int BIO_dump_indent_fp(FILE *fp, const char *s, int len, int indent)
+int __cdecl BIO_dump_indent_fp(FILE *fp, const char *s, int len, int indent)
 {
     return BIO_dump_indent_cb(write_fp, fp, s, len, indent);
 }
@@ -112,17 +112,17 @@ static int write_bio(const void *data, size_t len, void *bp)
     return BIO_write((BIO *)bp, (const char *)data, len);
 }
 
-int BIO_dump(BIO *bp, const char *s, int len)
+int __cdecl BIO_dump(BIO *bp, const char *s, int len)
 {
     return BIO_dump_cb(write_bio, bp, s, len);
 }
 
-int BIO_dump_indent(BIO *bp, const char *s, int len, int indent)
+int __cdecl BIO_dump_indent(BIO *bp, const char *s, int len, int indent)
 {
     return BIO_dump_indent_cb(write_bio, bp, s, len, indent);
 }
 
-int BIO_hex_string(BIO *out, int indent, int width, unsigned char *data,
+int __cdecl BIO_hex_string(BIO *out, int indent, int width, unsigned char *data,
                    int datalen)
 {
     int i, j = 0;
diff --git a/crypto/bio/b_print.c b/crypto/bio/b_print.c
index 9e907fcaa7..e5d4c1b52f 100644
--- a/crypto/bio/b_print.c
+++ b/crypto/bio/b_print.c
@@ -850,7 +850,7 @@ doapr_outch(char **sbuffer,
 
 /***************************************************************************/
 
-int BIO_printf(BIO *bio, const char *format, ...)
+int __cdecl BIO_printf(BIO *bio, const char *format, ...)
 {
     va_list args;
     int ret;
@@ -863,7 +863,7 @@ int BIO_printf(BIO *bio, const char *format, ...)
     return ret;
 }
 
-int BIO_vprintf(BIO *bio, const char *format, va_list args)
+int __cdecl BIO_vprintf(BIO *bio, const char *format, va_list args)
 {
     int ret;
     size_t retlen;
@@ -896,7 +896,7 @@ int BIO_vprintf(BIO *bio, const char *format, va_list args)
  * closely related to BIO_printf, and we need *some* name prefix ... (XXX the
  * function should be renamed, but to what?)
  */
-int BIO_snprintf(char *buf, size_t n, const char *format, ...)
+int __cdecl BIO_snprintf(char *buf, size_t n, const char *format, ...)
 {
     va_list args;
     int ret;
@@ -909,7 +909,7 @@ int BIO_snprintf(char *buf, size_t n, const char *format, ...)
     return ret;
 }
 
-int BIO_vsnprintf(char *buf, size_t n, const char *format, va_list args)
+int __cdecl BIO_vsnprintf(char *buf, size_t n, const char *format, va_list args)
 {
     size_t retlen;
     int truncated;
diff --git a/crypto/bio/b_sock.c b/crypto/bio/b_sock.c
index e7a24d02cb..ffa98b8041 100644
--- a/crypto/bio/b_sock.c
+++ b/crypto/bio/b_sock.c
@@ -85,7 +85,7 @@ int BIO_get_port(const char *str, unsigned short *port_ptr)
 }
 # endif
 
-int BIO_sock_error(int sock)
+int __cdecl BIO_sock_error(int sock)
 {
     int j = 0, i;
     socklen_t size = sizeof(j);
@@ -114,7 +114,7 @@ struct hostent *BIO_gethostbyname(const char *name)
 }
 # endif
 
-int BIO_sock_init(void)
+int __cdecl BIO_sock_init(void)
 {
 # ifdef OPENSSL_SYS_WINDOWS
     static struct WSAData wsa_state;
@@ -158,7 +158,7 @@ void bio_sock_cleanup_int(void)
 # endif
 }
 
-int BIO_socket_ioctl(int fd, long type, void *arg)
+int __cdecl BIO_socket_ioctl(int fd, long type, void *arg)
 {
     int i;
 
@@ -274,7 +274,7 @@ int BIO_accept(int sock, char **ip_port)
 }
 # endif
 
-int BIO_set_tcp_ndelay(int s, int on)
+int __cdecl BIO_set_tcp_ndelay(int s, int on)
 {
     int ret = 0;
 # if defined(TCP_NODELAY) && (defined(IPPROTO_TCP) || defined(SOL_TCP))
@@ -293,7 +293,7 @@ int BIO_set_tcp_ndelay(int s, int on)
     return (ret == 0);
 }
 
-int BIO_socket_nbio(int s, int mode)
+int __cdecl BIO_socket_nbio(int s, int mode)
 {
     int ret = -1;
     int l;
@@ -337,7 +337,7 @@ int BIO_socket_nbio(int s, int mode)
     return (ret == 0);
 }
 
-int BIO_sock_info(int sock,
+int __cdecl BIO_sock_info(int sock,
                   enum BIO_sock_info_type type, union BIO_sock_info_u *info)
 {
     switch (type) {
diff --git a/crypto/bio/b_sock2.c b/crypto/bio/b_sock2.c
index 5d82ab22dc..9ddc63b3e4 100644
--- a/crypto/bio/b_sock2.c
+++ b/crypto/bio/b_sock2.c
@@ -37,7 +37,7 @@
  * Returns the file descriptor on success or INVALID_SOCKET on failure.  On
  * failure errno is set, and a status is added to the OpenSSL error stack.
  */
-int BIO_socket(int domain, int socktype, int protocol, int options)
+int __cdecl BIO_socket(int domain, int socktype, int protocol, int options)
 {
     int sock = -1;
 
@@ -74,7 +74,7 @@ int BIO_socket(int domain, int socktype, int protocol, int options)
  * Returns 1 on success or 0 on failure.  On failure errno is set
  * and an error status is added to the OpenSSL error stack.
  */
-int BIO_connect(int sock, const BIO_ADDR *addr, int options)
+int __cdecl BIO_connect(int sock, const BIO_ADDR *addr, int options)
 {
     const int on = 1;
 
@@ -131,7 +131,7 @@ int BIO_connect(int sock, const BIO_ADDR *addr, int options)
  * you set to BIO_SOCK_REUSEADDR option it will try to reuse the port anyway.
  * It's recommended that you use this.
  */
-int BIO_bind(int sock, const BIO_ADDR *addr, int options)
+int __cdecl BIO_bind(int sock, const BIO_ADDR *addr, int options)
 {
 # ifndef OPENSSL_SYS_WINDOWS
     int on = 1;
@@ -203,7 +203,7 @@ int BIO_bind(int sock, const BIO_ADDR *addr, int options)
  * you set to BIO_SOCK_REUSEADDR option it will try to reuse the port anyway.
  * It's recommended that you use this.
  */
-int BIO_listen(int sock, const BIO_ADDR *addr, int options)
+int __cdecl BIO_listen(int sock, const BIO_ADDR *addr, int options)
 {
     int on = 1;
     int socktype;
@@ -278,7 +278,7 @@ int BIO_listen(int sock, const BIO_ADDR *addr, int options)
  * @options: BIO socket options, applied on the accepted socket.
  *
  */
-int BIO_accept_ex(int accept_sock, BIO_ADDR *addr_, int options)
+int __cdecl BIO_accept_ex(int accept_sock, BIO_ADDR *addr_, int options)
 {
     socklen_t len;
     int accepted_sock;
@@ -308,7 +308,7 @@ int BIO_accept_ex(int accept_sock, BIO_ADDR *addr_, int options)
  * BIO_closesocket - Close a socket
  * @sock: the socket to close
  */
-int BIO_closesocket(int sock)
+int __cdecl BIO_closesocket(int sock)
 {
     if (closesocket(sock) < 0)
         return 0;
diff --git a/crypto/bio/bf_buff.c b/crypto/bio/bf_buff.c
index 8e87a629b8..24081bc8ee 100644
--- a/crypto/bio/bf_buff.c
+++ b/crypto/bio/bf_buff.c
@@ -39,7 +39,7 @@ static const BIO_METHOD methods_buffer = {
     buffer_callback_ctrl,
 };
 
-const BIO_METHOD *BIO_f_buffer(void)
+const BIO_METHOD * __cdecl BIO_f_buffer(void)
 {
     return &methods_buffer;
 }
diff --git a/crypto/bio/bf_lbuf.c b/crypto/bio/bf_lbuf.c
index 194c7b8af7..dd2398aefe 100644
--- a/crypto/bio/bf_lbuf.c
+++ b/crypto/bio/bf_lbuf.c
@@ -44,7 +44,7 @@ static const BIO_METHOD methods_linebuffer = {
     linebuffer_callback_ctrl,
 };
 
-const BIO_METHOD *BIO_f_linebuffer(void)
+const BIO_METHOD * __cdecl BIO_f_linebuffer(void)
 {
     return &methods_linebuffer;
 }
diff --git a/crypto/bio/bf_nbio.c b/crypto/bio/bf_nbio.c
index 4bc84eeba6..ed299559eb 100644
--- a/crypto/bio/bf_nbio.c
+++ b/crypto/bio/bf_nbio.c
@@ -48,7 +48,7 @@ static const BIO_METHOD methods_nbiof = {
     nbiof_callback_ctrl,
 };
 
-const BIO_METHOD *BIO_f_nbio_test(void)
+const BIO_METHOD * __cdecl BIO_f_nbio_test(void)
 {
     return &methods_nbiof;
 }
diff --git a/crypto/bio/bf_null.c b/crypto/bio/bf_null.c
index 613fb2e058..0091b4aac5 100644
--- a/crypto/bio/bf_null.c
+++ b/crypto/bio/bf_null.c
@@ -39,7 +39,7 @@ static const BIO_METHOD methods_nullf = {
     nullf_callback_ctrl,
 };
 
-const BIO_METHOD *BIO_f_null(void)
+const BIO_METHOD * __cdecl BIO_f_null(void)
 {
     return &methods_nullf;
 }
diff --git a/crypto/bio/bio_cb.c b/crypto/bio/bio_cb.c
index 1154c233af..26c0a0d41b 100644
--- a/crypto/bio/bio_cb.c
+++ b/crypto/bio/bio_cb.c
@@ -14,7 +14,7 @@
 #include "internal/cryptlib.h"
 #include <openssl/err.h>
 
-long BIO_debug_callback(BIO *bio, int cmd, const char *argp,
+long __cdecl BIO_debug_callback(BIO *bio, int cmd, const char *argp,
                         int argi, long argl, long ret)
 {
     BIO *b;
diff --git a/crypto/bio/bio_err.c b/crypto/bio/bio_err.c
index 7aa9dabb29..15986e095d 100644
--- a/crypto/bio/bio_err.c
+++ b/crypto/bio/bio_err.c
@@ -133,7 +133,7 @@ static const ERR_STRING_DATA BIO_str_reasons[] = {
 
 #endif
 
-int ERR_load_BIO_strings(void)
+int __cdecl ERR_load_BIO_strings(void)
 {
 #ifndef OPENSSL_NO_ERR
     if (ERR_func_error_string(BIO_str_functs[0].error) == NULL) {
diff --git a/crypto/bio/bio_lib.c b/crypto/bio/bio_lib.c
index ca375b911a..7ecd31a1ad 100644
--- a/crypto/bio/bio_lib.c
+++ b/crypto/bio/bio_lib.c
@@ -68,7 +68,7 @@ static long bio_call_callback(BIO *b, int oper, const char *argp, size_t len,
     return ret;
 }
 
-BIO *BIO_new(const BIO_METHOD *method)
+BIO * __cdecl BIO_new(const BIO_METHOD *method)
 {
     BIO *bio = OPENSSL_zalloc(sizeof(*bio));
 
@@ -107,7 +107,7 @@ err:
     return NULL;
 }
 
-int BIO_free(BIO *a)
+int __cdecl BIO_free(BIO *a)
 {
     int ret;
 
@@ -140,42 +140,42 @@ int BIO_free(BIO *a)
     return 1;
 }
 
-void BIO_set_data(BIO *a, void *ptr)
+void __cdecl BIO_set_data(BIO *a, void *ptr)
 {
     a->ptr = ptr;
 }
 
-void *BIO_get_data(BIO *a)
+void * __cdecl BIO_get_data(BIO *a)
 {
     return a->ptr;
 }
 
-void BIO_set_init(BIO *a, int init)
+void __cdecl BIO_set_init(BIO *a, int init)
 {
     a->init = init;
 }
 
-int BIO_get_init(BIO *a)
+int __cdecl BIO_get_init(BIO *a)
 {
     return a->init;
 }
 
-void BIO_set_shutdown(BIO *a, int shut)
+void __cdecl BIO_set_shutdown(BIO *a, int shut)
 {
     a->shutdown = shut;
 }
 
-int BIO_get_shutdown(BIO *a)
+int __cdecl BIO_get_shutdown(BIO *a)
 {
     return a->shutdown;
 }
 
-void BIO_vfree(BIO *a)
+void __cdecl BIO_vfree(BIO *a)
 {
     BIO_free(a);
 }
 
-int BIO_up_ref(BIO *a)
+int __cdecl BIO_up_ref(BIO *a)
 {
     int i;
 
@@ -187,57 +187,57 @@ int BIO_up_ref(BIO *a)
     return ((i > 1) ? 1 : 0);
 }
 
-void BIO_clear_flags(BIO *b, int flags)
+void __cdecl BIO_clear_flags(BIO *b, int flags)
 {
     b->flags &= ~flags;
 }
 
-int BIO_test_flags(const BIO *b, int flags)
+int __cdecl BIO_test_flags(const BIO *b, int flags)
 {
     return (b->flags & flags);
 }
 
-void BIO_set_flags(BIO *b, int flags)
+void __cdecl BIO_set_flags(BIO *b, int flags)
 {
     b->flags |= flags;
 }
 
-BIO_callback_fn BIO_get_callback(const BIO *b)
+BIO_callback_fn __cdecl BIO_get_callback(const BIO *b)
 {
     return b->callback;
 }
 
-void BIO_set_callback(BIO *b, BIO_callback_fn cb)
+void __cdecl BIO_set_callback(BIO *b, BIO_callback_fn cb)
 {
     b->callback = cb;
 }
 
-BIO_callback_fn_ex BIO_get_callback_ex(const BIO *b)
+BIO_callback_fn_ex __cdecl BIO_get_callback_ex(const BIO *b)
 {
     return b->callback_ex;
 }
 
-void BIO_set_callback_ex(BIO *b, BIO_callback_fn_ex cb)
+void __cdecl BIO_set_callback_ex(BIO *b, BIO_callback_fn_ex cb)
 {
     b->callback_ex = cb;
 }
 
-void BIO_set_callback_arg(BIO *b, char *arg)
+void __cdecl BIO_set_callback_arg(BIO *b, char *arg)
 {
     b->cb_arg = arg;
 }
 
-char *BIO_get_callback_arg(const BIO *b)
+char * __cdecl BIO_get_callback_arg(const BIO *b)
 {
     return b->cb_arg;
 }
 
-const char *BIO_method_name(const BIO *b)
+const char * __cdecl BIO_method_name(const BIO *b)
 {
     return b->method->name;
 }
 
-int BIO_method_type(const BIO *b)
+int __cdecl BIO_method_type(const BIO *b)
 {
     return b->method->type;
 }
@@ -285,7 +285,7 @@ static int bio_read_intern(BIO *b, void *data, size_t dlen, size_t *readbytes)
     return ret;
 }
 
-int BIO_read(BIO *b, void *data, int dlen)
+int __cdecl BIO_read(BIO *b, void *data, int dlen)
 {
     size_t readbytes;
     int ret;
@@ -303,7 +303,7 @@ int BIO_read(BIO *b, void *data, int dlen)
     return ret;
 }
 
-int BIO_read_ex(BIO *b, void *data, size_t dlen, size_t *readbytes)
+int __cdecl BIO_read_ex(BIO *b, void *data, size_t dlen, size_t *readbytes)
 {
     int ret;
 
@@ -352,7 +352,7 @@ static int bio_write_intern(BIO *b, const void *data, size_t dlen,
     return ret;
 }
 
-int BIO_write(BIO *b, const void *data, int dlen)
+int __cdecl BIO_write(BIO *b, const void *data, int dlen)
 {
     size_t written;
     int ret;
@@ -370,7 +370,7 @@ int BIO_write(BIO *b, const void *data, int dlen)
     return ret;
 }
 
-int BIO_write_ex(BIO *b, const void *data, size_t dlen, size_t *written)
+int __cdecl BIO_write_ex(BIO *b, const void *data, size_t dlen, size_t *written)
 {
     int ret;
 
@@ -384,7 +384,7 @@ int BIO_write_ex(BIO *b, const void *data, size_t dlen, size_t *written)
     return ret;
 }
 
-int BIO_puts(BIO *b, const char *buf)
+int __cdecl BIO_puts(BIO *b, const char *buf)
 {
     int ret;
     size_t written = 0;
@@ -429,7 +429,7 @@ int BIO_puts(BIO *b, const char *buf)
     return ret;
 }
 
-int BIO_gets(BIO *b, char *buf, int size)
+int __cdecl BIO_gets(BIO *b, char *buf, int size)
 {
     int ret;
     size_t readbytes = 0;
@@ -477,7 +477,7 @@ int BIO_gets(BIO *b, char *buf, int size)
     return ret;
 }
 
-int BIO_indent(BIO *b, int indent, int max)
+int __cdecl BIO_indent(BIO *b, int indent, int max)
 {
     if (indent < 0)
         indent = 0;
@@ -489,7 +489,7 @@ int BIO_indent(BIO *b, int indent, int max)
     return 1;
 }
 
-long BIO_int_ctrl(BIO *b, int cmd, long larg, int iarg)
+long __cdecl BIO_int_ctrl(BIO *b, int cmd, long larg, int iarg)
 {
     int i;
 
@@ -497,7 +497,7 @@ long BIO_int_ctrl(BIO *b, int cmd, long larg, int iarg)
     return BIO_ctrl(b, cmd, larg, (char *)&i);
 }
 
-void *BIO_ptr_ctrl(BIO *b, int cmd, long larg)
+void * __cdecl BIO_ptr_ctrl(BIO *b, int cmd, long larg)
 {
     void *p = NULL;
 
@@ -507,7 +507,7 @@ void *BIO_ptr_ctrl(BIO *b, int cmd, long larg)
         return p;
 }
 
-long BIO_ctrl(BIO *b, int cmd, long larg, void *parg)
+long __cdecl BIO_ctrl(BIO *b, int cmd, long larg, void *parg)
 {
     long ret;
 
@@ -534,7 +534,7 @@ long BIO_ctrl(BIO *b, int cmd, long larg, void *parg)
     return ret;
 }
 
-long BIO_callback_ctrl(BIO *b, int cmd, BIO_info_cb *fp)
+long __cdecl BIO_callback_ctrl(BIO *b, int cmd, BIO_info_cb *fp)
 {
     long ret;
 
@@ -568,18 +568,18 @@ long BIO_callback_ctrl(BIO *b, int cmd, BIO_info_cb *fp)
  * do; but those macros have inappropriate return type, and for interfacing
  * from other programming languages, C macros aren't much of a help anyway.
  */
-size_t BIO_ctrl_pending(BIO *bio)
+size_t __cdecl BIO_ctrl_pending(BIO *bio)
 {
     return BIO_ctrl(bio, BIO_CTRL_PENDING, 0, NULL);
 }
 
-size_t BIO_ctrl_wpending(BIO *bio)
+size_t __cdecl BIO_ctrl_wpending(BIO *bio)
 {
     return BIO_ctrl(bio, BIO_CTRL_WPENDING, 0, NULL);
 }
 
 /* put the 'bio' on the end of b's list of operators */
-BIO *BIO_push(BIO *b, BIO *bio)
+BIO * __cdecl BIO_push(BIO *b, BIO *bio)
 {
     BIO *lb;
 
@@ -597,7 +597,7 @@ BIO *BIO_push(BIO *b, BIO *bio)
 }
 
 /* Remove the first and return the rest */
-BIO *BIO_pop(BIO *b)
+BIO * __cdecl BIO_pop(BIO *b)
 {
     BIO *ret;
 
@@ -617,7 +617,7 @@ BIO *BIO_pop(BIO *b)
     return ret;
 }
 
-BIO *BIO_get_retry_BIO(BIO *bio, int *reason)
+BIO * __cdecl BIO_get_retry_BIO(BIO *bio, int *reason)
 {
     BIO *b, *last;
 
@@ -635,17 +635,17 @@ BIO *BIO_get_retry_BIO(BIO *bio, int *reason)
     return last;
 }
 
-int BIO_get_retry_reason(BIO *bio)
+int __cdecl BIO_get_retry_reason(BIO *bio)
 {
     return bio->retry_reason;
 }
 
-void BIO_set_retry_reason(BIO *bio, int reason)
+void __cdecl BIO_set_retry_reason(BIO *bio, int reason)
 {
     bio->retry_reason = reason;
 }
 
-BIO *BIO_find_type(BIO *bio, int type)
+BIO * __cdecl BIO_find_type(BIO *bio, int type)
 {
     int mt, mask;
 
@@ -667,19 +667,19 @@ BIO *BIO_find_type(BIO *bio, int type)
     return NULL;
 }
 
-BIO *BIO_next(BIO *b)
+BIO * __cdecl BIO_next(BIO *b)
 {
     if (b == NULL)
         return NULL;
     return b->next_bio;
 }
 
-void BIO_set_next(BIO *b, BIO *next)
+void __cdecl BIO_set_next(BIO *b, BIO *next)
 {
     b->next_bio = next;
 }
 
-void BIO_free_all(BIO *bio)
+void __cdecl BIO_free_all(BIO *bio)
 {
     BIO *b;
     int ref;
@@ -695,7 +695,7 @@ void BIO_free_all(BIO *bio)
     }
 }
 
-BIO *BIO_dup_chain(BIO *in)
+BIO * __cdecl BIO_dup_chain(BIO *in)
 {
     BIO *ret = NULL, *eoc = NULL, *bio, *new_bio;
 
@@ -739,30 +739,30 @@ BIO *BIO_dup_chain(BIO *in)
     return NULL;
 }
 
-void BIO_copy_next_retry(BIO *b)
+void __cdecl BIO_copy_next_retry(BIO *b)
 {
     BIO_set_flags(b, BIO_get_retry_flags(b->next_bio));
     b->retry_reason = b->next_bio->retry_reason;
 }
 
-int BIO_set_ex_data(BIO *bio, int idx, void *data)
+int __cdecl BIO_set_ex_data(BIO *bio, int idx, void *data)
 {
     return CRYPTO_set_ex_data(&(bio->ex_data), idx, data);
 }
 
-void *BIO_get_ex_data(BIO *bio, int idx)
+void * __cdecl BIO_get_ex_data(BIO *bio, int idx)
 {
     return CRYPTO_get_ex_data(&(bio->ex_data), idx);
 }
 
-uint64_t BIO_number_read(BIO *bio)
+uint64_t __cdecl BIO_number_read(BIO *bio)
 {
     if (bio)
         return bio->num_read;
     return 0;
 }
 
-uint64_t BIO_number_written(BIO *bio)
+uint64_t __cdecl BIO_number_written(BIO *bio)
 {
     if (bio)
         return bio->num_write;
diff --git a/crypto/bio/bio_meth.c b/crypto/bio/bio_meth.c
index 493ff63a90..6018cbd424 100644
--- a/crypto/bio/bio_meth.c
+++ b/crypto/bio/bio_meth.c
@@ -19,7 +19,7 @@ DEFINE_RUN_ONCE_STATIC(do_bio_type_init)
     return bio_type_lock != NULL;
 }
 
-int BIO_get_new_index(void)
+int __cdecl BIO_get_new_index(void)
 {
     static CRYPTO_REF_COUNT bio_count = BIO_TYPE_START;
     int newval;
@@ -33,7 +33,7 @@ int BIO_get_new_index(void)
     return newval;
 }
 
-BIO_METHOD *BIO_meth_new(int type, const char *name)
+BIO_METHOD * __cdecl BIO_meth_new(int type, const char *name)
 {
     BIO_METHOD *biom = OPENSSL_zalloc(sizeof(BIO_METHOD));
 
@@ -47,7 +47,7 @@ BIO_METHOD *BIO_meth_new(int type, const char *name)
     return biom;
 }
 
-void BIO_meth_free(BIO_METHOD *biom)
+void __cdecl BIO_meth_free(BIO_METHOD *biom)
 {
     if (biom != NULL) {
         OPENSSL_free(biom->name);
@@ -55,12 +55,12 @@ void BIO_meth_free(BIO_METHOD *biom)
     }
 }
 
-int (*BIO_meth_get_write(const BIO_METHOD *biom)) (BIO *, const char *, int)
+int (* __cdecl BIO_meth_get_write(const BIO_METHOD *biom)) (BIO *, const char *, int)
 {
     return biom->bwrite_old;
 }
 
-int (*BIO_meth_get_write_ex(const BIO_METHOD *biom)) (BIO *, const char *, size_t,
+int (* __cdecl BIO_meth_get_write_ex(const BIO_METHOD *biom)) (BIO *, const char *, size_t,
                                                 size_t *)
 {
     return biom->bwrite;
@@ -86,7 +86,7 @@ int bwrite_conv(BIO *bio, const char *data, size_t datal, size_t *written)
     return 1;
 }
 
-int BIO_meth_set_write(BIO_METHOD *biom,
+int __cdecl BIO_meth_set_write(BIO_METHOD *biom,
                        int (*bwrite) (BIO *, const char *, int))
 {
     biom->bwrite_old = bwrite;
@@ -94,7 +94,7 @@ int BIO_meth_set_write(BIO_METHOD *biom,
     return 1;
 }
 
-int BIO_meth_set_write_ex(BIO_METHOD *biom,
+int __cdecl BIO_meth_set_write_ex(BIO_METHOD *biom,
                        int (*bwrite) (BIO *, const char *, size_t, size_t *))
 {
     biom->bwrite_old = NULL;
@@ -102,12 +102,12 @@ int BIO_meth_set_write_ex(BIO_METHOD *biom,
     return 1;
 }
 
-int (*BIO_meth_get_read(const BIO_METHOD *biom)) (BIO *, char *, int)
+int (* __cdecl BIO_meth_get_read(const BIO_METHOD *biom)) (BIO *, char *, int)
 {
     return biom->bread_old;
 }
 
-int (*BIO_meth_get_read_ex(const BIO_METHOD *biom)) (BIO *, char *, size_t, size_t *)
+int (* __cdecl BIO_meth_get_read_ex(const BIO_METHOD *biom)) (BIO *, char *, size_t, size_t *)
 {
     return biom->bread;
 }
@@ -132,7 +132,7 @@ int bread_conv(BIO *bio, char *data, size_t datal, size_t *readbytes)
     return 1;
 }
 
-int BIO_meth_set_read(BIO_METHOD *biom,
+int __cdecl BIO_meth_set_read(BIO_METHOD *biom,
                       int (*bread) (BIO *, char *, int))
 {
     biom->bread_old = bread;
@@ -140,7 +140,7 @@ int BIO_meth_set_read(BIO_METHOD *biom,
     return 1;
 }
 
-int BIO_meth_set_read_ex(BIO_METHOD *biom,
+int __cdecl BIO_meth_set_read_ex(BIO_METHOD *biom,
                          int (*bread) (BIO *, char *, size_t, size_t *))
 {
     biom->bread_old = NULL;
@@ -148,70 +148,70 @@ int BIO_meth_set_read_ex(BIO_METHOD *biom,
     return 1;
 }
 
-int (*BIO_meth_get_puts(const BIO_METHOD *biom)) (BIO *, const char *)
+int (* __cdecl BIO_meth_get_puts(const BIO_METHOD *biom)) (BIO *, const char *)
 {
     return biom->bputs;
 }
 
-int BIO_meth_set_puts(BIO_METHOD *biom,
+int __cdecl BIO_meth_set_puts(BIO_METHOD *biom,
                       int (*bputs) (BIO *, const char *))
 {
     biom->bputs = bputs;
     return 1;
 }
 
-int (*BIO_meth_get_gets(const BIO_METHOD *biom)) (BIO *, char *, int)
+int (* __cdecl BIO_meth_get_gets(const BIO_METHOD *biom)) (BIO *, char *, int)
 {
     return biom->bgets;
 }
 
-int BIO_meth_set_gets(BIO_METHOD *biom,
+int __cdecl BIO_meth_set_gets(BIO_METHOD *biom,
                       int (*bgets) (BIO *, char *, int))
 {
     biom->bgets = bgets;
     return 1;
 }
 
-long (*BIO_meth_get_ctrl(const BIO_METHOD *biom)) (BIO *, int, long, void *)
+long (* __cdecl BIO_meth_get_ctrl(const BIO_METHOD *biom)) (BIO *, int, long, void *)
 {
     return biom->ctrl;
 }
 
-int BIO_meth_set_ctrl(BIO_METHOD *biom,
+int __cdecl BIO_meth_set_ctrl(BIO_METHOD *biom,
                       long (*ctrl) (BIO *, int, long, void *))
 {
     biom->ctrl = ctrl;
     return 1;
 }
 
-int (*BIO_meth_get_create(const BIO_METHOD *biom)) (BIO *)
+int (* __cdecl BIO_meth_get_create(const BIO_METHOD *biom)) (BIO *)
 {
     return biom->create;
 }
 
-int BIO_meth_set_create(BIO_METHOD *biom, int (*create) (BIO *))
+int __cdecl BIO_meth_set_create(BIO_METHOD *biom, int (*create) (BIO *))
 {
     biom->create = create;
     return 1;
 }
 
-int (*BIO_meth_get_destroy(const BIO_METHOD *biom)) (BIO *)
+int (* __cdecl BIO_meth_get_destroy(const BIO_METHOD *biom)) (BIO *)
 {
     return biom->destroy;
 }
 
-int BIO_meth_set_destroy(BIO_METHOD *biom, int (*destroy) (BIO *))
+int __cdecl BIO_meth_set_destroy(BIO_METHOD *biom, int (*destroy) (BIO *))
 {
     biom->destroy = destroy;
     return 1;
 }
 
-long (*BIO_meth_get_callback_ctrl(const BIO_METHOD *biom)) (BIO *, int, BIO_info_cb *)
+long (* __cdecl BIO_meth_get_callback_ctrl(const BIO_METHOD *biom)) (BIO *, int, BIO_info_cb *)
 {
     return biom->callback_ctrl;
 }
 
-int BIO_meth_set_callback_ctrl(BIO_METHOD *biom,
+int __cdecl BIO_meth_set_callback_ctrl(BIO_METHOD *biom,
                                long (*callback_ctrl) (BIO *, int,
                                                       BIO_info_cb *))
 {
diff --git a/crypto/bio/bss_acpt.c b/crypto/bio/bss_acpt.c
index 993e5903a0..e1485816cf 100644
--- a/crypto/bio/bss_acpt.c
+++ b/crypto/bio/bss_acpt.c
@@ -68,7 +68,7 @@ static const BIO_METHOD methods_acceptp = {
     NULL,                       /* connect_callback_ctrl */
 };
 
-const BIO_METHOD *BIO_s_accept(void)
+const BIO_METHOD * __cdecl BIO_s_accept(void)
 {
     return &methods_acceptp;
 }
@@ -544,7 +544,7 @@ static int acpt_puts(BIO *bp, const char *str)
     return ret;
 }
 
-BIO *BIO_new_accept(const char *str)
+BIO * __cdecl BIO_new_accept(const char *str)
 {
     BIO *ret;
 
diff --git a/crypto/bio/bss_bio.c b/crypto/bio/bss_bio.c
index e34382c557..2d6529240f 100644
--- a/crypto/bio/bss_bio.c
+++ b/crypto/bio/bss_bio.c
@@ -52,7 +52,7 @@ static const BIO_METHOD methods_biop = {
     NULL                        /* no bio_callback_ctrl */
 };
 
-const BIO_METHOD *BIO_s_bio(void)
+const BIO_METHOD * __cdecl BIO_s_bio(void)
 {
     return &methods_biop;
 }
@@ -682,7 +682,7 @@ static void bio_destroy_pair(BIO *bio)
 }
 
 /* Exported convenience functions */
-int BIO_new_bio_pair(BIO **bio1_p, size_t writebuf1,
+int __cdecl BIO_new_bio_pair(BIO **bio1_p, size_t writebuf1,
                      BIO **bio2_p, size_t writebuf2)
 {
     BIO *bio1 = NULL, *bio2 = NULL;
@@ -725,17 +725,17 @@ int BIO_new_bio_pair(BIO **bio1_p, size_t writebuf1,
     return ret;
 }
 
-size_t BIO_ctrl_get_write_guarantee(BIO *bio)
+size_t __cdecl BIO_ctrl_get_write_guarantee(BIO *bio)
 {
     return BIO_ctrl(bio, BIO_C_GET_WRITE_GUARANTEE, 0, NULL);
 }
 
-size_t BIO_ctrl_get_read_request(BIO *bio)
+size_t __cdecl BIO_ctrl_get_read_request(BIO *bio)
 {
     return BIO_ctrl(bio, BIO_C_GET_READ_REQUEST, 0, NULL);
 }
 
-int BIO_ctrl_reset_read_request(BIO *bio)
+int __cdecl BIO_ctrl_reset_read_request(BIO *bio)
 {
     return (BIO_ctrl(bio, BIO_C_RESET_READ_REQUEST, 0, NULL) != 0);
 }
@@ -745,7 +745,7 @@ int BIO_ctrl_reset_read_request(BIO *bio)
  * (conceivably some other BIOs could allow non-copying reads and writes
  * too.)
  */
-int BIO_nread0(BIO *bio, char **buf)
+int __cdecl BIO_nread0(BIO *bio, char **buf)
 {
     long ret;
 
@@ -761,7 +761,7 @@ int BIO_nread0(BIO *bio, char **buf)
         return (int)ret;
 }
 
-int BIO_nread(BIO *bio, char **buf, int num)
+int __cdecl BIO_nread(BIO *bio, char **buf, int num)
 {
     int ret;
 
@@ -776,7 +776,7 @@ int BIO_nread(BIO *bio, char **buf, int num)
     return ret;
 }
 
-int BIO_nwrite0(BIO *bio, char **buf)
+int __cdecl BIO_nwrite0(BIO *bio, char **buf)
 {
     long ret;
 
@@ -792,7 +792,7 @@ int BIO_nwrite0(BIO *bio, char **buf)
         return (int)ret;
 }
 
-int BIO_nwrite(BIO *bio, char **buf, int num)
+int __cdecl BIO_nwrite(BIO *bio, char **buf, int num)
 {
     int ret;
 
diff --git a/crypto/bio/bss_conn.c b/crypto/bio/bss_conn.c
index e9673fe783..e6cfa068f5 100644
--- a/crypto/bio/bss_conn.c
+++ b/crypto/bio/bss_conn.c
@@ -242,7 +242,7 @@ void BIO_CONNECT_free(BIO_CONNECT *a)
     OPENSSL_free(a);
 }
 
-const BIO_METHOD *BIO_s_connect(void)
+const BIO_METHOD * __cdecl BIO_s_connect(void)
 {
     return &methods_connectp;
 }
@@ -524,7 +524,7 @@ static int conn_puts(BIO *bp, const char *str)
     return ret;
 }
 
-BIO *BIO_new_connect(const char *str)
+BIO * __cdecl BIO_new_connect(const char *str)
 {
     BIO *ret;
 
diff --git a/crypto/bio/bss_dgram.c b/crypto/bio/bss_dgram.c
index 551821609f..8fb8ccb96b 100644
--- a/crypto/bio/bss_dgram.c
+++ b/crypto/bio/bss_dgram.c
@@ -134,12 +134,12 @@ typedef struct bio_dgram_sctp_data_st {
 } bio_dgram_sctp_data;
 # endif
 
-const BIO_METHOD *BIO_s_datagram(void)
+const BIO_METHOD * __cdecl BIO_s_datagram(void)
 {
     return &methods_dgramp;
 }
 
-BIO *BIO_new_dgram(int fd, int close_flag)
+BIO * __cdecl BIO_new_dgram(int fd, int close_flag)
 {
     BIO *ret;
 
@@ -807,12 +807,12 @@ static int dgram_puts(BIO *bp, const char *str)
 }
 
 # ifndef OPENSSL_NO_SCTP
-const BIO_METHOD *BIO_s_datagram_sctp(void)
+const BIO_METHOD * __cdecl BIO_s_datagram_sctp(void)
 {
     return &methods_dgramp_sctp;
 }
 
-BIO *BIO_new_dgram_sctp(int fd, int close_flag)
+BIO * __cdecl BIO_new_dgram_sctp(int fd, int close_flag)
 {
     BIO *bio;
     int ret, optval = 20000;
@@ -944,7 +944,7 @@ BIO *BIO_new_dgram_sctp(int fd, int close_flag)
     return bio;
 }
 
-int BIO_dgram_is_sctp(BIO *bio)
+int __cdecl BIO_dgram_is_sctp(BIO *bio)
 {
     return (BIO_method_type(bio) == BIO_TYPE_DGRAM_SCTP);
 }
@@ -1573,7 +1573,7 @@ static long dgram_sctp_ctrl(BIO *b, int cmd, long num, void *ptr)
     return ret;
 }
 
-int BIO_dgram_sctp_notification_cb(BIO *b,
+int __cdecl BIO_dgram_sctp_notification_cb(BIO *b,
                                    void (*handle_notifications) (BIO *bio,
                                                                  void
                                                                  *context,
@@ -1604,7 +1604,7 @@ int BIO_dgram_sctp_notification_cb(BIO *b,
  *  0 when not dry yet
  *  1 when dry
  */
-int BIO_dgram_sctp_wait_for_dry(BIO *b)
+int __cdecl BIO_dgram_sctp_wait_for_dry(BIO *b)
 {
     int is_dry = 0;
     int sockflags = 0;
@@ -1762,7 +1762,7 @@ int BIO_dgram_sctp_wait_for_dry(BIO *b)
     return is_dry;
 }
 
-int BIO_dgram_sctp_msg_waiting(BIO *b)
+int __cdecl BIO_dgram_sctp_msg_waiting(BIO *b)
 {
     int n, sockflags;
     union sctp_notification snp;
@@ -1851,7 +1851,7 @@ static int BIO_dgram_should_retry(int i)
     return 0;
 }
 
-int BIO_dgram_non_fatal_error(int err)
+int __cdecl BIO_dgram_non_fatal_error(int err)
 {
     switch (err) {
 # if defined(OPENSSL_SYS_WINDOWS)
diff --git a/crypto/bio/bss_fd.c b/crypto/bio/bss_fd.c
index 5bc539c90b..d5e85b401a 100644
--- a/crypto/bio/bss_fd.c
+++ b/crypto/bio/bss_fd.c
@@ -16,22 +16,22 @@
 /*
  * Dummy placeholder for BIO_s_fd...
  */
-BIO *BIO_new_fd(int fd, int close_flag)
+BIO * __cdecl BIO_new_fd(int fd, int close_flag)
 {
     return NULL;
 }
 
-int BIO_fd_non_fatal_error(int err)
+int __cdecl BIO_fd_non_fatal_error(int err)
 {
     return 0;
 }
 
-int BIO_fd_should_retry(int i)
+int __cdecl BIO_fd_should_retry(int i)
 {
     return 0;
 }
 
-const BIO_METHOD *BIO_s_fd(void)
+const BIO_METHOD * __cdecl BIO_s_fd(void)
 {
     return NULL;
 }
@@ -55,7 +55,7 @@ static int fd_gets(BIO *h, char *buf, int size);
 static long fd_ctrl(BIO *h, int cmd, long arg1, void *arg2);
 static int fd_new(BIO *h);
 static int fd_free(BIO *data);
-int BIO_fd_should_retry(int s);
+int __cdecl BIO_fd_should_retry(int s);
 
 static const BIO_METHOD methods_fdp = {
     BIO_TYPE_FD,
@@ -74,12 +74,12 @@ static const BIO_METHOD methods_fdp = {
     NULL,                       /* fd_callback_ctrl */
 };
 
-const BIO_METHOD *BIO_s_fd(void)
+const BIO_METHOD * __cdecl BIO_s_fd(void)
 {
     return &methods_fdp;
 }
 
-BIO *BIO_new_fd(int fd, int close_flag)
+BIO * __cdecl BIO_new_fd(int fd, int close_flag)
 {
     BIO *ret;
     ret = BIO_new(BIO_s_fd());
@@ -220,7 +220,7 @@ static int fd_gets(BIO *bp, char *buf, int size)
     return ret;
 }
 
-int BIO_fd_should_retry(int i)
+int __cdecl BIO_fd_should_retry(int i)
 {
     int err;
 
@@ -232,7 +232,7 @@ int BIO_fd_should_retry(int i)
     return 0;
 }
 
-int BIO_fd_non_fatal_error(int err)
+int __cdecl BIO_fd_non_fatal_error(int err)
 {
     switch (err) {
 
diff --git a/crypto/bio/bss_file.c b/crypto/bio/bss_file.c
index a210205597..7247808a0f 100644
--- a/crypto/bio/bss_file.c
+++ b/crypto/bio/bss_file.c
@@ -56,7 +56,7 @@ static const BIO_METHOD methods_filep = {
     NULL,                      /* file_callback_ctrl */
 };
 
-BIO *BIO_new_file(const char *filename, const char *mode)
+BIO * __cdecl BIO_new_file(const char *filename, const char *mode)
 {
     BIO  *ret;
     FILE *file = openssl_fopen(filename, mode);
@@ -89,7 +89,7 @@ BIO *BIO_new_file(const char *filename, const char *mode)
     return ret;
 }
 
-BIO *BIO_new_fp(FILE *stream, int close_flag)
+BIO * __cdecl BIO_new_fp(FILE *stream, int close_flag)
 {
     BIO *ret;
 
@@ -102,7 +102,7 @@ BIO *BIO_new_fp(FILE *stream, int close_flag)
     return ret;
 }
 
-const BIO_METHOD *BIO_s_file(void)
+const BIO_METHOD * __cdecl BIO_s_file(void)
 {
     return &methods_filep;
 }
@@ -409,12 +409,12 @@ static const BIO_METHOD methods_filep = {
     NULL,                      /* file_callback_ctrl */
 };
 
-const BIO_METHOD *BIO_s_file(void)
+const BIO_METHOD * __cdecl BIO_s_file(void)
 {
     return &methods_filep;
 }
 
-BIO *BIO_new_file(const char *filename, const char *mode)
+BIO * __cdecl BIO_new_file(const char *filename, const char *mode)
 {
     return NULL;
 }
diff --git a/crypto/bio/bss_log.c b/crypto/bio/bss_log.c
index e9ab932ec2..631ab8875f 100644
--- a/crypto/bio/bss_log.c
+++ b/crypto/bio/bss_log.c
@@ -100,7 +100,7 @@ static const BIO_METHOD methods_slg = {
     NULL,                      /* slg_callback_ctrl */
 };
 
-const BIO_METHOD *BIO_s_log(void)
+const BIO_METHOD * __cdecl BIO_s_log(void)
 {
     return &methods_slg;
 }
@@ -409,7 +409,7 @@ static void xcloselog(BIO *bp)
 # endif                         /* Unix */
 
 #else                           /* NO_SYSLOG */
-const BIO_METHOD *BIO_s_log(void)
+const BIO_METHOD * __cdecl BIO_s_log(void)
 {
     return NULL;
 }
diff --git a/crypto/bio/bss_mem.c b/crypto/bio/bss_mem.c
index 2d536e9db0..e729731b75 100644
--- a/crypto/bio/bss_mem.c
+++ b/crypto/bio/bss_mem.c
@@ -73,17 +73,17 @@ typedef struct bio_buf_mem_st {
  * should_retry is not set
  */
 
-const BIO_METHOD *BIO_s_mem(void)
+const BIO_METHOD * __cdecl BIO_s_mem(void)
 {
     return &mem_method;
 }
 
-const BIO_METHOD *BIO_s_secmem(void)
+const BIO_METHOD * __cdecl BIO_s_secmem(void)
 {
     return(&secmem_method);
 }
 
-BIO *BIO_new_mem_buf(const void *buf, int len)
+BIO * __cdecl BIO_new_mem_buf(const void *buf, int len)
 {
     BIO *ret;
     BUF_MEM *b;
diff --git a/crypto/bio/bss_null.c b/crypto/bio/bss_null.c
index 08f1d2bc98..0f7fa42ece 100644
--- a/crypto/bio/bss_null.c
+++ b/crypto/bio/bss_null.c
@@ -34,7 +34,7 @@ static const BIO_METHOD null_method = {
     NULL,                     /* null_callback_ctrl */
 };
 
-const BIO_METHOD *BIO_s_null(void)
+const BIO_METHOD * __cdecl BIO_s_null(void)
 {
     return &null_method;
 }
diff --git a/crypto/bio/bss_sock.c b/crypto/bio/bss_sock.c
index ad38453201..ba84c5a75a 100644
--- a/crypto/bio/bss_sock.c
+++ b/crypto/bio/bss_sock.c
@@ -32,7 +32,7 @@ static int sock_puts(BIO *h, const char *str);
 static long sock_ctrl(BIO *h, int cmd, long arg1, void *arg2);
 static int sock_new(BIO *h);
 static int sock_free(BIO *data);
-int BIO_sock_should_retry(int s);
+int __cdecl BIO_sock_should_retry(int s);
 
 static const BIO_METHOD methods_sockp = {
     BIO_TYPE_SOCKET,
@@ -51,12 +51,12 @@ static const BIO_METHOD methods_sockp = {
     NULL,                       /* sock_callback_ctrl */
 };
 
-const BIO_METHOD *BIO_s_socket(void)
+const BIO_METHOD * __cdecl BIO_s_socket(void)
 {
     return &methods_sockp;
 }
 
-BIO *BIO_new_socket(int fd, int close_flag)
+BIO * __cdecl BIO_new_socket(int fd, int close_flag)
 {
     BIO *ret;
 
@@ -167,7 +167,7 @@ static int sock_puts(BIO *bp, const char *str)
     return ret;
 }
 
-int BIO_sock_should_retry(int i)
+int __cdecl BIO_sock_should_retry(int i)
 {
     int err;
 
@@ -179,7 +179,7 @@ int BIO_sock_should_retry(int i)
     return 0;
 }
 
-int BIO_sock_non_fatal_error(int err)
+int __cdecl BIO_sock_non_fatal_error(int err)
 {
     switch (err) {
 # if defined(OPENSSL_SYS_WINDOWS)
diff --git a/crypto/blake2/m_blake2b.c b/crypto/blake2/m_blake2b.c
index c493648c3c..818d78d53e 100644
--- a/crypto/blake2/m_blake2b.c
+++ b/crypto/blake2/m_blake2b.c
@@ -52,7 +52,7 @@ static const EVP_MD blake2b_md = {
     sizeof(EVP_MD *) + sizeof(BLAKE2B_CTX),
 };
 
-const EVP_MD *EVP_blake2b512(void)
+const EVP_MD * __cdecl EVP_blake2b512(void)
 {
     return &blake2b_md;
 }
diff --git a/crypto/blake2/m_blake2s.c b/crypto/blake2/m_blake2s.c
index 83b2811e44..ebd0bd0a69 100644
--- a/crypto/blake2/m_blake2s.c
+++ b/crypto/blake2/m_blake2s.c
@@ -52,7 +52,7 @@ static const EVP_MD blake2s_md = {
     sizeof(EVP_MD *) + sizeof(BLAKE2S_CTX),
 };
 
-const EVP_MD *EVP_blake2s256(void)
+const EVP_MD * __cdecl EVP_blake2s256(void)
 {
     return &blake2s_md;
 }
diff --git a/crypto/bn/bn_add.c b/crypto/bn/bn_add.c
index f2736b8f6d..ed3d53ddd6 100644
--- a/crypto/bn/bn_add.c
+++ b/crypto/bn/bn_add.c
@@ -11,7 +11,7 @@
 #include "bn_lcl.h"
 
 /* signed add of b to a. */
-int BN_add(BIGNUM *r, const BIGNUM *a, const BIGNUM *b)
+int __cdecl BN_add(BIGNUM *r, const BIGNUM *a, const BIGNUM *b)
 {
     int ret, r_neg, cmp_res;
 
@@ -42,7 +42,7 @@ int BN_add(BIGNUM *r, const BIGNUM *a, const BIGNUM *b)
 }
 
 /* signed sub of b from a. */
-int BN_sub(BIGNUM *r, const BIGNUM *a, const BIGNUM *b)
+int __cdecl BN_sub(BIGNUM *r, const BIGNUM *a, const BIGNUM *b)
 {
     int ret, r_neg, cmp_res;
 
@@ -73,7 +73,7 @@ int BN_sub(BIGNUM *r, const BIGNUM *a, const BIGNUM *b)
 }
 
 /* unsigned add of b to a, r can be equal to a or b. */
-int BN_uadd(BIGNUM *r, const BIGNUM *a, const BIGNUM *b)
+int __cdecl BN_uadd(BIGNUM *r, const BIGNUM *a, const BIGNUM *b)
 {
     int max, min, dif;
     const BN_ULONG *ap, *bp;
@@ -122,7 +122,7 @@ int BN_uadd(BIGNUM *r, const BIGNUM *a, const BIGNUM *b)
 }
 
 /* unsigned subtraction of b from a, a must be larger than b. */
-int BN_usub(BIGNUM *r, const BIGNUM *a, const BIGNUM *b)
+int __cdecl BN_usub(BIGNUM *r, const BIGNUM *a, const BIGNUM *b)
 {
     int max, min, dif;
     BN_ULONG t1, t2, borrow, *rp;
diff --git a/crypto/bn/bn_blind.c b/crypto/bn/bn_blind.c
index 450cdfb348..78def6d9ef 100644
--- a/crypto/bn/bn_blind.c
+++ b/crypto/bn/bn_blind.c
@@ -22,12 +22,12 @@ struct bn_blinding_st {
     int counter;
     unsigned long flags;
     BN_MONT_CTX *m_ctx;
-    int (*bn_mod_exp) (BIGNUM *r, const BIGNUM *a, const BIGNUM *p,
+    int (__cdecl *bn_mod_exp) (BIGNUM *r, const BIGNUM *a, const BIGNUM *p,
                        const BIGNUM *m, BN_CTX *ctx, BN_MONT_CTX *m_ctx);
     CRYPTO_RWLOCK *lock;
 };
 
-BN_BLINDING *BN_BLINDING_new(const BIGNUM *A, const BIGNUM *Ai, BIGNUM *mod)
+BN_BLINDING * __cdecl BN_BLINDING_new(const BIGNUM *A, const BIGNUM *Ai, BIGNUM *mod)
 {
     BN_BLINDING *ret = NULL;
 
@@ -78,7 +78,7 @@ BN_BLINDING *BN_BLINDING_new(const BIGNUM *A, const BIGNUM *Ai, BIGNUM *mod)
     return NULL;
 }
 
-void BN_BLINDING_free(BN_BLINDING *r)
+void __cdecl BN_BLINDING_free(BN_BLINDING *r)
 {
     if (r == NULL)
         return;
@@ -90,7 +90,7 @@ void BN_BLINDING_free(BN_BLINDING *r)
     OPENSSL_free(r);
 }
 
-int BN_BLINDING_update(BN_BLINDING *b, BN_CTX *ctx)
+int __cdecl BN_BLINDING_update(BN_BLINDING *b, BN_CTX *ctx)
 {
     int ret = 0;
 
@@ -126,12 +126,12 @@ int BN_BLINDING_update(BN_BLINDING *b, BN_CTX *ctx)
     return ret;
 }
 
-int BN_BLINDING_convert(BIGNUM *n, BN_BLINDING *b, BN_CTX *ctx)
+int __cdecl BN_BLINDING_convert(BIGNUM *n, BN_BLINDING *b, BN_CTX *ctx)
 {
     return BN_BLINDING_convert_ex(n, NULL, b, ctx);
 }
 
-int BN_BLINDING_convert_ex(BIGNUM *n, BIGNUM *r, BN_BLINDING *b, BN_CTX *ctx)
+int __cdecl BN_BLINDING_convert_ex(BIGNUM *n, BIGNUM *r, BN_BLINDING *b, BN_CTX *ctx)
 {
     int ret = 1;
 
@@ -159,12 +159,12 @@ int BN_BLINDING_convert_ex(BIGNUM *n, BIGNUM *r, BN_BLINDING *b, BN_CTX *ctx)
     return ret;
 }
 
-int BN_BLINDING_invert(BIGNUM *n, BN_BLINDING *b, BN_CTX *ctx)
+int __cdecl BN_BLINDING_invert(BIGNUM *n, BN_BLINDING *b, BN_CTX *ctx)
 {
     return BN_BLINDING_invert_ex(n, NULL, b, ctx);
 }
 
-int BN_BLINDING_invert_ex(BIGNUM *n, const BIGNUM *r, BN_BLINDING *b,
+int __cdecl BN_BLINDING_invert_ex(BIGNUM *n, const BIGNUM *r, BN_BLINDING *b,
                           BN_CTX *ctx)
 {
     int ret;
@@ -200,39 +200,39 @@ int BN_BLINDING_invert_ex(BIGNUM *n, const BIGNUM *r, BN_BLINDING *b,
     return ret;
 }
 
-int BN_BLINDING_is_current_thread(BN_BLINDING *b)
+int __cdecl BN_BLINDING_is_current_thread(BN_BLINDING *b)
 {
     return CRYPTO_THREAD_compare_id(CRYPTO_THREAD_get_current_id(), b->tid);
 }
 
-void BN_BLINDING_set_current_thread(BN_BLINDING *b)
+void __cdecl BN_BLINDING_set_current_thread(BN_BLINDING *b)
 {
     b->tid = CRYPTO_THREAD_get_current_id();
 }
 
-int BN_BLINDING_lock(BN_BLINDING *b)
+int __cdecl BN_BLINDING_lock(BN_BLINDING *b)
 {
     return CRYPTO_THREAD_write_lock(b->lock);
 }
 
-int BN_BLINDING_unlock(BN_BLINDING *b)
+int __cdecl BN_BLINDING_unlock(BN_BLINDING *b)
 {
     return CRYPTO_THREAD_unlock(b->lock);
 }
 
-unsigned long BN_BLINDING_get_flags(const BN_BLINDING *b)
+unsigned long __cdecl BN_BLINDING_get_flags(const BN_BLINDING *b)
 {
     return b->flags;
 }
 
-void BN_BLINDING_set_flags(BN_BLINDING *b, unsigned long flags)
+void __cdecl BN_BLINDING_set_flags(BN_BLINDING *b, unsigned long flags)
 {
     b->flags = flags;
 }
 
-BN_BLINDING *BN_BLINDING_create_param(BN_BLINDING *b,
+BN_BLINDING * __cdecl BN_BLINDING_create_param(BN_BLINDING *b,
                                       const BIGNUM *e, BIGNUM *m, BN_CTX *ctx,
-                                      int (*bn_mod_exp) (BIGNUM *r,
+                                      int (__cdecl *bn_mod_exp) (BIGNUM *r,
                                                          const BIGNUM *a,
                                                          const BIGNUM *p,
                                                          const BIGNUM *m,
diff --git a/crypto/bn/bn_const.c b/crypto/bn/bn_const.c
index 39dd61202a..584f77f91d 100644
--- a/crypto/bn/bn_const.c
+++ b/crypto/bn/bn_const.c
@@ -18,7 +18,7 @@
  * RFC2412 specifies a generator of of 22.
  */
 
-BIGNUM *BN_get_rfc2409_prime_768(BIGNUM *bn)
+BIGNUM * __cdecl BN_get_rfc2409_prime_768(BIGNUM *bn)
 {
     static const unsigned char RFC2409_PRIME_768[] = {
         0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF,
@@ -46,7 +46,7 @@ BIGNUM *BN_get_rfc2409_prime_768(BIGNUM *bn)
  * RFC2412 specifies a generator of 22.
  */
 
-BIGNUM *BN_get_rfc2409_prime_1024(BIGNUM *bn)
+BIGNUM * __cdecl BN_get_rfc2409_prime_1024(BIGNUM *bn)
 {
     static const unsigned char RFC2409_PRIME_1024[] = {
         0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF,
@@ -78,7 +78,7 @@ BIGNUM *BN_get_rfc2409_prime_1024(BIGNUM *bn)
  * RFC2312 specifies a generator of 22.
  */
 
-BIGNUM *BN_get_rfc3526_prime_1536(BIGNUM *bn)
+BIGNUM * __cdecl BN_get_rfc3526_prime_1536(BIGNUM *bn)
 {
     static const unsigned char RFC3526_PRIME_1536[] = {
         0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF,
@@ -117,7 +117,7 @@ BIGNUM *BN_get_rfc3526_prime_1536(BIGNUM *bn)
  * RFC3526 specifies a generator of 2.
  */
 
-BIGNUM *BN_get_rfc3526_prime_2048(BIGNUM *bn)
+BIGNUM * __cdecl BN_get_rfc3526_prime_2048(BIGNUM *bn)
 {
     static const unsigned char RFC3526_PRIME_2048[] = {
         0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF,
@@ -164,7 +164,7 @@ BIGNUM *BN_get_rfc3526_prime_2048(BIGNUM *bn)
  * RFC3526 specifies a generator of 2.
  */
 
-BIGNUM *BN_get_rfc3526_prime_3072(BIGNUM *bn)
+BIGNUM * __cdecl BN_get_rfc3526_prime_3072(BIGNUM *bn)
 {
     static const unsigned char RFC3526_PRIME_3072[] = {
         0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF,
@@ -227,7 +227,7 @@ BIGNUM *BN_get_rfc3526_prime_3072(BIGNUM *bn)
  * RFC3526 specifies a generator of 2.
  */
 
-BIGNUM *BN_get_rfc3526_prime_4096(BIGNUM *bn)
+BIGNUM * __cdecl BN_get_rfc3526_prime_4096(BIGNUM *bn)
 {
     static const unsigned char RFC3526_PRIME_4096[] = {
         0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF,
@@ -306,7 +306,7 @@ BIGNUM *BN_get_rfc3526_prime_4096(BIGNUM *bn)
  * RFC3526 specifies a generator of 2.
  */
 
-BIGNUM *BN_get_rfc3526_prime_6144(BIGNUM *bn)
+BIGNUM * __cdecl BN_get_rfc3526_prime_6144(BIGNUM *bn)
 {
     static const unsigned char RFC3526_PRIME_6144[] = {
         0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF,
@@ -417,7 +417,7 @@ BIGNUM *BN_get_rfc3526_prime_6144(BIGNUM *bn)
  * RFC3526 specifies a generator of 2.
  */
 
-BIGNUM *BN_get_rfc3526_prime_8192(BIGNUM *bn)
+BIGNUM * __cdecl BN_get_rfc3526_prime_8192(BIGNUM *bn)
 {
     static const unsigned char RFC3526_PRIME_8192[] = {
         0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF,
diff --git a/crypto/bn/bn_ctx.c b/crypto/bn/bn_ctx.c
index 90cecea2aa..30c25af63e 100644
--- a/crypto/bn/bn_ctx.c
+++ b/crypto/bn/bn_ctx.c
@@ -131,7 +131,7 @@ static void ctxdbg(BN_CTX *ctx)
 #endif
 
 
-BN_CTX *BN_CTX_new(void)
+BN_CTX * __cdecl BN_CTX_new(void)
 {
     BN_CTX *ret;
 
@@ -145,7 +145,7 @@ BN_CTX *BN_CTX_new(void)
     return ret;
 }
 
-BN_CTX *BN_CTX_secure_new(void)
+BN_CTX * __cdecl BN_CTX_secure_new(void)
 {
     BN_CTX *ret = BN_CTX_new();
 
@@ -154,7 +154,7 @@ BN_CTX *BN_CTX_secure_new(void)
     return ret;
 }
 
-void BN_CTX_free(BN_CTX *ctx)
+void __cdecl BN_CTX_free(BN_CTX *ctx)
 {
     if (ctx == NULL)
         return;
@@ -178,7 +178,7 @@ void BN_CTX_free(BN_CTX *ctx)
     OPENSSL_free(ctx);
 }
 
-void BN_CTX_start(BN_CTX *ctx)
+void __cdecl BN_CTX_start(BN_CTX *ctx)
 {
     CTXDBG_ENTRY("BN_CTX_start", ctx);
     /* If we're already overflowing ... */
@@ -192,7 +192,7 @@ void BN_CTX_start(BN_CTX *ctx)
     CTXDBG_EXIT(ctx);
 }
 
-void BN_CTX_end(BN_CTX *ctx)
+void __cdecl BN_CTX_end(BN_CTX *ctx)
 {
     if (ctx == NULL)
         return;
@@ -211,7 +211,7 @@ void BN_CTX_end(BN_CTX *ctx)
     CTXDBG_EXIT(ctx);
 }
 
-BIGNUM *BN_CTX_get(BN_CTX *ctx)
+BIGNUM * __cdecl BN_CTX_get(BN_CTX *ctx)
 {
     BIGNUM *ret;
 
diff --git a/crypto/bn/bn_div.c b/crypto/bn/bn_div.c
index 7fc0132830..2b50a5b322 100644
--- a/crypto/bn/bn_div.c
+++ b/crypto/bn/bn_div.c
@@ -14,7 +14,7 @@
 
 /* The old slow way */
 #if 0
-int BN_div(BIGNUM *dv, BIGNUM *rem, const BIGNUM *m, const BIGNUM *d,
+int __cdecl BN_div(BIGNUM *dv, BIGNUM *rem, const BIGNUM *m, const BIGNUM *d,
            BN_CTX *ctx)
 {
     int i, nm, nd;
@@ -206,7 +206,7 @@ static int bn_left_align(BIGNUM *num)
  *     rm->neg == num->neg                 (unless the remainder is zero)
  * If 'dv' or 'rm' is NULL, the respective value is not returned.
  */
-int BN_div(BIGNUM *dv, BIGNUM *rm, const BIGNUM *num, const BIGNUM *divisor,
+int __cdecl BN_div(BIGNUM *dv, BIGNUM *rm, const BIGNUM *num, const BIGNUM *divisor,
            BN_CTX *ctx)
 {
     int ret;
diff --git a/crypto/bn/bn_err.c b/crypto/bn/bn_err.c
index dd87c152cf..fb6c82a3a4 100644
--- a/crypto/bn/bn_err.c
+++ b/crypto/bn/bn_err.c
@@ -106,7 +106,7 @@ static const ERR_STRING_DATA BN_str_reasons[] = {
 
 #endif
 
-int ERR_load_BN_strings(void)
+int __cdecl ERR_load_BN_strings(void)
 {
 #ifndef OPENSSL_NO_ERR
     if (ERR_func_error_string(BN_str_functs[0].error) == NULL) {
diff --git a/crypto/bn/bn_exp.c b/crypto/bn/bn_exp.c
index 88f2baf0e5..5eb8d7986b 100644
--- a/crypto/bn/bn_exp.c
+++ b/crypto/bn/bn_exp.c
@@ -38,7 +38,7 @@ extern unsigned int OPENSSL_sparcv9cap_P[];
 #define TABLE_SIZE      32
 
 /* this one works - simple but works */
-int BN_exp(BIGNUM *r, const BIGNUM *a, const BIGNUM *p, BN_CTX *ctx)
+int __cdecl BN_exp(BIGNUM *r, const BIGNUM *a, const BIGNUM *p, BN_CTX *ctx)
 {
     int i, bits, ret = 0;
     BIGNUM *v, *rr;
@@ -86,7 +86,7 @@ int BN_exp(BIGNUM *r, const BIGNUM *a, const BIGNUM *p, BN_CTX *ctx)
     return ret;
 }
 
-int BN_mod_exp(BIGNUM *r, const BIGNUM *a, const BIGNUM *p, const BIGNUM *m,
+int __cdecl BN_mod_exp(BIGNUM *r, const BIGNUM *a, const BIGNUM *p, const BIGNUM *m,
                BN_CTX *ctx)
 {
     int ret;
@@ -158,7 +158,7 @@ int BN_mod_exp(BIGNUM *r, const BIGNUM *a, const BIGNUM *p, const BIGNUM *m,
     return ret;
 }
 
-int BN_mod_exp_recp(BIGNUM *r, const BIGNUM *a, const BIGNUM *p,
+int __cdecl BN_mod_exp_recp(BIGNUM *r, const BIGNUM *a, const BIGNUM *p,
                     const BIGNUM *m, BN_CTX *ctx)
 {
     int i, j, bits, ret = 0, wstart, wend, window, wvalue;
@@ -293,7 +293,7 @@ int BN_mod_exp_recp(BIGNUM *r, const BIGNUM *a, const BIGNUM *p,
     return ret;
 }
 
-int BN_mod_exp_mont(BIGNUM *rr, const BIGNUM *a, const BIGNUM *p,
+int __cdecl BN_mod_exp_mont(BIGNUM *rr, const BIGNUM *a, const BIGNUM *p,
                     const BIGNUM *m, BN_CTX *ctx, BN_MONT_CTX *in_mont)
 {
     int i, j, bits, ret = 0, wstart, wend, window, wvalue;
@@ -589,7 +589,7 @@ static int MOD_EXP_CTIME_COPY_FROM_PREBUF(BIGNUM *b, int top,
  * out by Colin Percival,
  * http://www.daemonology.net/hyperthreading-considered-harmful/)
  */
-int BN_mod_exp_mont_consttime(BIGNUM *rr, const BIGNUM *a, const BIGNUM *p,
+int __cdecl BN_mod_exp_mont_consttime(BIGNUM *rr, const BIGNUM *a, const BIGNUM *p,
                               const BIGNUM *m, BN_CTX *ctx,
                               BN_MONT_CTX *in_mont)
 {
@@ -1126,7 +1126,7 @@ int BN_mod_exp_mont_consttime(BIGNUM *rr, const BIGNUM *a, const BIGNUM *p,
     return ret;
 }
 
-int BN_mod_exp_mont_word(BIGNUM *rr, BN_ULONG a, const BIGNUM *p,
+int __cdecl BN_mod_exp_mont_word(BIGNUM *rr, BN_ULONG a, const BIGNUM *p,
                          const BIGNUM *m, BN_CTX *ctx, BN_MONT_CTX *in_mont)
 {
     BN_MONT_CTX *mont = NULL;
@@ -1274,7 +1274,7 @@ int BN_mod_exp_mont_word(BIGNUM *rr, BN_ULONG a, const BIGNUM *p,
 }
 
 /* The old fallback, simple version :-) */
-int BN_mod_exp_simple(BIGNUM *r, const BIGNUM *a, const BIGNUM *p,
+int __cdecl BN_mod_exp_simple(BIGNUM *r, const BIGNUM *a, const BIGNUM *p,
                       const BIGNUM *m, BN_CTX *ctx)
 {
     int i, j, bits, ret = 0, wstart, wend, window, wvalue;
diff --git a/crypto/bn/bn_exp2.c b/crypto/bn/bn_exp2.c
index 082c9286a0..6f0b1766e3 100644
--- a/crypto/bn/bn_exp2.c
+++ b/crypto/bn/bn_exp2.c
@@ -13,7 +13,7 @@
 
 #define TABLE_SIZE      32
 
-int BN_mod_exp2_mont(BIGNUM *rr, const BIGNUM *a1, const BIGNUM *p1,
+int __cdecl BN_mod_exp2_mont(BIGNUM *rr, const BIGNUM *a1, const BIGNUM *p1,
                      const BIGNUM *a2, const BIGNUM *p2, const BIGNUM *m,
                      BN_CTX *ctx, BN_MONT_CTX *in_mont)
 {
diff --git a/crypto/bn/bn_gcd.c b/crypto/bn/bn_gcd.c
index 0091ea4e08..e1a17257cf 100644
--- a/crypto/bn/bn_gcd.c
+++ b/crypto/bn/bn_gcd.c
@@ -12,7 +12,7 @@
 
 static BIGNUM *euclid(BIGNUM *a, BIGNUM *b);
 
-int BN_gcd(BIGNUM *r, const BIGNUM *in_a, const BIGNUM *in_b, BN_CTX *ctx)
+int __cdecl BN_gcd(BIGNUM *r, const BIGNUM *in_a, const BIGNUM *in_b, BN_CTX *ctx)
 {
     BIGNUM *a, *b, *t;
     int ret = 0;
@@ -121,7 +121,7 @@ static BIGNUM *BN_mod_inverse_no_branch(BIGNUM *in,
                                         const BIGNUM *a, const BIGNUM *n,
                                         BN_CTX *ctx);
 
-BIGNUM *BN_mod_inverse(BIGNUM *in,
+BIGNUM * __cdecl BN_mod_inverse(BIGNUM *in,
                        const BIGNUM *a, const BIGNUM *n, BN_CTX *ctx)
 {
     BIGNUM *rv;
diff --git a/crypto/bn/bn_gf2m.c b/crypto/bn/bn_gf2m.c
index 34d8b69c1e..e91d7f61f2 100644
--- a/crypto/bn/bn_gf2m.c
+++ b/crypto/bn/bn_gf2m.c
@@ -249,7 +249,7 @@ void bn_GF2m_mul_2x2(BN_ULONG *r, BN_ULONG a1, BN_ULONG a0, BN_ULONG b1,
  * Add polynomials a and b and store result in r; r could be a or b, a and b
  * could be equal; r is the bitwise XOR of a and b.
  */
-int BN_GF2m_add(BIGNUM *r, const BIGNUM *a, const BIGNUM *b)
+int __cdecl BN_GF2m_add(BIGNUM *r, const BIGNUM *a, const BIGNUM *b)
 {
     int i;
     const BIGNUM *at, *bt;
@@ -289,7 +289,7 @@ int BN_GF2m_add(BIGNUM *r, const BIGNUM *a, const BIGNUM *b)
  */
 
 /* Performs modular reduction of a and store result in r.  r could be a. */
-int BN_GF2m_mod_arr(BIGNUM *r, const BIGNUM *a, const int p[])
+int __cdecl BN_GF2m_mod_arr(BIGNUM *r, const BIGNUM *a, const int p[])
 {
     int j, k;
     int n, dN, d0, d1;
@@ -387,7 +387,7 @@ int BN_GF2m_mod_arr(BIGNUM *r, const BIGNUM *a, const int p[])
  * function is only provided for convenience; for best performance, use the
  * BN_GF2m_mod_arr function.
  */
-int BN_GF2m_mod(BIGNUM *r, const BIGNUM *a, const BIGNUM *p)
+int __cdecl BN_GF2m_mod(BIGNUM *r, const BIGNUM *a, const BIGNUM *p)
 {
     int ret = 0;
     int arr[6];
@@ -407,7 +407,7 @@ int BN_GF2m_mod(BIGNUM *r, const BIGNUM *a, const BIGNUM *p)
  * Compute the product of two polynomials a and b, reduce modulo p, and store
  * the result in r.  r could be a or b; a could be b.
  */
-int BN_GF2m_mod_mul_arr(BIGNUM *r, const BIGNUM *a, const BIGNUM *b,
+int __cdecl BN_GF2m_mod_mul_arr(BIGNUM *r, const BIGNUM *a, const BIGNUM *b,
                         const int p[], BN_CTX *ctx)
 {
     int zlen, i, j, k, ret = 0;
@@ -462,7 +462,7 @@ int BN_GF2m_mod_mul_arr(BIGNUM *r, const BIGNUM *a, const BIGNUM *b,
  * only provided for convenience; for best performance, use the
  * BN_GF2m_mod_mul_arr function.
  */
-int BN_GF2m_mod_mul(BIGNUM *r, const BIGNUM *a, const BIGNUM *b,
+int __cdecl BN_GF2m_mod_mul(BIGNUM *r, const BIGNUM *a, const BIGNUM *b,
                     const BIGNUM *p, BN_CTX *ctx)
 {
     int ret = 0;
@@ -486,7 +486,7 @@ int BN_GF2m_mod_mul(BIGNUM *r, const BIGNUM *a, const BIGNUM *b,
 }
 
 /* Square a, reduce the result mod p, and store it in a.  r could be a. */
-int BN_GF2m_mod_sqr_arr(BIGNUM *r, const BIGNUM *a, const int p[],
+int __cdecl BN_GF2m_mod_sqr_arr(BIGNUM *r, const BIGNUM *a, const int p[],
                         BN_CTX *ctx)
 {
     int i, ret = 0;
@@ -521,7 +521,7 @@ int BN_GF2m_mod_sqr_arr(BIGNUM *r, const BIGNUM *a, const int p[],
  * wrapper function is only provided for convenience; for best performance,
  * use the BN_GF2m_mod_sqr_arr function.
  */
-int BN_GF2m_mod_sqr(BIGNUM *r, const BIGNUM *a, const BIGNUM *p, BN_CTX *ctx)
+int __cdecl BN_GF2m_mod_sqr(BIGNUM *r, const BIGNUM *a, const BIGNUM *p, BN_CTX *ctx)
 {
     int ret = 0;
     const int max = BN_num_bits(p) + 1;
@@ -721,7 +721,7 @@ static int BN_GF2m_mod_inv_vartime(BIGNUM *r, const BIGNUM *a,
  * This is not constant time.
  * But it does eliminate first order deduction on the input.
  */
-int BN_GF2m_mod_inv(BIGNUM *r, const BIGNUM *a, const BIGNUM *p, BN_CTX *ctx)
+int __cdecl BN_GF2m_mod_inv(BIGNUM *r, const BIGNUM *a, const BIGNUM *p, BN_CTX *ctx)
 {
     BIGNUM *b = NULL;
     int ret = 0;
@@ -762,7 +762,7 @@ int BN_GF2m_mod_inv(BIGNUM *r, const BIGNUM *a, const BIGNUM *p, BN_CTX *ctx)
  * wrapper function is only provided for convenience; for best performance,
  * use the BN_GF2m_mod_inv function.
  */
-int BN_GF2m_mod_inv_arr(BIGNUM *r, const BIGNUM *xx, const int p[],
+int __cdecl BN_GF2m_mod_inv_arr(BIGNUM *r, const BIGNUM *xx, const int p[],
                         BN_CTX *ctx)
 {
     BIGNUM *field;
@@ -787,7 +787,7 @@ int BN_GF2m_mod_inv_arr(BIGNUM *r, const BIGNUM *xx, const int p[],
  * Divide y by x, reduce modulo p, and store the result in r. r could be x
  * or y, x could equal y.
  */
-int BN_GF2m_mod_div(BIGNUM *r, const BIGNUM *y, const BIGNUM *x,
+int __cdecl BN_GF2m_mod_div(BIGNUM *r, const BIGNUM *y, const BIGNUM *x,
                     const BIGNUM *p, BN_CTX *ctx)
 {
     BIGNUM *xinv = NULL;
@@ -820,7 +820,7 @@ int BN_GF2m_mod_div(BIGNUM *r, const BIGNUM *y, const BIGNUM *x,
  * BN_GF2m_mod_div implementation; this wrapper function is only provided for
  * convenience; for best performance, use the BN_GF2m_mod_div function.
  */
-int BN_GF2m_mod_div_arr(BIGNUM *r, const BIGNUM *yy, const BIGNUM *xx,
+int __cdecl BN_GF2m_mod_div_arr(BIGNUM *r, const BIGNUM *yy, const BIGNUM *xx,
                         const int p[], BN_CTX *ctx)
 {
     BIGNUM *field;
@@ -848,7 +848,7 @@ int BN_GF2m_mod_div_arr(BIGNUM *r, const BIGNUM *yy, const BIGNUM *xx,
  * could be a. Uses simple square-and-multiply algorithm A.5.1 from IEEE
  * P1363.
  */
-int BN_GF2m_mod_exp_arr(BIGNUM *r, const BIGNUM *a, const BIGNUM *b,
+int __cdecl BN_GF2m_mod_exp_arr(BIGNUM *r, const BIGNUM *a, const BIGNUM *b,
                         const int p[], BN_CTX *ctx)
 {
     int ret = 0, i, n;
@@ -894,7 +894,7 @@ int BN_GF2m_mod_exp_arr(BIGNUM *r, const BIGNUM *a, const BIGNUM *b,
  * implementation; this wrapper function is only provided for convenience;
  * for best performance, use the BN_GF2m_mod_exp_arr function.
  */
-int BN_GF2m_mod_exp(BIGNUM *r, const BIGNUM *a, const BIGNUM *b,
+int __cdecl BN_GF2m_mod_exp(BIGNUM *r, const BIGNUM *a, const BIGNUM *b,
                     const BIGNUM *p, BN_CTX *ctx)
 {
     int ret = 0;
@@ -921,7 +921,7 @@ int BN_GF2m_mod_exp(BIGNUM *r, const BIGNUM *a, const BIGNUM *b,
  * Compute the square root of a, reduce modulo p, and store the result in r.
  * r could be a. Uses exponentiation as in algorithm A.4.1 from IEEE P1363.
  */
-int BN_GF2m_mod_sqrt_arr(BIGNUM *r, const BIGNUM *a, const int p[],
+int __cdecl BN_GF2m_mod_sqrt_arr(BIGNUM *r, const BIGNUM *a, const int p[],
                          BN_CTX *ctx)
 {
     int ret = 0;
@@ -955,7 +955,7 @@ int BN_GF2m_mod_sqrt_arr(BIGNUM *r, const BIGNUM *a, const int p[],
  * implementation; this wrapper function is only provided for convenience;
  * for best performance, use the BN_GF2m_mod_sqrt_arr function.
  */
-int BN_GF2m_mod_sqrt(BIGNUM *r, const BIGNUM *a, const BIGNUM *p, BN_CTX *ctx)
+int __cdecl BN_GF2m_mod_sqrt(BIGNUM *r, const BIGNUM *a, const BIGNUM *p, BN_CTX *ctx)
 {
     int ret = 0;
     const int max = BN_num_bits(p) + 1;
@@ -980,7 +980,7 @@ int BN_GF2m_mod_sqrt(BIGNUM *r, const BIGNUM *a, const BIGNUM *p, BN_CTX *ctx)
  * Find r such that r^2 + r = a mod p.  r could be a. If no r exists returns
  * 0. Uses algorithms A.4.7 and A.4.6 from IEEE P1363.
  */
-int BN_GF2m_mod_solve_quad_arr(BIGNUM *r, const BIGNUM *a_, const int p[],
+int __cdecl BN_GF2m_mod_solve_quad_arr(BIGNUM *r, const BIGNUM *a_, const int p[],
                                BN_CTX *ctx)
 {
     int ret = 0, count = 0, j;
@@ -1084,7 +1084,7 @@ int BN_GF2m_mod_solve_quad_arr(BIGNUM *r, const BIGNUM *a_, const int p[],
  * implementation; this wrapper function is only provided for convenience;
  * for best performance, use the BN_GF2m_mod_solve_quad_arr function.
  */
-int BN_GF2m_mod_solve_quad(BIGNUM *r, const BIGNUM *a, const BIGNUM *p,
+int __cdecl BN_GF2m_mod_solve_quad(BIGNUM *r, const BIGNUM *a, const BIGNUM *p,
                            BN_CTX *ctx)
 {
     int ret = 0;
@@ -1113,7 +1113,7 @@ int BN_GF2m_mod_solve_quad(BIGNUM *r, const BIGNUM *a, const BIGNUM *p,
  * will be filled.  Return value is total number of array elements that would
  * be filled if array was large enough.
  */
-int BN_GF2m_poly2arr(const BIGNUM *a, int p[], int max)
+int __cdecl BN_GF2m_poly2arr(const BIGNUM *a, int p[], int max)
 {
     int i, j, k = 0;
     BN_ULONG mask;
@@ -1148,7 +1148,7 @@ int BN_GF2m_poly2arr(const BIGNUM *a, int p[], int max)
  * Convert the coefficient array representation of a polynomial to a
  * bit-string.  The array must be terminated by -1.
  */
-int BN_GF2m_arr2poly(const int p[], BIGNUM *a)
+int __cdecl BN_GF2m_arr2poly(const int p[], BIGNUM *a)
 {
     int i;
 
diff --git a/crypto/bn/bn_kron.c b/crypto/bn/bn_kron.c
index b9bc6cca27..b32009b2aa 100644
--- a/crypto/bn/bn_kron.c
+++ b/crypto/bn/bn_kron.c
@@ -14,7 +14,7 @@
 #define BN_lsw(n) (((n)->top == 0) ? (BN_ULONG) 0 : (n)->d[0])
 
 /* Returns -2 for errors because both -1 and 0 are valid results. */
-int BN_kronecker(const BIGNUM *a, const BIGNUM *b, BN_CTX *ctx)
+int __cdecl BN_kronecker(const BIGNUM *a, const BIGNUM *b, BN_CTX *ctx)
 {
     int i;
     int ret = -2;               /* avoid 'uninitialized' warning */
diff --git a/crypto/bn/bn_lib.c b/crypto/bn/bn_lib.c
index 254069ff38..9a56fb44fe 100644
--- a/crypto/bn/bn_lib.c
+++ b/crypto/bn/bn_lib.c
@@ -78,7 +78,7 @@ int BN_get_params(int which)
 }
 #endif
 
-const BIGNUM *BN_value_one(void)
+const BIGNUM * __cdecl BN_value_one(void)
 {
     static const BN_ULONG data_one = 1L;
     static const BIGNUM const_one =
@@ -87,7 +87,7 @@ const BIGNUM *BN_value_one(void)
     return &const_one;
 }
 
-int BN_num_bits_word(BN_ULONG l)
+int __cdecl BN_num_bits_word(BN_ULONG l)
 {
     BN_ULONG x, mask;
     int bits = (l != 0);
@@ -162,7 +162,7 @@ int bn_num_bits_consttime(const BIGNUM *a)
     return ret & mask;
 }
 
-int BN_num_bits(const BIGNUM *a)
+int __cdecl BN_num_bits(const BIGNUM *a)
 {
     int i = a->top - 1;
     bn_check_top(a);
@@ -197,7 +197,7 @@ static void bn_free_d(BIGNUM *a, int clear)
 }
 
 
-void BN_clear_free(BIGNUM *a)
+void __cdecl BN_clear_free(BIGNUM *a)
 {
     if (a == NULL)
         return;
@@ -209,7 +209,7 @@ void BN_clear_free(BIGNUM *a)
     }
 }
 
-void BN_free(BIGNUM *a)
+void __cdecl BN_free(BIGNUM *a)
 {
     if (a == NULL)
         return;
@@ -227,7 +227,7 @@ void bn_init(BIGNUM *a)
     bn_check_top(a);
 }
 
-BIGNUM *BN_new(void)
+BIGNUM * __cdecl BN_new(void)
 {
     BIGNUM *ret;
 
@@ -240,7 +240,7 @@ BIGNUM *BN_new(void)
     return ret;
 }
 
- BIGNUM *BN_secure_new(void)
+ BIGNUM * __cdecl BN_secure_new(void)
  {
      BIGNUM *ret = BN_new();
      if (ret != NULL)
@@ -301,7 +301,7 @@ BIGNUM *bn_expand2(BIGNUM *b, int words)
     return b;
 }
 
-BIGNUM *BN_dup(const BIGNUM *a)
+BIGNUM * __cdecl BN_dup(const BIGNUM *a)
 {
     BIGNUM *t;
 
@@ -320,7 +320,7 @@ BIGNUM *BN_dup(const BIGNUM *a)
     return t;
 }
 
-BIGNUM *BN_copy(BIGNUM *a, const BIGNUM *b)
+BIGNUM * __cdecl BN_copy(BIGNUM *a, const BIGNUM *b)
 {
     bn_check_top(b);
 
@@ -345,7 +345,7 @@ BIGNUM *BN_copy(BIGNUM *a, const BIGNUM *b)
                                     | BN_FLG_FIXED_TOP))
 #define FLAGS_STRUCT(flags) ((flags) & (BN_FLG_MALLOCED))
 
-void BN_swap(BIGNUM *a, BIGNUM *b)
+void __cdecl BN_swap(BIGNUM *a, BIGNUM *b)
 {
     int flags_old_a, flags_old_b;
     BN_ULONG *tmp_d;
@@ -378,7 +378,7 @@ void BN_swap(BIGNUM *a, BIGNUM *b)
     bn_check_top(b);
 }
 
-void BN_clear(BIGNUM *a)
+void __cdecl BN_clear(BIGNUM *a)
 {
     if (a == NULL)
         return;
@@ -390,7 +390,7 @@ void BN_clear(BIGNUM *a)
     a->flags &= ~BN_FLG_FIXED_TOP;
 }
 
-BN_ULONG BN_get_word(const BIGNUM *a)
+BN_ULONG __cdecl BN_get_word(const BIGNUM *a)
 {
     if (a->top > 1)
         return BN_MASK2;
@@ -400,7 +400,7 @@ BN_ULONG BN_get_word(const BIGNUM *a)
     return 0;
 }
 
-int BN_set_word(BIGNUM *a, BN_ULONG w)
+int __cdecl BN_set_word(BIGNUM *a, BN_ULONG w)
 {
     bn_check_top(a);
     if (bn_expand(a, (int)sizeof(BN_ULONG) * 8) == NULL)
@@ -413,7 +413,7 @@ int BN_set_word(BIGNUM *a, BN_ULONG w)
     return 1;
 }
 
-BIGNUM *BN_bin2bn(const unsigned char *s, int len, BIGNUM *ret)
+BIGNUM * __cdecl BN_bin2bn(const unsigned char *s, int len, BIGNUM *ret)
 {
     unsigned int i, m;
     unsigned int n;
@@ -511,19 +511,19 @@ int bn2binpad(const BIGNUM *a, unsigned char *to, int tolen, endianess_t endiane
     return tolen;
 }
 
-int BN_bn2binpad(const BIGNUM *a, unsigned char *to, int tolen)
+int __cdecl BN_bn2binpad(const BIGNUM *a, unsigned char *to, int tolen)
 {
     if (tolen < 0)
         return -1;
     return bn2binpad(a, to, tolen, big);
 }
 
-int BN_bn2bin(const BIGNUM *a, unsigned char *to)
+int __cdecl BN_bn2bin(const BIGNUM *a, unsigned char *to)
 {
     return bn2binpad(a, to, -1, big);
 }
 
-BIGNUM *BN_lebin2bn(const unsigned char *s, int len, BIGNUM *ret)
+BIGNUM * __cdecl BN_lebin2bn(const unsigned char *s, int len, BIGNUM *ret)
 {
     unsigned int i, m;
     unsigned int n;
@@ -570,14 +570,14 @@ BIGNUM *BN_lebin2bn(const unsigned char *s, int len, BIGNUM *ret)
     return ret;
 }
 
-int BN_bn2lebinpad(const BIGNUM *a, unsigned char *to, int tolen)
+int __cdecl BN_bn2lebinpad(const BIGNUM *a, unsigned char *to, int tolen)
 {
     if (tolen < 0)
         return -1;
     return bn2binpad(a, to, tolen, little);
 }
 
-int BN_ucmp(const BIGNUM *a, const BIGNUM *b)
+int __cdecl BN_ucmp(const BIGNUM *a, const BIGNUM *b)
 {
     int i;
     BN_ULONG t1, t2, *ap, *bp;
@@ -599,7 +599,7 @@ int BN_ucmp(const BIGNUM *a, const BIGNUM *b)
     return 0;
 }
 
-int BN_cmp(const BIGNUM *a, const BIGNUM *b)
+int __cdecl BN_cmp(const BIGNUM *a, const BIGNUM *b)
 {
     int i;
     int gt, lt;
@@ -646,7 +646,7 @@ int BN_cmp(const BIGNUM *a, const BIGNUM *b)
     return 0;
 }
 
-int BN_set_bit(BIGNUM *a, int n)
+int __cdecl BN_set_bit(BIGNUM *a, int n)
 {
     int i, j, k;
 
@@ -669,7 +669,7 @@ int BN_set_bit(BIGNUM *a, int n)
     return 1;
 }
 
-int BN_clear_bit(BIGNUM *a, int n)
+int __cdecl BN_clear_bit(BIGNUM *a, int n)
 {
     int i, j;
 
@@ -687,7 +687,7 @@ int BN_clear_bit(BIGNUM *a, int n)
     return 1;
 }
 
-int BN_is_bit_set(const BIGNUM *a, int n)
+int __cdecl BN_is_bit_set(const BIGNUM *a, int n)
 {
     int i, j;
 
@@ -701,7 +701,7 @@ int BN_is_bit_set(const BIGNUM *a, int n)
     return (int)(((a->d[i]) >> j) & ((BN_ULONG)1));
 }
 
-int BN_mask_bits(BIGNUM *a, int n)
+int __cdecl BN_mask_bits(BIGNUM *a, int n)
 {
     int b, w;
 
@@ -723,7 +723,7 @@ int BN_mask_bits(BIGNUM *a, int n)
     return 1;
 }
 
-void BN_set_negative(BIGNUM *a, int b)
+void __cdecl BN_set_negative(BIGNUM *a, int b)
 {
     if (b && !BN_is_zero(a))
         a->neg = 1;
@@ -788,7 +788,7 @@ int bn_cmp_part_words(const BN_ULONG *a, const BN_ULONG *b, int cl, int dl)
  * Assumes that at least nwords are allocated in both a and b.
  * Assumes that no more than nwords are used by either a or b.
  */
-void BN_consttime_swap(BN_ULONG condition, BIGNUM *a, BIGNUM *b, int nwords)
+void __cdecl BN_consttime_swap(BN_ULONG condition, BIGNUM *a, BIGNUM *b, int nwords)
 {
     BN_ULONG t;
     int i;
@@ -849,7 +849,7 @@ void BN_consttime_swap(BN_ULONG condition, BIGNUM *a, BIGNUM *b, int nwords)
 
 /* Bits of security, see SP800-57 */
 
-int BN_security_bits(int L, int N)
+int __cdecl BN_security_bits(int L, int N)
 {
     int secbits, bits;
     if (L >= 15360)
@@ -872,50 +872,50 @@ int BN_security_bits(int L, int N)
     return bits >= secbits ? secbits : bits;
 }
 
-void BN_zero_ex(BIGNUM *a)
+void __cdecl BN_zero_ex(BIGNUM *a)
 {
     a->neg = 0;
     a->top = 0;
     a->flags &= ~BN_FLG_FIXED_TOP;
 }
 
-int BN_abs_is_word(const BIGNUM *a, const BN_ULONG w)
+int __cdecl BN_abs_is_word(const BIGNUM *a, const BN_ULONG w)
 {
     return ((a->top == 1) && (a->d[0] == w)) || ((w == 0) && (a->top == 0));
 }
 
-int BN_is_zero(const BIGNUM *a)
+int __cdecl BN_is_zero(const BIGNUM *a)
 {
     return a->top == 0;
 }
 
-int BN_is_one(const BIGNUM *a)
+int __cdecl BN_is_one(const BIGNUM *a)
 {
     return BN_abs_is_word(a, 1) && !a->neg;
 }
 
-int BN_is_word(const BIGNUM *a, const BN_ULONG w)
+int __cdecl BN_is_word(const BIGNUM *a, const BN_ULONG w)
 {
     return BN_abs_is_word(a, w) && (!w || !a->neg);
 }
 
-int BN_is_odd(const BIGNUM *a)
+int __cdecl BN_is_odd(const BIGNUM *a)
 {
     return (a->top > 0) && (a->d[0] & 1);
 }
 
-int BN_is_negative(const BIGNUM *a)
+int __cdecl BN_is_negative(const BIGNUM *a)
 {
     return (a->neg != 0);
 }
 
-int BN_to_montgomery(BIGNUM *r, const BIGNUM *a, BN_MONT_CTX *mont,
+int __cdecl BN_to_montgomery(BIGNUM *r, const BIGNUM *a, BN_MONT_CTX *mont,
                      BN_CTX *ctx)
 {
     return BN_mod_mul_montgomery(r, a, &(mont->RR), mont, ctx);
 }
 
-void BN_with_flags(BIGNUM *dest, const BIGNUM *b, int flags)
+void __cdecl BN_with_flags(BIGNUM *dest, const BIGNUM *b, int flags)
 {
     dest->d = b->d;
     dest->top = b->top;
@@ -926,7 +926,7 @@ void BN_with_flags(BIGNUM *dest, const BIGNUM *b, int flags)
                    | BN_FLG_STATIC_DATA | flags);
 }
 
-BN_GENCB *BN_GENCB_new(void)
+BN_GENCB * __cdecl BN_GENCB_new(void)
 {
     BN_GENCB *ret;
 
@@ -938,25 +938,25 @@ BN_GENCB *BN_GENCB_new(void)
     return ret;
 }
 
-void BN_GENCB_free(BN_GENCB *cb)
+void __cdecl BN_GENCB_free(BN_GENCB *cb)
 {
     if (cb == NULL)
         return;
     OPENSSL_free(cb);
 }
 
-void BN_set_flags(BIGNUM *b, int n)
+void __cdecl BN_set_flags(BIGNUM *b, int n)
 {
     b->flags |= n;
 }
 
-int BN_get_flags(const BIGNUM *b, int n)
+int __cdecl BN_get_flags(const BIGNUM *b, int n)
 {
     return b->flags & n;
 }
 
 /* Populate a BN_GENCB structure with an "old"-style callback */
-void BN_GENCB_set_old(BN_GENCB *gencb, void (*callback) (int, int, void *),
+void __cdecl BN_GENCB_set_old(BN_GENCB *gencb, void (*callback) (int, int, void *),
                       void *cb_arg)
 {
     BN_GENCB *tmp_gencb = gencb;
@@ -966,7 +966,7 @@ void BN_GENCB_set_old(BN_GENCB *gencb, void (*callback) (int, int, void *),
 }
 
 /* Populate a BN_GENCB structure with a "new"-style callback */
-void BN_GENCB_set(BN_GENCB *gencb, int (*callback) (int, int, BN_GENCB *),
+void __cdecl BN_GENCB_set(BN_GENCB *gencb, int (*callback) (int, int, BN_GENCB *),
                   void *cb_arg)
 {
     BN_GENCB *tmp_gencb = gencb;
@@ -975,7 +975,7 @@ void BN_GENCB_set(BN_GENCB *gencb, int (*callback) (int, int, BN_GENCB *),
     tmp_gencb->cb.cb_2 = callback;
 }
 
-void *BN_GENCB_get_arg(BN_GENCB *cb)
+void * __cdecl BN_GENCB_get_arg(BN_GENCB *cb)
 {
     return cb->arg;
 }
diff --git a/crypto/bn/bn_mod.c b/crypto/bn/bn_mod.c
index 712fc8ac14..74f692d527 100644
--- a/crypto/bn/bn_mod.c
+++ b/crypto/bn/bn_mod.c
@@ -10,7 +10,7 @@
 #include "internal/cryptlib.h"
 #include "bn_lcl.h"
 
-int BN_nnmod(BIGNUM *r, const BIGNUM *m, const BIGNUM *d, BN_CTX *ctx)
+int __cdecl BN_nnmod(BIGNUM *r, const BIGNUM *m, const BIGNUM *d, BN_CTX *ctx)
 {
     /*
      * like BN_mod, but returns non-negative remainder (i.e., 0 <= r < |d|
@@ -25,7 +25,7 @@ int BN_nnmod(BIGNUM *r, const BIGNUM *m, const BIGNUM *d, BN_CTX *ctx)
     return (d->neg ? BN_sub : BN_add) (r, r, d);
 }
 
-int BN_mod_add(BIGNUM *r, const BIGNUM *a, const BIGNUM *b, const BIGNUM *m,
+int __cdecl BN_mod_add(BIGNUM *r, const BIGNUM *a, const BIGNUM *b, const BIGNUM *m,
                BN_CTX *ctx)
 {
     if (!BN_add(r, a, b))
@@ -92,7 +92,7 @@ int bn_mod_add_fixed_top(BIGNUM *r, const BIGNUM *a, const BIGNUM *b,
     return 1;
 }
 
-int BN_mod_add_quick(BIGNUM *r, const BIGNUM *a, const BIGNUM *b,
+int __cdecl BN_mod_add_quick(BIGNUM *r, const BIGNUM *a, const BIGNUM *b,
                      const BIGNUM *m)
 {
     int ret = bn_mod_add_fixed_top(r, a, b, m);
@@ -103,7 +103,7 @@ int BN_mod_add_quick(BIGNUM *r, const BIGNUM *a, const BIGNUM *b,
     return ret;
 }
 
-int BN_mod_sub(BIGNUM *r, const BIGNUM *a, const BIGNUM *b, const BIGNUM *m,
+int __cdecl BN_mod_sub(BIGNUM *r, const BIGNUM *a, const BIGNUM *b, const BIGNUM *m,
                BN_CTX *ctx)
 {
     if (!BN_sub(r, a, b))
@@ -179,7 +179,7 @@ int bn_mod_sub_fixed_top(BIGNUM *r, const BIGNUM *a, const BIGNUM *b,
  * BN_mod_sub variant that may be used if both a and b are non-negative and
  * less than m
  */
-int BN_mod_sub_quick(BIGNUM *r, const BIGNUM *a, const BIGNUM *b,
+int __cdecl BN_mod_sub_quick(BIGNUM *r, const BIGNUM *a, const BIGNUM *b,
                      const BIGNUM *m)
 {
     if (!BN_sub(r, a, b))
@@ -190,7 +190,7 @@ int BN_mod_sub_quick(BIGNUM *r, const BIGNUM *a, const BIGNUM *b,
 }
 
 /* slow but works */
-int BN_mod_mul(BIGNUM *r, const BIGNUM *a, const BIGNUM *b, const BIGNUM *m,
+int __cdecl BN_mod_mul(BIGNUM *r, const BIGNUM *a, const BIGNUM *b, const BIGNUM *m,
                BN_CTX *ctx)
 {
     BIGNUM *t;
@@ -219,7 +219,7 @@ int BN_mod_mul(BIGNUM *r, const BIGNUM *a, const BIGNUM *b, const BIGNUM *m,
     return ret;
 }
 
-int BN_mod_sqr(BIGNUM *r, const BIGNUM *a, const BIGNUM *m, BN_CTX *ctx)
+int __cdecl BN_mod_sqr(BIGNUM *r, const BIGNUM *a, const BIGNUM *m, BN_CTX *ctx)
 {
     if (!BN_sqr(r, a, ctx))
         return 0;
@@ -227,7 +227,7 @@ int BN_mod_sqr(BIGNUM *r, const BIGNUM *a, const BIGNUM *m, BN_CTX *ctx)
     return BN_mod(r, r, m, ctx);
 }
 
-int BN_mod_lshift1(BIGNUM *r, const BIGNUM *a, const BIGNUM *m, BN_CTX *ctx)
+int __cdecl BN_mod_lshift1(BIGNUM *r, const BIGNUM *a, const BIGNUM *m, BN_CTX *ctx)
 {
     if (!BN_lshift1(r, a))
         return 0;
@@ -239,7 +239,7 @@ int BN_mod_lshift1(BIGNUM *r, const BIGNUM *a, const BIGNUM *m, BN_CTX *ctx)
  * BN_mod_lshift1 variant that may be used if a is non-negative and less than
  * m
  */
-int BN_mod_lshift1_quick(BIGNUM *r, const BIGNUM *a, const BIGNUM *m)
+int __cdecl BN_mod_lshift1_quick(BIGNUM *r, const BIGNUM *a, const BIGNUM *m)
 {
     if (!BN_lshift1(r, a))
         return 0;
@@ -249,7 +249,7 @@ int BN_mod_lshift1_quick(BIGNUM *r, const BIGNUM *a, const BIGNUM *m)
     return 1;
 }
 
-int BN_mod_lshift(BIGNUM *r, const BIGNUM *a, int n, const BIGNUM *m,
+int __cdecl BN_mod_lshift(BIGNUM *r, const BIGNUM *a, int n, const BIGNUM *m,
                   BN_CTX *ctx)
 {
     BIGNUM *abs_m = NULL;
@@ -276,7 +276,7 @@ int BN_mod_lshift(BIGNUM *r, const BIGNUM *a, int n, const BIGNUM *m,
  * BN_mod_lshift variant that may be used if a is non-negative and less than
  * m
  */
-int BN_mod_lshift_quick(BIGNUM *r, const BIGNUM *a, int n, const BIGNUM *m)
+int __cdecl BN_mod_lshift_quick(BIGNUM *r, const BIGNUM *a, int n, const BIGNUM *m)
 {
     if (r != a) {
         if (BN_copy(r, a) == NULL)
diff --git a/crypto/bn/bn_mont.c b/crypto/bn/bn_mont.c
index 393d27c392..e7866176bb 100644
--- a/crypto/bn/bn_mont.c
+++ b/crypto/bn/bn_mont.c
@@ -23,7 +23,7 @@
 static int bn_from_montgomery_word(BIGNUM *ret, BIGNUM *r, BN_MONT_CTX *mont);
 #endif
 
-int BN_mod_mul_montgomery(BIGNUM *r, const BIGNUM *a, const BIGNUM *b,
+int __cdecl BN_mod_mul_montgomery(BIGNUM *r, const BIGNUM *a, const BIGNUM *b,
                           BN_MONT_CTX *mont, BN_CTX *ctx)
 {
     int ret = bn_mul_mont_fixed_top(r, a, b, mont, ctx);
@@ -159,7 +159,7 @@ static int bn_from_montgomery_word(BIGNUM *ret, BIGNUM *r, BN_MONT_CTX *mont)
 }
 #endif                          /* MONT_WORD */
 
-int BN_from_montgomery(BIGNUM *ret, const BIGNUM *a, BN_MONT_CTX *mont,
+int __cdecl BN_from_montgomery(BIGNUM *ret, const BIGNUM *a, BN_MONT_CTX *mont,
                        BN_CTX *ctx)
 {
     int retn;
@@ -225,7 +225,7 @@ int bn_to_mont_fixed_top(BIGNUM *r, const BIGNUM *a, BN_MONT_CTX *mont,
     return bn_mul_mont_fixed_top(r, a, &(mont->RR), mont, ctx);
 }
 
-BN_MONT_CTX *BN_MONT_CTX_new(void)
+BN_MONT_CTX * __cdecl BN_MONT_CTX_new(void)
 {
     BN_MONT_CTX *ret;
 
@@ -249,7 +249,7 @@ void BN_MONT_CTX_init(BN_MONT_CTX *ctx)
     ctx->flags = 0;
 }
 
-void BN_MONT_CTX_free(BN_MONT_CTX *mont)
+void __cdecl BN_MONT_CTX_free(BN_MONT_CTX *mont)
 {
     if (mont == NULL)
         return;
@@ -260,7 +260,7 @@ void BN_MONT_CTX_free(BN_MONT_CTX *mont)
         OPENSSL_free(mont);
 }
 
-int BN_MONT_CTX_set(BN_MONT_CTX *mont, const BIGNUM *mod, BN_CTX *ctx)
+int __cdecl BN_MONT_CTX_set(BN_MONT_CTX *mont, const BIGNUM *mod, BN_CTX *ctx)
 {
     int i, ret = 0;
     BIGNUM *Ri, *R;
@@ -408,7 +408,7 @@ int BN_MONT_CTX_set(BN_MONT_CTX *mont, const BIGNUM *mod, BN_CTX *ctx)
     return ret;
 }
 
-BN_MONT_CTX *BN_MONT_CTX_copy(BN_MONT_CTX *to, BN_MONT_CTX *from)
+BN_MONT_CTX * __cdecl BN_MONT_CTX_copy(BN_MONT_CTX *to, BN_MONT_CTX *from)
 {
     if (to == from)
         return to;
@@ -425,7 +425,7 @@ BN_MONT_CTX *BN_MONT_CTX_copy(BN_MONT_CTX *to, BN_MONT_CTX *from)
     return to;
 }
 
-BN_MONT_CTX *BN_MONT_CTX_set_locked(BN_MONT_CTX **pmont, CRYPTO_RWLOCK *lock,
+BN_MONT_CTX * __cdecl BN_MONT_CTX_set_locked(BN_MONT_CTX **pmont, CRYPTO_RWLOCK *lock,
                                     const BIGNUM *mod, BN_CTX *ctx)
 {
     BN_MONT_CTX *ret;
diff --git a/crypto/bn/bn_mpi.c b/crypto/bn/bn_mpi.c
index 043e21d26a..335e9ff56a 100644
--- a/crypto/bn/bn_mpi.c
+++ b/crypto/bn/bn_mpi.c
@@ -11,7 +11,7 @@
 #include "internal/cryptlib.h"
 #include "bn_lcl.h"
 
-int BN_bn2mpi(const BIGNUM *a, unsigned char *d)
+int __cdecl BN_bn2mpi(const BIGNUM *a, unsigned char *d)
 {
     int bits;
     int num = 0;
@@ -39,7 +39,7 @@ int BN_bn2mpi(const BIGNUM *a, unsigned char *d)
     return (num + 4 + ext);
 }
 
-BIGNUM *BN_mpi2bn(const unsigned char *d, int n, BIGNUM *ain)
+BIGNUM * __cdecl BN_mpi2bn(const unsigned char *d, int n, BIGNUM *ain)
 {
     long len;
     int neg = 0;
diff --git a/crypto/bn/bn_mul.c b/crypto/bn/bn_mul.c
index 5eda65cfbb..fb9c4345cb 100644
--- a/crypto/bn/bn_mul.c
+++ b/crypto/bn/bn_mul.c
@@ -494,7 +494,7 @@ void bn_mul_low_recursive(BN_ULONG *r, BN_ULONG *a, BN_ULONG *b, int n2,
 }
 #endif                          /* BN_RECURSION */
 
-int BN_mul(BIGNUM *r, const BIGNUM *a, const BIGNUM *b, BN_CTX *ctx)
+int __cdecl BN_mul(BIGNUM *r, const BIGNUM *a, const BIGNUM *b, BN_CTX *ctx)
 {
     int ret = bn_mul_fixed_top(r, a, b, ctx);
 
diff --git a/crypto/bn/bn_nist.c b/crypto/bn/bn_nist.c
index dcdd321c66..ad94535001 100644
--- a/crypto/bn/bn_nist.c
+++ b/crypto/bn/bn_nist.c
@@ -224,27 +224,27 @@ static const BIGNUM _bignum_nist_p_521 = {
     BN_FLG_STATIC_DATA
 };
 
-const BIGNUM *BN_get0_nist_prime_192(void)
+const BIGNUM * __cdecl BN_get0_nist_prime_192(void)
 {
     return &_bignum_nist_p_192;
 }
 
-const BIGNUM *BN_get0_nist_prime_224(void)
+const BIGNUM * __cdecl BN_get0_nist_prime_224(void)
 {
     return &_bignum_nist_p_224;
 }
 
-const BIGNUM *BN_get0_nist_prime_256(void)
+const BIGNUM * __cdecl BN_get0_nist_prime_256(void)
 {
     return &_bignum_nist_p_256;
 }
 
-const BIGNUM *BN_get0_nist_prime_384(void)
+const BIGNUM * __cdecl BN_get0_nist_prime_384(void)
 {
     return &_bignum_nist_p_384;
 }
 
-const BIGNUM *BN_get0_nist_prime_521(void)
+const BIGNUM * __cdecl BN_get0_nist_prime_521(void)
 {
     return &_bignum_nist_p_521;
 }
@@ -315,7 +315,7 @@ static void nist_cp_bn(BN_ULONG *dst, const BN_ULONG *src, int top)
         bn_cp_64(to, 2, from, (a1) - 3) \
         }
 
-int BN_nist_mod_192(BIGNUM *r, const BIGNUM *a, const BIGNUM *field,
+int __cdecl BN_nist_mod_192(BIGNUM *r, const BIGNUM *a, const BIGNUM *field,
                     BN_CTX *ctx)
 {
     int top = a->top, i;
@@ -456,7 +456,7 @@ typedef BN_ULONG (*bn_addsub_f) (BN_ULONG *, const BN_ULONG *,
         bn_cp_32(to, 6, from, (a1) - 7) \
         }
 
-int BN_nist_mod_224(BIGNUM *r, const BIGNUM *a, const BIGNUM *field,
+int __cdecl BN_nist_mod_224(BIGNUM *r, const BIGNUM *a, const BIGNUM *field,
                     BN_CTX *ctx)
 {
     int top = a->top, i;
@@ -637,7 +637,7 @@ int BN_nist_mod_224(BIGNUM *r, const BIGNUM *a, const BIGNUM *field,
         bn_cp_32(to, 7, from, (a1) - 8) \
         }
 
-int BN_nist_mod_256(BIGNUM *r, const BIGNUM *a, const BIGNUM *field,
+int __cdecl BN_nist_mod_256(BIGNUM *r, const BIGNUM *a, const BIGNUM *field,
                     BN_CTX *ctx)
 {
     int i, top = a->top;
@@ -883,7 +883,7 @@ int BN_nist_mod_256(BIGNUM *r, const BIGNUM *a, const BIGNUM *field,
         bn_cp_32(to, 11, from, (a1) - 12)  \
         }
 
-int BN_nist_mod_384(BIGNUM *r, const BIGNUM *a, const BIGNUM *field,
+int __cdecl BN_nist_mod_384(BIGNUM *r, const BIGNUM *a, const BIGNUM *field,
                     BN_CTX *ctx)
 {
     int i, top = a->top;
@@ -1152,7 +1152,7 @@ int BN_nist_mod_384(BIGNUM *r, const BIGNUM *a, const BIGNUM *field,
 #define BN_NIST_521_LSHIFT      (BN_BITS2-BN_NIST_521_RSHIFT)
 #define BN_NIST_521_TOP_MASK    ((BN_ULONG)BN_MASK2>>BN_NIST_521_LSHIFT)
 
-int BN_nist_mod_521(BIGNUM *r, const BIGNUM *a, const BIGNUM *field,
+int __cdecl BN_nist_mod_521(BIGNUM *r, const BIGNUM *a, const BIGNUM *field,
                     BN_CTX *ctx)
 {
     int top = a->top, i;
@@ -1223,7 +1223,7 @@ int BN_nist_mod_521(BIGNUM *r, const BIGNUM *a, const BIGNUM *field,
     return 1;
 }
 
-int (*BN_nist_mod_func(const BIGNUM *p)) (BIGNUM *r, const BIGNUM *a,
+int (__cdecl *BN_nist_mod_func(const BIGNUM *p)) (BIGNUM *r, const BIGNUM *a,
                                           const BIGNUM *field, BN_CTX *ctx) {
     if (BN_ucmp(&_bignum_nist_p_192, p) == 0)
         return BN_nist_mod_192;
diff --git a/crypto/bn/bn_prime.c b/crypto/bn/bn_prime.c
index 19b081f38e..860112b30c 100644
--- a/crypto/bn/bn_prime.c
+++ b/crypto/bn/bn_prime.c
@@ -27,7 +27,7 @@ static int probable_prime_dh_safe(BIGNUM *rnd, int bits,
                                   const BIGNUM *add, const BIGNUM *rem,
                                   BN_CTX *ctx);
 
-int BN_GENCB_call(BN_GENCB *cb, int a, int b)
+int __cdecl BN_GENCB_call(BN_GENCB *cb, int a, int b)
 {
     /* No callback means continue */
     if (!cb)
@@ -49,7 +49,7 @@ int BN_GENCB_call(BN_GENCB *cb, int a, int b)
     return 0;
 }
 
-int BN_generate_prime_ex(BIGNUM *ret, int bits, int safe,
+int __cdecl BN_generate_prime_ex(BIGNUM *ret, int bits, int safe,
                          const BIGNUM *add, const BIGNUM *rem, BN_GENCB *cb)
 {
     BIGNUM *t;
@@ -145,13 +145,13 @@ int BN_generate_prime_ex(BIGNUM *ret, int bits, int safe,
     return found;
 }
 
-int BN_is_prime_ex(const BIGNUM *a, int checks, BN_CTX *ctx_passed,
+int __cdecl BN_is_prime_ex(const BIGNUM *a, int checks, BN_CTX *ctx_passed,
                    BN_GENCB *cb)
 {
     return BN_is_prime_fasttest_ex(a, checks, ctx_passed, 0, cb);
 }
 
-int BN_is_prime_fasttest_ex(const BIGNUM *a, int checks, BN_CTX *ctx_passed,
+int __cdecl BN_is_prime_fasttest_ex(const BIGNUM *a, int checks, BN_CTX *ctx_passed,
                             int do_trial_division, BN_GENCB *cb)
 {
     int i, j, ret = -1;
diff --git a/crypto/bn/bn_print.c b/crypto/bn/bn_print.c
index 1853269d90..62ac640cca 100644
--- a/crypto/bn/bn_print.c
+++ b/crypto/bn/bn_print.c
@@ -17,7 +17,7 @@
 static const char Hex[] = "0123456789ABCDEF";
 
 /* Must 'OPENSSL_free' the returned data */
-char *BN_bn2hex(const BIGNUM *a)
+char * __cdecl BN_bn2hex(const BIGNUM *a)
 {
     int i, j, v, z = 0;
     char *buf;
@@ -50,7 +50,7 @@ char *BN_bn2hex(const BIGNUM *a)
 }
 
 /* Must 'OPENSSL_free' the returned data */
-char *BN_bn2dec(const BIGNUM *a)
+char * __cdecl BN_bn2dec(const BIGNUM *a)
 {
     int i = 0, num, ok = 0, n, tbytes;
     char *buf = NULL;
@@ -123,7 +123,7 @@ char *BN_bn2dec(const BIGNUM *a)
     return NULL;
 }
 
-int BN_hex2bn(BIGNUM **bn, const char *a)
+int __cdecl BN_hex2bn(BIGNUM **bn, const char *a)
 {
     BIGNUM *ret = NULL;
     BN_ULONG l = 0;
@@ -196,7 +196,7 @@ int BN_hex2bn(BIGNUM **bn, const char *a)
     return 0;
 }
 
-int BN_dec2bn(BIGNUM **bn, const char *a)
+int __cdecl BN_dec2bn(BIGNUM **bn, const char *a)
 {
     BIGNUM *ret = NULL;
     BN_ULONG l = 0;
@@ -266,7 +266,7 @@ int BN_dec2bn(BIGNUM **bn, const char *a)
     return 0;
 }
 
-int BN_asc2bn(BIGNUM **bn, const char *a)
+int __cdecl BN_asc2bn(BIGNUM **bn, const char *a)
 {
     const char *p = a;
 
@@ -287,7 +287,7 @@ int BN_asc2bn(BIGNUM **bn, const char *a)
 }
 
 # ifndef OPENSSL_NO_STDIO
-int BN_print_fp(FILE *fp, const BIGNUM *a)
+int __cdecl BN_print_fp(FILE *fp, const BIGNUM *a)
 {
     BIO *b;
     int ret;
@@ -301,7 +301,7 @@ int BN_print_fp(FILE *fp, const BIGNUM *a)
 }
 # endif
 
-int BN_print(BIO *bp, const BIGNUM *a)
+int __cdecl BN_print(BIO *bp, const BIGNUM *a)
 {
     int i, j, v, z = 0;
     int ret = 0;
@@ -326,7 +326,7 @@ int BN_print(BIO *bp, const BIGNUM *a)
     return ret;
 }
 
-char *BN_options(void)
+char * __cdecl BN_options(void)
 {
     static int init = 0;
     static char data[16];
diff --git a/crypto/bn/bn_rand.c b/crypto/bn/bn_rand.c
index 051f29e343..e43a405cb9 100644
--- a/crypto/bn/bn_rand.c
+++ b/crypto/bn/bn_rand.c
@@ -94,17 +94,17 @@ toosmall:
     return 0;
 }
 
-int BN_rand(BIGNUM *rnd, int bits, int top, int bottom)
+int __cdecl BN_rand(BIGNUM *rnd, int bits, int top, int bottom)
 {
     return bnrand(NORMAL, rnd, bits, top, bottom);
 }
 
-int BN_bntest_rand(BIGNUM *rnd, int bits, int top, int bottom)
+int __cdecl BN_bntest_rand(BIGNUM *rnd, int bits, int top, int bottom)
 {
     return bnrand(TESTING, rnd, bits, top, bottom);
 }
 
-int BN_priv_rand(BIGNUM *rnd, int bits, int top, int bottom)
+int __cdecl BN_priv_rand(BIGNUM *rnd, int bits, int top, int bottom)
 {
     return bnrand(PRIVATE, rnd, bits, top, bottom);
 }
@@ -174,22 +174,22 @@ static int bnrand_range(BNRAND_FLAG flag, BIGNUM *r, const BIGNUM *range)
     return 1;
 }
 
-int BN_rand_range(BIGNUM *r, const BIGNUM *range)
+int __cdecl BN_rand_range(BIGNUM *r, const BIGNUM *range)
 {
     return bnrand_range(NORMAL, r, range);
 }
 
-int BN_priv_rand_range(BIGNUM *r, const BIGNUM *range)
+int __cdecl BN_priv_rand_range(BIGNUM *r, const BIGNUM *range)
 {
     return bnrand_range(PRIVATE, r, range);
 }
 
-int BN_pseudo_rand(BIGNUM *rnd, int bits, int top, int bottom)
+int __cdecl BN_pseudo_rand(BIGNUM *rnd, int bits, int top, int bottom)
 {
     return BN_rand(rnd, bits, top, bottom);
 }
 
-int BN_pseudo_rand_range(BIGNUM *r, const BIGNUM *range)
+int __cdecl BN_pseudo_rand_range(BIGNUM *r, const BIGNUM *range)
 {
     return BN_rand_range(r, range);
 }
@@ -202,7 +202,7 @@ int BN_pseudo_rand_range(BIGNUM *r, const BIGNUM *range)
  * weakness leads directly to private key exposure unless this function is
  * used.
  */
-int BN_generate_dsa_nonce(BIGNUM *out, const BIGNUM *range,
+int __cdecl BN_generate_dsa_nonce(BIGNUM *out, const BIGNUM *range,
                           const BIGNUM *priv, const unsigned char *message,
                           size_t message_len, BN_CTX *ctx)
 {
diff --git a/crypto/bn/bn_recp.c b/crypto/bn/bn_recp.c
index 9ab767f42f..a2110af2c5 100644
--- a/crypto/bn/bn_recp.c
+++ b/crypto/bn/bn_recp.c
@@ -17,7 +17,7 @@ void BN_RECP_CTX_init(BN_RECP_CTX *recp)
     bn_init(&(recp->Nr));
 }
 
-BN_RECP_CTX *BN_RECP_CTX_new(void)
+BN_RECP_CTX * __cdecl BN_RECP_CTX_new(void)
 {
     BN_RECP_CTX *ret;
 
@@ -32,7 +32,7 @@ BN_RECP_CTX *BN_RECP_CTX_new(void)
     return ret;
 }
 
-void BN_RECP_CTX_free(BN_RECP_CTX *recp)
+void __cdecl BN_RECP_CTX_free(BN_RECP_CTX *recp)
 {
     if (recp == NULL)
         return;
@@ -42,7 +42,7 @@ void BN_RECP_CTX_free(BN_RECP_CTX *recp)
         OPENSSL_free(recp);
 }
 
-int BN_RECP_CTX_set(BN_RECP_CTX *recp, const BIGNUM *d, BN_CTX *ctx)
+int __cdecl BN_RECP_CTX_set(BN_RECP_CTX *recp, const BIGNUM *d, BN_CTX *ctx)
 {
     if (!BN_copy(&(recp->N), d))
         return 0;
@@ -52,7 +52,7 @@ int BN_RECP_CTX_set(BN_RECP_CTX *recp, const BIGNUM *d, BN_CTX *ctx)
     return 1;
 }
 
-int BN_mod_mul_reciprocal(BIGNUM *r, const BIGNUM *x, const BIGNUM *y,
+int __cdecl BN_mod_mul_reciprocal(BIGNUM *r, const BIGNUM *x, const BIGNUM *y,
                           BN_RECP_CTX *recp, BN_CTX *ctx)
 {
     int ret = 0;
@@ -81,7 +81,7 @@ int BN_mod_mul_reciprocal(BIGNUM *r, const BIGNUM *x, const BIGNUM *y,
     return ret;
 }
 
-int BN_div_recp(BIGNUM *dv, BIGNUM *rem, const BIGNUM *m,
+int __cdecl BN_div_recp(BIGNUM *dv, BIGNUM *rem, const BIGNUM *m,
                 BN_RECP_CTX *recp, BN_CTX *ctx)
 {
     int i, j, ret = 0;
@@ -171,7 +171,7 @@ int BN_div_recp(BIGNUM *dv, BIGNUM *rem, const BIGNUM *m,
  * required.
  */
 /* r := 2^len / m */
-int BN_reciprocal(BIGNUM *r, const BIGNUM *m, int len, BN_CTX *ctx)
+int __cdecl BN_reciprocal(BIGNUM *r, const BIGNUM *m, int len, BN_CTX *ctx)
 {
     int ret = -1;
     BIGNUM *t;
diff --git a/crypto/bn/bn_shift.c b/crypto/bn/bn_shift.c
index b7a1e0ff9a..4276529583 100644
--- a/crypto/bn/bn_shift.c
+++ b/crypto/bn/bn_shift.c
@@ -11,7 +11,7 @@
 #include "internal/cryptlib.h"
 #include "bn_lcl.h"
 
-int BN_lshift1(BIGNUM *r, const BIGNUM *a)
+int __cdecl BN_lshift1(BIGNUM *r, const BIGNUM *a)
 {
     register BN_ULONG *ap, *rp, t, c;
     int i;
@@ -44,7 +44,7 @@ int BN_lshift1(BIGNUM *r, const BIGNUM *a)
     return 1;
 }
 
-int BN_rshift1(BIGNUM *r, const BIGNUM *a)
+int __cdecl BN_rshift1(BIGNUM *r, const BIGNUM *a)
 {
     BN_ULONG *ap, *rp, t, c;
     int i, j;
@@ -81,7 +81,7 @@ int BN_rshift1(BIGNUM *r, const BIGNUM *a)
     return 1;
 }
 
-int BN_lshift(BIGNUM *r, const BIGNUM *a, int n)
+int __cdecl BN_lshift(BIGNUM *r, const BIGNUM *a, int n)
 {
     int ret;
 
@@ -150,7 +150,7 @@ int bn_lshift_fixed_top(BIGNUM *r, const BIGNUM *a, int n)
     return 1;
 }
 
-int BN_rshift(BIGNUM *r, const BIGNUM *a, int n)
+int __cdecl BN_rshift(BIGNUM *r, const BIGNUM *a, int n)
 {
     int i, j, nw, lb, rb;
     BN_ULONG *t, *f;
diff --git a/crypto/bn/bn_sqr.c b/crypto/bn/bn_sqr.c
index 0c0a590f0c..01acfc0a46 100644
--- a/crypto/bn/bn_sqr.c
+++ b/crypto/bn/bn_sqr.c
@@ -14,7 +14,7 @@
 /*
  * I've just gone over this and it is now %20 faster on x86 - eay - 27 Jun 96
  */
-int BN_sqr(BIGNUM *r, const BIGNUM *a, BN_CTX *ctx)
+int __cdecl BN_sqr(BIGNUM *r, const BIGNUM *a, BN_CTX *ctx)
 {
     int ret = bn_sqr_fixed_top(r, a, ctx);
 
diff --git a/crypto/bn/bn_sqrt.c b/crypto/bn/bn_sqrt.c
index c3e66b033b..67b8c2e9bc 100644
--- a/crypto/bn/bn_sqrt.c
+++ b/crypto/bn/bn_sqrt.c
@@ -10,7 +10,7 @@
 #include "internal/cryptlib.h"
 #include "bn_lcl.h"
 
-BIGNUM *BN_mod_sqrt(BIGNUM *in, const BIGNUM *a, const BIGNUM *p, BN_CTX *ctx)
+BIGNUM * __cdecl BN_mod_sqrt(BIGNUM *in, const BIGNUM *a, const BIGNUM *p, BN_CTX *ctx)
 /*
  * Returns 'ret' such that ret^2 == a (mod p), using the Tonelli/Shanks
  * algorithm (cf. Henri Cohen, "A Course in Algebraic Computational Number
diff --git a/crypto/bn/bn_word.c b/crypto/bn/bn_word.c
index 262d7668fc..5a69b23337 100644
--- a/crypto/bn/bn_word.c
+++ b/crypto/bn/bn_word.c
@@ -10,7 +10,7 @@
 #include "internal/cryptlib.h"
 #include "bn_lcl.h"
 
-BN_ULONG BN_mod_word(const BIGNUM *a, BN_ULONG w)
+BN_ULONG __cdecl BN_mod_word(const BIGNUM *a, BN_ULONG w)
 {
 #ifndef BN_LLONG
     BN_ULONG ret = 0;
@@ -58,7 +58,7 @@ BN_ULONG BN_mod_word(const BIGNUM *a, BN_ULONG w)
     return (BN_ULONG)ret;
 }
 
-BN_ULONG BN_div_word(BIGNUM *a, BN_ULONG w)
+BN_ULONG __cdecl BN_div_word(BIGNUM *a, BN_ULONG w)
 {
     BN_ULONG ret = 0;
     int i, j;
@@ -95,7 +95,7 @@ BN_ULONG BN_div_word(BIGNUM *a, BN_ULONG w)
     return ret;
 }
 
-int BN_add_word(BIGNUM *a, BN_ULONG w)
+int __cdecl BN_add_word(BIGNUM *a, BN_ULONG w)
 {
     BN_ULONG l;
     int i;
@@ -131,7 +131,7 @@ int BN_add_word(BIGNUM *a, BN_ULONG w)
     return 1;
 }
 
-int BN_sub_word(BIGNUM *a, BN_ULONG w)
+int __cdecl BN_sub_word(BIGNUM *a, BN_ULONG w)
 {
     int i;
 
@@ -178,7 +178,7 @@ int BN_sub_word(BIGNUM *a, BN_ULONG w)
     return 1;
 }
 
-int BN_mul_word(BIGNUM *a, BN_ULONG w)
+int __cdecl BN_mul_word(BIGNUM *a, BN_ULONG w)
 {
     BN_ULONG ll;
 
diff --git a/crypto/bn/bn_x931p.c b/crypto/bn/bn_x931p.c
index 9eb8384fde..1f909079bf 100644
--- a/crypto/bn/bn_x931p.c
+++ b/crypto/bn/bn_x931p.c
@@ -48,7 +48,7 @@ static int bn_x931_derive_pi(BIGNUM *pi, const BIGNUM *Xpi, BN_CTX *ctx,
  * will be returned too: this is needed for testing.
  */
 
-int BN_X931_derive_prime_ex(BIGNUM *p, BIGNUM *p1, BIGNUM *p2,
+int __cdecl BN_X931_derive_prime_ex(BIGNUM *p, BIGNUM *p1, BIGNUM *p2,
                             const BIGNUM *Xp, const BIGNUM *Xp1,
                             const BIGNUM *Xp2, const BIGNUM *e, BN_CTX *ctx,
                             BN_GENCB *cb)
@@ -157,7 +157,7 @@ int BN_X931_derive_prime_ex(BIGNUM *p, BIGNUM *p1, BIGNUM *p2,
  * parameter is sum of number of bits in both.
  */
 
-int BN_X931_generate_Xpq(BIGNUM *Xp, BIGNUM *Xq, int nbits, BN_CTX *ctx)
+int __cdecl BN_X931_generate_Xpq(BIGNUM *Xp, BIGNUM *Xq, int nbits, BN_CTX *ctx)
 {
     BIGNUM *t;
     int i;
@@ -212,7 +212,7 @@ int BN_X931_generate_Xpq(BIGNUM *Xp, BIGNUM *Xq, int nbits, BN_CTX *ctx)
  * previous function and supplied as input.
  */
 
-int BN_X931_generate_prime_ex(BIGNUM *p, BIGNUM *p1, BIGNUM *p2,
+int __cdecl BN_X931_generate_prime_ex(BIGNUM *p, BIGNUM *p1, BIGNUM *p2,
                               BIGNUM *Xp1, BIGNUM *Xp2,
                               const BIGNUM *Xp,
                               const BIGNUM *e, BN_CTX *ctx, BN_GENCB *cb)
diff --git a/crypto/buffer/buf_err.c b/crypto/buffer/buf_err.c
index 7e6e53226a..7980b60764 100644
--- a/crypto/buffer/buf_err.c
+++ b/crypto/buffer/buf_err.c
@@ -26,7 +26,7 @@ static const ERR_STRING_DATA BUF_str_reasons[] = {
 
 #endif
 
-int ERR_load_BUF_strings(void)
+int __cdecl ERR_load_BUF_strings(void)
 {
 #ifndef OPENSSL_NO_ERR
     if (ERR_func_error_string(BUF_str_functs[0].error) == NULL) {
diff --git a/crypto/buffer/buffer.c b/crypto/buffer/buffer.c
index 72258abb9e..d22c318e90 100644
--- a/crypto/buffer/buffer.c
+++ b/crypto/buffer/buffer.c
@@ -18,7 +18,7 @@
  */
 #define LIMIT_BEFORE_EXPANSION 0x5ffffffc
 
-BUF_MEM *BUF_MEM_new_ex(unsigned long flags)
+BUF_MEM * __cdecl BUF_MEM_new_ex(unsigned long flags)
 {
     BUF_MEM *ret;
 
@@ -28,7 +28,7 @@ BUF_MEM *BUF_MEM_new_ex(unsigned long flags)
     return ret;
 }
 
-BUF_MEM *BUF_MEM_new(void)
+BUF_MEM * __cdecl BUF_MEM_new(void)
 {
     BUF_MEM *ret;
 
@@ -40,7 +40,7 @@ BUF_MEM *BUF_MEM_new(void)
     return ret;
 }
 
-void BUF_MEM_free(BUF_MEM *a)
+void __cdecl BUF_MEM_free(BUF_MEM *a)
 {
     if (a == NULL)
         return;
@@ -70,7 +70,7 @@ static char *sec_alloc_realloc(BUF_MEM *str, size_t len)
     return ret;
 }
 
-size_t BUF_MEM_grow(BUF_MEM *str, size_t len)
+size_t __cdecl BUF_MEM_grow(BUF_MEM *str, size_t len)
 {
     char *ret;
     size_t n;
@@ -107,7 +107,7 @@ size_t BUF_MEM_grow(BUF_MEM *str, size_t len)
     return len;
 }
 
-size_t BUF_MEM_grow_clean(BUF_MEM *str, size_t len)
+size_t __cdecl BUF_MEM_grow_clean(BUF_MEM *str, size_t len)
 {
     char *ret;
     size_t n;
@@ -145,7 +145,7 @@ size_t BUF_MEM_grow_clean(BUF_MEM *str, size_t len)
     return len;
 }
 
-void BUF_reverse(unsigned char *out, const unsigned char *in, size_t size)
+void __cdecl BUF_reverse(unsigned char *out, const unsigned char *in, size_t size)
 {
     size_t i;
     if (in) {
diff --git a/crypto/camellia/cmll_cbc.c b/crypto/camellia/cmll_cbc.c
index b19171ded2..fb26318666 100644
--- a/crypto/camellia/cmll_cbc.c
+++ b/crypto/camellia/cmll_cbc.c
@@ -10,7 +10,7 @@
 #include <openssl/camellia.h>
 #include <openssl/modes.h>
 
-void Camellia_cbc_encrypt(const unsigned char *in, unsigned char *out,
+void __cdecl Camellia_cbc_encrypt(const unsigned char *in, unsigned char *out,
                           size_t len, const CAMELLIA_KEY *key,
                           unsigned char *ivec, const int enc)
 {
diff --git a/crypto/camellia/cmll_cfb.c b/crypto/camellia/cmll_cfb.c
index 4f49eaded6..cdc2301048 100644
--- a/crypto/camellia/cmll_cfb.c
+++ b/crypto/camellia/cmll_cfb.c
@@ -16,7 +16,7 @@
  * used is contained in *num;
  */
 
-void Camellia_cfb128_encrypt(const unsigned char *in, unsigned char *out,
+void __cdecl Camellia_cfb128_encrypt(const unsigned char *in, unsigned char *out,
                              size_t length, const CAMELLIA_KEY *key,
                              unsigned char *ivec, int *num, const int enc)
 {
@@ -26,7 +26,7 @@ void Camellia_cfb128_encrypt(const unsigned char *in, unsigned char *out,
 }
 
 /* N.B. This expects the input to be packed, MS bit first */
-void Camellia_cfb1_encrypt(const unsigned char *in, unsigned char *out,
+void __cdecl Camellia_cfb1_encrypt(const unsigned char *in, unsigned char *out,
                            size_t length, const CAMELLIA_KEY *key,
                            unsigned char *ivec, int *num, const int enc)
 {
@@ -34,7 +34,7 @@ void Camellia_cfb1_encrypt(const unsigned char *in, unsigned char *out,
                             (block128_f) Camellia_encrypt);
 }
 
-void Camellia_cfb8_encrypt(const unsigned char *in, unsigned char *out,
+void __cdecl Camellia_cfb8_encrypt(const unsigned char *in, unsigned char *out,
                            size_t length, const CAMELLIA_KEY *key,
                            unsigned char *ivec, int *num, const int enc)
 {
diff --git a/crypto/camellia/cmll_ctr.c b/crypto/camellia/cmll_ctr.c
index 161d1e18c1..22d866e810 100644
--- a/crypto/camellia/cmll_ctr.c
+++ b/crypto/camellia/cmll_ctr.c
@@ -10,7 +10,7 @@
 #include <openssl/camellia.h>
 #include <openssl/modes.h>
 
-void Camellia_ctr128_encrypt(const unsigned char *in, unsigned char *out,
+void __cdecl Camellia_ctr128_encrypt(const unsigned char *in, unsigned char *out,
                              size_t length, const CAMELLIA_KEY *key,
                              unsigned char ivec[CAMELLIA_BLOCK_SIZE],
                              unsigned char ecount_buf[CAMELLIA_BLOCK_SIZE],
diff --git a/crypto/camellia/cmll_ecb.c b/crypto/camellia/cmll_ecb.c
index d932f1b375..e45cf04902 100644
--- a/crypto/camellia/cmll_ecb.c
+++ b/crypto/camellia/cmll_ecb.c
@@ -10,7 +10,7 @@
 #include <openssl/camellia.h>
 #include "cmll_locl.h"
 
-void Camellia_ecb_encrypt(const unsigned char *in, unsigned char *out,
+void __cdecl Camellia_ecb_encrypt(const unsigned char *in, unsigned char *out,
                           const CAMELLIA_KEY *key, const int enc)
 {
     if (CAMELLIA_ENCRYPT == enc)
diff --git a/crypto/camellia/cmll_misc.c b/crypto/camellia/cmll_misc.c
index e5f014b79c..4179aec6b5 100644
--- a/crypto/camellia/cmll_misc.c
+++ b/crypto/camellia/cmll_misc.c
@@ -11,7 +11,7 @@
 #include <openssl/camellia.h>
 #include "cmll_locl.h"
 
-int Camellia_set_key(const unsigned char *userKey, const int bits,
+int __cdecl Camellia_set_key(const unsigned char *userKey, const int bits,
                      CAMELLIA_KEY *key)
 {
     if (!userKey || !key)
@@ -22,13 +22,13 @@ int Camellia_set_key(const unsigned char *userKey, const int bits,
     return 0;
 }
 
-void Camellia_encrypt(const unsigned char *in, unsigned char *out,
+void __cdecl Camellia_encrypt(const unsigned char *in, unsigned char *out,
                       const CAMELLIA_KEY *key)
 {
     Camellia_EncryptBlock_Rounds(key->grand_rounds, in, key->u.rd_key, out);
 }
 
-void Camellia_decrypt(const unsigned char *in, unsigned char *out,
+void __cdecl Camellia_decrypt(const unsigned char *in, unsigned char *out,
                       const CAMELLIA_KEY *key)
 {
     Camellia_DecryptBlock_Rounds(key->grand_rounds, in, key->u.rd_key, out);
diff --git a/crypto/camellia/cmll_ofb.c b/crypto/camellia/cmll_ofb.c
index b43c685c75..313e0ad165 100644
--- a/crypto/camellia/cmll_ofb.c
+++ b/crypto/camellia/cmll_ofb.c
@@ -15,7 +15,7 @@
  * The extra state information to record how much of the 128bit block we have
  * used is contained in *num;
  */
-void Camellia_ofb128_encrypt(const unsigned char *in, unsigned char *out,
+void __cdecl Camellia_ofb128_encrypt(const unsigned char *in, unsigned char *out,
                              size_t length, const CAMELLIA_KEY *key,
                              unsigned char *ivec, int *num)
 {
diff --git a/crypto/cast/c_cfb64.c b/crypto/cast/c_cfb64.c
index bd7cb2f468..1de8cafef3 100644
--- a/crypto/cast/c_cfb64.c
+++ b/crypto/cast/c_cfb64.c
@@ -16,7 +16,7 @@
  * used is contained in *num;
  */
 
-void CAST_cfb64_encrypt(const unsigned char *in, unsigned char *out,
+void __cdecl CAST_cfb64_encrypt(const unsigned char *in, unsigned char *out,
                         long length, const CAST_KEY *schedule,
                         unsigned char *ivec, int *num, int enc)
 {
diff --git a/crypto/cast/c_ecb.c b/crypto/cast/c_ecb.c
index da4179438f..35fca6cac3 100644
--- a/crypto/cast/c_ecb.c
+++ b/crypto/cast/c_ecb.c
@@ -11,7 +11,7 @@
 #include "cast_lcl.h"
 #include <openssl/opensslv.h>
 
-void CAST_ecb_encrypt(const unsigned char *in, unsigned char *out,
+void __cdecl CAST_ecb_encrypt(const unsigned char *in, unsigned char *out,
                       const CAST_KEY *ks, int enc)
 {
     CAST_LONG l, d[2];
diff --git a/crypto/cast/c_enc.c b/crypto/cast/c_enc.c
index 700b6d162a..79ef8d1d3a 100644
--- a/crypto/cast/c_enc.c
+++ b/crypto/cast/c_enc.c
@@ -10,7 +10,7 @@
 #include <openssl/cast.h>
 #include "cast_lcl.h"
 
-void CAST_encrypt(CAST_LONG *data, const CAST_KEY *key)
+void __cdecl CAST_encrypt(CAST_LONG *data, const CAST_KEY *key)
 {
     CAST_LONG l, r, t;
     const CAST_LONG *k;
@@ -42,7 +42,7 @@ void CAST_encrypt(CAST_LONG *data, const CAST_KEY *key)
     data[0] = r & 0xffffffffL;
 }
 
-void CAST_decrypt(CAST_LONG *data, const CAST_KEY *key)
+void __cdecl CAST_decrypt(CAST_LONG *data, const CAST_KEY *key)
 {
     CAST_LONG l, r, t;
     const CAST_LONG *k;
@@ -74,7 +74,7 @@ void CAST_decrypt(CAST_LONG *data, const CAST_KEY *key)
     data[0] = r & 0xffffffffL;
 }
 
-void CAST_cbc_encrypt(const unsigned char *in, unsigned char *out,
+void __cdecl CAST_cbc_encrypt(const unsigned char *in, unsigned char *out,
                       long length, const CAST_KEY *ks, unsigned char *iv,
                       int enc)
 {
diff --git a/crypto/cast/c_ofb64.c b/crypto/cast/c_ofb64.c
index dffb074762..5633b76659 100644
--- a/crypto/cast/c_ofb64.c
+++ b/crypto/cast/c_ofb64.c
@@ -15,7 +15,7 @@
  * The extra state information to record how much of the 64bit block we have
  * used is contained in *num;
  */
-void CAST_ofb64_encrypt(const unsigned char *in, unsigned char *out,
+void __cdecl CAST_ofb64_encrypt(const unsigned char *in, unsigned char *out,
                         long length, const CAST_KEY *schedule,
                         unsigned char *ivec, int *num)
 {
diff --git a/crypto/cast/c_skey.c b/crypto/cast/c_skey.c
index 962d2a60b4..16aa1b085e 100644
--- a/crypto/cast/c_skey.c
+++ b/crypto/cast/c_skey.c
@@ -23,7 +23,7 @@
 #define S6 CAST_S_table6
 #define S7 CAST_S_table7
 
-void CAST_set_key(CAST_KEY *key, int len, const unsigned char *data)
+void __cdecl CAST_set_key(CAST_KEY *key, int len, const unsigned char *data)
 {
     CAST_LONG x[16];
     CAST_LONG z[16];
diff --git a/crypto/cmac/cmac.c b/crypto/cmac/cmac.c
index 6989c32d06..7bc58bb88d 100644
--- a/crypto/cmac/cmac.c
+++ b/crypto/cmac/cmac.c
@@ -43,7 +43,7 @@ static void make_kn(unsigned char *k1, const unsigned char *l, int bl)
     k1[i] = (c << 1) ^ ((0 - carry) & (bl == 16 ? 0x87 : 0x1b));
 }
 
-CMAC_CTX *CMAC_CTX_new(void)
+CMAC_CTX * __cdecl CMAC_CTX_new(void)
 {
     CMAC_CTX *ctx;
 
@@ -60,7 +60,7 @@ CMAC_CTX *CMAC_CTX_new(void)
     return ctx;
 }
 
-void CMAC_CTX_cleanup(CMAC_CTX *ctx)
+void __cdecl CMAC_CTX_cleanup(CMAC_CTX *ctx)
 {
     EVP_CIPHER_CTX_reset(ctx->cctx);
     OPENSSL_cleanse(ctx->tbl, EVP_MAX_BLOCK_LENGTH);
@@ -70,12 +70,12 @@ void CMAC_CTX_cleanup(CMAC_CTX *ctx)
     ctx->nlast_block = -1;
 }
 
-EVP_CIPHER_CTX *CMAC_CTX_get0_cipher_ctx(CMAC_CTX *ctx)
+EVP_CIPHER_CTX * __cdecl CMAC_CTX_get0_cipher_ctx(CMAC_CTX *ctx)
 {
     return ctx->cctx;
 }
 
-void CMAC_CTX_free(CMAC_CTX *ctx)
+void __cdecl CMAC_CTX_free(CMAC_CTX *ctx)
 {
     if (!ctx)
         return;
@@ -84,7 +84,7 @@ void CMAC_CTX_free(CMAC_CTX *ctx)
     OPENSSL_free(ctx);
 }
 
-int CMAC_CTX_copy(CMAC_CTX *out, const CMAC_CTX *in)
+int __cdecl CMAC_CTX_copy(CMAC_CTX *out, const CMAC_CTX *in)
 {
     int bl;
     if (in->nlast_block == -1)
@@ -100,7 +100,7 @@ int CMAC_CTX_copy(CMAC_CTX *out, const CMAC_CTX *in)
     return 1;
 }
 
-int CMAC_Init(CMAC_CTX *ctx, const void *key, size_t keylen,
+int __cdecl CMAC_Init(CMAC_CTX *ctx, const void *key, size_t keylen,
               const EVP_CIPHER *cipher, ENGINE *impl)
 {
     static const unsigned char zero_iv[EVP_MAX_BLOCK_LENGTH] = { 0 };
@@ -143,7 +143,7 @@ int CMAC_Init(CMAC_CTX *ctx, const void *key, size_t keylen,
     return 1;
 }
 
-int CMAC_Update(CMAC_CTX *ctx, const void *in, size_t dlen)
+int __cdecl CMAC_Update(CMAC_CTX *ctx, const void *in, size_t dlen)
 {
     const unsigned char *data = in;
     size_t bl;
@@ -183,7 +183,7 @@ int CMAC_Update(CMAC_CTX *ctx, const void *in, size_t dlen)
 
 }
 
-int CMAC_Final(CMAC_CTX *ctx, unsigned char *out, size_t *poutlen)
+int __cdecl CMAC_Final(CMAC_CTX *ctx, unsigned char *out, size_t *poutlen)
 {
     int i, bl, lb;
     if (ctx->nlast_block == -1)
@@ -211,7 +211,7 @@ int CMAC_Final(CMAC_CTX *ctx, unsigned char *out, size_t *poutlen)
     return 1;
 }
 
-int CMAC_resume(CMAC_CTX *ctx)
+int __cdecl CMAC_resume(CMAC_CTX *ctx)
 {
     if (ctx->nlast_block == -1)
         return 0;
diff --git a/crypto/cms/cms_asn1.c b/crypto/cms/cms_asn1.c
index 993ea6b219..1d42f1d800 100644
--- a/crypto/cms/cms_asn1.c
+++ b/crypto/cms/cms_asn1.c
@@ -372,7 +372,7 @@ ASN1_SEQUENCE(CMS_SharedInfo) = {
   ASN1_EXP_OPT(CMS_SharedInfo, suppPubInfo, ASN1_OCTET_STRING, 2),
 } static_ASN1_SEQUENCE_END(CMS_SharedInfo)
 
-int CMS_SharedInfo_encode(unsigned char **pder, X509_ALGOR *kekalg,
+int __cdecl CMS_SharedInfo_encode(unsigned char **pder, X509_ALGOR *kekalg,
                           ASN1_OCTET_STRING *ukm, int keylen)
 {
     union {
diff --git a/crypto/cms/cms_att.c b/crypto/cms/cms_att.c
index 0566019753..2354bf1b49 100644
--- a/crypto/cms/cms_att.c
+++ b/crypto/cms/cms_att.c
@@ -66,40 +66,40 @@ static const struct {
 
 /* CMS SignedData Attribute utilities */
 
-int CMS_signed_get_attr_count(const CMS_SignerInfo *si)
+int __cdecl CMS_signed_get_attr_count(const CMS_SignerInfo *si)
 {
     return X509at_get_attr_count(si->signedAttrs);
 }
 
-int CMS_signed_get_attr_by_NID(const CMS_SignerInfo *si, int nid, int lastpos)
+int __cdecl CMS_signed_get_attr_by_NID(const CMS_SignerInfo *si, int nid, int lastpos)
 {
     return X509at_get_attr_by_NID(si->signedAttrs, nid, lastpos);
 }
 
-int CMS_signed_get_attr_by_OBJ(const CMS_SignerInfo *si, const ASN1_OBJECT *obj,
+int __cdecl CMS_signed_get_attr_by_OBJ(const CMS_SignerInfo *si, const ASN1_OBJECT *obj,
                                int lastpos)
 {
     return X509at_get_attr_by_OBJ(si->signedAttrs, obj, lastpos);
 }
 
-X509_ATTRIBUTE *CMS_signed_get_attr(const CMS_SignerInfo *si, int loc)
+X509_ATTRIBUTE * __cdecl CMS_signed_get_attr(const CMS_SignerInfo *si, int loc)
 {
     return X509at_get_attr(si->signedAttrs, loc);
 }
 
-X509_ATTRIBUTE *CMS_signed_delete_attr(CMS_SignerInfo *si, int loc)
+X509_ATTRIBUTE * __cdecl CMS_signed_delete_attr(CMS_SignerInfo *si, int loc)
 {
     return X509at_delete_attr(si->signedAttrs, loc);
 }
 
-int CMS_signed_add1_attr(CMS_SignerInfo *si, X509_ATTRIBUTE *attr)
+int __cdecl CMS_signed_add1_attr(CMS_SignerInfo *si, X509_ATTRIBUTE *attr)
 {
     if (X509at_add1_attr(&si->signedAttrs, attr))
         return 1;
     return 0;
 }
 
-int CMS_signed_add1_attr_by_OBJ(CMS_SignerInfo *si,
+int __cdecl CMS_signed_add1_attr_by_OBJ(CMS_SignerInfo *si,
                                 const ASN1_OBJECT *obj, int type,
                                 const void *bytes, int len)
 {
@@ -108,7 +108,7 @@ int CMS_signed_add1_attr_by_OBJ(CMS_SignerInfo *si,
     return 0;
 }
 
-int CMS_signed_add1_attr_by_NID(CMS_SignerInfo *si,
+int __cdecl CMS_signed_add1_attr_by_NID(CMS_SignerInfo *si,
                                 int nid, int type, const void *bytes, int len)
 {
     if (X509at_add1_attr_by_NID(&si->signedAttrs, nid, type, bytes, len))
@@ -116,7 +116,7 @@ int CMS_signed_add1_attr_by_NID(CMS_SignerInfo *si,
     return 0;
 }
 
-int CMS_signed_add1_attr_by_txt(CMS_SignerInfo *si,
+int __cdecl CMS_signed_add1_attr_by_txt(CMS_SignerInfo *si,
                                 const char *attrname, int type,
                                 const void *bytes, int len)
 {
@@ -125,47 +125,47 @@ int CMS_signed_add1_attr_by_txt(CMS_SignerInfo *si,
     return 0;
 }
 
-void *CMS_signed_get0_data_by_OBJ(CMS_SignerInfo *si, const ASN1_OBJECT *oid,
+void * __cdecl CMS_signed_get0_data_by_OBJ(CMS_SignerInfo *si, const ASN1_OBJECT *oid,
                                   int lastpos, int type)
 {
     return X509at_get0_data_by_OBJ(si->signedAttrs, oid, lastpos, type);
 }
 
-int CMS_unsigned_get_attr_count(const CMS_SignerInfo *si)
+int __cdecl CMS_unsigned_get_attr_count(const CMS_SignerInfo *si)
 {
     return X509at_get_attr_count(si->unsignedAttrs);
 }
 
-int CMS_unsigned_get_attr_by_NID(const CMS_SignerInfo *si, int nid,
+int __cdecl CMS_unsigned_get_attr_by_NID(const CMS_SignerInfo *si, int nid,
                                  int lastpos)
 {
     return X509at_get_attr_by_NID(si->unsignedAttrs, nid, lastpos);
 }
 
-int CMS_unsigned_get_attr_by_OBJ(const CMS_SignerInfo *si,
+int __cdecl CMS_unsigned_get_attr_by_OBJ(const CMS_SignerInfo *si,
                                  const ASN1_OBJECT *obj, int lastpos)
 {
     return X509at_get_attr_by_OBJ(si->unsignedAttrs, obj, lastpos);
 }
 
-X509_ATTRIBUTE *CMS_unsigned_get_attr(const CMS_SignerInfo *si, int loc)
+X509_ATTRIBUTE * __cdecl CMS_unsigned_get_attr(const CMS_SignerInfo *si, int loc)
 {
     return X509at_get_attr(si->unsignedAttrs, loc);
 }
 
-X509_ATTRIBUTE *CMS_unsigned_delete_attr(CMS_SignerInfo *si, int loc)
+X509_ATTRIBUTE * __cdecl CMS_unsigned_delete_attr(CMS_SignerInfo *si, int loc)
 {
     return X509at_delete_attr(si->unsignedAttrs, loc);
 }
 
-int CMS_unsigned_add1_attr(CMS_SignerInfo *si, X509_ATTRIBUTE *attr)
+int __cdecl CMS_unsigned_add1_attr(CMS_SignerInfo *si, X509_ATTRIBUTE *attr)
 {
     if (X509at_add1_attr(&si->unsignedAttrs, attr))
         return 1;
     return 0;
 }
 
-int CMS_unsigned_add1_attr_by_OBJ(CMS_SignerInfo *si,
+int __cdecl CMS_unsigned_add1_attr_by_OBJ(CMS_SignerInfo *si,
                                   const ASN1_OBJECT *obj, int type,
                                   const void *bytes, int len)
 {
@@ -174,7 +174,7 @@ int CMS_unsigned_add1_attr_by_OBJ(CMS_SignerInfo *si,
     return 0;
 }
 
-int CMS_unsigned_add1_attr_by_NID(CMS_SignerInfo *si,
+int __cdecl CMS_unsigned_add1_attr_by_NID(CMS_SignerInfo *si,
                                   int nid, int type,
                                   const void *bytes, int len)
 {
@@ -183,7 +183,7 @@ int CMS_unsigned_add1_attr_by_NID(CMS_SignerInfo *si,
     return 0;
 }
 
-int CMS_unsigned_add1_attr_by_txt(CMS_SignerInfo *si,
+int __cdecl CMS_unsigned_add1_attr_by_txt(CMS_SignerInfo *si,
                                   const char *attrname, int type,
                                   const void *bytes, int len)
 {
@@ -193,7 +193,7 @@ int CMS_unsigned_add1_attr_by_txt(CMS_SignerInfo *si,
     return 0;
 }
 
-void *CMS_unsigned_get0_data_by_OBJ(CMS_SignerInfo *si, ASN1_OBJECT *oid,
+void * __cdecl CMS_unsigned_get0_data_by_OBJ(CMS_SignerInfo *si, ASN1_OBJECT *oid,
                                     int lastpos, int type)
 {
     return X509at_get0_data_by_OBJ(si->unsignedAttrs, oid, lastpos, type);
diff --git a/crypto/cms/cms_enc.c b/crypto/cms/cms_enc.c
index a1719830e8..d1f52954f7 100644
--- a/crypto/cms/cms_enc.c
+++ b/crypto/cms/cms_enc.c
@@ -180,7 +180,7 @@ int cms_EncryptedContent_init(CMS_EncryptedContentInfo *ec,
     return 1;
 }
 
-int CMS_EncryptedData_set1_key(CMS_ContentInfo *cms, const EVP_CIPHER *ciph,
+int __cdecl CMS_EncryptedData_set1_key(CMS_ContentInfo *cms, const EVP_CIPHER *ciph,
                                const unsigned char *key, size_t keylen)
 {
     CMS_EncryptedContentInfo *ec;
diff --git a/crypto/cms/cms_env.c b/crypto/cms/cms_env.c
index 26fb81f79a..b28624c111 100644
--- a/crypto/cms/cms_env.c
+++ b/crypto/cms/cms_env.c
@@ -78,7 +78,7 @@ int cms_env_asn1_ctrl(CMS_RecipientInfo *ri, int cmd)
     return 1;
 }
 
-STACK_OF(CMS_RecipientInfo) *CMS_get0_RecipientInfos(CMS_ContentInfo *cms)
+STACK_OF(CMS_RecipientInfo) * __cdecl CMS_get0_RecipientInfos(CMS_ContentInfo *cms)
 {
     CMS_EnvelopedData *env;
     env = cms_get0_enveloped(cms);
@@ -87,12 +87,12 @@ STACK_OF(CMS_RecipientInfo) *CMS_get0_RecipientInfos(CMS_ContentInfo *cms)
     return env->recipientInfos;
 }
 
-int CMS_RecipientInfo_type(CMS_RecipientInfo *ri)
+int __cdecl CMS_RecipientInfo_type(CMS_RecipientInfo *ri)
 {
     return ri->type;
 }
 
-EVP_PKEY_CTX *CMS_RecipientInfo_get0_pkey_ctx(CMS_RecipientInfo *ri)
+EVP_PKEY_CTX * __cdecl CMS_RecipientInfo_get0_pkey_ctx(CMS_RecipientInfo *ri)
 {
     if (ri->type == CMS_RECIPINFO_TRANS)
         return ri->d.ktri->pctx;
@@ -101,7 +101,7 @@ EVP_PKEY_CTX *CMS_RecipientInfo_get0_pkey_ctx(CMS_RecipientInfo *ri)
     return NULL;
 }
 
-CMS_ContentInfo *CMS_EnvelopedData_create(const EVP_CIPHER *cipher)
+CMS_ContentInfo *__cdecl CMS_EnvelopedData_create(const EVP_CIPHER *cipher)
 {
     CMS_ContentInfo *cms;
     CMS_EnvelopedData *env;
@@ -175,7 +175,7 @@ static int cms_RecipientInfo_ktri_init(CMS_RecipientInfo *ri, X509 *recip,
  * Add a recipient certificate using appropriate type of RecipientInfo
  */
 
-CMS_RecipientInfo *CMS_add1_recipient_cert(CMS_ContentInfo *cms,
+CMS_RecipientInfo * __cdecl CMS_add1_recipient_cert(CMS_ContentInfo *cms,
                                            X509 *recip, unsigned int flags)
 {
     CMS_RecipientInfo *ri = NULL;
@@ -228,7 +228,7 @@ CMS_RecipientInfo *CMS_add1_recipient_cert(CMS_ContentInfo *cms,
 
 }
 
-int CMS_RecipientInfo_ktri_get0_algs(CMS_RecipientInfo *ri,
+int __cdecl CMS_RecipientInfo_ktri_get0_algs(CMS_RecipientInfo *ri,
                                      EVP_PKEY **pk, X509 **recip,
                                      X509_ALGOR **palg)
 {
@@ -250,7 +250,7 @@ int CMS_RecipientInfo_ktri_get0_algs(CMS_RecipientInfo *ri,
     return 1;
 }
 
-int CMS_RecipientInfo_ktri_get0_signer_id(CMS_RecipientInfo *ri,
+int __cdecl CMS_RecipientInfo_ktri_get0_signer_id(CMS_RecipientInfo *ri,
                                           ASN1_OCTET_STRING **keyid,
                                           X509_NAME **issuer,
                                           ASN1_INTEGER **sno)
@@ -266,7 +266,7 @@ int CMS_RecipientInfo_ktri_get0_signer_id(CMS_RecipientInfo *ri,
     return cms_SignerIdentifier_get0_signer_id(ktri->rid, keyid, issuer, sno);
 }
 
-int CMS_RecipientInfo_ktri_cert_cmp(CMS_RecipientInfo *ri, X509 *cert)
+int __cdecl CMS_RecipientInfo_ktri_cert_cmp(CMS_RecipientInfo *ri, X509 *cert)
 {
     if (ri->type != CMS_RECIPINFO_TRANS) {
         CMSerr(CMS_F_CMS_RECIPIENTINFO_KTRI_CERT_CMP,
@@ -276,7 +276,7 @@ int CMS_RecipientInfo_ktri_cert_cmp(CMS_RecipientInfo *ri, X509 *cert)
     return cms_SignerIdentifier_cert_cmp(ri->d.ktri->rid, cert);
 }
 
-int CMS_RecipientInfo_set0_pkey(CMS_RecipientInfo *ri, EVP_PKEY *pkey)
+int __cdecl CMS_RecipientInfo_set0_pkey(CMS_RecipientInfo *ri, EVP_PKEY *pkey)
 {
     if (ri->type != CMS_RECIPINFO_TRANS) {
         CMSerr(CMS_F_CMS_RECIPIENTINFO_SET0_PKEY, CMS_R_NOT_KEY_TRANSPORT);
@@ -439,7 +439,7 @@ static int cms_RecipientInfo_ktri_decrypt(CMS_ContentInfo *cms,
 
 /* Key Encrypted Key (KEK) RecipientInfo routines */
 
-int CMS_RecipientInfo_kekri_id_cmp(CMS_RecipientInfo *ri,
+int __cdecl CMS_RecipientInfo_kekri_id_cmp(CMS_RecipientInfo *ri,
                                    const unsigned char *id, size_t idlen)
 {
     ASN1_OCTET_STRING tmp_os;
@@ -475,7 +475,7 @@ static size_t aes_wrap_keylen(int nid)
     }
 }
 
-CMS_RecipientInfo *CMS_add0_recipient_key(CMS_ContentInfo *cms, int nid,
+CMS_RecipientInfo * __cdecl CMS_add0_recipient_key(CMS_ContentInfo *cms, int nid,
                                           unsigned char *key, size_t keylen,
                                           unsigned char *id, size_t idlen,
                                           ASN1_GENERALIZEDTIME *date,
@@ -575,7 +575,7 @@ CMS_RecipientInfo *CMS_add0_recipient_key(CMS_ContentInfo *cms, int nid,
 
 }
 
-int CMS_RecipientInfo_kekri_get0_id(CMS_RecipientInfo *ri,
+int __cdecl CMS_RecipientInfo_kekri_get0_id(CMS_RecipientInfo *ri,
                                     X509_ALGOR **palg,
                                     ASN1_OCTET_STRING **pid,
                                     ASN1_GENERALIZEDTIME **pdate,
@@ -609,7 +609,7 @@ int CMS_RecipientInfo_kekri_get0_id(CMS_RecipientInfo *ri,
     return 1;
 }
 
-int CMS_RecipientInfo_set0_key(CMS_RecipientInfo *ri,
+int __cdecl CMS_RecipientInfo_set0_key(CMS_RecipientInfo *ri,
                                unsigned char *key, size_t keylen)
 {
     CMS_KEKRecipientInfo *kekri;
@@ -752,7 +752,7 @@ static int cms_RecipientInfo_kekri_decrypt(CMS_ContentInfo *cms,
 
 }
 
-int CMS_RecipientInfo_decrypt(CMS_ContentInfo *cms, CMS_RecipientInfo *ri)
+int __cdecl CMS_RecipientInfo_decrypt(CMS_ContentInfo *cms, CMS_RecipientInfo *ri)
 {
     switch (ri->type) {
     case CMS_RECIPINFO_TRANS:
@@ -771,7 +771,7 @@ int CMS_RecipientInfo_decrypt(CMS_ContentInfo *cms, CMS_RecipientInfo *ri)
     }
 }
 
-int CMS_RecipientInfo_encrypt(CMS_ContentInfo *cms, CMS_RecipientInfo *ri)
+int __cdecl CMS_RecipientInfo_encrypt(CMS_ContentInfo *cms, CMS_RecipientInfo *ri)
 {
     switch (ri->type) {
     case CMS_RECIPINFO_TRANS:
diff --git a/crypto/cms/cms_err.c b/crypto/cms/cms_err.c
index a211f4954c..6812833251 100644
--- a/crypto/cms/cms_err.c
+++ b/crypto/cms/cms_err.c
@@ -285,7 +285,7 @@ static const ERR_STRING_DATA CMS_str_reasons[] = {
 
 #endif
 
-int ERR_load_CMS_strings(void)
+int __cdecl ERR_load_CMS_strings(void)
 {
 #ifndef OPENSSL_NO_ERR
     if (ERR_func_error_string(CMS_str_functs[0].error) == NULL) {
diff --git a/crypto/cms/cms_ess.c b/crypto/cms/cms_ess.c
index 4780231c22..d50a5d94a4 100644
--- a/crypto/cms/cms_ess.c
+++ b/crypto/cms/cms_ess.c
@@ -20,7 +20,7 @@ IMPLEMENT_ASN1_FUNCTIONS(CMS_ReceiptRequest)
 
 /* ESS services: for now just Signed Receipt related */
 
-int CMS_get1_ReceiptRequest(CMS_SignerInfo *si, CMS_ReceiptRequest **prr)
+int __cdecl CMS_get1_ReceiptRequest(CMS_SignerInfo *si, CMS_ReceiptRequest **prr)
 {
     ASN1_STRING *str;
     CMS_ReceiptRequest *rr = NULL;
@@ -43,7 +43,7 @@ int CMS_get1_ReceiptRequest(CMS_SignerInfo *si, CMS_ReceiptRequest **prr)
     return 1;
 }
 
-CMS_ReceiptRequest *CMS_ReceiptRequest_create0(unsigned char *id, int idlen,
+CMS_ReceiptRequest * __cdecl CMS_ReceiptRequest_create0(unsigned char *id, int idlen,
                                                int allorfirst,
                                                STACK_OF(GENERAL_NAMES)
                                                *receiptList, STACK_OF(GENERAL_NAMES)
@@ -85,7 +85,7 @@ CMS_ReceiptRequest *CMS_ReceiptRequest_create0(unsigned char *id, int idlen,
 
 }
 
-int CMS_add1_ReceiptRequest(CMS_SignerInfo *si, CMS_ReceiptRequest *rr)
+int __cdecl CMS_add1_ReceiptRequest(CMS_SignerInfo *si, CMS_ReceiptRequest *rr)
 {
     unsigned char *rrder = NULL;
     int rrderlen, r = 0;
@@ -110,7 +110,7 @@ int CMS_add1_ReceiptRequest(CMS_SignerInfo *si, CMS_ReceiptRequest *rr)
 
 }
 
-void CMS_ReceiptRequest_get0_values(CMS_ReceiptRequest *rr,
+void __cdecl CMS_ReceiptRequest_get0_values(CMS_ReceiptRequest *rr,
                                     ASN1_STRING **pcid,
                                     int *pallorfirst,
                                     STACK_OF(GENERAL_NAMES) **plist,
diff --git a/crypto/cms/cms_io.c b/crypto/cms/cms_io.c
index d18f980a97..9665751f04 100644
--- a/crypto/cms/cms_io.c
+++ b/crypto/cms/cms_io.c
@@ -14,7 +14,7 @@
 #include <openssl/cms.h>
 #include "cms_lcl.h"
 
-int CMS_stream(unsigned char ***boundary, CMS_ContentInfo *cms)
+int __cdecl CMS_stream(unsigned char ***boundary, CMS_ContentInfo *cms)
 {
     ASN1_OCTET_STRING **pos;
     pos = CMS_get0_content(cms);
@@ -32,19 +32,19 @@ int CMS_stream(unsigned char ***boundary, CMS_ContentInfo *cms)
     return 0;
 }
 
-CMS_ContentInfo *d2i_CMS_bio(BIO *bp, CMS_ContentInfo **cms)
+CMS_ContentInfo * __cdecl d2i_CMS_bio(BIO *bp, CMS_ContentInfo **cms)
 {
     return ASN1_item_d2i_bio(ASN1_ITEM_rptr(CMS_ContentInfo), bp, cms);
 }
 
-int i2d_CMS_bio(BIO *bp, CMS_ContentInfo *cms)
+int __cdecl i2d_CMS_bio(BIO *bp, CMS_ContentInfo *cms)
 {
     return ASN1_item_i2d_bio(ASN1_ITEM_rptr(CMS_ContentInfo), bp, cms);
 }
 
 IMPLEMENT_PEM_rw_const(CMS, CMS_ContentInfo, PEM_STRING_CMS, CMS_ContentInfo)
 
-BIO *BIO_new_CMS(BIO *out, CMS_ContentInfo *cms)
+BIO * __cdecl BIO_new_CMS(BIO *out, CMS_ContentInfo *cms)
 {
     return BIO_new_NDEF(out, (ASN1_VALUE *)cms,
                         ASN1_ITEM_rptr(CMS_ContentInfo));
@@ -52,20 +52,20 @@ BIO *BIO_new_CMS(BIO *out, CMS_ContentInfo *cms)
 
 /* CMS wrappers round generalised stream and MIME routines */
 
-int i2d_CMS_bio_stream(BIO *out, CMS_ContentInfo *cms, BIO *in, int flags)
+int __cdecl i2d_CMS_bio_stream(BIO *out, CMS_ContentInfo *cms, BIO *in, int flags)
 {
     return i2d_ASN1_bio_stream(out, (ASN1_VALUE *)cms, in, flags,
                                ASN1_ITEM_rptr(CMS_ContentInfo));
 }
 
-int PEM_write_bio_CMS_stream(BIO *out, CMS_ContentInfo *cms, BIO *in,
+int __cdecl PEM_write_bio_CMS_stream(BIO *out, CMS_ContentInfo *cms, BIO *in,
                              int flags)
 {
     return PEM_write_bio_ASN1_stream(out, (ASN1_VALUE *)cms, in, flags,
                                      "CMS", ASN1_ITEM_rptr(CMS_ContentInfo));
 }
 
-int SMIME_write_CMS(BIO *bio, CMS_ContentInfo *cms, BIO *data, int flags)
+int __cdecl SMIME_write_CMS(BIO *bio, CMS_ContentInfo *cms, BIO *data, int flags)
 {
     STACK_OF(X509_ALGOR) *mdalgs;
     int ctype_nid = OBJ_obj2nid(cms->contentType);
@@ -80,7 +80,7 @@ int SMIME_write_CMS(BIO *bio, CMS_ContentInfo *cms, BIO *data, int flags)
                             ASN1_ITEM_rptr(CMS_ContentInfo));
 }
 
-CMS_ContentInfo *SMIME_read_CMS(BIO *bio, BIO **bcont)
+CMS_ContentInfo * __cdecl SMIME_read_CMS(BIO *bio, BIO **bcont)
 {
     return (CMS_ContentInfo *)SMIME_read_ASN1(bio, bcont,
                                               ASN1_ITEM_rptr
diff --git a/crypto/cms/cms_kari.c b/crypto/cms/cms_kari.c
index 5e83814d0f..f864155d24 100644
--- a/crypto/cms/cms_kari.c
+++ b/crypto/cms/cms_kari.c
@@ -19,7 +19,7 @@
 
 /* Key Agreement Recipient Info (KARI) routines */
 
-int CMS_RecipientInfo_kari_get0_alg(CMS_RecipientInfo *ri,
+int __cdecl CMS_RecipientInfo_kari_get0_alg(CMS_RecipientInfo *ri,
                                     X509_ALGOR **palg,
                                     ASN1_OCTET_STRING **pukm)
 {
@@ -38,7 +38,7 @@ int CMS_RecipientInfo_kari_get0_alg(CMS_RecipientInfo *ri,
 /* Retrieve recipient encrypted keys from a kari */
 
 STACK_OF(CMS_RecipientEncryptedKey)
-*CMS_RecipientInfo_kari_get0_reks(CMS_RecipientInfo *ri)
+* __cdecl CMS_RecipientInfo_kari_get0_reks(CMS_RecipientInfo *ri)
 {
     if (ri->type != CMS_RECIPINFO_AGREE) {
         CMSerr(CMS_F_CMS_RECIPIENTINFO_KARI_GET0_REKS,
@@ -48,7 +48,7 @@ STACK_OF(CMS_RecipientEncryptedKey)
     return ri->d.kari->recipientEncryptedKeys;
 }
 
-int CMS_RecipientInfo_kari_get0_orig_id(CMS_RecipientInfo *ri,
+int __cdecl CMS_RecipientInfo_kari_get0_orig_id(CMS_RecipientInfo *ri,
                                         X509_ALGOR **pubalg,
                                         ASN1_BIT_STRING **pubkey,
                                         ASN1_OCTET_STRING **keyid,
@@ -90,7 +90,7 @@ int CMS_RecipientInfo_kari_get0_orig_id(CMS_RecipientInfo *ri,
     return 1;
 }
 
-int CMS_RecipientInfo_kari_orig_id_cmp(CMS_RecipientInfo *ri, X509 *cert)
+int __cdecl CMS_RecipientInfo_kari_orig_id_cmp(CMS_RecipientInfo *ri, X509 *cert)
 {
     CMS_OriginatorIdentifierOrKey *oik;
     if (ri->type != CMS_RECIPINFO_AGREE) {
@@ -106,7 +106,7 @@ int CMS_RecipientInfo_kari_orig_id_cmp(CMS_RecipientInfo *ri, X509 *cert)
     return -1;
 }
 
-int CMS_RecipientEncryptedKey_get0_id(CMS_RecipientEncryptedKey *rek,
+int __cdecl CMS_RecipientEncryptedKey_get0_id(CMS_RecipientEncryptedKey *rek,
                                       ASN1_OCTET_STRING **keyid,
                                       ASN1_GENERALIZEDTIME **tm,
                                       CMS_OtherKeyAttribute **other,
@@ -140,7 +140,7 @@ int CMS_RecipientEncryptedKey_get0_id(CMS_RecipientEncryptedKey *rek,
     return 1;
 }
 
-int CMS_RecipientEncryptedKey_cert_cmp(CMS_RecipientEncryptedKey *rek,
+int __cdecl CMS_RecipientEncryptedKey_cert_cmp(CMS_RecipientEncryptedKey *rek,
                                        X509 *cert)
 {
     CMS_KeyAgreeRecipientIdentifier *rid = rek->rid;
@@ -152,7 +152,7 @@ int CMS_RecipientEncryptedKey_cert_cmp(CMS_RecipientEncryptedKey *rek,
         return -1;
 }
 
-int CMS_RecipientInfo_kari_set0_pkey(CMS_RecipientInfo *ri, EVP_PKEY *pk)
+int __cdecl CMS_RecipientInfo_kari_set0_pkey(CMS_RecipientInfo *ri, EVP_PKEY *pk)
 {
     EVP_PKEY_CTX *pctx;
     CMS_KeyAgreeRecipientInfo *kari = ri->d.kari;
@@ -171,7 +171,7 @@ int CMS_RecipientInfo_kari_set0_pkey(CMS_RecipientInfo *ri, EVP_PKEY *pk)
     return 0;
 }
 
-EVP_CIPHER_CTX *CMS_RecipientInfo_kari_get0_ctx(CMS_RecipientInfo *ri)
+EVP_CIPHER_CTX * __cdecl CMS_RecipientInfo_kari_get0_ctx(CMS_RecipientInfo *ri)
 {
     if (ri->type == CMS_RECIPINFO_AGREE)
         return ri->d.kari->ctx;
@@ -225,7 +225,7 @@ static int cms_kek_cipher(unsigned char **pout, size_t *poutlen,
     return rv;
 }
 
-int CMS_RecipientInfo_kari_decrypt(CMS_ContentInfo *cms,
+int __cdecl CMS_RecipientInfo_kari_decrypt(CMS_ContentInfo *cms,
                                    CMS_RecipientInfo *ri,
                                    CMS_RecipientEncryptedKey *rek)
 {
diff --git a/crypto/cms/cms_lib.c b/crypto/cms/cms_lib.c
index c2cac26010..fd8ccac1b8 100644
--- a/crypto/cms/cms_lib.c
+++ b/crypto/cms/cms_lib.c
@@ -19,7 +19,7 @@
 IMPLEMENT_ASN1_FUNCTIONS(CMS_ContentInfo)
 IMPLEMENT_ASN1_PRINT_FUNCTION(CMS_ContentInfo)
 
-const ASN1_OBJECT *CMS_get0_type(const CMS_ContentInfo *cms)
+const ASN1_OBJECT * __cdecl CMS_get0_type(const CMS_ContentInfo *cms)
 {
     return cms->contentType;
 }
@@ -53,7 +53,7 @@ BIO *cms_content_bio(CMS_ContentInfo *cms)
     return BIO_new_mem_buf((*pos)->data, (*pos)->length);
 }
 
-BIO *CMS_dataInit(CMS_ContentInfo *cms, BIO *icont)
+BIO * __cdecl CMS_dataInit(CMS_ContentInfo *cms, BIO *icont)
 {
     BIO *cmsbio, *cont;
     if (icont)
@@ -104,7 +104,7 @@ BIO *CMS_dataInit(CMS_ContentInfo *cms, BIO *icont)
 
 }
 
-int CMS_dataFinal(CMS_ContentInfo *cms, BIO *cmsbio)
+int __cdecl CMS_dataFinal(CMS_ContentInfo *cms, BIO *cmsbio)
 {
     ASN1_OCTET_STRING **pos = CMS_get0_content(cms);
     if (!pos)
@@ -153,7 +153,7 @@ int CMS_dataFinal(CMS_ContentInfo *cms, BIO *cmsbio)
  * or set later.
  */
 
-ASN1_OCTET_STRING **CMS_get0_content(CMS_ContentInfo *cms)
+ASN1_OCTET_STRING ** __cdecl CMS_get0_content(CMS_ContentInfo *cms)
 {
     switch (OBJ_obj2nid(cms->contentType)) {
 
@@ -221,7 +221,7 @@ static ASN1_OBJECT **cms_get0_econtent_type(CMS_ContentInfo *cms)
     }
 }
 
-const ASN1_OBJECT *CMS_get0_eContentType(CMS_ContentInfo *cms)
+const ASN1_OBJECT * __cdecl CMS_get0_eContentType(CMS_ContentInfo *cms)
 {
     ASN1_OBJECT **petype;
     petype = cms_get0_econtent_type(cms);
@@ -230,7 +230,7 @@ const ASN1_OBJECT *CMS_get0_eContentType(CMS_ContentInfo *cms)
     return NULL;
 }
 
-int CMS_set1_eContentType(CMS_ContentInfo *cms, const ASN1_OBJECT *oid)
+int __cdecl CMS_set1_eContentType(CMS_ContentInfo *cms, const ASN1_OBJECT *oid)
 {
     ASN1_OBJECT **petype, *etype;
     petype = cms_get0_econtent_type(cms);
@@ -246,7 +246,7 @@ int CMS_set1_eContentType(CMS_ContentInfo *cms, const ASN1_OBJECT *oid)
     return 1;
 }
 
-int CMS_is_detached(CMS_ContentInfo *cms)
+int __cdecl CMS_is_detached(CMS_ContentInfo *cms)
 {
     ASN1_OCTET_STRING **pos;
     pos = CMS_get0_content(cms);
@@ -257,7 +257,7 @@ int CMS_is_detached(CMS_ContentInfo *cms)
     return 1;
 }
 
-int CMS_set_detached(CMS_ContentInfo *cms, int detached)
+int __cdecl CMS_set_detached(CMS_ContentInfo *cms, int detached)
 {
     ASN1_OCTET_STRING **pos;
     pos = CMS_get0_content(cms);
@@ -357,7 +357,7 @@ static STACK_OF(CMS_CertificateChoices)
     }
 }
 
-CMS_CertificateChoices *CMS_add0_CertificateChoices(CMS_ContentInfo *cms)
+CMS_CertificateChoices * __cdecl CMS_add0_CertificateChoices(CMS_ContentInfo *cms)
 {
     STACK_OF(CMS_CertificateChoices) **pcerts;
     CMS_CertificateChoices *cch;
@@ -378,7 +378,7 @@ CMS_CertificateChoices *CMS_add0_CertificateChoices(CMS_ContentInfo *cms)
     return cch;
 }
 
-int CMS_add0_cert(CMS_ContentInfo *cms, X509 *cert)
+int __cdecl CMS_add0_cert(CMS_ContentInfo *cms, X509 *cert)
 {
     CMS_CertificateChoices *cch;
     STACK_OF(CMS_CertificateChoices) **pcerts;
@@ -404,7 +404,7 @@ int CMS_add0_cert(CMS_ContentInfo *cms, X509 *cert)
     return 1;
 }
 
-int CMS_add1_cert(CMS_ContentInfo *cms, X509 *cert)
+int __cdecl CMS_add1_cert(CMS_ContentInfo *cms, X509 *cert)
 {
     int r;
     r = CMS_add0_cert(cms, cert);
@@ -434,7 +434,7 @@ static STACK_OF(CMS_RevocationInfoChoice)
     }
 }
 
-CMS_RevocationInfoChoice *CMS_add0_RevocationInfoChoice(CMS_ContentInfo *cms)
+CMS_RevocationInfoChoice * __cdecl CMS_add0_RevocationInfoChoice(CMS_ContentInfo *cms)
 {
     STACK_OF(CMS_RevocationInfoChoice) **pcrls;
     CMS_RevocationInfoChoice *rch;
@@ -455,7 +455,7 @@ CMS_RevocationInfoChoice *CMS_add0_RevocationInfoChoice(CMS_ContentInfo *cms)
     return rch;
 }
 
-int CMS_add0_crl(CMS_ContentInfo *cms, X509_CRL *crl)
+int __cdecl CMS_add0_crl(CMS_ContentInfo *cms, X509_CRL *crl)
 {
     CMS_RevocationInfoChoice *rch;
     rch = CMS_add0_RevocationInfoChoice(cms);
@@ -466,7 +466,7 @@ int CMS_add0_crl(CMS_ContentInfo *cms, X509_CRL *crl)
     return 1;
 }
 
-int CMS_add1_crl(CMS_ContentInfo *cms, X509_CRL *crl)
+int __cdecl CMS_add1_crl(CMS_ContentInfo *cms, X509_CRL *crl)
 {
     int r;
     r = CMS_add0_crl(cms, crl);
@@ -475,7 +475,7 @@ int CMS_add1_crl(CMS_ContentInfo *cms, X509_CRL *crl)
     return r;
 }
 
-STACK_OF(X509) *CMS_get1_certs(CMS_ContentInfo *cms)
+STACK_OF(X509) * __cdecl CMS_get1_certs(CMS_ContentInfo *cms)
 {
     STACK_OF(X509) *certs = NULL;
     CMS_CertificateChoices *cch;
@@ -503,7 +503,7 @@ STACK_OF(X509) *CMS_get1_certs(CMS_ContentInfo *cms)
 
 }
 
-STACK_OF(X509_CRL) *CMS_get1_crls(CMS_ContentInfo *cms)
+STACK_OF(X509_CRL) * __cdecl CMS_get1_crls(CMS_ContentInfo *cms)
 {
     STACK_OF(X509_CRL) *crls = NULL;
     STACK_OF(CMS_RevocationInfoChoice) **pcrls;
diff --git a/crypto/cms/cms_pwri.c b/crypto/cms/cms_pwri.c
index 26e3bdcf9e..d23f4e9fd3 100644
--- a/crypto/cms/cms_pwri.c
+++ b/crypto/cms/cms_pwri.c
@@ -18,7 +18,7 @@
 #include "cms_lcl.h"
 #include "internal/asn1_int.h"
 
-int CMS_RecipientInfo_set0_password(CMS_RecipientInfo *ri,
+int __cdecl CMS_RecipientInfo_set0_password(CMS_RecipientInfo *ri,
                                     unsigned char *pass, ossl_ssize_t passlen)
 {
     CMS_PasswordRecipientInfo *pwri;
@@ -35,7 +35,7 @@ int CMS_RecipientInfo_set0_password(CMS_RecipientInfo *ri,
     return 1;
 }
 
-CMS_RecipientInfo *CMS_add0_recipient_password(CMS_ContentInfo *cms,
+CMS_RecipientInfo * __cdecl CMS_add0_recipient_password(CMS_ContentInfo *cms,
                                                int iter, int wrap_nid,
                                                int pbe_nid,
                                                unsigned char *pass,
diff --git a/crypto/cms/cms_sd.c b/crypto/cms/cms_sd.c
index 3841513f8b..ad291f9b50 100644
--- a/crypto/cms/cms_sd.c
+++ b/crypto/cms/cms_sd.c
@@ -50,7 +50,7 @@ static CMS_SignedData *cms_signed_data_init(CMS_ContentInfo *cms)
 
 /* Just initialise SignedData e.g. for certs only structure */
 
-int CMS_SignedData_init(CMS_ContentInfo *cms)
+int __cdecl CMS_SignedData_init(CMS_ContentInfo *cms)
 {
     if (cms_signed_data_init(cms))
         return 1;
@@ -238,7 +238,7 @@ static int cms_sd_asn1_ctrl(CMS_SignerInfo *si, int cmd)
     return 1;
 }
 
-CMS_SignerInfo *CMS_add1_signer(CMS_ContentInfo *cms,
+CMS_SignerInfo * __cdecl CMS_add1_signer(CMS_ContentInfo *cms,
                                 X509 *signer, EVP_PKEY *pk, const EVP_MD *md,
                                 unsigned int flags)
 {
@@ -422,17 +422,17 @@ static int cms_add1_signingTime(CMS_SignerInfo *si, ASN1_TIME *t)
 
 }
 
-EVP_PKEY_CTX *CMS_SignerInfo_get0_pkey_ctx(CMS_SignerInfo *si)
+EVP_PKEY_CTX * __cdecl CMS_SignerInfo_get0_pkey_ctx(CMS_SignerInfo *si)
 {
     return si->pctx;
 }
 
-EVP_MD_CTX *CMS_SignerInfo_get0_md_ctx(CMS_SignerInfo *si)
+EVP_MD_CTX * __cdecl CMS_SignerInfo_get0_md_ctx(CMS_SignerInfo *si)
 {
     return si->mctx;
 }
 
-STACK_OF(CMS_SignerInfo) *CMS_get0_SignerInfos(CMS_ContentInfo *cms)
+STACK_OF(CMS_SignerInfo) * __cdecl CMS_get0_SignerInfos(CMS_ContentInfo *cms)
 {
     CMS_SignedData *sd;
     sd = cms_get0_signed(cms);
@@ -441,7 +441,7 @@ STACK_OF(CMS_SignerInfo) *CMS_get0_SignerInfos(CMS_ContentInfo *cms)
     return sd->signerInfos;
 }
 
-STACK_OF(X509) *CMS_get0_signers(CMS_ContentInfo *cms)
+STACK_OF(X509) * __cdecl CMS_get0_signers(CMS_ContentInfo *cms)
 {
     STACK_OF(X509) *signers = NULL;
     STACK_OF(CMS_SignerInfo) *sinfos;
@@ -465,7 +465,7 @@ STACK_OF(X509) *CMS_get0_signers(CMS_ContentInfo *cms)
     return signers;
 }
 
-void CMS_SignerInfo_set1_signer_cert(CMS_SignerInfo *si, X509 *signer)
+void __cdecl CMS_SignerInfo_set1_signer_cert(CMS_SignerInfo *si, X509 *signer)
 {
     if (signer) {
         X509_up_ref(signer);
@@ -476,19 +476,19 @@ void CMS_SignerInfo_set1_signer_cert(CMS_SignerInfo *si, X509 *signer)
     si->signer = signer;
 }
 
-int CMS_SignerInfo_get0_signer_id(CMS_SignerInfo *si,
+int __cdecl CMS_SignerInfo_get0_signer_id(CMS_SignerInfo *si,
                                   ASN1_OCTET_STRING **keyid,
                                   X509_NAME **issuer, ASN1_INTEGER **sno)
 {
     return cms_SignerIdentifier_get0_signer_id(si->sid, keyid, issuer, sno);
 }
 
-int CMS_SignerInfo_cert_cmp(CMS_SignerInfo *si, X509 *cert)
+int __cdecl CMS_SignerInfo_cert_cmp(CMS_SignerInfo *si, X509 *cert)
 {
     return cms_SignerIdentifier_cert_cmp(si->sid, cert);
 }
 
-int CMS_set1_signers_certs(CMS_ContentInfo *cms, STACK_OF(X509) *scerts,
+int __cdecl CMS_set1_signers_certs(CMS_ContentInfo *cms, STACK_OF(X509) *scerts,
                            unsigned int flags)
 {
     CMS_SignedData *sd;
@@ -534,7 +534,7 @@ int CMS_set1_signers_certs(CMS_ContentInfo *cms, STACK_OF(X509) *scerts,
     return ret;
 }
 
-void CMS_SignerInfo_get0_algs(CMS_SignerInfo *si, EVP_PKEY **pk,
+void __cdecl CMS_SignerInfo_get0_algs(CMS_SignerInfo *si, EVP_PKEY **pk,
                               X509 **signer, X509_ALGOR **pdig,
                               X509_ALGOR **psig)
 {
@@ -548,7 +548,7 @@ void CMS_SignerInfo_get0_algs(CMS_SignerInfo *si, EVP_PKEY **pk,
         *psig = si->signatureAlgorithm;
 }
 
-ASN1_OCTET_STRING *CMS_SignerInfo_get0_signature(CMS_SignerInfo *si)
+ASN1_OCTET_STRING * __cdecl CMS_SignerInfo_get0_signature(CMS_SignerInfo *si)
 {
     return si->signature;
 }
@@ -653,7 +653,7 @@ int cms_SignedData_final(CMS_ContentInfo *cms, BIO *chain)
     return 1;
 }
 
-int CMS_SignerInfo_sign(CMS_SignerInfo *si)
+int __cdecl CMS_SignerInfo_sign(CMS_SignerInfo *si)
 {
     EVP_MD_CTX *mctx = si->mctx;
     EVP_PKEY_CTX *pctx = NULL;
@@ -722,7 +722,7 @@ int CMS_SignerInfo_sign(CMS_SignerInfo *si)
     return 0;
 }
 
-int CMS_SignerInfo_verify(CMS_SignerInfo *si)
+int __cdecl CMS_SignerInfo_verify(CMS_SignerInfo *si)
 {
     EVP_MD_CTX *mctx = NULL;
     unsigned char *abuf = NULL;
@@ -800,7 +800,7 @@ BIO *cms_SignedData_init_bio(CMS_ContentInfo *cms)
     return NULL;
 }
 
-int CMS_SignerInfo_verify_content(CMS_SignerInfo *si, BIO *chain)
+int __cdecl CMS_SignerInfo_verify_content(CMS_SignerInfo *si, BIO *chain)
 {
     ASN1_OCTET_STRING *os = NULL;
     EVP_MD_CTX *mctx = EVP_MD_CTX_new();
@@ -877,7 +877,7 @@ int CMS_SignerInfo_verify_content(CMS_SignerInfo *si, BIO *chain)
 
 }
 
-int CMS_add_smimecap(CMS_SignerInfo *si, STACK_OF(X509_ALGOR) *algs)
+int __cdecl CMS_add_smimecap(CMS_SignerInfo *si, STACK_OF(X509_ALGOR) *algs)
 {
     unsigned char *smder = NULL;
     int smderlen, r;
@@ -890,7 +890,7 @@ int CMS_add_smimecap(CMS_SignerInfo *si, STACK_OF(X509_ALGOR) *algs)
     return r;
 }
 
-int CMS_add_simple_smimecap(STACK_OF(X509_ALGOR) **algs,
+int __cdecl CMS_add_simple_smimecap(STACK_OF(X509_ALGOR) **algs,
                             int algnid, int keysize)
 {
     X509_ALGOR *alg;
@@ -933,7 +933,7 @@ static int cms_add_digest_smcap(STACK_OF(X509_ALGOR) **sk, int nid, int arg)
     return 1;
 }
 
-int CMS_add_standard_smimecap(STACK_OF(X509_ALGOR) **smcap)
+int __cdecl CMS_add_standard_smimecap(STACK_OF(X509_ALGOR) **smcap)
 {
     if (!cms_add_cipher_smcap(smcap, NID_aes_256_cbc, -1)
         || !cms_add_digest_smcap(smcap, NID_id_GostR3411_2012_256, -1)
diff --git a/crypto/cms/cms_smime.c b/crypto/cms/cms_smime.c
index 10815639f8..319c96e015 100644
--- a/crypto/cms/cms_smime.c
+++ b/crypto/cms/cms_smime.c
@@ -99,7 +99,7 @@ static void do_free_upto(BIO *f, BIO *upto)
         BIO_free_all(f);
 }
 
-int CMS_data(CMS_ContentInfo *cms, BIO *out, unsigned int flags)
+int __cdecl CMS_data(CMS_ContentInfo *cms, BIO *out, unsigned int flags)
 {
     BIO *cont;
     int r;
@@ -115,7 +115,7 @@ int CMS_data(CMS_ContentInfo *cms, BIO *out, unsigned int flags)
     return r;
 }
 
-CMS_ContentInfo *CMS_data_create(BIO *in, unsigned int flags)
+CMS_ContentInfo * __cdecl CMS_data_create(BIO *in, unsigned int flags)
 {
     CMS_ContentInfo *cms;
     cms = cms_Data_create();
@@ -130,7 +130,7 @@ CMS_ContentInfo *CMS_data_create(BIO *in, unsigned int flags)
     return NULL;
 }
 
-int CMS_digest_verify(CMS_ContentInfo *cms, BIO *dcont, BIO *out,
+int __cdecl CMS_digest_verify(CMS_ContentInfo *cms, BIO *dcont, BIO *out,
                       unsigned int flags)
 {
     BIO *cont;
@@ -153,7 +153,7 @@ int CMS_digest_verify(CMS_ContentInfo *cms, BIO *dcont, BIO *out,
     return r;
 }
 
-CMS_ContentInfo *CMS_digest_create(BIO *in, const EVP_MD *md,
+CMS_ContentInfo * __cdecl CMS_digest_create(BIO *in, const EVP_MD *md,
                                    unsigned int flags)
 {
     CMS_ContentInfo *cms;
@@ -173,7 +173,7 @@ CMS_ContentInfo *CMS_digest_create(BIO *in, const EVP_MD *md,
     return NULL;
 }
 
-int CMS_EncryptedData_decrypt(CMS_ContentInfo *cms,
+int __cdecl CMS_EncryptedData_decrypt(CMS_ContentInfo *cms,
                               const unsigned char *key, size_t keylen,
                               BIO *dcont, BIO *out, unsigned int flags)
 {
@@ -198,7 +198,7 @@ int CMS_EncryptedData_decrypt(CMS_ContentInfo *cms,
     return r;
 }
 
-CMS_ContentInfo *CMS_EncryptedData_encrypt(BIO *in, const EVP_CIPHER *cipher,
+CMS_ContentInfo * __cdecl CMS_EncryptedData_encrypt(BIO *in, const EVP_CIPHER *cipher,
                                            const unsigned char *key,
                                            size_t keylen, unsigned int flags)
 {
@@ -262,7 +262,7 @@ static int cms_signerinfo_verify_cert(CMS_SignerInfo *si,
 
 }
 
-int CMS_verify(CMS_ContentInfo *cms, STACK_OF(X509) *certs,
+int __cdecl CMS_verify(CMS_ContentInfo *cms, STACK_OF(X509) *certs,
                X509_STORE *store, BIO *dcont, BIO *out, unsigned int flags)
 {
     CMS_SignerInfo *si;
@@ -420,7 +420,7 @@ int CMS_verify(CMS_ContentInfo *cms, STACK_OF(X509) *certs,
     return ret;
 }
 
-int CMS_verify_receipt(CMS_ContentInfo *rcms, CMS_ContentInfo *ocms,
+int __cdecl CMS_verify_receipt(CMS_ContentInfo *rcms, CMS_ContentInfo *ocms,
                        STACK_OF(X509) *certs,
                        X509_STORE *store, unsigned int flags)
 {
@@ -432,7 +432,7 @@ int CMS_verify_receipt(CMS_ContentInfo *rcms, CMS_ContentInfo *ocms,
     return cms_Receipt_verify(rcms, ocms);
 }
 
-CMS_ContentInfo *CMS_sign(X509 *signcert, EVP_PKEY *pkey,
+CMS_ContentInfo * __cdecl CMS_sign(X509 *signcert, EVP_PKEY *pkey,
                           STACK_OF(X509) *certs, BIO *data,
                           unsigned int flags)
 {
@@ -475,7 +475,7 @@ CMS_ContentInfo *CMS_sign(X509 *signcert, EVP_PKEY *pkey,
     return NULL;
 }
 
-CMS_ContentInfo *CMS_sign_receipt(CMS_SignerInfo *si,
+CMS_ContentInfo * __cdecl CMS_sign_receipt(CMS_SignerInfo *si,
                                   X509 *signcert, EVP_PKEY *pkey,
                                   STACK_OF(X509) *certs, unsigned int flags)
 {
@@ -543,7 +543,7 @@ CMS_ContentInfo *CMS_sign_receipt(CMS_SignerInfo *si,
 
 }
 
-CMS_ContentInfo *CMS_encrypt(STACK_OF(X509) *certs, BIO *data,
+CMS_ContentInfo * __cdecl CMS_encrypt(STACK_OF(X509) *certs, BIO *data,
                              const EVP_CIPHER *cipher, unsigned int flags)
 {
     CMS_ContentInfo *cms;
@@ -598,7 +598,7 @@ static int cms_kari_set1_pkey(CMS_ContentInfo *cms, CMS_RecipientInfo *ri,
     return 0;
 }
 
-int CMS_decrypt_set1_pkey(CMS_ContentInfo *cms, EVP_PKEY *pk, X509 *cert)
+int __cdecl CMS_decrypt_set1_pkey(CMS_ContentInfo *cms, EVP_PKEY *pk, X509 *cert)
 {
     STACK_OF(CMS_RecipientInfo) *ris;
     CMS_RecipientInfo *ri;
@@ -669,7 +669,7 @@ int CMS_decrypt_set1_pkey(CMS_ContentInfo *cms, EVP_PKEY *pk, X509 *cert)
 
 }
 
-int CMS_decrypt_set1_key(CMS_ContentInfo *cms,
+int __cdecl CMS_decrypt_set1_key(CMS_ContentInfo *cms,
                          unsigned char *key, size_t keylen,
                          const unsigned char *id, size_t idlen)
 {
@@ -705,7 +705,7 @@ int CMS_decrypt_set1_key(CMS_ContentInfo *cms,
 
 }
 
-int CMS_decrypt_set1_password(CMS_ContentInfo *cms,
+int __cdecl CMS_decrypt_set1_password(CMS_ContentInfo *cms,
                               unsigned char *pass, ossl_ssize_t passlen)
 {
     STACK_OF(CMS_RecipientInfo) *ris;
@@ -728,7 +728,7 @@ int CMS_decrypt_set1_password(CMS_ContentInfo *cms,
 
 }
 
-int CMS_decrypt(CMS_ContentInfo *cms, EVP_PKEY *pk, X509 *cert,
+int __cdecl CMS_decrypt(CMS_ContentInfo *cms, EVP_PKEY *pk, X509 *cert,
                 BIO *dcont, BIO *out, unsigned int flags)
 {
     int r;
@@ -759,7 +759,7 @@ int CMS_decrypt(CMS_ContentInfo *cms, EVP_PKEY *pk, X509 *cert,
     return r;
 }
 
-int CMS_final(CMS_ContentInfo *cms, BIO *data, BIO *dcont, unsigned int flags)
+int __cdecl CMS_final(CMS_ContentInfo *cms, BIO *data, BIO *dcont, unsigned int flags)
 {
     BIO *cmsbio;
     int ret = 0;
@@ -789,7 +789,7 @@ int CMS_final(CMS_ContentInfo *cms, BIO *data, BIO *dcont, unsigned int flags)
 
 #ifdef ZLIB
 
-int CMS_uncompress(CMS_ContentInfo *cms, BIO *dcont, BIO *out,
+int __cdecl CMS_uncompress(CMS_ContentInfo *cms, BIO *dcont, BIO *out,
                    unsigned int flags)
 {
     BIO *cont;
@@ -810,7 +810,7 @@ int CMS_uncompress(CMS_ContentInfo *cms, BIO *dcont, BIO *out,
     return r;
 }
 
-CMS_ContentInfo *CMS_compress(BIO *in, int comp_nid, unsigned int flags)
+CMS_ContentInfo * __cdecl CMS_compress(BIO *in, int comp_nid, unsigned int flags)
 {
     CMS_ContentInfo *cms;
     if (comp_nid <= 0)
@@ -831,14 +831,14 @@ CMS_ContentInfo *CMS_compress(BIO *in, int comp_nid, unsigned int flags)
 
 #else
 
-int CMS_uncompress(CMS_ContentInfo *cms, BIO *dcont, BIO *out,
+int __cdecl CMS_uncompress(CMS_ContentInfo *cms, BIO *dcont, BIO *out,
                    unsigned int flags)
 {
     CMSerr(CMS_F_CMS_UNCOMPRESS, CMS_R_UNSUPPORTED_COMPRESSION_ALGORITHM);
     return 0;
 }
 
-CMS_ContentInfo *CMS_compress(BIO *in, int comp_nid, unsigned int flags)
+CMS_ContentInfo * __cdecl CMS_compress(BIO *in, int comp_nid, unsigned int flags)
 {
     CMSerr(CMS_F_CMS_COMPRESS, CMS_R_UNSUPPORTED_COMPRESSION_ALGORITHM);
     return NULL;
diff --git a/crypto/comp/c_zlib.c b/crypto/comp/c_zlib.c
index d688deee5f..be15b051e5 100644
--- a/crypto/comp/c_zlib.c
+++ b/crypto/comp/c_zlib.c
@@ -17,7 +17,7 @@
 #include "internal/bio.h"
 #include "comp_lcl.h"
 
-COMP_METHOD *COMP_zlib(void);
+COMP_METHOD * __cdecl COMP_zlib(void);
 
 static COMP_METHOD zlib_method_nozlib = {
     NID_undef,
@@ -206,7 +206,7 @@ static int zlib_stateful_expand_block(COMP_CTX *ctx, unsigned char *out,
 
 #endif
 
-COMP_METHOD *COMP_zlib(void)
+COMP_METHOD * __cdecl COMP_zlib(void)
 {
     COMP_METHOD *meth = &zlib_method_nozlib;
 
@@ -310,7 +310,7 @@ static const BIO_METHOD bio_meth_zlib = {
     bio_zlib_callback_ctrl
 };
 
-const BIO_METHOD *BIO_f_zlib(void)
+const BIO_METHOD * __cdecl BIO_f_zlib(void)
 {
     return &bio_meth_zlib;
 }
diff --git a/crypto/comp/comp_err.c b/crypto/comp/comp_err.c
index 2dca315cf1..9d893d52ad 100644
--- a/crypto/comp/comp_err.c
+++ b/crypto/comp/comp_err.c
@@ -34,7 +34,7 @@ static const ERR_STRING_DATA COMP_str_reasons[] = {
 
 #endif
 
-int ERR_load_COMP_strings(void)
+int __cdecl ERR_load_COMP_strings(void)
 {
 #ifndef OPENSSL_NO_ERR
     if (ERR_func_error_string(COMP_str_functs[0].error) == NULL) {
diff --git a/crypto/comp/comp_lib.c b/crypto/comp/comp_lib.c
index 6ae2114496..99169e6acd 100644
--- a/crypto/comp/comp_lib.c
+++ b/crypto/comp/comp_lib.c
@@ -15,7 +15,7 @@
 #include <openssl/err.h>
 #include "comp_lcl.h"
 
-COMP_CTX *COMP_CTX_new(COMP_METHOD *meth)
+COMP_CTX * __cdecl COMP_CTX_new(COMP_METHOD *meth)
 {
     COMP_CTX *ret;
 
@@ -31,22 +31,22 @@ COMP_CTX *COMP_CTX_new(COMP_METHOD *meth)
     return ret;
 }
 
-const COMP_METHOD *COMP_CTX_get_method(const COMP_CTX *ctx)
+const COMP_METHOD * __cdecl COMP_CTX_get_method(const COMP_CTX *ctx)
 {
     return ctx->meth;
 }
 
-int COMP_get_type(const COMP_METHOD *meth)
+int __cdecl COMP_get_type(const COMP_METHOD *meth)
 {
     return meth->type;
 }
 
-const char *COMP_get_name(const COMP_METHOD *meth)
+const char * __cdecl COMP_get_name(const COMP_METHOD *meth)
 {
     return meth->name;
 }
 
-void COMP_CTX_free(COMP_CTX *ctx)
+void __cdecl COMP_CTX_free(COMP_CTX *ctx)
 {
     if (ctx == NULL)
         return;
@@ -56,7 +56,7 @@ void COMP_CTX_free(COMP_CTX *ctx)
     OPENSSL_free(ctx);
 }
 
-int COMP_compress_block(COMP_CTX *ctx, unsigned char *out, int olen,
+int __cdecl COMP_compress_block(COMP_CTX *ctx, unsigned char *out, int olen,
                         unsigned char *in, int ilen)
 {
     int ret;
@@ -71,7 +71,7 @@ int COMP_compress_block(COMP_CTX *ctx, unsigned char *out, int olen,
     return ret;
 }
 
-int COMP_expand_block(COMP_CTX *ctx, unsigned char *out, int olen,
+int __cdecl COMP_expand_block(COMP_CTX *ctx, unsigned char *out, int olen,
                       unsigned char *in, int ilen)
 {
     int ret;
@@ -87,7 +87,7 @@ int COMP_expand_block(COMP_CTX *ctx, unsigned char *out, int olen,
     return ret;
 }
 
-int COMP_CTX_get_type(const COMP_CTX* comp)
+int __cdecl COMP_CTX_get_type(const COMP_CTX* comp)
 {
     return comp->meth ? comp->meth->type : NID_undef;
 }
diff --git a/crypto/conf/conf_api.c b/crypto/conf/conf_api.c
index 5e57d749ce..14a98b93bf 100644
--- a/crypto/conf/conf_api.c
+++ b/crypto/conf/conf_api.c
@@ -20,7 +20,7 @@ static void value_free_hash(const CONF_VALUE *a, LHASH_OF(CONF_VALUE) *conf);
 static void value_free_stack_doall(CONF_VALUE *a);
 
 /* Up until OpenSSL 0.9.5a, this was get_section */
-CONF_VALUE *_CONF_get_section(const CONF *conf, const char *section)
+CONF_VALUE * __cdecl _CONF_get_section(const CONF *conf, const char *section)
 {
     CONF_VALUE *v, vv;
 
@@ -33,7 +33,7 @@ CONF_VALUE *_CONF_get_section(const CONF *conf, const char *section)
 }
 
 /* Up until OpenSSL 0.9.5a, this was CONF_get_section */
-STACK_OF(CONF_VALUE) *_CONF_get_section_values(const CONF *conf,
+STACK_OF(CONF_VALUE) * __cdecl _CONF_get_section_values(const CONF *conf,
                                                const char *section)
 {
     CONF_VALUE *v;
@@ -45,7 +45,7 @@ STACK_OF(CONF_VALUE) *_CONF_get_section_values(const CONF *conf,
         return NULL;
 }
 
-int _CONF_add_string(CONF *conf, CONF_VALUE *section, CONF_VALUE *value)
+int __cdecl _CONF_add_string(CONF *conf, CONF_VALUE *section, CONF_VALUE *value)
 {
     CONF_VALUE *v = NULL;
     STACK_OF(CONF_VALUE) *ts;
@@ -67,7 +67,7 @@ int _CONF_add_string(CONF *conf, CONF_VALUE *section, CONF_VALUE *value)
     return 1;
 }
 
-char *_CONF_get_string(const CONF *conf, const char *section,
+char * __cdecl _CONF_get_string(const CONF *conf, const char *section,
                        const char *name)
 {
     CONF_VALUE *v, vv;
@@ -104,7 +104,7 @@ static unsigned long conf_value_hash(const CONF_VALUE *v)
     return (OPENSSL_LH_strhash(v->section) << 2) ^ OPENSSL_LH_strhash(v->name);
 }
 
-static int conf_value_cmp(const CONF_VALUE *a, const CONF_VALUE *b)
+static int __cdecl conf_value_cmp(const CONF_VALUE *a, const CONF_VALUE *b)
 {
     int i;
 
@@ -123,7 +123,7 @@ static int conf_value_cmp(const CONF_VALUE *a, const CONF_VALUE *b)
         return ((a->name == NULL) ? -1 : 1);
 }
 
-int _CONF_new_data(CONF *conf)
+int __cdecl _CONF_new_data(CONF *conf)
 {
     if (conf == NULL) {
         return 0;
@@ -140,7 +140,7 @@ typedef LHASH_OF(CONF_VALUE) LH_CONF_VALUE;
 
 IMPLEMENT_LHASH_DOALL_ARG_CONST(CONF_VALUE, LH_CONF_VALUE);
 
-void _CONF_free_data(CONF *conf)
+void __cdecl _CONF_free_data(CONF *conf)
 {
     if (conf == NULL || conf->data == NULL)
         return;
@@ -186,7 +186,7 @@ static void value_free_stack_doall(CONF_VALUE *a)
 }
 
 /* Up until OpenSSL 0.9.5a, this was new_section */
-CONF_VALUE *_CONF_new_section(CONF *conf, const char *section)
+CONF_VALUE * __cdecl _CONF_new_section(CONF *conf, const char *section)
 {
     STACK_OF(CONF_VALUE) *sk = NULL;
     int i;
diff --git a/crypto/conf/conf_def.c b/crypto/conf/conf_def.c
index 8e3f42a0ca..5a07ccda71 100644
--- a/crypto/conf/conf_def.c
+++ b/crypto/conf/conf_def.c
@@ -89,12 +89,12 @@ static CONF_METHOD WIN32_method = {
     def_load
 };
 
-CONF_METHOD *NCONF_default(void)
+CONF_METHOD * __cdecl NCONF_default(void)
 {
     return &default_method;
 }
 
-CONF_METHOD *NCONF_WIN32(void)
+CONF_METHOD * __cdecl NCONF_WIN32(void)
 {
     return &WIN32_method;
 }
diff --git a/crypto/conf/conf_err.c b/crypto/conf/conf_err.c
index f7613584ec..a7d299e885 100644
--- a/crypto/conf/conf_err.c
+++ b/crypto/conf/conf_err.c
@@ -83,7 +83,7 @@ static const ERR_STRING_DATA CONF_str_reasons[] = {
 
 #endif
 
-int ERR_load_CONF_strings(void)
+int __cdecl ERR_load_CONF_strings(void)
 {
 #ifndef OPENSSL_NO_ERR
     if (ERR_func_error_string(CONF_str_functs[0].error) == NULL) {
diff --git a/crypto/conf/conf_lib.c b/crypto/conf/conf_lib.c
index 2d40ac97ec..21fe21c999 100644
--- a/crypto/conf/conf_lib.c
+++ b/crypto/conf/conf_lib.c
@@ -22,7 +22,7 @@ static CONF_METHOD *default_CONF_method = NULL;
 
 /* Init a 'CONF' structure from an old LHASH */
 
-void CONF_set_nconf(CONF *conf, LHASH_OF(CONF_VALUE) *hash)
+void __cdecl CONF_set_nconf(CONF *conf, LHASH_OF(CONF_VALUE) *hash)
 {
     if (default_CONF_method == NULL)
         default_CONF_method = NCONF_default();
@@ -36,13 +36,13 @@ void CONF_set_nconf(CONF *conf, LHASH_OF(CONF_VALUE) *hash)
  * terms of the new CONF interface.
  */
 
-int CONF_set_default_method(CONF_METHOD *meth)
+int __cdecl CONF_set_default_method(CONF_METHOD *meth)
 {
     default_CONF_method = meth;
     return 1;
 }
 
-LHASH_OF(CONF_VALUE) *CONF_load(LHASH_OF(CONF_VALUE) *conf, const char *file,
+LHASH_OF(CONF_VALUE) * __cdecl CONF_load(LHASH_OF(CONF_VALUE) *conf, const char *file,
                                 long *eline)
 {
     LHASH_OF(CONF_VALUE) *ltmp;
@@ -65,7 +65,7 @@ LHASH_OF(CONF_VALUE) *CONF_load(LHASH_OF(CONF_VALUE) *conf, const char *file,
 }
 
 #ifndef OPENSSL_NO_STDIO
-LHASH_OF(CONF_VALUE) *CONF_load_fp(LHASH_OF(CONF_VALUE) *conf, FILE *fp,
+LHASH_OF(CONF_VALUE) * __cdecl CONF_load_fp(LHASH_OF(CONF_VALUE) *conf, FILE *fp,
                                    long *eline)
 {
     BIO *btmp;
@@ -80,7 +80,7 @@ LHASH_OF(CONF_VALUE) *CONF_load_fp(LHASH_OF(CONF_VALUE) *conf, FILE *fp,
 }
 #endif
 
-LHASH_OF(CONF_VALUE) *CONF_load_bio(LHASH_OF(CONF_VALUE) *conf, BIO *bp,
+LHASH_OF(CONF_VALUE) * __cdecl CONF_load_bio(LHASH_OF(CONF_VALUE) *conf, BIO *bp,
                                     long *eline)
 {
     CONF ctmp;
@@ -94,7 +94,7 @@ LHASH_OF(CONF_VALUE) *CONF_load_bio(LHASH_OF(CONF_VALUE) *conf, BIO *bp,
     return NULL;
 }
 
-STACK_OF(CONF_VALUE) *CONF_get_section(LHASH_OF(CONF_VALUE) *conf,
+STACK_OF(CONF_VALUE) * __cdecl CONF_get_section(LHASH_OF(CONF_VALUE) *conf,
                                        const char *section)
 {
     if (conf == NULL) {
@@ -106,7 +106,7 @@ STACK_OF(CONF_VALUE) *CONF_get_section(LHASH_OF(CONF_VALUE) *conf,
     }
 }
 
-char *CONF_get_string(LHASH_OF(CONF_VALUE) *conf, const char *group,
+char * __cdecl CONF_get_string(LHASH_OF(CONF_VALUE) *conf, const char *group,
                       const char *name)
 {
     if (conf == NULL) {
@@ -118,7 +118,7 @@ char *CONF_get_string(LHASH_OF(CONF_VALUE) *conf, const char *group,
     }
 }
 
-long CONF_get_number(LHASH_OF(CONF_VALUE) *conf, const char *group,
+long __cdecl CONF_get_number(LHASH_OF(CONF_VALUE) *conf, const char *group,
                      const char *name)
 {
     int status;
@@ -136,7 +136,7 @@ long CONF_get_number(LHASH_OF(CONF_VALUE) *conf, const char *group,
     return status == 0 ? 0L : result;
 }
 
-void CONF_free(LHASH_OF(CONF_VALUE) *conf)
+void __cdecl CONF_free(LHASH_OF(CONF_VALUE) *conf)
 {
     CONF ctmp;
     CONF_set_nconf(&ctmp, conf);
@@ -144,7 +144,7 @@ void CONF_free(LHASH_OF(CONF_VALUE) *conf)
 }
 
 #ifndef OPENSSL_NO_STDIO
-int CONF_dump_fp(LHASH_OF(CONF_VALUE) *conf, FILE *out)
+int __cdecl CONF_dump_fp(LHASH_OF(CONF_VALUE) *conf, FILE *out)
 {
     BIO *btmp;
     int ret;
@@ -159,7 +159,7 @@ int CONF_dump_fp(LHASH_OF(CONF_VALUE) *conf, FILE *out)
 }
 #endif
 
-int CONF_dump_bio(LHASH_OF(CONF_VALUE) *conf, BIO *out)
+int __cdecl CONF_dump_bio(LHASH_OF(CONF_VALUE) *conf, BIO *out)
 {
     CONF ctmp;
     CONF_set_nconf(&ctmp, conf);
@@ -174,7 +174,7 @@ int CONF_dump_bio(LHASH_OF(CONF_VALUE) *conf, BIO *out)
  * the "CONF classic" functions, for consistency.
  */
 
-CONF *NCONF_new(CONF_METHOD *meth)
+CONF * __cdecl NCONF_new(CONF_METHOD *meth)
 {
     CONF *ret;
 
@@ -190,21 +190,21 @@ CONF *NCONF_new(CONF_METHOD *meth)
     return ret;
 }
 
-void NCONF_free(CONF *conf)
+void __cdecl NCONF_free(CONF *conf)
 {
     if (conf == NULL)
         return;
     conf->meth->destroy(conf);
 }
 
-void NCONF_free_data(CONF *conf)
+void __cdecl NCONF_free_data(CONF *conf)
 {
     if (conf == NULL)
         return;
     conf->meth->destroy_data(conf);
 }
 
-int NCONF_load(CONF *conf, const char *file, long *eline)
+int __cdecl NCONF_load(CONF *conf, const char *file, long *eline)
 {
     if (conf == NULL) {
         CONFerr(CONF_F_NCONF_LOAD, CONF_R_NO_CONF);
@@ -215,7 +215,7 @@ int NCONF_load(CONF *conf, const char *file, long *eline)
 }
 
 #ifndef OPENSSL_NO_STDIO
-int NCONF_load_fp(CONF *conf, FILE *fp, long *eline)
+int __cdecl NCONF_load_fp(CONF *conf, FILE *fp, long *eline)
 {
     BIO *btmp;
     int ret;
@@ -229,7 +229,7 @@ int NCONF_load_fp(CONF *conf, FILE *fp, long *eline)
 }
 #endif
 
-int NCONF_load_bio(CONF *conf, BIO *bp, long *eline)
+int __cdecl NCONF_load_bio(CONF *conf, BIO *bp, long *eline)
 {
     if (conf == NULL) {
         CONFerr(CONF_F_NCONF_LOAD_BIO, CONF_R_NO_CONF);
@@ -239,7 +239,7 @@ int NCONF_load_bio(CONF *conf, BIO *bp, long *eline)
     return conf->meth->load_bio(conf, bp, eline);
 }
 
-STACK_OF(CONF_VALUE) *NCONF_get_section(const CONF *conf, const char *section)
+STACK_OF(CONF_VALUE) * __cdecl NCONF_get_section(const CONF *conf, const char *section)
 {
     if (conf == NULL) {
         CONFerr(CONF_F_NCONF_GET_SECTION, CONF_R_NO_CONF);
@@ -254,7 +254,7 @@ STACK_OF(CONF_VALUE) *NCONF_get_section(const CONF *conf, const char *section)
     return _CONF_get_section_values(conf, section);
 }
 
-char *NCONF_get_string(const CONF *conf, const char *group, const char *name)
+char * __cdecl NCONF_get_string(const CONF *conf, const char *group, const char *name)
 {
     char *s = _CONF_get_string(conf, group, name);
 
@@ -285,7 +285,7 @@ static int default_to_int(const CONF *conf, char c)
     return (int)(c - '0');
 }
 
-int NCONF_get_number_e(const CONF *conf, const char *group, const char *name,
+int __cdecl NCONF_get_number_e(const CONF *conf, const char *group, const char *name,
                        long *result)
 {
     char *str;
@@ -324,7 +324,7 @@ int NCONF_get_number_e(const CONF *conf, const char *group, const char *name,
 }
 
 #ifndef OPENSSL_NO_STDIO
-int NCONF_dump_fp(const CONF *conf, FILE *out)
+int __cdecl NCONF_dump_fp(const CONF *conf, FILE *out)
 {
     BIO *btmp;
     int ret;
@@ -338,7 +338,7 @@ int NCONF_dump_fp(const CONF *conf, FILE *out)
 }
 #endif
 
-int NCONF_dump_bio(const CONF *conf, BIO *out)
+int __cdecl NCONF_dump_bio(const CONF *conf, BIO *out)
 {
     if (conf == NULL) {
         CONFerr(CONF_F_NCONF_DUMP_BIO, CONF_R_NO_CONF);
@@ -352,7 +352,7 @@ int NCONF_dump_bio(const CONF *conf, BIO *out)
  * These routines call the C malloc/free, to avoid intermixing with
  * OpenSSL function pointers before the library is initialized.
  */
-OPENSSL_INIT_SETTINGS *OPENSSL_INIT_new(void)
+OPENSSL_INIT_SETTINGS * __cdecl OPENSSL_INIT_new(void)
 {
     OPENSSL_INIT_SETTINGS *ret = malloc(sizeof(*ret));
 
@@ -365,7 +365,7 @@ OPENSSL_INIT_SETTINGS *OPENSSL_INIT_new(void)
 
 
 #ifndef OPENSSL_NO_STDIO
-int OPENSSL_INIT_set_config_filename(OPENSSL_INIT_SETTINGS *settings,
+int __cdecl OPENSSL_INIT_set_config_filename(OPENSSL_INIT_SETTINGS *settings,
                                      const char *filename)
 {
     char *newfilename = NULL;
@@ -382,13 +382,13 @@ int OPENSSL_INIT_set_config_filename(OPENSSL_INIT_SETTINGS *settings,
     return 1;
 }
 
-void OPENSSL_INIT_set_config_file_flags(OPENSSL_INIT_SETTINGS *settings,
+void __cdecl OPENSSL_INIT_set_config_file_flags(OPENSSL_INIT_SETTINGS *settings,
                                         unsigned long flags)
 {
     settings->flags = flags;
 }
 
-int OPENSSL_INIT_set_config_appname(OPENSSL_INIT_SETTINGS *settings,
+int __cdecl OPENSSL_INIT_set_config_appname(OPENSSL_INIT_SETTINGS *settings,
                                     const char *appname)
 {
     char *newappname = NULL;
@@ -406,7 +406,7 @@ int OPENSSL_INIT_set_config_appname(OPENSSL_INIT_SETTINGS *settings,
 }
 #endif
 
-void OPENSSL_INIT_free(OPENSSL_INIT_SETTINGS *settings)
+void __cdecl OPENSSL_INIT_free(OPENSSL_INIT_SETTINGS *settings)
 {
     free(settings->filename);
     free(settings->appname);
diff --git a/crypto/conf/conf_mall.c b/crypto/conf/conf_mall.c
index 7e86948e89..164e3247cc 100644
--- a/crypto/conf/conf_mall.c
+++ b/crypto/conf/conf_mall.c
@@ -18,7 +18,7 @@
 
 /* Load all OpenSSL builtin modules */
 
-void OPENSSL_load_builtin_modules(void)
+void __cdecl OPENSSL_load_builtin_modules(void)
 {
     /* Add builtin modules here */
     ASN1_add_oid_module();
diff --git a/crypto/conf/conf_mod.c b/crypto/conf/conf_mod.c
index e703d97f54..8fd90440b4 100644
--- a/crypto/conf/conf_mod.c
+++ b/crypto/conf/conf_mod.c
@@ -69,7 +69,7 @@ static CONF_MODULE *module_load_dso(const CONF *cnf, const char *name,
 
 /* Main function: load modules from a CONF structure */
 
-int CONF_modules_load(const CONF *cnf, const char *appname,
+int __cdecl CONF_modules_load(const CONF *cnf, const char *appname,
                       unsigned long flags)
 {
     STACK_OF(CONF_VALUE) *values;
@@ -109,7 +109,7 @@ int CONF_modules_load(const CONF *cnf, const char *appname,
 
 }
 
-int CONF_modules_load_file(const char *filename, const char *appname,
+int __cdecl CONF_modules_load_file(const char *filename, const char *appname,
                            unsigned long flags)
 {
     char *file = NULL;
@@ -356,7 +356,7 @@ static int module_init(CONF_MODULE *pmod, const char *name, const char *value,
  * including static ones.
  */
 
-void CONF_modules_unload(int all)
+void __cdecl CONF_modules_unload(int all)
 {
     int i;
     CONF_MODULE *md;
@@ -387,7 +387,7 @@ static void module_free(CONF_MODULE *md)
 
 /* finish and free up all modules instances */
 
-void CONF_modules_finish(void)
+void __cdecl CONF_modules_finish(void)
 {
     CONF_IMODULE *imod;
     while (sk_CONF_IMODULE_num(initialized_modules) > 0) {
@@ -414,7 +414,7 @@ static void module_finish(CONF_IMODULE *imod)
 
 /* Add a static module to OpenSSL */
 
-int CONF_module_add(const char *name, conf_init_func *ifunc,
+int __cdecl CONF_module_add(const char *name, conf_init_func *ifunc,
                     conf_finish_func *ffunc)
 {
     if (module_add(NULL, name, ifunc, ffunc))
@@ -431,54 +431,54 @@ void conf_modules_free_int(void)
 
 /* Utility functions */
 
-const char *CONF_imodule_get_name(const CONF_IMODULE *md)
+const char * __cdecl CONF_imodule_get_name(const CONF_IMODULE *md)
 {
     return md->name;
 }
 
-const char *CONF_imodule_get_value(const CONF_IMODULE *md)
+const char * __cdecl CONF_imodule_get_value(const CONF_IMODULE *md)
 {
     return md->value;
 }
 
-void *CONF_imodule_get_usr_data(const CONF_IMODULE *md)
+void * __cdecl CONF_imodule_get_usr_data(const CONF_IMODULE *md)
 {
     return md->usr_data;
 }
 
-void CONF_imodule_set_usr_data(CONF_IMODULE *md, void *usr_data)
+void __cdecl CONF_imodule_set_usr_data(CONF_IMODULE *md, void *usr_data)
 {
     md->usr_data = usr_data;
 }
 
-CONF_MODULE *CONF_imodule_get_module(const CONF_IMODULE *md)
+CONF_MODULE * __cdecl CONF_imodule_get_module(const CONF_IMODULE *md)
 {
     return md->pmod;
 }
 
-unsigned long CONF_imodule_get_flags(const CONF_IMODULE *md)
+unsigned long __cdecl CONF_imodule_get_flags(const CONF_IMODULE *md)
 {
     return md->flags;
 }
 
-void CONF_imodule_set_flags(CONF_IMODULE *md, unsigned long flags)
+void __cdecl CONF_imodule_set_flags(CONF_IMODULE *md, unsigned long flags)
 {
     md->flags = flags;
 }
 
-void *CONF_module_get_usr_data(CONF_MODULE *pmod)
+void * __cdecl CONF_module_get_usr_data(CONF_MODULE *pmod)
 {
     return pmod->usr_data;
 }
 
-void CONF_module_set_usr_data(CONF_MODULE *pmod, void *usr_data)
+void __cdecl CONF_module_set_usr_data(CONF_MODULE *pmod, void *usr_data)
 {
     pmod->usr_data = usr_data;
 }
 
 /* Return default config file name */
 
-char *CONF_get1_default_config_file(void)
+char * __cdecl CONF_get1_default_config_file(void)
 {
     char *file, *sep = "";
     int len;
@@ -510,7 +510,7 @@ char *CONF_get1_default_config_file(void)
  * lists for example.
  */
 
-int CONF_parse_list(const char *list_, int sep, int nospc,
+int __cdecl CONF_parse_list(const char *list_, int sep, int nospc,
                     int (*list_cb) (const char *elem, int len, void *usr),
                     void *arg)
 {
diff --git a/crypto/cpt_err.c b/crypto/cpt_err.c
index 4147b1cb9e..e01ac49581 100644
--- a/crypto/cpt_err.c
+++ b/crypto/cpt_err.c
@@ -65,7 +65,7 @@ static const ERR_STRING_DATA CRYPTO_str_reasons[] = {
 
 #endif
 
-int ERR_load_CRYPTO_strings(void)
+int __cdecl ERR_load_CRYPTO_strings(void)
 {
 #ifndef OPENSSL_NO_ERR
     if (ERR_func_error_string(CRYPTO_str_functs[0].error) == NULL) {
diff --git a/crypto/cryptlib.c b/crypto/cryptlib.c
index 7b761a3adc..f91032571e 100644
--- a/crypto/cryptlib.c
+++ b/crypto/cryptlib.c
@@ -184,13 +184,13 @@ void OPENSSL_cpuid_setup(void)
 # if defined(_WIN32_WINNT) && _WIN32_WINNT>=0x0333
 #  ifdef OPENSSL_SYS_WIN_CORE
 
-int OPENSSL_isservice(void)
+int __cdecl OPENSSL_isservice(void)
 {
     /* OneCore API cannot interact with GUI */
     return 1;
 }
 #  else
-int OPENSSL_isservice(void)
+int __cdecl OPENSSL_isservice(void)
 {
     HWINSTA h;
     DWORD len;
@@ -252,7 +252,7 @@ int OPENSSL_isservice(void)
 }
 #  endif
 # else
-int OPENSSL_isservice(void)
+int __cdecl OPENSSL_isservice(void)
 {
     return 0;
 }
@@ -407,13 +407,13 @@ void OPENSSL_showfatal(const char *fmta, ...)
 #endif
 }
 
-int OPENSSL_isservice(void)
+int __cdecl OPENSSL_isservice(void)
 {
     return 0;
 }
 #endif
 
-void OPENSSL_die(const char *message, const char *file, int line)
+void __cdecl OPENSSL_die(const char *message, const char *file, int line)
 {
     OPENSSL_showfatal("%s:%d: OpenSSL internal error: %s\n",
                       file, line, message);
@@ -440,7 +440,7 @@ void OPENSSL_die(const char *message, const char *file, int line)
  * There are also assembler versions of this function.
  */
 # undef CRYPTO_memcmp
-int CRYPTO_memcmp(const void * in_a, const void * in_b, size_t len)
+int __cdecl CRYPTO_memcmp(const void * in_a, const void * in_b, size_t len)
 {
     size_t i;
     const volatile unsigned char *a = in_a;
diff --git a/crypto/ct/ct_b64.c b/crypto/ct/ct_b64.c
index 109ffcdcf2..96a0923227 100644
--- a/crypto/ct/ct_b64.c
+++ b/crypto/ct/ct_b64.c
@@ -60,7 +60,7 @@ err:
     return -1;
 }
 
-SCT *SCT_new_from_base64(unsigned char version, const char *logid_base64,
+SCT * __cdecl SCT_new_from_base64(unsigned char version, const char *logid_base64,
                          ct_log_entry_type_t entry_type, uint64_t timestamp,
                          const char *extensions_base64,
                          const char *signature_base64)
@@ -132,7 +132,7 @@ SCT *SCT_new_from_base64(unsigned char version, const char *logid_base64,
  * 0 on decoding failure, or invalid parameter if any
  * -1 on internal (malloc) failure
  */
-int CTLOG_new_from_base64(CTLOG **ct_log, const char *pkey_base64, const char *name)
+int __cdecl CTLOG_new_from_base64(CTLOG **ct_log, const char *pkey_base64, const char *name)
 {
     unsigned char *pkey_der = NULL;
     int pkey_der_len;
diff --git a/crypto/ct/ct_err.c b/crypto/ct/ct_err.c
index c0c62fee6c..6873d6869a 100644
--- a/crypto/ct/ct_err.c
+++ b/crypto/ct/ct_err.c
@@ -84,7 +84,7 @@ static const ERR_STRING_DATA CT_str_reasons[] = {
 
 #endif
 
-int ERR_load_CT_strings(void)
+int __cdecl ERR_load_CT_strings(void)
 {
 #ifndef OPENSSL_NO_ERR
     if (ERR_func_error_string(CT_str_functs[0].error) == NULL) {
diff --git a/crypto/ct/ct_log.c b/crypto/ct/ct_log.c
index c1bca3e141..b1478336c6 100644
--- a/crypto/ct/ct_log.c
+++ b/crypto/ct/ct_log.c
@@ -89,7 +89,7 @@ err:
     return ret;
 }
 
-CTLOG_STORE *CTLOG_STORE_new(void)
+CTLOG_STORE * __cdecl CTLOG_STORE_new(void)
 {
     CTLOG_STORE *ret = OPENSSL_zalloc(sizeof(*ret));
 
@@ -108,7 +108,7 @@ err:
     return NULL;
 }
 
-void CTLOG_STORE_free(CTLOG_STORE *store)
+void __cdecl CTLOG_STORE_free(CTLOG_STORE *store)
 {
     if (store != NULL) {
         sk_CTLOG_pop_free(store->logs, CTLOG_free);
@@ -135,7 +135,7 @@ static int ctlog_new_from_conf(CTLOG **ct_log, const CONF *conf, const char *sec
     return CTLOG_new_from_base64(ct_log, pkey_base64, description);
 }
 
-int CTLOG_STORE_load_default_file(CTLOG_STORE *store)
+int __cdecl CTLOG_STORE_load_default_file(CTLOG_STORE *store)
 {
     const char *fpath = ossl_safe_getenv(CTLOG_FILE_EVP);
 
@@ -192,7 +192,7 @@ mem_err:
     return -1;
 }
 
-int CTLOG_STORE_load_file(CTLOG_STORE *store, const char *file)
+int __cdecl CTLOG_STORE_load_file(CTLOG_STORE *store, const char *file)
 {
     int ret = 0;
     char *enabled_logs;
@@ -234,7 +234,7 @@ end:
  * Takes ownership of the public key.
  * Copies the name.
  */
-CTLOG *CTLOG_new(EVP_PKEY *public_key, const char *name)
+CTLOG * __cdecl CTLOG_new(EVP_PKEY *public_key, const char *name)
 {
     CTLOG *ret = OPENSSL_zalloc(sizeof(*ret));
 
@@ -260,7 +260,7 @@ err:
 }
 
 /* Frees CT log and associated structures */
-void CTLOG_free(CTLOG *log)
+void __cdecl CTLOG_free(CTLOG *log)
 {
     if (log != NULL) {
         OPENSSL_free(log->name);
@@ -269,19 +269,19 @@ void CTLOG_free(CTLOG *log)
     }
 }
 
-const char *CTLOG_get0_name(const CTLOG *log)
+const char * __cdecl CTLOG_get0_name(const CTLOG *log)
 {
     return log->name;
 }
 
-void CTLOG_get0_log_id(const CTLOG *log, const uint8_t **log_id,
+void __cdecl CTLOG_get0_log_id(const CTLOG *log, const uint8_t **log_id,
                        size_t *log_id_len)
 {
     *log_id = log->log_id;
     *log_id_len = CT_V1_HASHLEN;
 }
 
-EVP_PKEY *CTLOG_get0_public_key(const CTLOG *log)
+EVP_PKEY * __cdecl CTLOG_get0_public_key(const CTLOG *log)
 {
     return log->public_key;
 }
@@ -290,7 +290,7 @@ EVP_PKEY *CTLOG_get0_public_key(const CTLOG *log)
  * Given a log ID, finds the matching log.
  * Returns NULL if no match found.
  */
-const CTLOG *CTLOG_STORE_get0_log_by_id(const CTLOG_STORE *store,
+const CTLOG * __cdecl CTLOG_STORE_get0_log_by_id(const CTLOG_STORE *store,
                                         const uint8_t *log_id,
                                         size_t log_id_len)
 {
diff --git a/crypto/ct/ct_oct.c b/crypto/ct/ct_oct.c
index 0dd691c0f7..283c7fd229 100644
--- a/crypto/ct/ct_oct.c
+++ b/crypto/ct/ct_oct.c
@@ -67,7 +67,7 @@ int o2i_SCT_signature(SCT *sct, const unsigned char **in, size_t len)
     return len - len_remaining;
 }
 
-SCT *o2i_SCT(SCT **psct, const unsigned char **in, size_t len)
+SCT * __cdecl o2i_SCT(SCT **psct, const unsigned char **in, size_t len)
 {
     SCT *sct = NULL;
     const unsigned char *p;
@@ -197,7 +197,7 @@ err:
     return -1;
 }
 
-int i2o_SCT(const SCT *sct, unsigned char **out)
+int __cdecl i2o_SCT(const SCT *sct, unsigned char **out)
 {
     size_t len;
     unsigned char *p = NULL, *pstart = NULL;
@@ -254,7 +254,7 @@ err:
     return -1;
 }
 
-STACK_OF(SCT) *o2i_SCT_LIST(STACK_OF(SCT) **a, const unsigned char **pp,
+STACK_OF(SCT) * __cdecl o2i_SCT_LIST(STACK_OF(SCT) **a, const unsigned char **pp,
                             size_t len)
 {
     STACK_OF(SCT) *sk = NULL;
@@ -318,7 +318,7 @@ STACK_OF(SCT) *o2i_SCT_LIST(STACK_OF(SCT) **a, const unsigned char **pp,
     return NULL;
 }
 
-int i2o_SCT_LIST(const STACK_OF(SCT) *a, unsigned char **pp)
+int __cdecl i2o_SCT_LIST(const STACK_OF(SCT) *a, unsigned char **pp)
 {
     int len, sct_len, i, is_pp_new = 0;
     size_t len2;
@@ -373,7 +373,7 @@ int i2o_SCT_LIST(const STACK_OF(SCT) *a, unsigned char **pp)
     return -1;
 }
 
-STACK_OF(SCT) *d2i_SCT_LIST(STACK_OF(SCT) **a, const unsigned char **pp,
+STACK_OF(SCT) * __cdecl d2i_SCT_LIST(STACK_OF(SCT) **a, const unsigned char **pp,
                             long len)
 {
     ASN1_OCTET_STRING *oct = NULL;
@@ -392,7 +392,7 @@ STACK_OF(SCT) *d2i_SCT_LIST(STACK_OF(SCT) **a, const unsigned char **pp,
     return sk;
 }
 
-int i2d_SCT_LIST(const STACK_OF(SCT) *a, unsigned char **out)
+int __cdecl i2d_SCT_LIST(const STACK_OF(SCT) *a, unsigned char **out)
 {
     ASN1_OCTET_STRING oct;
     int len;
diff --git a/crypto/ct/ct_policy.c b/crypto/ct/ct_policy.c
index 0d7b346387..9ee70de48f 100644
--- a/crypto/ct/ct_policy.c
+++ b/crypto/ct/ct_policy.c
@@ -25,7 +25,7 @@
  */
 static const time_t SCT_CLOCK_DRIFT_TOLERANCE = 300;
 
-CT_POLICY_EVAL_CTX *CT_POLICY_EVAL_CTX_new(void)
+CT_POLICY_EVAL_CTX * __cdecl CT_POLICY_EVAL_CTX_new(void)
 {
     CT_POLICY_EVAL_CTX *ctx = OPENSSL_zalloc(sizeof(CT_POLICY_EVAL_CTX));
 
@@ -41,7 +41,7 @@ CT_POLICY_EVAL_CTX *CT_POLICY_EVAL_CTX_new(void)
     return ctx;
 }
 
-void CT_POLICY_EVAL_CTX_free(CT_POLICY_EVAL_CTX *ctx)
+void __cdecl CT_POLICY_EVAL_CTX_free(CT_POLICY_EVAL_CTX *ctx)
 {
     if (ctx == NULL)
         return;
@@ -50,7 +50,7 @@ void CT_POLICY_EVAL_CTX_free(CT_POLICY_EVAL_CTX *ctx)
     OPENSSL_free(ctx);
 }
 
-int CT_POLICY_EVAL_CTX_set1_cert(CT_POLICY_EVAL_CTX *ctx, X509 *cert)
+int __cdecl CT_POLICY_EVAL_CTX_set1_cert(CT_POLICY_EVAL_CTX *ctx, X509 *cert)
 {
     if (!X509_up_ref(cert))
         return 0;
@@ -58,7 +58,7 @@ int CT_POLICY_EVAL_CTX_set1_cert(CT_POLICY_EVAL_CTX *ctx, X509 *cert)
     return 1;
 }
 
-int CT_POLICY_EVAL_CTX_set1_issuer(CT_POLICY_EVAL_CTX *ctx, X509 *issuer)
+int __cdecl CT_POLICY_EVAL_CTX_set1_issuer(CT_POLICY_EVAL_CTX *ctx, X509 *issuer)
 {
     if (!X509_up_ref(issuer))
         return 0;
@@ -66,33 +66,33 @@ int CT_POLICY_EVAL_CTX_set1_issuer(CT_POLICY_EVAL_CTX *ctx, X509 *issuer)
     return 1;
 }
 
-void CT_POLICY_EVAL_CTX_set_shared_CTLOG_STORE(CT_POLICY_EVAL_CTX *ctx,
+void __cdecl CT_POLICY_EVAL_CTX_set_shared_CTLOG_STORE(CT_POLICY_EVAL_CTX *ctx,
                                                CTLOG_STORE *log_store)
 {
     ctx->log_store = log_store;
 }
 
-void CT_POLICY_EVAL_CTX_set_time(CT_POLICY_EVAL_CTX *ctx, uint64_t time_in_ms)
+void __cdecl CT_POLICY_EVAL_CTX_set_time(CT_POLICY_EVAL_CTX *ctx, uint64_t time_in_ms)
 {
     ctx->epoch_time_in_ms = time_in_ms;
 }
 
-X509* CT_POLICY_EVAL_CTX_get0_cert(const CT_POLICY_EVAL_CTX *ctx)
+X509* __cdecl CT_POLICY_EVAL_CTX_get0_cert(const CT_POLICY_EVAL_CTX *ctx)
 {
     return ctx->cert;
 }
 
-X509* CT_POLICY_EVAL_CTX_get0_issuer(const CT_POLICY_EVAL_CTX *ctx)
+X509* __cdecl CT_POLICY_EVAL_CTX_get0_issuer(const CT_POLICY_EVAL_CTX *ctx)
 {
     return ctx->issuer;
 }
 
-const CTLOG_STORE *CT_POLICY_EVAL_CTX_get0_log_store(const CT_POLICY_EVAL_CTX *ctx)
+const CTLOG_STORE * __cdecl CT_POLICY_EVAL_CTX_get0_log_store(const CT_POLICY_EVAL_CTX *ctx)
 {
     return ctx->log_store;
 }
 
-uint64_t CT_POLICY_EVAL_CTX_get_time(const CT_POLICY_EVAL_CTX *ctx)
+uint64_t __cdecl CT_POLICY_EVAL_CTX_get_time(const CT_POLICY_EVAL_CTX *ctx)
 {
     return ctx->epoch_time_in_ms;
 }
diff --git a/crypto/ct/ct_prn.c b/crypto/ct/ct_prn.c
index 376e04523e..1d96075d24 100644
--- a/crypto/ct/ct_prn.c
+++ b/crypto/ct/ct_prn.c
@@ -47,7 +47,7 @@ static void timestamp_print(uint64_t timestamp, BIO *out)
     ASN1_GENERALIZEDTIME_free(gen);
 }
 
-const char *SCT_validation_status_string(const SCT *sct)
+const char * __cdecl SCT_validation_status_string(const SCT *sct)
 {
 
     switch (SCT_get_validation_status(sct)) {
@@ -67,7 +67,7 @@ const char *SCT_validation_status_string(const SCT *sct)
     return "unknown status";
 }
 
-void SCT_print(const SCT *sct, BIO *out, int indent,
+void __cdecl SCT_print(const SCT *sct, BIO *out, int indent,
                const CTLOG_STORE *log_store)
 {
     const CTLOG *log = NULL;
@@ -111,7 +111,7 @@ void SCT_print(const SCT *sct, BIO *out, int indent,
     BIO_hex_string(out, indent + 16, 16, sct->sig, sct->sig_len);
 }
 
-void SCT_LIST_print(const STACK_OF(SCT) *sct_list, BIO *out, int indent,
+void __cdecl SCT_LIST_print(const STACK_OF(SCT) *sct_list, BIO *out, int indent,
                     const char *separator, const CTLOG_STORE *log_store)
 {
     int sct_count = sk_SCT_num(sct_list);
diff --git a/crypto/ct/ct_sct.c b/crypto/ct/ct_sct.c
index 1dc16857ba..7f209479ae 100644
--- a/crypto/ct/ct_sct.c
+++ b/crypto/ct/ct_sct.c
@@ -19,7 +19,7 @@
 
 #include "ct_locl.h"
 
-SCT *SCT_new(void)
+SCT * __cdecl SCT_new(void)
 {
     SCT *sct = OPENSSL_zalloc(sizeof(*sct));
 
@@ -33,7 +33,7 @@ SCT *SCT_new(void)
     return sct;
 }
 
-void SCT_free(SCT *sct)
+void __cdecl SCT_free(SCT *sct)
 {
     if (sct == NULL)
         return;
@@ -45,12 +45,12 @@ void SCT_free(SCT *sct)
     OPENSSL_free(sct);
 }
 
-void SCT_LIST_free(STACK_OF(SCT) *a)
+void __cdecl SCT_LIST_free(STACK_OF(SCT) *a)
 {
     sk_SCT_pop_free(a, SCT_free);
 }
 
-int SCT_set_version(SCT *sct, sct_version_t version)
+int __cdecl SCT_set_version(SCT *sct, sct_version_t version)
 {
     if (version != SCT_VERSION_V1) {
         CTerr(CT_F_SCT_SET_VERSION, CT_R_UNSUPPORTED_VERSION);
@@ -61,7 +61,7 @@ int SCT_set_version(SCT *sct, sct_version_t version)
     return 1;
 }
 
-int SCT_set_log_entry_type(SCT *sct, ct_log_entry_type_t entry_type)
+int __cdecl SCT_set_log_entry_type(SCT *sct, ct_log_entry_type_t entry_type)
 {
     sct->validation_status = SCT_VALIDATION_STATUS_NOT_SET;
 
@@ -77,7 +77,7 @@ int SCT_set_log_entry_type(SCT *sct, ct_log_entry_type_t entry_type)
     return 0;
 }
 
-int SCT_set0_log_id(SCT *sct, unsigned char *log_id, size_t log_id_len)
+int __cdecl SCT_set0_log_id(SCT *sct, unsigned char *log_id, size_t log_id_len)
 {
     if (sct->version == SCT_VERSION_V1 && log_id_len != CT_V1_HASHLEN) {
         CTerr(CT_F_SCT_SET0_LOG_ID, CT_R_INVALID_LOG_ID_LENGTH);
@@ -91,7 +91,7 @@ int SCT_set0_log_id(SCT *sct, unsigned char *log_id, size_t log_id_len)
     return 1;
 }
 
-int SCT_set1_log_id(SCT *sct, const unsigned char *log_id, size_t log_id_len)
+int __cdecl SCT_set1_log_id(SCT *sct, const unsigned char *log_id, size_t log_id_len)
 {
     if (sct->version == SCT_VERSION_V1 && log_id_len != CT_V1_HASHLEN) {
         CTerr(CT_F_SCT_SET1_LOG_ID, CT_R_INVALID_LOG_ID_LENGTH);
@@ -115,13 +115,13 @@ int SCT_set1_log_id(SCT *sct, const unsigned char *log_id, size_t log_id_len)
 }
 
 
-void SCT_set_timestamp(SCT *sct, uint64_t timestamp)
+void __cdecl SCT_set_timestamp(SCT *sct, uint64_t timestamp)
 {
     sct->timestamp = timestamp;
     sct->validation_status = SCT_VALIDATION_STATUS_NOT_SET;
 }
 
-int SCT_set_signature_nid(SCT *sct, int nid)
+int __cdecl SCT_set_signature_nid(SCT *sct, int nid)
 {
     switch (nid) {
     case NID_sha256WithRSAEncryption:
@@ -140,7 +140,7 @@ int SCT_set_signature_nid(SCT *sct, int nid)
     }
 }
 
-void SCT_set0_extensions(SCT *sct, unsigned char *ext, size_t ext_len)
+void __cdecl SCT_set0_extensions(SCT *sct, unsigned char *ext, size_t ext_len)
 {
     OPENSSL_free(sct->ext);
     sct->ext = ext;
@@ -148,7 +148,7 @@ void SCT_set0_extensions(SCT *sct, unsigned char *ext, size_t ext_len)
     sct->validation_status = SCT_VALIDATION_STATUS_NOT_SET;
 }
 
-int SCT_set1_extensions(SCT *sct, const unsigned char *ext, size_t ext_len)
+int __cdecl SCT_set1_extensions(SCT *sct, const unsigned char *ext, size_t ext_len)
 {
     OPENSSL_free(sct->ext);
     sct->ext = NULL;
@@ -166,7 +166,7 @@ int SCT_set1_extensions(SCT *sct, const unsigned char *ext, size_t ext_len)
     return 1;
 }
 
-void SCT_set0_signature(SCT *sct, unsigned char *sig, size_t sig_len)
+void __cdecl SCT_set0_signature(SCT *sct, unsigned char *sig, size_t sig_len)
 {
     OPENSSL_free(sct->sig);
     sct->sig = sig;
@@ -174,7 +174,7 @@ void SCT_set0_signature(SCT *sct, unsigned char *sig, size_t sig_len)
     sct->validation_status = SCT_VALIDATION_STATUS_NOT_SET;
 }
 
-int SCT_set1_signature(SCT *sct, const unsigned char *sig, size_t sig_len)
+int __cdecl SCT_set1_signature(SCT *sct, const unsigned char *sig, size_t sig_len)
 {
     OPENSSL_free(sct->sig);
     sct->sig = NULL;
@@ -192,28 +192,28 @@ int SCT_set1_signature(SCT *sct, const unsigned char *sig, size_t sig_len)
     return 1;
 }
 
-sct_version_t SCT_get_version(const SCT *sct)
+sct_version_t __cdecl SCT_get_version(const SCT *sct)
 {
     return sct->version;
 }
 
-ct_log_entry_type_t SCT_get_log_entry_type(const SCT *sct)
+ct_log_entry_type_t __cdecl SCT_get_log_entry_type(const SCT *sct)
 {
     return sct->entry_type;
 }
 
-size_t SCT_get0_log_id(const SCT *sct, unsigned char **log_id)
+size_t __cdecl SCT_get0_log_id(const SCT *sct, unsigned char **log_id)
 {
     *log_id = sct->log_id;
     return sct->log_id_len;
 }
 
-uint64_t SCT_get_timestamp(const SCT *sct)
+uint64_t __cdecl SCT_get_timestamp(const SCT *sct)
 {
     return sct->timestamp;
 }
 
-int SCT_get_signature_nid(const SCT *sct)
+int __cdecl SCT_get_signature_nid(const SCT *sct)
 {
     if (sct->version == SCT_VERSION_V1) {
         if (sct->hash_alg == TLSEXT_hash_sha256) {
@@ -230,13 +230,13 @@ int SCT_get_signature_nid(const SCT *sct)
     return NID_undef;
 }
 
-size_t SCT_get0_extensions(const SCT *sct, unsigned char **ext)
+size_t __cdecl SCT_get0_extensions(const SCT *sct, unsigned char **ext)
 {
     *ext = sct->ext;
     return sct->ext_len;
 }
 
-size_t SCT_get0_signature(const SCT *sct, unsigned char **sig)
+size_t __cdecl SCT_get0_signature(const SCT *sct, unsigned char **sig)
 {
     *sig = sct->sig;
     return sct->sig_len;
@@ -260,12 +260,12 @@ int SCT_signature_is_complete(const SCT *sct)
         sct->sig != NULL && sct->sig_len > 0;
 }
 
-sct_source_t SCT_get_source(const SCT *sct)
+sct_source_t __cdecl SCT_get_source(const SCT *sct)
 {
     return sct->source;
 }
 
-int SCT_set_source(SCT *sct, sct_source_t source)
+int __cdecl SCT_set_source(SCT *sct, sct_source_t source)
 {
     sct->source = source;
     sct->validation_status = SCT_VALIDATION_STATUS_NOT_SET;
@@ -282,12 +282,12 @@ int SCT_set_source(SCT *sct, sct_source_t source)
     return 1;
 }
 
-sct_validation_status_t SCT_get_validation_status(const SCT *sct)
+sct_validation_status_t __cdecl SCT_get_validation_status(const SCT *sct)
 {
     return sct->validation_status;
 }
 
-int SCT_validate(SCT *sct, const CT_POLICY_EVAL_CTX *ctx)
+int __cdecl SCT_validate(SCT *sct, const CT_POLICY_EVAL_CTX *ctx)
 {
     int is_sct_valid = -1;
     SCT_CTX *sctx = NULL;
@@ -373,7 +373,7 @@ err:
     return is_sct_valid;
 }
 
-int SCT_LIST_validate(const STACK_OF(SCT) *scts, CT_POLICY_EVAL_CTX *ctx)
+int __cdecl SCT_LIST_validate(const STACK_OF(SCT) *scts, CT_POLICY_EVAL_CTX *ctx)
 {
     int are_scts_valid = 1;
     int sct_count = scts != NULL ? sk_SCT_num(scts) : 0;
diff --git a/crypto/cversion.c b/crypto/cversion.c
index 534e7eba55..dae679e43d 100644
--- a/crypto/cversion.c
+++ b/crypto/cversion.c
@@ -11,12 +11,12 @@
 
 #include "buildinf.h"
 
-unsigned long OpenSSL_version_num(void)
+unsigned long __cdecl OpenSSL_version_num(void)
 {
     return OPENSSL_VERSION_NUMBER;
 }
 
-const char *OpenSSL_version(int t)
+const char * __cdecl OpenSSL_version(int t)
 {
     switch (t) {
     case OPENSSL_VERSION:
diff --git a/crypto/des/cbc_cksm.c b/crypto/des/cbc_cksm.c
index 5a1f72f82d..08eb1daeae 100644
--- a/crypto/des/cbc_cksm.c
+++ b/crypto/des/cbc_cksm.c
@@ -9,7 +9,7 @@
 
 #include "des_locl.h"
 
-DES_LONG DES_cbc_cksum(const unsigned char *in, DES_cblock *output,
+DES_LONG __cdecl DES_cbc_cksum(const unsigned char *in, DES_cblock *output,
                        long length, DES_key_schedule *schedule,
                        const_DES_cblock *ivec)
 {
diff --git a/crypto/des/cfb64ede.c b/crypto/des/cfb64ede.c
index 21943f6143..5787e2e741 100644
--- a/crypto/des/cfb64ede.c
+++ b/crypto/des/cfb64ede.c
@@ -15,7 +15,7 @@
  * used is contained in *num;
  */
 
-void DES_ede3_cfb64_encrypt(const unsigned char *in, unsigned char *out,
+void __cdecl DES_ede3_cfb64_encrypt(const unsigned char *in, unsigned char *out,
                             long length, DES_key_schedule *ks1,
                             DES_key_schedule *ks2, DES_key_schedule *ks3,
                             DES_cblock *ivec, int *num, int enc)
@@ -82,7 +82,7 @@ void DES_ede3_cfb64_encrypt(const unsigned char *in, unsigned char *out,
  * not what EVP needs.
  */
 
-void DES_ede3_cfb_encrypt(const unsigned char *in, unsigned char *out,
+void __cdecl DES_ede3_cfb_encrypt(const unsigned char *in, unsigned char *out,
                           int numbits, long length, DES_key_schedule *ks1,
                           DES_key_schedule *ks2, DES_key_schedule *ks3,
                           DES_cblock *ivec, int enc)
diff --git a/crypto/des/cfb64enc.c b/crypto/des/cfb64enc.c
index 96de51b055..fe5494e048 100644
--- a/crypto/des/cfb64enc.c
+++ b/crypto/des/cfb64enc.c
@@ -15,7 +15,7 @@
  * used is contained in *num;
  */
 
-void DES_cfb64_encrypt(const unsigned char *in, unsigned char *out,
+void __cdecl DES_cfb64_encrypt(const unsigned char *in, unsigned char *out,
                        long length, DES_key_schedule *schedule,
                        DES_cblock *ivec, int *num, int enc)
 {
diff --git a/crypto/des/cfb_enc.c b/crypto/des/cfb_enc.c
index 544392e405..038cc0b5c2 100644
--- a/crypto/des/cfb_enc.c
+++ b/crypto/des/cfb_enc.c
@@ -21,7 +21,7 @@
  * Until Aug 1 2003 this function did not correctly implement CFB-r, so it
  * will not be compatible with any encryption prior to that date. Ben.
  */
-void DES_cfb_encrypt(const unsigned char *in, unsigned char *out, int numbits,
+void __cdecl DES_cfb_encrypt(const unsigned char *in, unsigned char *out, int numbits,
                      long length, DES_key_schedule *schedule,
                      DES_cblock *ivec, int enc)
 {
diff --git a/crypto/des/des_enc.c b/crypto/des/des_enc.c
index ed134ace8c..cc26900077 100644
--- a/crypto/des/des_enc.c
+++ b/crypto/des/des_enc.c
@@ -11,7 +11,7 @@
 #include "des_locl.h"
 #include "spr.h"
 
-void DES_encrypt1(DES_LONG *data, DES_key_schedule *ks, int enc)
+void __cdecl DES_encrypt1(DES_LONG *data, DES_key_schedule *ks, int enc)
 {
     register DES_LONG l, r, t, u;
     register DES_LONG *s;
@@ -82,7 +82,7 @@ void DES_encrypt1(DES_LONG *data, DES_key_schedule *ks, int enc)
     l = r = t = u = 0;
 }
 
-void DES_encrypt2(DES_LONG *data, DES_key_schedule *ks, int enc)
+void __cdecl DES_encrypt2(DES_LONG *data, DES_key_schedule *ks, int enc)
 {
     register DES_LONG l, r, t, u;
     register DES_LONG *s;
@@ -146,7 +146,7 @@ void DES_encrypt2(DES_LONG *data, DES_key_schedule *ks, int enc)
     l = r = t = u = 0;
 }
 
-void DES_encrypt3(DES_LONG *data, DES_key_schedule *ks1,
+void __cdecl DES_encrypt3(DES_LONG *data, DES_key_schedule *ks1,
                   DES_key_schedule *ks2, DES_key_schedule *ks3)
 {
     register DES_LONG l, r;
@@ -166,7 +166,7 @@ void DES_encrypt3(DES_LONG *data, DES_key_schedule *ks1,
     data[1] = r;
 }
 
-void DES_decrypt3(DES_LONG *data, DES_key_schedule *ks1,
+void __cdecl DES_decrypt3(DES_LONG *data, DES_key_schedule *ks1,
                   DES_key_schedule *ks2, DES_key_schedule *ks3)
 {
     register DES_LONG l, r;
@@ -191,7 +191,7 @@ void DES_decrypt3(DES_LONG *data, DES_key_schedule *ks1,
 # undef CBC_ENC_C__DONT_UPDATE_IV
 # include "ncbc_enc.c"          /* DES_ncbc_encrypt */
 
-void DES_ede3_cbc_encrypt(const unsigned char *input, unsigned char *output,
+void __cdecl DES_ede3_cbc_encrypt(const unsigned char *input, unsigned char *output,
                           long length, DES_key_schedule *ks1,
                           DES_key_schedule *ks2, DES_key_schedule *ks3,
                           DES_cblock *ivec, int enc)
diff --git a/crypto/des/ecb3_enc.c b/crypto/des/ecb3_enc.c
index 6ac89d4e78..87d36b06f2 100644
--- a/crypto/des/ecb3_enc.c
+++ b/crypto/des/ecb3_enc.c
@@ -9,7 +9,7 @@
 
 #include "des_locl.h"
 
-void DES_ecb3_encrypt(const_DES_cblock *input, DES_cblock *output,
+void __cdecl DES_ecb3_encrypt(const_DES_cblock *input, DES_cblock *output,
                       DES_key_schedule *ks1, DES_key_schedule *ks2,
                       DES_key_schedule *ks3, int enc)
 {
diff --git a/crypto/des/ecb_enc.c b/crypto/des/ecb_enc.c
index 5ed079d15f..96283d0b72 100644
--- a/crypto/des/ecb_enc.c
+++ b/crypto/des/ecb_enc.c
@@ -12,7 +12,7 @@
 #include <openssl/bio.h>
 
 
-const char *DES_options(void)
+const char * __cdecl DES_options(void)
 {
     static int init = 1;
     static char buf[12];
@@ -27,7 +27,7 @@ const char *DES_options(void)
     return buf;
 }
 
-void DES_ecb_encrypt(const_DES_cblock *input, DES_cblock *output,
+void __cdecl DES_ecb_encrypt(const_DES_cblock *input, DES_cblock *output,
                      DES_key_schedule *ks, int enc)
 {
     register DES_LONG l;
diff --git a/crypto/des/fcrypt.c b/crypto/des/fcrypt.c
index aaee4bf236..c398fcc879 100644
--- a/crypto/des/fcrypt.c
+++ b/crypto/des/fcrypt.c
@@ -55,7 +55,7 @@ static unsigned const char cov_2char[64] = {
     0x73, 0x74, 0x75, 0x76, 0x77, 0x78, 0x79, 0x7A
 };
 
-char *DES_crypt(const char *buf, const char *salt)
+char * __cdecl DES_crypt(const char *buf, const char *salt)
 {
     static char buff[14];
 
@@ -88,7 +88,7 @@ char *DES_crypt(const char *buf, const char *salt)
 #endif
 }
 
-char *DES_fcrypt(const char *buf, const char *salt, char *ret)
+char * __cdecl DES_fcrypt(const char *buf, const char *salt, char *ret)
 {
     unsigned int i, j, x, y;
     DES_LONG Eswap0, Eswap1;
diff --git a/crypto/des/ncbc_enc.c b/crypto/des/ncbc_enc.c
index 244f15ca2a..6143a3a46d 100644
--- a/crypto/des/ncbc_enc.c
+++ b/crypto/des/ncbc_enc.c
@@ -16,10 +16,10 @@
 #include "des_locl.h"
 
 #ifdef CBC_ENC_C__DONT_UPDATE_IV
-void DES_cbc_encrypt(const unsigned char *in, unsigned char *out, long length,
+void __cdecl DES_cbc_encrypt(const unsigned char *in, unsigned char *out, long length,
                      DES_key_schedule *_schedule, DES_cblock *ivec, int enc)
 #else
-void DES_ncbc_encrypt(const unsigned char *in, unsigned char *out,
+void __cdecl DES_ncbc_encrypt(const unsigned char *in, unsigned char *out,
                       long length, DES_key_schedule *_schedule,
                       DES_cblock *ivec, int enc)
 #endif
diff --git a/crypto/des/ofb64ede.c b/crypto/des/ofb64ede.c
index a551a07e0e..321c627aa3 100644
--- a/crypto/des/ofb64ede.c
+++ b/crypto/des/ofb64ede.c
@@ -14,7 +14,7 @@
  * The extra state information to record how much of the 64bit block we have
  * used is contained in *num;
  */
-void DES_ede3_ofb64_encrypt(register const unsigned char *in,
+void __cdecl DES_ede3_ofb64_encrypt(register const unsigned char *in,
                             register unsigned char *out, long length,
                             DES_key_schedule *k1, DES_key_schedule *k2,
                             DES_key_schedule *k3, DES_cblock *ivec, int *num)
diff --git a/crypto/des/ofb64enc.c b/crypto/des/ofb64enc.c
index 30976c871d..cd8bb4894a 100644
--- a/crypto/des/ofb64enc.c
+++ b/crypto/des/ofb64enc.c
@@ -14,7 +14,7 @@
  * The extra state information to record how much of the 64bit block we have
  * used is contained in *num;
  */
-void DES_ofb64_encrypt(register const unsigned char *in,
+void __cdecl DES_ofb64_encrypt(register const unsigned char *in,
                        register unsigned char *out, long length,
                        DES_key_schedule *schedule, DES_cblock *ivec, int *num)
 {
diff --git a/crypto/des/ofb_enc.c b/crypto/des/ofb_enc.c
index 65a9b8604d..03b3aa5f64 100644
--- a/crypto/des/ofb_enc.c
+++ b/crypto/des/ofb_enc.c
@@ -15,7 +15,7 @@
  * retrieved from the first byte and half the second.  The second 12 bits
  * will come from the 3rd and half the 4th byte.
  */
-void DES_ofb_encrypt(const unsigned char *in, unsigned char *out, int numbits,
+void __cdecl DES_ofb_encrypt(const unsigned char *in, unsigned char *out, int numbits,
                      long length, DES_key_schedule *schedule,
                      DES_cblock *ivec)
 {
diff --git a/crypto/des/pcbc_enc.c b/crypto/des/pcbc_enc.c
index 0fa058f03f..eef34b6503 100644
--- a/crypto/des/pcbc_enc.c
+++ b/crypto/des/pcbc_enc.c
@@ -9,7 +9,7 @@
 
 #include "des_locl.h"
 
-void DES_pcbc_encrypt(const unsigned char *input, unsigned char *output,
+void __cdecl DES_pcbc_encrypt(const unsigned char *input, unsigned char *output,
                       long length, DES_key_schedule *schedule,
                       DES_cblock *ivec, int enc)
 {
diff --git a/crypto/des/qud_cksm.c b/crypto/des/qud_cksm.c
index 81e6be8226..283914f386 100644
--- a/crypto/des/qud_cksm.c
+++ b/crypto/des/qud_cksm.c
@@ -24,7 +24,7 @@
 /* Got the value MIT uses via brute force :-) 2/10/90 eay */
 #define NOISE   ((DES_LONG)83653421L)
 
-DES_LONG DES_quad_cksum(const unsigned char *input, DES_cblock output[],
+DES_LONG __cdecl DES_quad_cksum(const unsigned char *input, DES_cblock output[],
                         long length, int out_count, DES_cblock *seed)
 {
     DES_LONG z0, z1, t0, t1;
diff --git a/crypto/des/rand_key.c b/crypto/des/rand_key.c
index fe8aefec37..1ae58a94ad 100644
--- a/crypto/des/rand_key.c
+++ b/crypto/des/rand_key.c
@@ -10,7 +10,7 @@
 #include <openssl/des.h>
 #include <openssl/rand.h>
 
-int DES_random_key(DES_cblock *ret)
+int __cdecl DES_random_key(DES_cblock *ret)
 {
     do {
         if (RAND_priv_bytes((unsigned char *)ret, sizeof(DES_cblock)) != 1)
diff --git a/crypto/des/set_key.c b/crypto/des/set_key.c
index adbad72362..bb9663f51e 100644
--- a/crypto/des/set_key.c
+++ b/crypto/des/set_key.c
@@ -50,7 +50,7 @@ static const unsigned char odd_parity[256] = {
     254
 };
 
-void DES_set_odd_parity(DES_cblock *key)
+void __cdecl DES_set_odd_parity(DES_cblock *key)
 {
     unsigned int i;
 
@@ -58,7 +58,7 @@ void DES_set_odd_parity(DES_cblock *key)
         (*key)[i] = odd_parity[(*key)[i]];
 }
 
-int DES_check_key_parity(const_DES_cblock *key)
+int __cdecl DES_check_key_parity(const_DES_cblock *key)
 {
     unsigned int i;
 
@@ -99,7 +99,7 @@ static const DES_cblock weak_keys[NUM_WEAK_KEY] = {
     {0xFE, 0xE0, 0xFE, 0xE0, 0xFE, 0xF1, 0xFE, 0xF1}
 };
 
-int DES_is_weak_key(const_DES_cblock *key)
+int __cdecl DES_is_weak_key(const_DES_cblock *key)
 {
     int i;
 
@@ -275,7 +275,7 @@ static const DES_LONG des_skb[8][64] = {
      }
 };
 
-int DES_set_key(const_DES_cblock *key, DES_key_schedule *schedule)
+int __cdecl DES_set_key(const_DES_cblock *key, DES_key_schedule *schedule)
 {
     if (DES_check_key) {
         return DES_set_key_checked(key, schedule);
@@ -290,7 +290,7 @@ int DES_set_key(const_DES_cblock *key, DES_key_schedule *schedule)
  * return -1 if key parity error,
  * return -2 if illegal weak key.
  */
-int DES_set_key_checked(const_DES_cblock *key, DES_key_schedule *schedule)
+int __cdecl DES_set_key_checked(const_DES_cblock *key, DES_key_schedule *schedule)
 {
     if (!DES_check_key_parity(key))
         return -1;
@@ -300,7 +300,7 @@ int DES_set_key_checked(const_DES_cblock *key, DES_key_schedule *schedule)
     return 0;
 }
 
-void DES_set_key_unchecked(const_DES_cblock *key, DES_key_schedule *schedule)
+void __cdecl DES_set_key_unchecked(const_DES_cblock *key, DES_key_schedule *schedule)
 {
     static const int shifts2[16] =
         { 0, 0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 0 };
@@ -366,7 +366,7 @@ void DES_set_key_unchecked(const_DES_cblock *key, DES_key_schedule *schedule)
     }
 }
 
-int DES_key_sched(const_DES_cblock *key, DES_key_schedule *schedule)
+int __cdecl DES_key_sched(const_DES_cblock *key, DES_key_schedule *schedule)
 {
     return DES_set_key(key, schedule);
 }
diff --git a/crypto/des/str2key.c b/crypto/des/str2key.c
index e18d726522..0b290d9da5 100644
--- a/crypto/des/str2key.c
+++ b/crypto/des/str2key.c
@@ -10,7 +10,7 @@
 #include <openssl/crypto.h>
 #include "des_locl.h"
 
-void DES_string_to_key(const char *str, DES_cblock *key)
+void __cdecl DES_string_to_key(const char *str, DES_cblock *key)
 {
     DES_key_schedule ks;
     int i, length;
@@ -37,7 +37,7 @@ void DES_string_to_key(const char *str, DES_cblock *key)
     DES_set_odd_parity(key);
 }
 
-void DES_string_to_2keys(const char *str, DES_cblock *key1, DES_cblock *key2)
+void __cdecl DES_string_to_2keys(const char *str, DES_cblock *key1, DES_cblock *key2)
 {
     DES_key_schedule ks;
     int i, length;
diff --git a/crypto/des/xcbc_enc.c b/crypto/des/xcbc_enc.c
index c4e455d9b9..108e6d99af 100644
--- a/crypto/des/xcbc_enc.c
+++ b/crypto/des/xcbc_enc.c
@@ -11,7 +11,7 @@
 
 /* RSA's DESX */
 
-void DES_xcbc_encrypt(const unsigned char *in, unsigned char *out,
+void __cdecl DES_xcbc_encrypt(const unsigned char *in, unsigned char *out,
                       long length, DES_key_schedule *schedule,
                       DES_cblock *ivec, const_DES_cblock *inw,
                       const_DES_cblock *outw, int enc)
diff --git a/crypto/dh/dh_ameth.c b/crypto/dh/dh_ameth.c
index 05a1d4227e..bb1f2fe5b5 100644
--- a/crypto/dh/dh_ameth.c
+++ b/crypto/dh/dh_ameth.c
@@ -418,7 +418,7 @@ static int int_dh_param_copy(DH *to, const DH *from, int is_x942)
     return 1;
 }
 
-DH *DHparams_dup(DH *dh)
+DH * __cdecl DHparams_dup(DH *dh)
 {
     DH *ret;
     ret = DH_new();
@@ -477,7 +477,7 @@ static int dh_private_print(BIO *bp, const EVP_PKEY *pkey, int indent,
     return do_dh_print(bp, pkey->pkey.dh, indent, 2);
 }
 
-int DHparams_print(BIO *bp, const DH *x)
+int __cdecl DHparams_print(BIO *bp, const DH *x)
 {
     return do_dh_print(bp, x, 4, 0);
 }
diff --git a/crypto/dh/dh_asn1.c b/crypto/dh/dh_asn1.c
index 1a40633b48..812985b456 100644
--- a/crypto/dh/dh_asn1.c
+++ b/crypto/dh/dh_asn1.c
@@ -70,15 +70,15 @@ ASN1_SEQUENCE(DHxparams) = {
         ASN1_OPT(int_dhx942_dh, vparams, DHvparams),
 } static_ASN1_SEQUENCE_END_name(int_dhx942_dh, DHxparams)
 
-int_dhx942_dh *d2i_int_dhx(int_dhx942_dh **a,
+int_dhx942_dh * __cdecl d2i_int_dhx(int_dhx942_dh **a,
                            const unsigned char **pp, long length);
-int i2d_int_dhx(const int_dhx942_dh *a, unsigned char **pp);
+int __cdecl i2d_int_dhx(const int_dhx942_dh *a, unsigned char **pp);
 
 IMPLEMENT_ASN1_ENCODE_FUNCTIONS_const_fname(int_dhx942_dh, DHxparams, int_dhx)
 
 /* Application public function: read in X9.42 DH parameters into DH structure */
 
-DH *d2i_DHxparams(DH **a, const unsigned char **pp, long length)
+DH * __cdecl d2i_DHxparams(DH **a, const unsigned char **pp, long length)
 {
     int_dhx942_dh *dhx = NULL;
     DH *dh = NULL;
@@ -115,7 +115,7 @@ DH *d2i_DHxparams(DH **a, const unsigned char **pp, long length)
     return dh;
 }
 
-int i2d_DHxparams(const DH *dh, unsigned char **pp)
+int __cdecl i2d_DHxparams(const DH *dh, unsigned char **pp)
 {
     int_dhx942_dh dhx;
     int_dhvparams dhv;
diff --git a/crypto/dh/dh_check.c b/crypto/dh/dh_check.c
index d13d8206ce..6fd1ed4e24 100644
--- a/crypto/dh/dh_check.c
+++ b/crypto/dh/dh_check.c
@@ -20,7 +20,7 @@
  * p is odd
  * 1 < g < p - 1
  */
-int DH_check_params_ex(const DH *dh)
+int __cdecl DH_check_params_ex(const DH *dh)
 {
     int errflags = 0;
 
@@ -35,7 +35,7 @@ int DH_check_params_ex(const DH *dh)
     return errflags == 0;
 }
 
-int DH_check_params(const DH *dh, int *ret)
+int __cdecl DH_check_params(const DH *dh, int *ret)
 {
     int ok = 0;
     BIGNUM *tmp = NULL;
@@ -70,7 +70,7 @@ int DH_check_params(const DH *dh, int *ret)
  * Check that p is a safe prime and
  * g is a suitable generator.
  */
-int DH_check_ex(const DH *dh)
+int __cdecl DH_check_ex(const DH *dh)
 {
     int errflags = 0;
 
@@ -95,7 +95,7 @@ int DH_check_ex(const DH *dh)
     return errflags == 0;
 }
 
-int DH_check(const DH *dh, int *ret)
+int __cdecl DH_check(const DH *dh, int *ret)
 {
     int ok = 0, r;
     BN_CTX *ctx = NULL;
@@ -160,7 +160,7 @@ int DH_check(const DH *dh, int *ret)
     return ok;
 }
 
-int DH_check_pub_key_ex(const DH *dh, const BIGNUM *pub_key)
+int __cdecl DH_check_pub_key_ex(const DH *dh, const BIGNUM *pub_key)
 {
     int errflags = 0;
 
@@ -177,7 +177,7 @@ int DH_check_pub_key_ex(const DH *dh, const BIGNUM *pub_key)
     return errflags == 0;
 }
 
-int DH_check_pub_key(const DH *dh, const BIGNUM *pub_key, int *ret)
+int __cdecl DH_check_pub_key(const DH *dh, const BIGNUM *pub_key, int *ret)
 {
     int ok = 0;
     BIGNUM *tmp = NULL;
diff --git a/crypto/dh/dh_err.c b/crypto/dh/dh_err.c
index 7285587b4a..c0d1a0f856 100644
--- a/crypto/dh/dh_err.c
+++ b/crypto/dh/dh_err.c
@@ -89,7 +89,7 @@ static const ERR_STRING_DATA DH_str_reasons[] = {
 
 #endif
 
-int ERR_load_DH_strings(void)
+int __cdecl ERR_load_DH_strings(void)
 {
 #ifndef OPENSSL_NO_ERR
     if (ERR_func_error_string(DH_str_functs[0].error) == NULL) {
diff --git a/crypto/dh/dh_gen.c b/crypto/dh/dh_gen.c
index d293835eb2..20e3b0d4d7 100644
--- a/crypto/dh/dh_gen.c
+++ b/crypto/dh/dh_gen.c
@@ -20,7 +20,7 @@
 static int dh_builtin_genparams(DH *ret, int prime_len, int generator,
                                 BN_GENCB *cb);
 
-int DH_generate_parameters_ex(DH *ret, int prime_len, int generator,
+int __cdecl DH_generate_parameters_ex(DH *ret, int prime_len, int generator,
                               BN_GENCB *cb)
 {
     if (ret->meth->generate_params)
diff --git a/crypto/dh/dh_kdf.c b/crypto/dh/dh_kdf.c
index e17122bc82..1424edaa3e 100644
--- a/crypto/dh/dh_kdf.c
+++ b/crypto/dh/dh_kdf.c
@@ -95,7 +95,7 @@ static int dh_sharedinfo_encode(unsigned char **pder, unsigned char **pctr,
     return derlen;
 }
 
-int DH_KDF_X9_42(unsigned char *out, size_t outlen,
+int __cdecl DH_KDF_X9_42(unsigned char *out, size_t outlen,
                  const unsigned char *Z, size_t Zlen,
                  ASN1_OBJECT *key_oid,
                  const unsigned char *ukm, size_t ukmlen, const EVP_MD *md)
diff --git a/crypto/dh/dh_key.c b/crypto/dh/dh_key.c
index 718aa422d9..41e831df91 100644
--- a/crypto/dh/dh_key.c
+++ b/crypto/dh/dh_key.c
@@ -20,17 +20,17 @@ static int dh_bn_mod_exp(const DH *dh, BIGNUM *r,
 static int dh_init(DH *dh);
 static int dh_finish(DH *dh);
 
-int DH_generate_key(DH *dh)
+int __cdecl DH_generate_key(DH *dh)
 {
     return dh->meth->generate_key(dh);
 }
 
-int DH_compute_key(unsigned char *key, const BIGNUM *pub_key, DH *dh)
+int __cdecl DH_compute_key(unsigned char *key, const BIGNUM *pub_key, DH *dh)
 {
     return dh->meth->compute_key(key, pub_key, dh);
 }
 
-int DH_compute_key_padded(unsigned char *key, const BIGNUM *pub_key, DH *dh)
+int __cdecl DH_compute_key_padded(unsigned char *key, const BIGNUM *pub_key, DH *dh)
 {
     int rv, pad;
     rv = dh->meth->compute_key(key, pub_key, dh);
@@ -58,17 +58,17 @@ static DH_METHOD dh_ossl = {
 
 static const DH_METHOD *default_DH_method = &dh_ossl;
 
-const DH_METHOD *DH_OpenSSL(void)
+const DH_METHOD * __cdecl DH_OpenSSL(void)
 {
     return &dh_ossl;
 }
 
-void DH_set_default_method(const DH_METHOD *meth)
+void __cdecl DH_set_default_method(const DH_METHOD *meth)
 {
     default_DH_method = meth;
 }
 
-const DH_METHOD *DH_get_default_method(void)
+const DH_METHOD * __cdecl DH_get_default_method(void)
 {
     return default_DH_method;
 }
diff --git a/crypto/dh/dh_lib.c b/crypto/dh/dh_lib.c
index e7e7ef08e9..5b478956e6 100644
--- a/crypto/dh/dh_lib.c
+++ b/crypto/dh/dh_lib.c
@@ -14,7 +14,7 @@
 #include "dh_locl.h"
 #include <openssl/engine.h>
 
-int DH_set_method(DH *dh, const DH_METHOD *meth)
+int __cdecl DH_set_method(DH *dh, const DH_METHOD *meth)
 {
     /*
      * NB: The caller is specifically setting a method, so it's not up to us
@@ -34,12 +34,12 @@ int DH_set_method(DH *dh, const DH_METHOD *meth)
     return 1;
 }
 
-DH *DH_new(void)
+DH * __cdecl DH_new(void)
 {
     return DH_new_method(NULL);
 }
 
-DH *DH_new_method(ENGINE *engine)
+DH * __cdecl DH_new_method(ENGINE *engine)
 {
     DH *ret = OPENSSL_zalloc(sizeof(*ret));
 
@@ -93,7 +93,7 @@ DH *DH_new_method(ENGINE *engine)
     return NULL;
 }
 
-void DH_free(DH *r)
+void __cdecl DH_free(DH *r)
 {
     int i;
 
@@ -127,7 +127,7 @@ void DH_free(DH *r)
     OPENSSL_free(r);
 }
 
-int DH_up_ref(DH *r)
+int __cdecl DH_up_ref(DH *r)
 {
     int i;
 
@@ -139,27 +139,27 @@ int DH_up_ref(DH *r)
     return ((i > 1) ? 1 : 0);
 }
 
-int DH_set_ex_data(DH *d, int idx, void *arg)
+int __cdecl DH_set_ex_data(DH *d, int idx, void *arg)
 {
     return CRYPTO_set_ex_data(&d->ex_data, idx, arg);
 }
 
-void *DH_get_ex_data(DH *d, int idx)
+void * __cdecl DH_get_ex_data(DH *d, int idx)
 {
     return CRYPTO_get_ex_data(&d->ex_data, idx);
 }
 
-int DH_bits(const DH *dh)
+int __cdecl DH_bits(const DH *dh)
 {
     return BN_num_bits(dh->p);
 }
 
-int DH_size(const DH *dh)
+int __cdecl DH_size(const DH *dh)
 {
     return BN_num_bytes(dh->p);
 }
 
-int DH_security_bits(const DH *dh)
+int __cdecl DH_security_bits(const DH *dh)
 {
     int N;
     if (dh->q)
@@ -172,7 +172,7 @@ int DH_security_bits(const DH *dh)
 }
 
 
-void DH_get0_pqg(const DH *dh,
+void __cdecl DH_get0_pqg(const DH *dh,
                  const BIGNUM **p, const BIGNUM **q, const BIGNUM **g)
 {
     if (p != NULL)
@@ -183,7 +183,7 @@ void DH_get0_pqg(const DH *dh,
         *g = dh->g;
 }
 
-int DH_set0_pqg(DH *dh, BIGNUM *p, BIGNUM *q, BIGNUM *g)
+int __cdecl DH_set0_pqg(DH *dh, BIGNUM *p, BIGNUM *q, BIGNUM *g)
 {
     /* If the fields p and g in d are NULL, the corresponding input
      * parameters MUST be non-NULL.  q may remain NULL.
@@ -212,18 +212,18 @@ int DH_set0_pqg(DH *dh, BIGNUM *p, BIGNUM *q, BIGNUM *g)
     return 1;
 }
 
-long DH_get_length(const DH *dh)
+long __cdecl DH_get_length(const DH *dh)
 {
     return dh->length;
 }
 
-int DH_set_length(DH *dh, long length)
+int __cdecl DH_set_length(DH *dh, long length)
 {
     dh->length = length;
     return 1;
 }
 
-void DH_get0_key(const DH *dh, const BIGNUM **pub_key, const BIGNUM **priv_key)
+void __cdecl DH_get0_key(const DH *dh, const BIGNUM **pub_key, const BIGNUM **priv_key)
 {
     if (pub_key != NULL)
         *pub_key = dh->pub_key;
@@ -231,7 +231,7 @@ void DH_get0_key(const DH *dh, const BIGNUM **pub_key, const BIGNUM **priv_key)
         *priv_key = dh->priv_key;
 }
 
-int DH_set0_key(DH *dh, BIGNUM *pub_key, BIGNUM *priv_key)
+int __cdecl DH_set0_key(DH *dh, BIGNUM *pub_key, BIGNUM *priv_key)
 {
     if (pub_key != NULL) {
         BN_clear_free(dh->pub_key);
@@ -245,47 +245,47 @@ int DH_set0_key(DH *dh, BIGNUM *pub_key, BIGNUM *priv_key)
     return 1;
 }
 
-const BIGNUM *DH_get0_p(const DH *dh)
+const BIGNUM * __cdecl DH_get0_p(const DH *dh)
 {
     return dh->p;
 }
 
-const BIGNUM *DH_get0_q(const DH *dh)
+const BIGNUM * __cdecl DH_get0_q(const DH *dh)
 {
     return dh->q;
 }
 
-const BIGNUM *DH_get0_g(const DH *dh)
+const BIGNUM * __cdecl DH_get0_g(const DH *dh)
 {
     return dh->g;
 }
 
-const BIGNUM *DH_get0_priv_key(const DH *dh)
+const BIGNUM * __cdecl DH_get0_priv_key(const DH *dh)
 {
     return dh->priv_key;
 }
 
-const BIGNUM *DH_get0_pub_key(const DH *dh)
+const BIGNUM * __cdecl DH_get0_pub_key(const DH *dh)
 {
     return dh->pub_key;
 }
 
-void DH_clear_flags(DH *dh, int flags)
+void __cdecl DH_clear_flags(DH *dh, int flags)
 {
     dh->flags &= ~flags;
 }
 
-int DH_test_flags(const DH *dh, int flags)
+int __cdecl DH_test_flags(const DH *dh, int flags)
 {
     return dh->flags & flags;
 }
 
-void DH_set_flags(DH *dh, int flags)
+void __cdecl DH_set_flags(DH *dh, int flags)
 {
     dh->flags |= flags;
 }
 
-ENGINE *DH_get0_engine(DH *dh)
+ENGINE * __cdecl DH_get0_engine(DH *dh)
 {
     return dh->engine;
 }
diff --git a/crypto/dh/dh_meth.c b/crypto/dh/dh_meth.c
index 59c4d7e967..8e1c98640f 100644
--- a/crypto/dh/dh_meth.c
+++ b/crypto/dh/dh_meth.c
@@ -11,7 +11,7 @@
 #include <string.h>
 #include <openssl/err.h>
 
-DH_METHOD *DH_meth_new(const char *name, int flags)
+DH_METHOD * __cdecl DH_meth_new(const char *name, int flags)
 {
     DH_METHOD *dhm = OPENSSL_zalloc(sizeof(*dhm));
 
@@ -29,7 +29,7 @@ DH_METHOD *DH_meth_new(const char *name, int flags)
     return NULL;
 }
 
-void DH_meth_free(DH_METHOD *dhm)
+void __cdecl DH_meth_free(DH_METHOD *dhm)
 {
     if (dhm != NULL) {
         OPENSSL_free(dhm->name);
@@ -37,7 +37,7 @@ void DH_meth_free(DH_METHOD *dhm)
     }
 }
 
-DH_METHOD *DH_meth_dup(const DH_METHOD *dhm)
+DH_METHOD * __cdecl DH_meth_dup(const DH_METHOD *dhm)
 {
     DH_METHOD *ret = OPENSSL_malloc(sizeof(*ret));
 
@@ -55,12 +55,12 @@ DH_METHOD *DH_meth_dup(const DH_METHOD *dhm)
     return NULL;
 }
 
-const char *DH_meth_get0_name(const DH_METHOD *dhm)
+const char * __cdecl DH_meth_get0_name(const DH_METHOD *dhm)
 {
     return dhm->name;
 }
 
-int DH_meth_set1_name(DH_METHOD *dhm, const char *name)
+int __cdecl DH_meth_set1_name(DH_METHOD *dhm, const char *name)
 {
     char *tmpname = OPENSSL_strdup(name);
 
@@ -75,46 +75,46 @@ int DH_meth_set1_name(DH_METHOD *dhm, const char *name)
     return 1;
 }
 
-int DH_meth_get_flags(const DH_METHOD *dhm)
+int __cdecl DH_meth_get_flags(const DH_METHOD *dhm)
 {
     return dhm->flags;
 }
 
-int DH_meth_set_flags(DH_METHOD *dhm, int flags)
+int __cdecl DH_meth_set_flags(DH_METHOD *dhm, int flags)
 {
     dhm->flags = flags;
     return 1;
 }
 
-void *DH_meth_get0_app_data(const DH_METHOD *dhm)
+void * __cdecl DH_meth_get0_app_data(const DH_METHOD *dhm)
 {
     return dhm->app_data;
 }
 
-int DH_meth_set0_app_data(DH_METHOD *dhm, void *app_data)
+int __cdecl DH_meth_set0_app_data(DH_METHOD *dhm, void *app_data)
 {
     dhm->app_data = app_data;
     return 1;
 }
 
-int (*DH_meth_get_generate_key(const DH_METHOD *dhm)) (DH *)
+int (* __cdecl DH_meth_get_generate_key(const DH_METHOD *dhm)) (DH *)
 {
     return dhm->generate_key;
 }
 
-int DH_meth_set_generate_key(DH_METHOD *dhm, int (*generate_key) (DH *))
+int __cdecl DH_meth_set_generate_key(DH_METHOD *dhm, int (*generate_key) (DH *))
 {
     dhm->generate_key = generate_key;
     return 1;
 }
 
-int (*DH_meth_get_compute_key(const DH_METHOD *dhm))
+int (* __cdecl DH_meth_get_compute_key(const DH_METHOD *dhm))
         (unsigned char *key, const BIGNUM *pub_key, DH *dh)
 {
     return dhm->compute_key;
 }
 
-int DH_meth_set_compute_key(DH_METHOD *dhm,
+int __cdecl DH_meth_set_compute_key(DH_METHOD *dhm,
         int (*compute_key) (unsigned char *key, const BIGNUM *pub_key, DH *dh))
 {
     dhm->compute_key = compute_key;
@@ -122,14 +122,14 @@ int DH_meth_set_compute_key(DH_METHOD *dhm,
 }
 
 
-int (*DH_meth_get_bn_mod_exp(const DH_METHOD *dhm))
+int (* __cdecl DH_meth_get_bn_mod_exp(const DH_METHOD *dhm))
     (const DH *, BIGNUM *, const BIGNUM *, const BIGNUM *, const BIGNUM *,
      BN_CTX *, BN_MONT_CTX *)
 {
     return dhm->bn_mod_exp;
 }
 
-int DH_meth_set_bn_mod_exp(DH_METHOD *dhm,
+int __cdecl DH_meth_set_bn_mod_exp(DH_METHOD *dhm,
     int (*bn_mod_exp) (const DH *, BIGNUM *, const BIGNUM *, const BIGNUM *,
                        const BIGNUM *, BN_CTX *, BN_MONT_CTX *))
 {
@@ -137,35 +137,35 @@ int DH_meth_set_bn_mod_exp(DH_METHOD *dhm,
     return 1;
 }
 
-int (*DH_meth_get_init(const DH_METHOD *dhm))(DH *)
+int (* __cdecl DH_meth_get_init(const DH_METHOD *dhm))(DH *)
 {
     return dhm->init;
 }
 
-int DH_meth_set_init(DH_METHOD *dhm, int (*init)(DH *))
+int __cdecl DH_meth_set_init(DH_METHOD *dhm, int (*init)(DH *))
 {
     dhm->init = init;
     return 1;
 }
 
-int (*DH_meth_get_finish(const DH_METHOD *dhm)) (DH *)
+int (* __cdecl DH_meth_get_finish(const DH_METHOD *dhm)) (DH *)
 {
     return dhm->finish;
 }
 
-int DH_meth_set_finish(DH_METHOD *dhm, int (*finish) (DH *))
+int __cdecl DH_meth_set_finish(DH_METHOD *dhm, int (*finish) (DH *))
 {
     dhm->finish = finish;
     return 1;
 }
 
-int (*DH_meth_get_generate_params(const DH_METHOD *dhm))
+int (* __cdecl DH_meth_get_generate_params(const DH_METHOD *dhm))
         (DH *, int, int, BN_GENCB *)
 {
     return dhm->generate_params;
 }
 
-int DH_meth_set_generate_params(DH_METHOD *dhm,
+int __cdecl DH_meth_set_generate_params(DH_METHOD *dhm,
         int (*generate_params) (DH *, int, int, BN_GENCB *))
 {
     dhm->generate_params = generate_params;
diff --git a/crypto/dh/dh_prn.c b/crypto/dh/dh_prn.c
index aab1733db3..a92bc8c4f0 100644
--- a/crypto/dh/dh_prn.c
+++ b/crypto/dh/dh_prn.c
@@ -13,7 +13,7 @@
 #include <openssl/dh.h>
 
 #ifndef OPENSSL_NO_STDIO
-int DHparams_print_fp(FILE *fp, const DH *x)
+int __cdecl DHparams_print_fp(FILE *fp, const DH *x)
 {
     BIO *b;
     int ret;
diff --git a/crypto/dh/dh_rfc5114.c b/crypto/dh/dh_rfc5114.c
index c4a219590e..da0aa66125 100644
--- a/crypto/dh/dh_rfc5114.c
+++ b/crypto/dh/dh_rfc5114.c
@@ -20,7 +20,7 @@
  */
 
 #define make_dh(x) \
-DH *DH_get_##x(void) \
+DH * __cdecl DH_get_##x(void) \
 { \
     DH *dh = DH_new(); \
 \
diff --git a/crypto/dh/dh_rfc7919.c b/crypto/dh/dh_rfc7919.c
index a54b468e55..1395473199 100644
--- a/crypto/dh/dh_rfc7919.c
+++ b/crypto/dh/dh_rfc7919.c
@@ -25,7 +25,7 @@ static DH *dh_param_init(const BIGNUM *p, int32_t nbits)
     return dh;
 }
 
-DH *DH_new_by_nid(int nid)
+DH * __cdecl DH_new_by_nid(int nid)
 {
     switch (nid) {
     case NID_ffdhe2048:
@@ -44,7 +44,7 @@ DH *DH_new_by_nid(int nid)
     }
 }
 
-int DH_get_nid(const DH *dh)
+int __cdecl DH_get_nid(const DH *dh)
 {
     int nid;
 
diff --git a/crypto/dsa/dsa_asn1.c b/crypto/dsa/dsa_asn1.c
index 6499e87ef3..6212c3abae 100644
--- a/crypto/dsa/dsa_asn1.c
+++ b/crypto/dsa/dsa_asn1.c
@@ -21,7 +21,7 @@ ASN1_SEQUENCE(DSA_SIG) = {
 
 IMPLEMENT_ASN1_ENCODE_FUNCTIONS_const_fname(DSA_SIG, DSA_SIG, DSA_SIG)
 
-DSA_SIG *DSA_SIG_new(void)
+DSA_SIG * __cdecl DSA_SIG_new(void)
 {
     DSA_SIG *sig = OPENSSL_zalloc(sizeof(*sig));
     if (sig == NULL)
@@ -29,7 +29,7 @@ DSA_SIG *DSA_SIG_new(void)
     return sig;
 }
 
-void DSA_SIG_free(DSA_SIG *sig)
+void __cdecl DSA_SIG_free(DSA_SIG *sig)
 {
     if (sig == NULL)
         return;
@@ -38,7 +38,7 @@ void DSA_SIG_free(DSA_SIG *sig)
     OPENSSL_free(sig);
 }
 
-void DSA_SIG_get0(const DSA_SIG *sig, const BIGNUM **pr, const BIGNUM **ps)
+void __cdecl DSA_SIG_get0(const DSA_SIG *sig, const BIGNUM **pr, const BIGNUM **ps)
 {
     if (pr != NULL)
         *pr = sig->r;
@@ -46,7 +46,7 @@ void DSA_SIG_get0(const DSA_SIG *sig, const BIGNUM **pr, const BIGNUM **ps)
         *ps = sig->s;
 }
 
-int DSA_SIG_set0(DSA_SIG *sig, BIGNUM *r, BIGNUM *s)
+int __cdecl DSA_SIG_set0(DSA_SIG *sig, BIGNUM *r, BIGNUM *s)
 {
     if (r == NULL || s == NULL)
         return 0;
@@ -102,12 +102,12 @@ ASN1_SEQUENCE_cb(DSAPublicKey, dsa_cb) = {
 
 IMPLEMENT_ASN1_ENCODE_FUNCTIONS_const_fname(DSA, DSAPublicKey, DSAPublicKey)
 
-DSA *DSAparams_dup(DSA *dsa)
+DSA * __cdecl DSAparams_dup(DSA *dsa)
 {
     return ASN1_item_dup(ASN1_ITEM_rptr(DSAparams), dsa);
 }
 
-int DSA_sign(int type, const unsigned char *dgst, int dlen,
+int __cdecl DSA_sign(int type, const unsigned char *dgst, int dlen,
              unsigned char *sig, unsigned int *siglen, DSA *dsa)
 {
     DSA_SIG *s;
@@ -129,7 +129,7 @@ int DSA_sign(int type, const unsigned char *dgst, int dlen,
  *      0: incorrect signature
  *     -1: error
  */
-int DSA_verify(int type, const unsigned char *dgst, int dgst_len,
+int __cdecl DSA_verify(int type, const unsigned char *dgst, int dgst_len,
                const unsigned char *sigbuf, int siglen, DSA *dsa)
 {
     DSA_SIG *s;
diff --git a/crypto/dsa/dsa_err.c b/crypto/dsa/dsa_err.c
index 8dcf0548ac..5503fc2534 100644
--- a/crypto/dsa/dsa_err.c
+++ b/crypto/dsa/dsa_err.c
@@ -66,7 +66,7 @@ static const ERR_STRING_DATA DSA_str_reasons[] = {
 
 #endif
 
-int ERR_load_DSA_strings(void)
+int __cdecl ERR_load_DSA_strings(void)
 {
 #ifndef OPENSSL_NO_ERR
     if (ERR_func_error_string(DSA_str_functs[0].error) == NULL) {
diff --git a/crypto/dsa/dsa_gen.c b/crypto/dsa/dsa_gen.c
index af59a582b5..adf6d55561 100644
--- a/crypto/dsa/dsa_gen.c
+++ b/crypto/dsa/dsa_gen.c
@@ -23,7 +23,7 @@
 #include <openssl/sha.h>
 #include "dsa_locl.h"
 
-int DSA_generate_parameters_ex(DSA *ret, int bits,
+int __cdecl DSA_generate_parameters_ex(DSA *ret, int bits,
                                const unsigned char *seed_in, int seed_len,
                                int *counter_ret, unsigned long *h_ret,
                                BN_GENCB *cb)
diff --git a/crypto/dsa/dsa_key.c b/crypto/dsa/dsa_key.c
index a48af58492..7e5140c1bf 100644
--- a/crypto/dsa/dsa_key.c
+++ b/crypto/dsa/dsa_key.c
@@ -15,7 +15,7 @@
 
 static int dsa_builtin_keygen(DSA *dsa);
 
-int DSA_generate_key(DSA *dsa)
+int __cdecl DSA_generate_key(DSA *dsa)
 {
     if (dsa->meth->dsa_keygen)
         return dsa->meth->dsa_keygen(dsa);
diff --git a/crypto/dsa/dsa_lib.c b/crypto/dsa/dsa_lib.c
index 1048601beb..686d1c6532 100644
--- a/crypto/dsa/dsa_lib.c
+++ b/crypto/dsa/dsa_lib.c
@@ -16,12 +16,12 @@
 #include <openssl/engine.h>
 #include <openssl/dh.h>
 
-DSA *DSA_new(void)
+DSA * __cdecl DSA_new(void)
 {
     return DSA_new_method(NULL);
 }
 
-int DSA_set_method(DSA *dsa, const DSA_METHOD *meth)
+int __cdecl DSA_set_method(DSA *dsa, const DSA_METHOD *meth)
 {
     /*
      * NB: The caller is specifically setting a method, so it's not up to us
@@ -41,12 +41,12 @@ int DSA_set_method(DSA *dsa, const DSA_METHOD *meth)
     return 1;
 }
 
-const DSA_METHOD *DSA_get_method(DSA *d)
+const DSA_METHOD * __cdecl DSA_get_method(DSA *d)
 {
     return d->meth;
 }
 
-DSA *DSA_new_method(ENGINE *engine)
+DSA * __cdecl DSA_new_method(ENGINE *engine)
 {
     DSA *ret = OPENSSL_zalloc(sizeof(*ret));
 
@@ -100,7 +100,7 @@ DSA *DSA_new_method(ENGINE *engine)
     return NULL;
 }
 
-void DSA_free(DSA *r)
+void __cdecl DSA_free(DSA *r)
 {
     int i;
 
@@ -131,7 +131,7 @@ void DSA_free(DSA *r)
     OPENSSL_free(r);
 }
 
-int DSA_up_ref(DSA *r)
+int __cdecl DSA_up_ref(DSA *r)
 {
     int i;
 
@@ -143,7 +143,7 @@ int DSA_up_ref(DSA *r)
     return ((i > 1) ? 1 : 0);
 }
 
-int DSA_size(const DSA *r)
+int __cdecl DSA_size(const DSA *r)
 {
     int ret, i;
     ASN1_INTEGER bs;
@@ -165,17 +165,17 @@ int DSA_size(const DSA *r)
     return ret;
 }
 
-int DSA_set_ex_data(DSA *d, int idx, void *arg)
+int __cdecl DSA_set_ex_data(DSA *d, int idx, void *arg)
 {
     return CRYPTO_set_ex_data(&d->ex_data, idx, arg);
 }
 
-void *DSA_get_ex_data(DSA *d, int idx)
+void * __cdecl DSA_get_ex_data(DSA *d, int idx)
 {
     return CRYPTO_get_ex_data(&d->ex_data, idx);
 }
 
-int DSA_security_bits(const DSA *d)
+int __cdecl DSA_security_bits(const DSA *d)
 {
     if (d->p && d->q)
         return BN_security_bits(BN_num_bits(d->p), BN_num_bits(d->q));
@@ -183,7 +183,7 @@ int DSA_security_bits(const DSA *d)
 }
 
 #ifndef OPENSSL_NO_DH
-DH *DSA_dup_DH(const DSA *r)
+DH * __cdecl DSA_dup_DH(const DSA *r)
 {
     /*
      * DSA has p, q, g, optional pub_key, optional priv_key. DH has p,
@@ -240,7 +240,7 @@ DH *DSA_dup_DH(const DSA *r)
 }
 #endif
 
-void DSA_get0_pqg(const DSA *d,
+void __cdecl DSA_get0_pqg(const DSA *d,
                   const BIGNUM **p, const BIGNUM **q, const BIGNUM **g)
 {
     if (p != NULL)
@@ -251,7 +251,7 @@ void DSA_get0_pqg(const DSA *d,
         *g = d->g;
 }
 
-int DSA_set0_pqg(DSA *d, BIGNUM *p, BIGNUM *q, BIGNUM *g)
+int __cdecl DSA_set0_pqg(DSA *d, BIGNUM *p, BIGNUM *q, BIGNUM *g)
 {
     /* If the fields p, q and g in d are NULL, the corresponding input
      * parameters MUST be non-NULL.
@@ -277,7 +277,7 @@ int DSA_set0_pqg(DSA *d, BIGNUM *p, BIGNUM *q, BIGNUM *g)
     return 1;
 }
 
-void DSA_get0_key(const DSA *d,
+void __cdecl DSA_get0_key(const DSA *d,
                   const BIGNUM **pub_key, const BIGNUM **priv_key)
 {
     if (pub_key != NULL)
@@ -286,7 +286,7 @@ void DSA_get0_key(const DSA *d,
         *priv_key = d->priv_key;
 }
 
-int DSA_set0_key(DSA *d, BIGNUM *pub_key, BIGNUM *priv_key)
+int __cdecl DSA_set0_key(DSA *d, BIGNUM *pub_key, BIGNUM *priv_key)
 {
     /* If the field pub_key in d is NULL, the corresponding input
      * parameters MUST be non-NULL.  The priv_key field may
@@ -307,52 +307,52 @@ int DSA_set0_key(DSA *d, BIGNUM *pub_key, BIGNUM *priv_key)
     return 1;
 }
 
-const BIGNUM *DSA_get0_p(const DSA *d)
+const BIGNUM * __cdecl DSA_get0_p(const DSA *d)
 {
     return d->p;
 }
 
-const BIGNUM *DSA_get0_q(const DSA *d)
+const BIGNUM * __cdecl DSA_get0_q(const DSA *d)
 {
     return d->q;
 }
 
-const BIGNUM *DSA_get0_g(const DSA *d)
+const BIGNUM * __cdecl DSA_get0_g(const DSA *d)
 {
     return d->g;
 }
 
-const BIGNUM *DSA_get0_pub_key(const DSA *d)
+const BIGNUM * __cdecl DSA_get0_pub_key(const DSA *d)
 {
     return d->pub_key;
 }
 
-const BIGNUM *DSA_get0_priv_key(const DSA *d)
+const BIGNUM * __cdecl DSA_get0_priv_key(const DSA *d)
 {
     return d->priv_key;
 }
 
-void DSA_clear_flags(DSA *d, int flags)
+void __cdecl DSA_clear_flags(DSA *d, int flags)
 {
     d->flags &= ~flags;
 }
 
-int DSA_test_flags(const DSA *d, int flags)
+int __cdecl DSA_test_flags(const DSA *d, int flags)
 {
     return d->flags & flags;
 }
 
-void DSA_set_flags(DSA *d, int flags)
+void __cdecl DSA_set_flags(DSA *d, int flags)
 {
     d->flags |= flags;
 }
 
-ENGINE *DSA_get0_engine(DSA *d)
+ENGINE * __cdecl DSA_get0_engine(DSA *d)
 {
     return d->engine;
 }
 
-int DSA_bits(const DSA *dsa)
+int __cdecl DSA_bits(const DSA *dsa)
 {
     return BN_num_bits(dsa->p);
 }
diff --git a/crypto/dsa/dsa_locl.h b/crypto/dsa/dsa_locl.h
index a81a4b4978..96310a6585 100644
--- a/crypto/dsa/dsa_locl.h
+++ b/crypto/dsa/dsa_locl.h
@@ -40,7 +40,7 @@ struct DSA_SIG_st {
 
 struct dsa_method {
     char *name;
-    DSA_SIG *(*dsa_do_sign) (const unsigned char *dgst, int dlen, DSA *dsa);
+    DSA_SIG *(__cdecl *dsa_do_sign) (const unsigned char *dgst, int dlen, DSA *dsa);
     int (*dsa_sign_setup) (DSA *dsa, BN_CTX *ctx_in, BIGNUM **kinvp,
                            BIGNUM **rp);
     int (*dsa_do_verify) (const unsigned char *dgst, int dgst_len,
diff --git a/crypto/dsa/dsa_meth.c b/crypto/dsa/dsa_meth.c
index ff4fae44a7..c7c5eae75d 100644
--- a/crypto/dsa/dsa_meth.c
+++ b/crypto/dsa/dsa_meth.c
@@ -19,7 +19,7 @@
 #include <string.h>
 #include <openssl/err.h>
 
-DSA_METHOD *DSA_meth_new(const char *name, int flags)
+DSA_METHOD * __cdecl DSA_meth_new(const char *name, int flags)
 {
     DSA_METHOD *dsam = OPENSSL_zalloc(sizeof(*dsam));
 
@@ -37,7 +37,7 @@ DSA_METHOD *DSA_meth_new(const char *name, int flags)
     return NULL;
 }
 
-void DSA_meth_free(DSA_METHOD *dsam)
+void __cdecl DSA_meth_free(DSA_METHOD *dsam)
 {
     if (dsam != NULL) {
         OPENSSL_free(dsam->name);
@@ -45,7 +45,7 @@ void DSA_meth_free(DSA_METHOD *dsam)
     }
 }
 
-DSA_METHOD *DSA_meth_dup(const DSA_METHOD *dsam)
+DSA_METHOD * __cdecl DSA_meth_dup(const DSA_METHOD *dsam)
 {
     DSA_METHOD *ret = OPENSSL_malloc(sizeof(*ret));
 
@@ -63,12 +63,12 @@ DSA_METHOD *DSA_meth_dup(const DSA_METHOD *dsam)
     return NULL;
 }
 
-const char *DSA_meth_get0_name(const DSA_METHOD *dsam)
+const char * __cdecl DSA_meth_get0_name(const DSA_METHOD *dsam)
 {
     return dsam->name;
 }
 
-int DSA_meth_set1_name(DSA_METHOD *dsam, const char *name)
+int __cdecl DSA_meth_set1_name(DSA_METHOD *dsam, const char *name)
 {
     char *tmpname = OPENSSL_strdup(name);
 
@@ -83,75 +83,75 @@ int DSA_meth_set1_name(DSA_METHOD *dsam, const char *name)
     return 1;
 }
 
-int DSA_meth_get_flags(const DSA_METHOD *dsam)
+int __cdecl DSA_meth_get_flags(const DSA_METHOD *dsam)
 {
     return dsam->flags;
 }
 
-int DSA_meth_set_flags(DSA_METHOD *dsam, int flags)
+int __cdecl DSA_meth_set_flags(DSA_METHOD *dsam, int flags)
 {
     dsam->flags = flags;
     return 1;
 }
 
-void *DSA_meth_get0_app_data(const DSA_METHOD *dsam)
+void * __cdecl DSA_meth_get0_app_data(const DSA_METHOD *dsam)
 {
     return dsam->app_data;
 }
 
-int DSA_meth_set0_app_data(DSA_METHOD *dsam, void *app_data)
+int __cdecl DSA_meth_set0_app_data(DSA_METHOD *dsam, void *app_data)
 {
     dsam->app_data = app_data;
     return 1;
 }
 
-DSA_SIG *(*DSA_meth_get_sign(const DSA_METHOD *dsam))
+DSA_SIG *(__cdecl *DSA_meth_get_sign(const DSA_METHOD *dsam))
         (const unsigned char *, int, DSA *)
 {
     return dsam->dsa_do_sign;
 }
 
-int DSA_meth_set_sign(DSA_METHOD *dsam,
-                       DSA_SIG *(*sign) (const unsigned char *, int, DSA *))
+int __cdecl DSA_meth_set_sign(DSA_METHOD *dsam,
+                       DSA_SIG *(__cdecl *sign) (const unsigned char *, int, DSA *))
 {
     dsam->dsa_do_sign = sign;
     return 1;
 }
 
-int (*DSA_meth_get_sign_setup(const DSA_METHOD *dsam))
+int (* __cdecl DSA_meth_get_sign_setup(const DSA_METHOD *dsam))
         (DSA *, BN_CTX *, BIGNUM **, BIGNUM **)
 {
     return dsam->dsa_sign_setup;
 }
 
-int DSA_meth_set_sign_setup(DSA_METHOD *dsam,
+int __cdecl DSA_meth_set_sign_setup(DSA_METHOD *dsam,
         int (*sign_setup) (DSA *, BN_CTX *, BIGNUM **, BIGNUM **))
 {
     dsam->dsa_sign_setup = sign_setup;
     return 1;
 }
 
-int (*DSA_meth_get_verify(const DSA_METHOD *dsam))
+int (* __cdecl DSA_meth_get_verify(const DSA_METHOD *dsam))
         (const unsigned char *, int, DSA_SIG *, DSA *)
 {
     return dsam->dsa_do_verify;
 }
 
-int DSA_meth_set_verify(DSA_METHOD *dsam,
+int __cdecl DSA_meth_set_verify(DSA_METHOD *dsam,
     int (*verify) (const unsigned char *, int, DSA_SIG *, DSA *))
 {
     dsam->dsa_do_verify = verify;
     return 1;
 }
 
-int (*DSA_meth_get_mod_exp(const DSA_METHOD *dsam))
+int (* __cdecl DSA_meth_get_mod_exp(const DSA_METHOD *dsam))
         (DSA *, BIGNUM *, const BIGNUM *, const BIGNUM *, const BIGNUM *,
          const BIGNUM *, const BIGNUM *, BN_CTX *, BN_MONT_CTX *)
 {
     return dsam->dsa_mod_exp;
 }
 
-int DSA_meth_set_mod_exp(DSA_METHOD *dsam,
+int __cdecl DSA_meth_set_mod_exp(DSA_METHOD *dsam,
     int (*mod_exp) (DSA *, BIGNUM *, const BIGNUM *, const BIGNUM *,
                     const BIGNUM *, const BIGNUM *, const BIGNUM *, BN_CTX *,
                     BN_MONT_CTX *))
@@ -160,14 +160,14 @@ int DSA_meth_set_mod_exp(DSA_METHOD *dsam,
     return 1;
 }
 
-int (*DSA_meth_get_bn_mod_exp(const DSA_METHOD *dsam))
+int (* __cdecl DSA_meth_get_bn_mod_exp(const DSA_METHOD *dsam))
     (DSA *, BIGNUM *, const BIGNUM *, const BIGNUM *, const BIGNUM *, BN_CTX *,
      BN_MONT_CTX *)
 {
     return dsam->bn_mod_exp;
 }
 
-int DSA_meth_set_bn_mod_exp(DSA_METHOD *dsam,
+int __cdecl DSA_meth_set_bn_mod_exp(DSA_METHOD *dsam,
     int (*bn_mod_exp) (DSA *, BIGNUM *, const BIGNUM *, const BIGNUM *,
                        const BIGNUM *, BN_CTX *, BN_MONT_CTX *))
 {
@@ -175,36 +175,36 @@ int DSA_meth_set_bn_mod_exp(DSA_METHOD *dsam,
     return 1;
 }
 
-int (*DSA_meth_get_init(const DSA_METHOD *dsam))(DSA *)
+int (* __cdecl DSA_meth_get_init(const DSA_METHOD *dsam))(DSA *)
 {
     return dsam->init;
 }
 
-int DSA_meth_set_init(DSA_METHOD *dsam, int (*init)(DSA *))
+int __cdecl DSA_meth_set_init(DSA_METHOD *dsam, int (*init)(DSA *))
 {
     dsam->init = init;
     return 1;
 }
 
-int (*DSA_meth_get_finish(const DSA_METHOD *dsam)) (DSA *)
+int (* __cdecl DSA_meth_get_finish(const DSA_METHOD *dsam)) (DSA *)
 {
     return dsam->finish;
 }
 
-int DSA_meth_set_finish(DSA_METHOD *dsam, int (*finish) (DSA *))
+int __cdecl DSA_meth_set_finish(DSA_METHOD *dsam, int (*finish) (DSA *))
 {
     dsam->finish = finish;
     return 1;
 }
 
-int (*DSA_meth_get_paramgen(const DSA_METHOD *dsam))
+int (* __cdecl DSA_meth_get_paramgen(const DSA_METHOD *dsam))
         (DSA *, int, const unsigned char *, int, int *, unsigned long *,
          BN_GENCB *)
 {
     return dsam->dsa_paramgen;
 }
 
-int DSA_meth_set_paramgen(DSA_METHOD *dsam,
+int __cdecl DSA_meth_set_paramgen(DSA_METHOD *dsam,
         int (*paramgen) (DSA *, int, const unsigned char *, int, int *,
                          unsigned long *, BN_GENCB *))
 {
@@ -212,12 +212,12 @@ int DSA_meth_set_paramgen(DSA_METHOD *dsam,
     return 1;
 }
 
-int (*DSA_meth_get_keygen(const DSA_METHOD *dsam)) (DSA *)
+int (* __cdecl DSA_meth_get_keygen(const DSA_METHOD *dsam)) (DSA *)
 {
     return dsam->dsa_keygen;
 }
 
-int DSA_meth_set_keygen(DSA_METHOD *dsam, int (*keygen) (DSA *))
+int __cdecl DSA_meth_set_keygen(DSA_METHOD *dsam, int (*keygen) (DSA *))
 {
     dsam->dsa_keygen = keygen;
     return 1;
diff --git a/crypto/dsa/dsa_ossl.c b/crypto/dsa/dsa_ossl.c
index 16161dcadf..3eb1be20c7 100644
--- a/crypto/dsa/dsa_ossl.c
+++ b/crypto/dsa/dsa_ossl.c
@@ -15,7 +15,7 @@
 #include "dsa_locl.h"
 #include <openssl/asn1.h>
 
-static DSA_SIG *dsa_do_sign(const unsigned char *dgst, int dlen, DSA *dsa);
+static DSA_SIG * __cdecl dsa_do_sign(const unsigned char *dgst, int dlen, DSA *dsa);
 static int dsa_sign_setup_no_digest(DSA *dsa, BN_CTX *ctx_in, BIGNUM **kinvp,
                                     BIGNUM **rp);
 static int dsa_sign_setup(DSA *dsa, BN_CTX *ctx_in, BIGNUM **kinvp,
@@ -44,22 +44,22 @@ static DSA_METHOD openssl_dsa_meth = {
 
 static const DSA_METHOD *default_DSA_method = &openssl_dsa_meth;
 
-void DSA_set_default_method(const DSA_METHOD *meth)
+void __cdecl DSA_set_default_method(const DSA_METHOD *meth)
 {
     default_DSA_method = meth;
 }
 
-const DSA_METHOD *DSA_get_default_method(void)
+const DSA_METHOD * __cdecl DSA_get_default_method(void)
 {
     return default_DSA_method;
 }
 
-const DSA_METHOD *DSA_OpenSSL(void)
+const DSA_METHOD * __cdecl DSA_OpenSSL(void)
 {
     return &openssl_dsa_meth;
 }
 
-static DSA_SIG *dsa_do_sign(const unsigned char *dgst, int dlen, DSA *dsa)
+static DSA_SIG * __cdecl dsa_do_sign(const unsigned char *dgst, int dlen, DSA *dsa)
 {
     BIGNUM *kinv = NULL;
     BIGNUM *m, *blind, *blindm, *tmp;
diff --git a/crypto/dsa/dsa_prn.c b/crypto/dsa/dsa_prn.c
index a4a1fd5650..da9213c59d 100644
--- a/crypto/dsa/dsa_prn.c
+++ b/crypto/dsa/dsa_prn.c
@@ -13,7 +13,7 @@
 #include <openssl/dsa.h>
 
 #ifndef OPENSSL_NO_STDIO
-int DSA_print_fp(FILE *fp, const DSA *x, int off)
+int __cdecl DSA_print_fp(FILE *fp, const DSA *x, int off)
 {
     BIO *b;
     int ret;
@@ -28,7 +28,7 @@ int DSA_print_fp(FILE *fp, const DSA *x, int off)
     return ret;
 }
 
-int DSAparams_print_fp(FILE *fp, const DSA *x)
+int __cdecl DSAparams_print_fp(FILE *fp, const DSA *x)
 {
     BIO *b;
     int ret;
@@ -44,7 +44,7 @@ int DSAparams_print_fp(FILE *fp, const DSA *x)
 }
 #endif
 
-int DSA_print(BIO *bp, const DSA *x, int off)
+int __cdecl DSA_print(BIO *bp, const DSA *x, int off)
 {
     EVP_PKEY *pk;
     int ret;
@@ -56,7 +56,7 @@ int DSA_print(BIO *bp, const DSA *x, int off)
     return ret;
 }
 
-int DSAparams_print(BIO *bp, const DSA *x)
+int __cdecl DSAparams_print(BIO *bp, const DSA *x)
 {
     EVP_PKEY *pk;
     int ret;
diff --git a/crypto/dsa/dsa_sign.c b/crypto/dsa/dsa_sign.c
index e9466b29f1..ab7988119e 100644
--- a/crypto/dsa/dsa_sign.c
+++ b/crypto/dsa/dsa_sign.c
@@ -11,13 +11,13 @@
 #include "dsa_locl.h"
 #include <openssl/bn.h>
 
-DSA_SIG *DSA_do_sign(const unsigned char *dgst, int dlen, DSA *dsa)
+DSA_SIG * __cdecl DSA_do_sign(const unsigned char *dgst, int dlen, DSA *dsa)
 {
     return dsa->meth->dsa_do_sign(dgst, dlen, dsa);
 }
 
 #if OPENSSL_API_COMPAT < 0x10200000L
-int DSA_sign_setup(DSA *dsa, BN_CTX *ctx_in, BIGNUM **kinvp, BIGNUM **rp)
+int __cdecl DSA_sign_setup(DSA *dsa, BN_CTX *ctx_in, BIGNUM **kinvp, BIGNUM **rp)
 {
     return dsa->meth->dsa_sign_setup(dsa, ctx_in, kinvp, rp);
 }
diff --git a/crypto/dsa/dsa_vrf.c b/crypto/dsa/dsa_vrf.c
index 21f98cd94e..fb1091ffb4 100644
--- a/crypto/dsa/dsa_vrf.c
+++ b/crypto/dsa/dsa_vrf.c
@@ -10,7 +10,7 @@
 #include "internal/cryptlib.h"
 #include "dsa_locl.h"
 
-int DSA_do_verify(const unsigned char *dgst, int dgst_len, DSA_SIG *sig,
+int __cdecl DSA_do_verify(const unsigned char *dgst, int dgst_len, DSA_SIG *sig,
                   DSA *dsa)
 {
     return dsa->meth->dsa_do_verify(dgst, dgst_len, sig, dsa);
diff --git a/crypto/ebcdic.c b/crypto/ebcdic.c
index 2a8ca61010..e41789a09c 100644
--- a/crypto/ebcdic.c
+++ b/crypto/ebcdic.c
@@ -334,7 +334,7 @@ const unsigned char os_toebcdic[256] = {
  * memcpy(3).
  */
 
-void *ebcdic2ascii(void *dest, const void *srce, size_t count)
+void * __cdecl ebcdic2ascii(void *dest, const void *srce, size_t count)
 {
     unsigned char *udest = dest;
     const unsigned char *usrce = srce;
@@ -346,7 +346,7 @@ void *ebcdic2ascii(void *dest, const void *srce, size_t count)
     return dest;
 }
 
-void *ascii2ebcdic(void *dest, const void *srce, size_t count)
+void * __cdecl ascii2ebcdic(void *dest, const void *srce, size_t count)
 {
     unsigned char *udest = dest;
     const unsigned char *usrce = srce;
diff --git a/crypto/ec/ec2_smpl.c b/crypto/ec/ec2_smpl.c
index 898e741fcb..7b5894dedd 100644
--- a/crypto/ec/ec2_smpl.c
+++ b/crypto/ec/ec2_smpl.c
@@ -903,7 +903,7 @@ static int ec_GF2m_simple_field_inv(const EC_GROUP *group, BIGNUM *r,
     return ret;
 }
 
-const EC_METHOD *EC_GF2m_simple_method(void)
+const EC_METHOD * __cdecl EC_GF2m_simple_method(void)
 {
     static const EC_METHOD ret = {
         EC_FLAGS_DEFAULT_OCT,
diff --git a/crypto/ec/ec_ameth.c b/crypto/ec/ec_ameth.c
index c086f47ab3..4bbec3c4c0 100644
--- a/crypto/ec/ec_ameth.c
+++ b/crypto/ec/ec_ameth.c
@@ -616,7 +616,7 @@ const EVP_PKEY_ASN1_METHOD sm2_asn1_meth = {
 };
 #endif
 
-int EC_KEY_print(BIO *bp, const EC_KEY *x, int off)
+int __cdecl EC_KEY_print(BIO *bp, const EC_KEY *x, int off)
 {
     int private = EC_KEY_get0_private_key(x) != NULL;
 
@@ -624,7 +624,7 @@ int EC_KEY_print(BIO *bp, const EC_KEY *x, int off)
                 private ? EC_KEY_PRINT_PRIVATE : EC_KEY_PRINT_PUBLIC);
 }
 
-int ECParameters_print(BIO *bp, const EC_KEY *x)
+int __cdecl ECParameters_print(BIO *bp, const EC_KEY *x)
 {
     return do_EC_KEY_print(bp, x, 4, EC_KEY_PRINT_PARAM);
 }
diff --git a/crypto/ec/ec_asn1.c b/crypto/ec/ec_asn1.c
index 1ce1181fc1..cbb3d725da 100644
--- a/crypto/ec/ec_asn1.c
+++ b/crypto/ec/ec_asn1.c
@@ -14,7 +14,7 @@
 #include <openssl/objects.h>
 #include "internal/nelem.h"
 
-int EC_GROUP_get_basis_type(const EC_GROUP *group)
+int __cdecl EC_GROUP_get_basis_type(const EC_GROUP *group)
 {
     int i;
 
@@ -39,7 +39,7 @@ int EC_GROUP_get_basis_type(const EC_GROUP *group)
 }
 
 #ifndef OPENSSL_NO_EC2M
-int EC_GROUP_get_trinomial_basis(const EC_GROUP *group, unsigned int *k)
+int __cdecl EC_GROUP_get_trinomial_basis(const EC_GROUP *group, unsigned int *k)
 {
     if (group == NULL)
         return 0;
@@ -59,7 +59,7 @@ int EC_GROUP_get_trinomial_basis(const EC_GROUP *group, unsigned int *k)
     return 1;
 }
 
-int EC_GROUP_get_pentanomial_basis(const EC_GROUP *group, unsigned int *k1,
+int __cdecl EC_GROUP_get_pentanomial_basis(const EC_GROUP *group, unsigned int *k1,
                                    unsigned int *k2, unsigned int *k3)
 {
     if (group == NULL)
@@ -437,7 +437,7 @@ static int ec_asn1_group2curve(const EC_GROUP *group, X9_62_CURVE *curve)
     return ok;
 }
 
-ECPARAMETERS *EC_GROUP_get_ecparameters(const EC_GROUP *group,
+ECPARAMETERS * __cdecl EC_GROUP_get_ecparameters(const EC_GROUP *group,
                                                ECPARAMETERS *params)
 {
     size_t len = 0;
@@ -520,7 +520,7 @@ ECPARAMETERS *EC_GROUP_get_ecparameters(const EC_GROUP *group,
     return NULL;
 }
 
-ECPKPARAMETERS *EC_GROUP_get_ecpkparameters(const EC_GROUP *group,
+ECPKPARAMETERS * __cdecl EC_GROUP_get_ecpkparameters(const EC_GROUP *group,
                                             ECPKPARAMETERS *params)
 {
     int ok = 1, tmp;
@@ -565,7 +565,7 @@ ECPKPARAMETERS *EC_GROUP_get_ecpkparameters(const EC_GROUP *group,
     return ret;
 }
 
-EC_GROUP *EC_GROUP_new_from_ecparameters(const ECPARAMETERS *params)
+EC_GROUP * __cdecl EC_GROUP_new_from_ecparameters(const ECPARAMETERS *params)
 {
     int ok = 0, tmp;
     EC_GROUP *ret = NULL, *dup = NULL;
@@ -867,7 +867,7 @@ EC_GROUP *EC_GROUP_new_from_ecparameters(const ECPARAMETERS *params)
     return ret;
 }
 
-EC_GROUP *EC_GROUP_new_from_ecpkparameters(const ECPKPARAMETERS *params)
+EC_GROUP * __cdecl EC_GROUP_new_from_ecpkparameters(const ECPKPARAMETERS *params)
 {
     EC_GROUP *ret = NULL;
     int tmp = 0;
@@ -905,7 +905,7 @@ EC_GROUP *EC_GROUP_new_from_ecpkparameters(const ECPKPARAMETERS *params)
 
 /* EC_GROUP <-> DER encoding of ECPKPARAMETERS */
 
-EC_GROUP *d2i_ECPKParameters(EC_GROUP **a, const unsigned char **in, long len)
+EC_GROUP * __cdecl d2i_ECPKParameters(EC_GROUP **a, const unsigned char **in, long len)
 {
     EC_GROUP *group = NULL;
     ECPKPARAMETERS *params = NULL;
@@ -933,7 +933,7 @@ EC_GROUP *d2i_ECPKParameters(EC_GROUP **a, const unsigned char **in, long len)
     return group;
 }
 
-int i2d_ECPKParameters(const EC_GROUP *a, unsigned char **out)
+int __cdecl i2d_ECPKParameters(const EC_GROUP *a, unsigned char **out)
 {
     int ret = 0;
     ECPKPARAMETERS *tmp = EC_GROUP_get_ecpkparameters(a, NULL);
@@ -952,7 +952,7 @@ int i2d_ECPKParameters(const EC_GROUP *a, unsigned char **out)
 
 /* some EC_KEY functions */
 
-EC_KEY *d2i_ECPrivateKey(EC_KEY **a, const unsigned char **in, long len)
+EC_KEY * __cdecl d2i_ECPrivateKey(EC_KEY **a, const unsigned char **in, long len)
 {
     EC_KEY *ret = NULL;
     EC_PRIVATEKEY *priv_key = NULL;
@@ -1031,7 +1031,7 @@ EC_KEY *d2i_ECPrivateKey(EC_KEY **a, const unsigned char **in, long len)
     return NULL;
 }
 
-int i2d_ECPrivateKey(EC_KEY *a, unsigned char **out)
+int __cdecl i2d_ECPrivateKey(EC_KEY *a, unsigned char **out)
 {
     int ret = 0, ok = 0;
     unsigned char *priv= NULL, *pub= NULL;
@@ -1103,7 +1103,7 @@ int i2d_ECPrivateKey(EC_KEY *a, unsigned char **out)
     return (ok ? ret : 0);
 }
 
-int i2d_ECParameters(EC_KEY *a, unsigned char **out)
+int __cdecl i2d_ECParameters(EC_KEY *a, unsigned char **out)
 {
     if (a == NULL) {
         ECerr(EC_F_I2D_ECPARAMETERS, ERR_R_PASSED_NULL_PARAMETER);
@@ -1112,7 +1112,7 @@ int i2d_ECParameters(EC_KEY *a, unsigned char **out)
     return i2d_ECPKParameters(a->group, out);
 }
 
-EC_KEY *d2i_ECParameters(EC_KEY **a, const unsigned char **in, long len)
+EC_KEY * __cdecl d2i_ECParameters(EC_KEY **a, const unsigned char **in, long len)
 {
     EC_KEY *ret;
 
@@ -1142,7 +1142,7 @@ EC_KEY *d2i_ECParameters(EC_KEY **a, const unsigned char **in, long len)
     return ret;
 }
 
-EC_KEY *o2i_ECPublicKey(EC_KEY **a, const unsigned char **in, long len)
+EC_KEY * __cdecl o2i_ECPublicKey(EC_KEY **a, const unsigned char **in, long len)
 {
     EC_KEY *ret = NULL;
 
@@ -1162,7 +1162,7 @@ EC_KEY *o2i_ECPublicKey(EC_KEY **a, const unsigned char **in, long len)
     return ret;
 }
 
-int i2o_ECPublicKey(const EC_KEY *a, unsigned char **out)
+int __cdecl i2o_ECPublicKey(const EC_KEY *a, unsigned char **out)
 {
     size_t buf_len = 0;
     int new_buffer = 0;
@@ -1209,7 +1209,7 @@ DECLARE_ASN1_FUNCTIONS_const(ECDSA_SIG)
 DECLARE_ASN1_ENCODE_FUNCTIONS_const(ECDSA_SIG, ECDSA_SIG)
 IMPLEMENT_ASN1_ENCODE_FUNCTIONS_const_fname(ECDSA_SIG, ECDSA_SIG, ECDSA_SIG)
 
-ECDSA_SIG *ECDSA_SIG_new(void)
+ECDSA_SIG * __cdecl ECDSA_SIG_new(void)
 {
     ECDSA_SIG *sig = OPENSSL_zalloc(sizeof(*sig));
     if (sig == NULL)
@@ -1217,7 +1217,7 @@ ECDSA_SIG *ECDSA_SIG_new(void)
     return sig;
 }
 
-void ECDSA_SIG_free(ECDSA_SIG *sig)
+void __cdecl ECDSA_SIG_free(ECDSA_SIG *sig)
 {
     if (sig == NULL)
         return;
@@ -1226,7 +1226,7 @@ void ECDSA_SIG_free(ECDSA_SIG *sig)
     OPENSSL_free(sig);
 }
 
-void ECDSA_SIG_get0(const ECDSA_SIG *sig, const BIGNUM **pr, const BIGNUM **ps)
+void __cdecl ECDSA_SIG_get0(const ECDSA_SIG *sig, const BIGNUM **pr, const BIGNUM **ps)
 {
     if (pr != NULL)
         *pr = sig->r;
@@ -1234,17 +1234,17 @@ void ECDSA_SIG_get0(const ECDSA_SIG *sig, const BIGNUM **pr, const BIGNUM **ps)
         *ps = sig->s;
 }
 
-const BIGNUM *ECDSA_SIG_get0_r(const ECDSA_SIG *sig)
+const BIGNUM * __cdecl ECDSA_SIG_get0_r(const ECDSA_SIG *sig)
 {
     return sig->r;
 }
 
-const BIGNUM *ECDSA_SIG_get0_s(const ECDSA_SIG *sig)
+const BIGNUM * __cdecl ECDSA_SIG_get0_s(const ECDSA_SIG *sig)
 {
     return sig->s;
 }
 
-int ECDSA_SIG_set0(ECDSA_SIG *sig, BIGNUM *r, BIGNUM *s)
+int __cdecl ECDSA_SIG_set0(ECDSA_SIG *sig, BIGNUM *r, BIGNUM *s)
 {
     if (r == NULL || s == NULL)
         return 0;
@@ -1255,7 +1255,7 @@ int ECDSA_SIG_set0(ECDSA_SIG *sig, BIGNUM *r, BIGNUM *s)
     return 1;
 }
 
-int ECDSA_size(const EC_KEY *r)
+int __cdecl ECDSA_size(const EC_KEY *r)
 {
     int ret, i;
     ASN1_INTEGER bs;
diff --git a/crypto/ec/ec_check.c b/crypto/ec/ec_check.c
index eeb06ec1cb..ab55650b13 100644
--- a/crypto/ec/ec_check.c
+++ b/crypto/ec/ec_check.c
@@ -10,7 +10,7 @@
 #include "ec_lcl.h"
 #include <openssl/err.h>
 
-int EC_GROUP_check(const EC_GROUP *group, BN_CTX *ctx)
+int __cdecl EC_GROUP_check(const EC_GROUP *group, BN_CTX *ctx)
 {
     int ret = 0;
     const BIGNUM *order;
diff --git a/crypto/ec/ec_curve.c b/crypto/ec/ec_curve.c
index 477349d441..edf394e6ca 100644
--- a/crypto/ec/ec_curve.c
+++ b/crypto/ec/ec_curve.c
@@ -3114,7 +3114,7 @@ static EC_GROUP *ec_group_new_from_data(const ec_list_element curve)
     return group;
 }
 
-EC_GROUP *EC_GROUP_new_by_curve_name(int nid)
+EC_GROUP * __cdecl EC_GROUP_new_by_curve_name(int nid)
 {
     size_t i;
     EC_GROUP *ret = NULL;
@@ -3136,7 +3136,7 @@ EC_GROUP *EC_GROUP_new_by_curve_name(int nid)
     return ret;
 }
 
-size_t EC_get_builtin_curves(EC_builtin_curve *r, size_t nitems)
+size_t __cdecl EC_get_builtin_curves(EC_builtin_curve *r, size_t nitems)
 {
     size_t i, min;
 
@@ -3178,7 +3178,7 @@ static EC_NIST_NAME nist_curves[] = {
     {"P-521", NID_secp521r1}
 };
 
-const char *EC_curve_nid2nist(int nid)
+const char * __cdecl EC_curve_nid2nist(int nid)
 {
     size_t i;
     for (i = 0; i < OSSL_NELEM(nist_curves); i++) {
@@ -3188,7 +3188,7 @@ const char *EC_curve_nid2nist(int nid)
     return NULL;
 }
 
-int EC_curve_nist2nid(const char *name)
+int __cdecl EC_curve_nist2nid(const char *name)
 {
     size_t i;
     for (i = 0; i < OSSL_NELEM(nist_curves); i++) {
diff --git a/crypto/ec/ec_cvt.c b/crypto/ec/ec_cvt.c
index 0ec346c125..8960e873b7 100644
--- a/crypto/ec/ec_cvt.c
+++ b/crypto/ec/ec_cvt.c
@@ -11,7 +11,7 @@
 #include <openssl/err.h>
 #include "ec_lcl.h"
 
-EC_GROUP *EC_GROUP_new_curve_GFp(const BIGNUM *p, const BIGNUM *a,
+EC_GROUP * __cdecl EC_GROUP_new_curve_GFp(const BIGNUM *p, const BIGNUM *a,
                                  const BIGNUM *b, BN_CTX *ctx)
 {
     const EC_METHOD *meth;
@@ -60,7 +60,7 @@ EC_GROUP *EC_GROUP_new_curve_GFp(const BIGNUM *p, const BIGNUM *a,
 }
 
 #ifndef OPENSSL_NO_EC2M
-EC_GROUP *EC_GROUP_new_curve_GF2m(const BIGNUM *p, const BIGNUM *a,
+EC_GROUP * __cdecl EC_GROUP_new_curve_GF2m(const BIGNUM *p, const BIGNUM *a,
                                   const BIGNUM *b, BN_CTX *ctx)
 {
     const EC_METHOD *meth;
diff --git a/crypto/ec/ec_err.c b/crypto/ec/ec_err.c
index ce34938232..761f37dba1 100644
--- a/crypto/ec/ec_err.c
+++ b/crypto/ec/ec_err.c
@@ -382,7 +382,7 @@ static const ERR_STRING_DATA EC_str_reasons[] = {
 
 #endif
 
-int ERR_load_EC_strings(void)
+int __cdecl ERR_load_EC_strings(void)
 {
 #ifndef OPENSSL_NO_ERR
     if (ERR_func_error_string(EC_str_functs[0].error) == NULL) {
diff --git a/crypto/ec/ec_key.c b/crypto/ec/ec_key.c
index 9349abf030..ac124a3c93 100644
--- a/crypto/ec/ec_key.c
+++ b/crypto/ec/ec_key.c
@@ -15,12 +15,12 @@
 #include <openssl/err.h>
 #include <openssl/engine.h>
 
-EC_KEY *EC_KEY_new(void)
+EC_KEY * __cdecl EC_KEY_new(void)
 {
     return EC_KEY_new_method(NULL);
 }
 
-EC_KEY *EC_KEY_new_by_curve_name(int nid)
+EC_KEY * __cdecl EC_KEY_new_by_curve_name(int nid)
 {
     EC_KEY *ret = EC_KEY_new();
     if (ret == NULL)
@@ -38,7 +38,7 @@ EC_KEY *EC_KEY_new_by_curve_name(int nid)
     return ret;
 }
 
-void EC_KEY_free(EC_KEY *r)
+void __cdecl EC_KEY_free(EC_KEY *r)
 {
     int i;
 
@@ -70,7 +70,7 @@ void EC_KEY_free(EC_KEY *r)
     OPENSSL_clear_free((void *)r, sizeof(EC_KEY));
 }
 
-EC_KEY *EC_KEY_copy(EC_KEY *dest, const EC_KEY *src)
+EC_KEY * __cdecl EC_KEY_copy(EC_KEY *dest, const EC_KEY *src)
 {
     if (dest == NULL || src == NULL) {
         ECerr(EC_F_EC_KEY_COPY, ERR_R_PASSED_NULL_PARAMETER);
@@ -147,7 +147,7 @@ EC_KEY *EC_KEY_copy(EC_KEY *dest, const EC_KEY *src)
     return dest;
 }
 
-EC_KEY *EC_KEY_dup(const EC_KEY *ec_key)
+EC_KEY * __cdecl EC_KEY_dup(const EC_KEY *ec_key)
 {
     EC_KEY *ret = EC_KEY_new_method(ec_key->engine);
 
@@ -161,7 +161,7 @@ EC_KEY *EC_KEY_dup(const EC_KEY *ec_key)
     return ret;
 }
 
-int EC_KEY_up_ref(EC_KEY *r)
+int __cdecl EC_KEY_up_ref(EC_KEY *r)
 {
     int i;
 
@@ -173,12 +173,12 @@ int EC_KEY_up_ref(EC_KEY *r)
     return ((i > 1) ? 1 : 0);
 }
 
-ENGINE *EC_KEY_get0_engine(const EC_KEY *eckey)
+ENGINE * __cdecl EC_KEY_get0_engine(const EC_KEY *eckey)
 {
     return eckey->engine;
 }
 
-int EC_KEY_generate_key(EC_KEY *eckey)
+int __cdecl EC_KEY_generate_key(EC_KEY *eckey)
 {
     if (eckey == NULL || eckey->group == NULL) {
         ECerr(EC_F_EC_KEY_GENERATE_KEY, ERR_R_PASSED_NULL_PARAMETER);
@@ -252,7 +252,7 @@ int ec_key_simple_generate_public_key(EC_KEY *eckey)
                         NULL, NULL);
 }
 
-int EC_KEY_check_key(const EC_KEY *eckey)
+int __cdecl EC_KEY_check_key(const EC_KEY *eckey)
 {
     if (eckey == NULL || eckey->group == NULL || eckey->pub_key == NULL) {
         ECerr(EC_F_EC_KEY_CHECK_KEY, ERR_R_PASSED_NULL_PARAMETER);
@@ -334,7 +334,7 @@ int ec_key_simple_check_key(const EC_KEY *eckey)
     return ok;
 }
 
-int EC_KEY_set_public_key_affine_coordinates(EC_KEY *key, BIGNUM *x,
+int __cdecl EC_KEY_set_public_key_affine_coordinates(EC_KEY *key, BIGNUM *x,
                                              BIGNUM *y)
 {
     BN_CTX *ctx = NULL;
@@ -395,12 +395,12 @@ int EC_KEY_set_public_key_affine_coordinates(EC_KEY *key, BIGNUM *x,
 
 }
 
-const EC_GROUP *EC_KEY_get0_group(const EC_KEY *key)
+const EC_GROUP * __cdecl EC_KEY_get0_group(const EC_KEY *key)
 {
     return key->group;
 }
 
-int EC_KEY_set_group(EC_KEY *key, const EC_GROUP *group)
+int __cdecl EC_KEY_set_group(EC_KEY *key, const EC_GROUP *group)
 {
     if (key->meth->set_group != NULL && key->meth->set_group(key, group) == 0)
         return 0;
@@ -409,12 +409,12 @@ int EC_KEY_set_group(EC_KEY *key, const EC_GROUP *group)
     return (key->group == NULL) ? 0 : 1;
 }
 
-const BIGNUM *EC_KEY_get0_private_key(const EC_KEY *key)
+const BIGNUM * __cdecl EC_KEY_get0_private_key(const EC_KEY *key)
 {
     return key->priv_key;
 }
 
-int EC_KEY_set_private_key(EC_KEY *key, const BIGNUM *priv_key)
+int __cdecl EC_KEY_set_private_key(EC_KEY *key, const BIGNUM *priv_key)
 {
     if (key->group == NULL || key->group->meth == NULL)
         return 0;
@@ -429,12 +429,12 @@ int EC_KEY_set_private_key(EC_KEY *key, const BIGNUM *priv_key)
     return (key->priv_key == NULL) ? 0 : 1;
 }
 
-const EC_POINT *EC_KEY_get0_public_key(const EC_KEY *key)
+const EC_POINT * __cdecl EC_KEY_get0_public_key(const EC_KEY *key)
 {
     return key->pub_key;
 }
 
-int EC_KEY_set_public_key(EC_KEY *key, const EC_POINT *pub_key)
+int __cdecl EC_KEY_set_public_key(EC_KEY *key, const EC_POINT *pub_key)
 {
     if (key->meth->set_public != NULL
         && key->meth->set_public(key, pub_key) == 0)
@@ -444,57 +444,57 @@ int EC_KEY_set_public_key(EC_KEY *key, const EC_POINT *pub_key)
     return (key->pub_key == NULL) ? 0 : 1;
 }
 
-unsigned int EC_KEY_get_enc_flags(const EC_KEY *key)
+unsigned int __cdecl EC_KEY_get_enc_flags(const EC_KEY *key)
 {
     return key->enc_flag;
 }
 
-void EC_KEY_set_enc_flags(EC_KEY *key, unsigned int flags)
+void __cdecl EC_KEY_set_enc_flags(EC_KEY *key, unsigned int flags)
 {
     key->enc_flag = flags;
 }
 
-point_conversion_form_t EC_KEY_get_conv_form(const EC_KEY *key)
+point_conversion_form_t __cdecl EC_KEY_get_conv_form(const EC_KEY *key)
 {
     return key->conv_form;
 }
 
-void EC_KEY_set_conv_form(EC_KEY *key, point_conversion_form_t cform)
+void __cdecl EC_KEY_set_conv_form(EC_KEY *key, point_conversion_form_t cform)
 {
     key->conv_form = cform;
     if (key->group != NULL)
         EC_GROUP_set_point_conversion_form(key->group, cform);
 }
 
-void EC_KEY_set_asn1_flag(EC_KEY *key, int flag)
+void __cdecl EC_KEY_set_asn1_flag(EC_KEY *key, int flag)
 {
     if (key->group != NULL)
         EC_GROUP_set_asn1_flag(key->group, flag);
 }
 
-int EC_KEY_precompute_mult(EC_KEY *key, BN_CTX *ctx)
+int __cdecl EC_KEY_precompute_mult(EC_KEY *key, BN_CTX *ctx)
 {
     if (key->group == NULL)
         return 0;
     return EC_GROUP_precompute_mult(key->group, ctx);
 }
 
-int EC_KEY_get_flags(const EC_KEY *key)
+int __cdecl EC_KEY_get_flags(const EC_KEY *key)
 {
     return key->flags;
 }
 
-void EC_KEY_set_flags(EC_KEY *key, int flags)
+void __cdecl EC_KEY_set_flags(EC_KEY *key, int flags)
 {
     key->flags |= flags;
 }
 
-void EC_KEY_clear_flags(EC_KEY *key, int flags)
+void __cdecl EC_KEY_clear_flags(EC_KEY *key, int flags)
 {
     key->flags &= ~flags;
 }
 
-size_t EC_KEY_key2buf(const EC_KEY *key, point_conversion_form_t form,
+size_t __cdecl EC_KEY_key2buf(const EC_KEY *key, point_conversion_form_t form,
                         unsigned char **pbuf, BN_CTX *ctx)
 {
     if (key == NULL || key->pub_key == NULL || key->group == NULL)
@@ -502,7 +502,7 @@ size_t EC_KEY_key2buf(const EC_KEY *key, point_conversion_form_t form,
     return EC_POINT_point2buf(key->group, key->pub_key, form, pbuf, ctx);
 }
 
-int EC_KEY_oct2key(EC_KEY *key, const unsigned char *buf, size_t len,
+int __cdecl EC_KEY_oct2key(EC_KEY *key, const unsigned char *buf, size_t len,
                    BN_CTX *ctx)
 {
     if (key == NULL || key->group == NULL)
@@ -525,7 +525,7 @@ int EC_KEY_oct2key(EC_KEY *key, const unsigned char *buf, size_t len,
     return 1;
 }
 
-size_t EC_KEY_priv2oct(const EC_KEY *eckey,
+size_t __cdecl EC_KEY_priv2oct(const EC_KEY *eckey,
                        unsigned char *buf, size_t len)
 {
     if (eckey->group == NULL || eckey->group->meth == NULL)
@@ -561,7 +561,7 @@ size_t ec_key_simple_priv2oct(const EC_KEY *eckey,
     return buf_len;
 }
 
-int EC_KEY_oct2priv(EC_KEY *eckey, const unsigned char *buf, size_t len)
+int __cdecl EC_KEY_oct2priv(EC_KEY *eckey, const unsigned char *buf, size_t len)
 {
     if (eckey->group == NULL || eckey->group->meth == NULL)
         return 0;
@@ -588,7 +588,7 @@ int ec_key_simple_oct2priv(EC_KEY *eckey, const unsigned char *buf, size_t len)
     return 1;
 }
 
-size_t EC_KEY_priv2buf(const EC_KEY *eckey, unsigned char **pbuf)
+size_t __cdecl EC_KEY_priv2buf(const EC_KEY *eckey, unsigned char **pbuf)
 {
     size_t len;
     unsigned char *buf;
@@ -609,7 +609,7 @@ size_t EC_KEY_priv2buf(const EC_KEY *eckey, unsigned char **pbuf)
     return len;
 }
 
-int EC_KEY_can_sign(const EC_KEY *eckey)
+int __cdecl EC_KEY_can_sign(const EC_KEY *eckey)
 {
     if (eckey->group == NULL || eckey->group->meth == NULL
         || (eckey->group->meth->flags & EC_FLAGS_NO_SIGN))
diff --git a/crypto/ec/ec_kmeth.c b/crypto/ec/ec_kmeth.c
index 64a5d20872..cab34298f9 100644
--- a/crypto/ec/ec_kmeth.c
+++ b/crypto/ec/ec_kmeth.c
@@ -29,17 +29,17 @@ static const EC_KEY_METHOD openssl_ec_key_method = {
 
 static const EC_KEY_METHOD *default_ec_key_meth = &openssl_ec_key_method;
 
-const EC_KEY_METHOD *EC_KEY_OpenSSL(void)
+const EC_KEY_METHOD * __cdecl EC_KEY_OpenSSL(void)
 {
     return &openssl_ec_key_method;
 }
 
-const EC_KEY_METHOD *EC_KEY_get_default_method(void)
+const EC_KEY_METHOD * __cdecl EC_KEY_get_default_method(void)
 {
     return default_ec_key_meth;
 }
 
-void EC_KEY_set_default_method(const EC_KEY_METHOD *meth)
+void __cdecl EC_KEY_set_default_method(const EC_KEY_METHOD *meth)
 {
     if (meth == NULL)
         default_ec_key_meth = &openssl_ec_key_method;
@@ -47,12 +47,12 @@ void EC_KEY_set_default_method(const EC_KEY_METHOD *meth)
         default_ec_key_meth = meth;
 }
 
-const EC_KEY_METHOD *EC_KEY_get_method(const EC_KEY *key)
+const EC_KEY_METHOD * __cdecl EC_KEY_get_method(const EC_KEY *key)
 {
     return key->meth;
 }
 
-int EC_KEY_set_method(EC_KEY *key, const EC_KEY_METHOD *meth)
+int __cdecl EC_KEY_set_method(EC_KEY *key, const EC_KEY_METHOD *meth)
 {
     void (*finish)(EC_KEY *key) = key->meth->finish;
 
@@ -70,7 +70,7 @@ int EC_KEY_set_method(EC_KEY *key, const EC_KEY_METHOD *meth)
     return 1;
 }
 
-EC_KEY *EC_KEY_new_method(ENGINE *engine)
+EC_KEY * __cdecl EC_KEY_new_method(ENGINE *engine)
 {
     EC_KEY *ret = OPENSSL_zalloc(sizeof(*ret));
 
@@ -124,7 +124,7 @@ EC_KEY *EC_KEY_new_method(ENGINE *engine)
     return NULL;
 }
 
-int ECDH_compute_key(void *out, size_t outlen, const EC_POINT *pub_key,
+int __cdecl ECDH_compute_key(void *out, size_t outlen, const EC_POINT *pub_key,
                      const EC_KEY *eckey,
                      void *(*KDF) (const void *in, size_t inlen, void *out,
                                    size_t *outlen))
@@ -152,7 +152,7 @@ int ECDH_compute_key(void *out, size_t outlen, const EC_POINT *pub_key,
     return outlen;
 }
 
-EC_KEY_METHOD *EC_KEY_METHOD_new(const EC_KEY_METHOD *meth)
+EC_KEY_METHOD * __cdecl EC_KEY_METHOD_new(const EC_KEY_METHOD *meth)
 {
     EC_KEY_METHOD *ret = OPENSSL_zalloc(sizeof(*meth));
 
@@ -164,13 +164,13 @@ EC_KEY_METHOD *EC_KEY_METHOD_new(const EC_KEY_METHOD *meth)
     return ret;
 }
 
-void EC_KEY_METHOD_free(EC_KEY_METHOD *meth)
+void __cdecl EC_KEY_METHOD_free(EC_KEY_METHOD *meth)
 {
     if (meth->flags & EC_KEY_METHOD_DYNAMIC)
         OPENSSL_free(meth);
 }
 
-void EC_KEY_METHOD_set_init(EC_KEY_METHOD *meth,
+void __cdecl EC_KEY_METHOD_set_init(EC_KEY_METHOD *meth,
                             int (*init)(EC_KEY *key),
                             void (*finish)(EC_KEY *key),
                             int (*copy)(EC_KEY *dest, const EC_KEY *src),
@@ -188,13 +188,13 @@ void EC_KEY_METHOD_set_init(EC_KEY_METHOD *meth,
     meth->set_public = set_public;
 }
 
-void EC_KEY_METHOD_set_keygen(EC_KEY_METHOD *meth,
+void __cdecl EC_KEY_METHOD_set_keygen(EC_KEY_METHOD *meth,
                               int (*keygen)(EC_KEY *key))
 {
     meth->keygen = keygen;
 }
 
-void EC_KEY_METHOD_set_compute_key(EC_KEY_METHOD *meth,
+void __cdecl EC_KEY_METHOD_set_compute_key(EC_KEY_METHOD *meth,
                                    int (*ckey)(unsigned char **psec,
                                                size_t *pseclen,
                                                const EC_POINT *pub_key,
@@ -203,7 +203,7 @@ void EC_KEY_METHOD_set_compute_key(EC_KEY_METHOD *meth,
     meth->compute_key = ckey;
 }
 
-void EC_KEY_METHOD_set_sign(EC_KEY_METHOD *meth,
+void __cdecl EC_KEY_METHOD_set_sign(EC_KEY_METHOD *meth,
                             int (*sign)(int type, const unsigned char *dgst,
                                         int dlen, unsigned char *sig,
                                         unsigned int *siglen,
@@ -222,7 +222,7 @@ void EC_KEY_METHOD_set_sign(EC_KEY_METHOD *meth,
     meth->sign_sig = sign_sig;
 }
 
-void EC_KEY_METHOD_set_verify(EC_KEY_METHOD *meth,
+void __cdecl EC_KEY_METHOD_set_verify(EC_KEY_METHOD *meth,
                               int (*verify)(int type, const unsigned
                                             char *dgst, int dgst_len,
                                             const unsigned char *sigbuf,
@@ -236,7 +236,7 @@ void EC_KEY_METHOD_set_verify(EC_KEY_METHOD *meth,
     meth->verify_sig = verify_sig;
 }
 
-void EC_KEY_METHOD_get_init(const EC_KEY_METHOD *meth,
+void __cdecl EC_KEY_METHOD_get_init(const EC_KEY_METHOD *meth,
                             int (**pinit)(EC_KEY *key),
                             void (**pfinish)(EC_KEY *key),
                             int (**pcopy)(EC_KEY *dest, const EC_KEY *src),
@@ -261,14 +261,14 @@ void EC_KEY_METHOD_get_init(const EC_KEY_METHOD *meth,
         *pset_public = meth->set_public;
 }
 
-void EC_KEY_METHOD_get_keygen(const EC_KEY_METHOD *meth,
+void __cdecl EC_KEY_METHOD_get_keygen(const EC_KEY_METHOD *meth,
                               int (**pkeygen)(EC_KEY *key))
 {
     if (pkeygen != NULL)
         *pkeygen = meth->keygen;
 }
 
-void EC_KEY_METHOD_get_compute_key(const EC_KEY_METHOD *meth,
+void __cdecl EC_KEY_METHOD_get_compute_key(const EC_KEY_METHOD *meth,
                                    int (**pck)(unsigned char **pout,
                                                size_t *poutlen,
                                                const EC_POINT *pub_key,
@@ -278,7 +278,7 @@ void EC_KEY_METHOD_get_compute_key(const EC_KEY_METHOD *meth,
         *pck = meth->compute_key;
 }
 
-void EC_KEY_METHOD_get_sign(const EC_KEY_METHOD *meth,
+void __cdecl EC_KEY_METHOD_get_sign(const EC_KEY_METHOD *meth,
                             int (**psign)(int type, const unsigned char *dgst,
                                           int dlen, unsigned char *sig,
                                           unsigned int *siglen,
@@ -300,7 +300,7 @@ void EC_KEY_METHOD_get_sign(const EC_KEY_METHOD *meth,
         *psign_sig = meth->sign_sig;
 }
 
-void EC_KEY_METHOD_get_verify(const EC_KEY_METHOD *meth,
+void __cdecl EC_KEY_METHOD_get_verify(const EC_KEY_METHOD *meth,
                               int (**pverify)(int type, const unsigned
                                               char *dgst, int dgst_len,
                                               const unsigned char *sigbuf,
diff --git a/crypto/ec/ec_lcl.h b/crypto/ec/ec_lcl.h
index fbdb04ea3a..c979ee994f 100644
--- a/crypto/ec/ec_lcl.h
+++ b/crypto/ec/ec_lcl.h
@@ -246,7 +246,7 @@ struct ec_group_st {
     /* method-specific */
     void *field_data2;
     /* method-specific */
-    int (*field_mod_func) (BIGNUM *, const BIGNUM *, const BIGNUM *,
+    int (__cdecl *field_mod_func) (BIGNUM *, const BIGNUM *, const BIGNUM *,
                            BN_CTX *);
     /* data for ECDSA inverse */
     BN_MONT_CTX *mont_data;
diff --git a/crypto/ec/ec_lib.c b/crypto/ec/ec_lib.c
index 1289c8608e..2b5e64c2eb 100644
--- a/crypto/ec/ec_lib.c
+++ b/crypto/ec/ec_lib.c
@@ -17,7 +17,7 @@
 
 /* functions for EC_GROUP objects */
 
-EC_GROUP *EC_GROUP_new(const EC_METHOD *meth)
+EC_GROUP * __cdecl EC_GROUP_new(const EC_METHOD *meth)
 {
     EC_GROUP *ret;
 
@@ -91,7 +91,7 @@ void EC_pre_comp_free(EC_GROUP *group)
     group->pre_comp.ec = NULL;
 }
 
-void EC_GROUP_free(EC_GROUP *group)
+void __cdecl EC_GROUP_free(EC_GROUP *group)
 {
     if (!group)
         return;
@@ -108,7 +108,7 @@ void EC_GROUP_free(EC_GROUP *group)
     OPENSSL_free(group);
 }
 
-void EC_GROUP_clear_free(EC_GROUP *group)
+void __cdecl EC_GROUP_clear_free(EC_GROUP *group)
 {
     if (!group)
         return;
@@ -127,7 +127,7 @@ void EC_GROUP_clear_free(EC_GROUP *group)
     OPENSSL_clear_free(group, sizeof(*group));
 }
 
-int EC_GROUP_copy(EC_GROUP *dest, const EC_GROUP *src)
+int __cdecl EC_GROUP_copy(EC_GROUP *dest, const EC_GROUP *src)
 {
     if (dest->meth->group_copy == 0) {
         ECerr(EC_F_EC_GROUP_COPY, ERR_R_SHOULD_NOT_HAVE_BEEN_CALLED);
@@ -230,7 +230,7 @@ int EC_GROUP_copy(EC_GROUP *dest, const EC_GROUP *src)
     return dest->meth->group_copy(dest, src);
 }
 
-EC_GROUP *EC_GROUP_dup(const EC_GROUP *a)
+EC_GROUP * __cdecl EC_GROUP_dup(const EC_GROUP *a)
 {
     EC_GROUP *t = NULL;
     int ok = 0;
@@ -253,12 +253,12 @@ EC_GROUP *EC_GROUP_dup(const EC_GROUP *a)
         return t;
 }
 
-const EC_METHOD *EC_GROUP_method_of(const EC_GROUP *group)
+const EC_METHOD * __cdecl EC_GROUP_method_of(const EC_GROUP *group)
 {
     return group->meth;
 }
 
-int EC_METHOD_get_field_type(const EC_METHOD *meth)
+int __cdecl EC_METHOD_get_field_type(const EC_METHOD *meth)
 {
     return meth->field_type;
 }
@@ -326,7 +326,7 @@ static int ec_guess_cofactor(EC_GROUP *group) {
     return ret;
 }
 
-int EC_GROUP_set_generator(EC_GROUP *group, const EC_POINT *generator,
+int __cdecl EC_GROUP_set_generator(EC_GROUP *group, const EC_POINT *generator,
                            const BIGNUM *order, const BIGNUM *cofactor)
 {
     if (generator == NULL) {
@@ -396,17 +396,17 @@ int EC_GROUP_set_generator(EC_GROUP *group, const EC_POINT *generator,
     return 1;
 }
 
-const EC_POINT *EC_GROUP_get0_generator(const EC_GROUP *group)
+const EC_POINT * __cdecl EC_GROUP_get0_generator(const EC_GROUP *group)
 {
     return group->generator;
 }
 
-BN_MONT_CTX *EC_GROUP_get_mont_data(const EC_GROUP *group)
+BN_MONT_CTX * __cdecl EC_GROUP_get_mont_data(const EC_GROUP *group)
 {
     return group->mont_data;
 }
 
-int EC_GROUP_get_order(const EC_GROUP *group, BIGNUM *order, BN_CTX *ctx)
+int __cdecl EC_GROUP_get_order(const EC_GROUP *group, BIGNUM *order, BN_CTX *ctx)
 {
     if (group->order == NULL)
         return 0;
@@ -416,17 +416,17 @@ int EC_GROUP_get_order(const EC_GROUP *group, BIGNUM *order, BN_CTX *ctx)
     return !BN_is_zero(order);
 }
 
-const BIGNUM *EC_GROUP_get0_order(const EC_GROUP *group)
+const BIGNUM * __cdecl EC_GROUP_get0_order(const EC_GROUP *group)
 {
     return group->order;
 }
 
-int EC_GROUP_order_bits(const EC_GROUP *group)
+int __cdecl EC_GROUP_order_bits(const EC_GROUP *group)
 {
     return group->meth->group_order_bits(group);
 }
 
-int EC_GROUP_get_cofactor(const EC_GROUP *group, BIGNUM *cofactor,
+int __cdecl EC_GROUP_get_cofactor(const EC_GROUP *group, BIGNUM *cofactor,
                           BN_CTX *ctx)
 {
 
@@ -438,44 +438,44 @@ int EC_GROUP_get_cofactor(const EC_GROUP *group, BIGNUM *cofactor,
     return !BN_is_zero(group->cofactor);
 }
 
-const BIGNUM *EC_GROUP_get0_cofactor(const EC_GROUP *group)
+const BIGNUM * __cdecl EC_GROUP_get0_cofactor(const EC_GROUP *group)
 {
     return group->cofactor;
 }
 
-void EC_GROUP_set_curve_name(EC_GROUP *group, int nid)
+void __cdecl EC_GROUP_set_curve_name(EC_GROUP *group, int nid)
 {
     group->curve_name = nid;
 }
 
-int EC_GROUP_get_curve_name(const EC_GROUP *group)
+int __cdecl EC_GROUP_get_curve_name(const EC_GROUP *group)
 {
     return group->curve_name;
 }
 
-void EC_GROUP_set_asn1_flag(EC_GROUP *group, int flag)
+void __cdecl EC_GROUP_set_asn1_flag(EC_GROUP *group, int flag)
 {
     group->asn1_flag = flag;
 }
 
-int EC_GROUP_get_asn1_flag(const EC_GROUP *group)
+int __cdecl EC_GROUP_get_asn1_flag(const EC_GROUP *group)
 {
     return group->asn1_flag;
 }
 
-void EC_GROUP_set_point_conversion_form(EC_GROUP *group,
+void __cdecl EC_GROUP_set_point_conversion_form(EC_GROUP *group,
                                         point_conversion_form_t form)
 {
     group->asn1_form = form;
 }
 
-point_conversion_form_t EC_GROUP_get_point_conversion_form(const EC_GROUP
+point_conversion_form_t __cdecl EC_GROUP_get_point_conversion_form(const EC_GROUP
                                                            *group)
 {
     return group->asn1_form;
 }
 
-size_t EC_GROUP_set_seed(EC_GROUP *group, const unsigned char *p, size_t len)
+size_t __cdecl EC_GROUP_set_seed(EC_GROUP *group, const unsigned char *p, size_t len)
 {
     OPENSSL_free(group->seed);
     group->seed = NULL;
@@ -494,17 +494,17 @@ size_t EC_GROUP_set_seed(EC_GROUP *group, const unsigned char *p, size_t len)
     return len;
 }
 
-unsigned char *EC_GROUP_get0_seed(const EC_GROUP *group)
+unsigned char * __cdecl EC_GROUP_get0_seed(const EC_GROUP *group)
 {
     return group->seed;
 }
 
-size_t EC_GROUP_get_seed_len(const EC_GROUP *group)
+size_t __cdecl EC_GROUP_get_seed_len(const EC_GROUP *group)
 {
     return group->seed_len;
 }
 
-int EC_GROUP_set_curve(EC_GROUP *group, const BIGNUM *p, const BIGNUM *a,
+int __cdecl EC_GROUP_set_curve(EC_GROUP *group, const BIGNUM *p, const BIGNUM *a,
                        const BIGNUM *b, BN_CTX *ctx)
 {
     if (group->meth->group_set_curve == 0) {
@@ -514,7 +514,7 @@ int EC_GROUP_set_curve(EC_GROUP *group, const BIGNUM *p, const BIGNUM *a,
     return group->meth->group_set_curve(group, p, a, b, ctx);
 }
 
-int EC_GROUP_get_curve(const EC_GROUP *group, BIGNUM *p, BIGNUM *a, BIGNUM *b,
+int __cdecl EC_GROUP_get_curve(const EC_GROUP *group, BIGNUM *p, BIGNUM *a, BIGNUM *b,
                        BN_CTX *ctx)
 {
     if (group->meth->group_get_curve == NULL) {
@@ -525,26 +525,26 @@ int EC_GROUP_get_curve(const EC_GROUP *group, BIGNUM *p, BIGNUM *a, BIGNUM *b,
 }
 
 #if OPENSSL_API_COMPAT < 0x10200000L
-int EC_GROUP_set_curve_GFp(EC_GROUP *group, const BIGNUM *p, const BIGNUM *a,
+int __cdecl EC_GROUP_set_curve_GFp(EC_GROUP *group, const BIGNUM *p, const BIGNUM *a,
                            const BIGNUM *b, BN_CTX *ctx)
 {
     return EC_GROUP_set_curve(group, p, a, b, ctx);
 }
 
-int EC_GROUP_get_curve_GFp(const EC_GROUP *group, BIGNUM *p, BIGNUM *a,
+int __cdecl EC_GROUP_get_curve_GFp(const EC_GROUP *group, BIGNUM *p, BIGNUM *a,
                            BIGNUM *b, BN_CTX *ctx)
 {
     return EC_GROUP_get_curve(group, p, a, b, ctx);
 }
 
 # ifndef OPENSSL_NO_EC2M
-int EC_GROUP_set_curve_GF2m(EC_GROUP *group, const BIGNUM *p, const BIGNUM *a,
+int __cdecl EC_GROUP_set_curve_GF2m(EC_GROUP *group, const BIGNUM *p, const BIGNUM *a,
                             const BIGNUM *b, BN_CTX *ctx)
 {
     return EC_GROUP_set_curve(group, p, a, b, ctx);
 }
 
-int EC_GROUP_get_curve_GF2m(const EC_GROUP *group, BIGNUM *p, BIGNUM *a,
+int __cdecl EC_GROUP_get_curve_GF2m(const EC_GROUP *group, BIGNUM *p, BIGNUM *a,
                             BIGNUM *b, BN_CTX *ctx)
 {
     return EC_GROUP_get_curve(group, p, a, b, ctx);
@@ -552,7 +552,7 @@ int EC_GROUP_get_curve_GF2m(const EC_GROUP *group, BIGNUM *p, BIGNUM *a,
 # endif
 #endif
 
-int EC_GROUP_get_degree(const EC_GROUP *group)
+int __cdecl EC_GROUP_get_degree(const EC_GROUP *group)
 {
     if (group->meth->group_get_degree == 0) {
         ECerr(EC_F_EC_GROUP_GET_DEGREE, ERR_R_SHOULD_NOT_HAVE_BEEN_CALLED);
@@ -561,7 +561,7 @@ int EC_GROUP_get_degree(const EC_GROUP *group)
     return group->meth->group_get_degree(group);
 }
 
-int EC_GROUP_check_discriminant(const EC_GROUP *group, BN_CTX *ctx)
+int __cdecl EC_GROUP_check_discriminant(const EC_GROUP *group, BN_CTX *ctx)
 {
     if (group->meth->group_check_discriminant == 0) {
         ECerr(EC_F_EC_GROUP_CHECK_DISCRIMINANT,
@@ -571,7 +571,7 @@ int EC_GROUP_check_discriminant(const EC_GROUP *group, BN_CTX *ctx)
     return group->meth->group_check_discriminant(group, ctx);
 }
 
-int EC_GROUP_cmp(const EC_GROUP *a, const EC_GROUP *b, BN_CTX *ctx)
+int __cdecl EC_GROUP_cmp(const EC_GROUP *a, const EC_GROUP *b, BN_CTX *ctx)
 {
     int r = 0;
     BIGNUM *a1, *a2, *a3, *b1, *b2, *b3;
@@ -646,7 +646,7 @@ int EC_GROUP_cmp(const EC_GROUP *a, const EC_GROUP *b, BN_CTX *ctx)
 
 /* functions for EC_POINT objects */
 
-EC_POINT *EC_POINT_new(const EC_GROUP *group)
+EC_POINT * __cdecl EC_POINT_new(const EC_GROUP *group)
 {
     EC_POINT *ret;
 
@@ -676,7 +676,7 @@ EC_POINT *EC_POINT_new(const EC_GROUP *group)
     return ret;
 }
 
-void EC_POINT_free(EC_POINT *point)
+void __cdecl EC_POINT_free(EC_POINT *point)
 {
     if (!point)
         return;
@@ -686,7 +686,7 @@ void EC_POINT_free(EC_POINT *point)
     OPENSSL_free(point);
 }
 
-void EC_POINT_clear_free(EC_POINT *point)
+void __cdecl EC_POINT_clear_free(EC_POINT *point)
 {
     if (!point)
         return;
@@ -698,7 +698,7 @@ void EC_POINT_clear_free(EC_POINT *point)
     OPENSSL_clear_free(point, sizeof(*point));
 }
 
-int EC_POINT_copy(EC_POINT *dest, const EC_POINT *src)
+int __cdecl EC_POINT_copy(EC_POINT *dest, const EC_POINT *src)
 {
     if (dest->meth->point_copy == 0) {
         ECerr(EC_F_EC_POINT_COPY, ERR_R_SHOULD_NOT_HAVE_BEEN_CALLED);
@@ -716,7 +716,7 @@ int EC_POINT_copy(EC_POINT *dest, const EC_POINT *src)
     return dest->meth->point_copy(dest, src);
 }
 
-EC_POINT *EC_POINT_dup(const EC_POINT *a, const EC_GROUP *group)
+EC_POINT * __cdecl EC_POINT_dup(const EC_POINT *a, const EC_GROUP *group)
 {
     EC_POINT *t;
     int r;
@@ -735,12 +735,12 @@ EC_POINT *EC_POINT_dup(const EC_POINT *a, const EC_GROUP *group)
     return t;
 }
 
-const EC_METHOD *EC_POINT_method_of(const EC_POINT *point)
+const EC_METHOD * __cdecl EC_POINT_method_of(const EC_POINT *point)
 {
     return point->meth;
 }
 
-int EC_POINT_set_to_infinity(const EC_GROUP *group, EC_POINT *point)
+int __cdecl EC_POINT_set_to_infinity(const EC_GROUP *group, EC_POINT *point)
 {
     if (group->meth->point_set_to_infinity == 0) {
         ECerr(EC_F_EC_POINT_SET_TO_INFINITY,
@@ -754,7 +754,7 @@ int EC_POINT_set_to_infinity(const EC_GROUP *group, EC_POINT *point)
     return group->meth->point_set_to_infinity(group, point);
 }
 
-int EC_POINT_set_Jprojective_coordinates_GFp(const EC_GROUP *group,
+int __cdecl EC_POINT_set_Jprojective_coordinates_GFp(const EC_GROUP *group,
                                              EC_POINT *point, const BIGNUM *x,
                                              const BIGNUM *y, const BIGNUM *z,
                                              BN_CTX *ctx)
@@ -773,7 +773,7 @@ int EC_POINT_set_Jprojective_coordinates_GFp(const EC_GROUP *group,
                                                               y, z, ctx);
 }
 
-int EC_POINT_get_Jprojective_coordinates_GFp(const EC_GROUP *group,
+int __cdecl EC_POINT_get_Jprojective_coordinates_GFp(const EC_GROUP *group,
                                              const EC_POINT *point, BIGNUM *x,
                                              BIGNUM *y, BIGNUM *z,
                                              BN_CTX *ctx)
@@ -792,7 +792,7 @@ int EC_POINT_get_Jprojective_coordinates_GFp(const EC_GROUP *group,
                                                               y, z, ctx);
 }
 
-int EC_POINT_set_affine_coordinates(const EC_GROUP *group, EC_POINT *point,
+int __cdecl EC_POINT_set_affine_coordinates(const EC_GROUP *group, EC_POINT *point,
                                     const BIGNUM *x, const BIGNUM *y,
                                     BN_CTX *ctx)
 {
@@ -816,7 +816,7 @@ int EC_POINT_set_affine_coordinates(const EC_GROUP *group, EC_POINT *point,
 }
 
 #if OPENSSL_API_COMPAT < 0x10200000L
-int EC_POINT_set_affine_coordinates_GFp(const EC_GROUP *group,
+int __cdecl EC_POINT_set_affine_coordinates_GFp(const EC_GROUP *group,
                                         EC_POINT *point, const BIGNUM *x,
                                         const BIGNUM *y, BN_CTX *ctx)
 {
@@ -824,7 +824,7 @@ int EC_POINT_set_affine_coordinates_GFp(const EC_GROUP *group,
 }
 
 # ifndef OPENSSL_NO_EC2M
-int EC_POINT_set_affine_coordinates_GF2m(const EC_GROUP *group,
+int __cdecl EC_POINT_set_affine_coordinates_GF2m(const EC_GROUP *group,
                                          EC_POINT *point, const BIGNUM *x,
                                          const BIGNUM *y, BN_CTX *ctx)
 {
@@ -833,7 +833,7 @@ int EC_POINT_set_affine_coordinates_GF2m(const EC_GROUP *group,
 # endif
 #endif
 
-int EC_POINT_get_affine_coordinates(const EC_GROUP *group,
+int __cdecl EC_POINT_get_affine_coordinates(const EC_GROUP *group,
                                     const EC_POINT *point, BIGNUM *x, BIGNUM *y,
                                     BN_CTX *ctx)
 {
@@ -854,7 +854,7 @@ int EC_POINT_get_affine_coordinates(const EC_GROUP *group,
 }
 
 #if OPENSSL_API_COMPAT < 0x10200000L
-int EC_POINT_get_affine_coordinates_GFp(const EC_GROUP *group,
+int __cdecl EC_POINT_get_affine_coordinates_GFp(const EC_GROUP *group,
                                         const EC_POINT *point, BIGNUM *x,
                                         BIGNUM *y, BN_CTX *ctx)
 {
@@ -862,7 +862,7 @@ int EC_POINT_get_affine_coordinates_GFp(const EC_GROUP *group,
 }
 
 # ifndef OPENSSL_NO_EC2M
-int EC_POINT_get_affine_coordinates_GF2m(const EC_GROUP *group,
+int __cdecl EC_POINT_get_affine_coordinates_GF2m(const EC_GROUP *group,
                                          const EC_POINT *point, BIGNUM *x,
                                          BIGNUM *y, BN_CTX *ctx)
 {
@@ -871,7 +871,7 @@ int EC_POINT_get_affine_coordinates_GF2m(const EC_GROUP *group,
 # endif
 #endif
 
-int EC_POINT_add(const EC_GROUP *group, EC_POINT *r, const EC_POINT *a,
+int __cdecl EC_POINT_add(const EC_GROUP *group, EC_POINT *r, const EC_POINT *a,
                  const EC_POINT *b, BN_CTX *ctx)
 {
     if (group->meth->add == 0) {
@@ -886,7 +886,7 @@ int EC_POINT_add(const EC_GROUP *group, EC_POINT *r, const EC_POINT *a,
     return group->meth->add(group, r, a, b, ctx);
 }
 
-int EC_POINT_dbl(const EC_GROUP *group, EC_POINT *r, const EC_POINT *a,
+int __cdecl EC_POINT_dbl(const EC_GROUP *group, EC_POINT *r, const EC_POINT *a,
                  BN_CTX *ctx)
 {
     if (group->meth->dbl == 0) {
@@ -900,7 +900,7 @@ int EC_POINT_dbl(const EC_GROUP *group, EC_POINT *r, const EC_POINT *a,
     return group->meth->dbl(group, r, a, ctx);
 }
 
-int EC_POINT_invert(const EC_GROUP *group, EC_POINT *a, BN_CTX *ctx)
+int __cdecl EC_POINT_invert(const EC_GROUP *group, EC_POINT *a, BN_CTX *ctx)
 {
     if (group->meth->invert == 0) {
         ECerr(EC_F_EC_POINT_INVERT, ERR_R_SHOULD_NOT_HAVE_BEEN_CALLED);
@@ -913,7 +913,7 @@ int EC_POINT_invert(const EC_GROUP *group, EC_POINT *a, BN_CTX *ctx)
     return group->meth->invert(group, a, ctx);
 }
 
-int EC_POINT_is_at_infinity(const EC_GROUP *group, const EC_POINT *point)
+int __cdecl EC_POINT_is_at_infinity(const EC_GROUP *group, const EC_POINT *point)
 {
     if (group->meth->is_at_infinity == 0) {
         ECerr(EC_F_EC_POINT_IS_AT_INFINITY,
@@ -934,7 +934,7 @@ int EC_POINT_is_at_infinity(const EC_GROUP *group, const EC_POINT *point)
  *  0: The point is not on the curve
  * -1: An error occurred
  */
-int EC_POINT_is_on_curve(const EC_GROUP *group, const EC_POINT *point,
+int __cdecl EC_POINT_is_on_curve(const EC_GROUP *group, const EC_POINT *point,
                          BN_CTX *ctx)
 {
     if (group->meth->is_on_curve == 0) {
@@ -948,7 +948,7 @@ int EC_POINT_is_on_curve(const EC_GROUP *group, const EC_POINT *point,
     return group->meth->is_on_curve(group, point, ctx);
 }
 
-int EC_POINT_cmp(const EC_GROUP *group, const EC_POINT *a, const EC_POINT *b,
+int __cdecl EC_POINT_cmp(const EC_GROUP *group, const EC_POINT *a, const EC_POINT *b,
                  BN_CTX *ctx)
 {
     if (group->meth->point_cmp == 0) {
@@ -962,7 +962,7 @@ int EC_POINT_cmp(const EC_GROUP *group, const EC_POINT *a, const EC_POINT *b,
     return group->meth->point_cmp(group, a, b, ctx);
 }
 
-int EC_POINT_make_affine(const EC_GROUP *group, EC_POINT *point, BN_CTX *ctx)
+int __cdecl EC_POINT_make_affine(const EC_GROUP *group, EC_POINT *point, BN_CTX *ctx)
 {
     if (group->meth->make_affine == 0) {
         ECerr(EC_F_EC_POINT_MAKE_AFFINE, ERR_R_SHOULD_NOT_HAVE_BEEN_CALLED);
@@ -975,7 +975,7 @@ int EC_POINT_make_affine(const EC_GROUP *group, EC_POINT *point, BN_CTX *ctx)
     return group->meth->make_affine(group, point, ctx);
 }
 
-int EC_POINTs_make_affine(const EC_GROUP *group, size_t num,
+int __cdecl EC_POINTs_make_affine(const EC_GROUP *group, size_t num,
                           EC_POINT *points[], BN_CTX *ctx)
 {
     size_t i;
@@ -999,7 +999,7 @@ int EC_POINTs_make_affine(const EC_GROUP *group, size_t num,
  * methods.
  */
 
-int EC_POINTs_mul(const EC_GROUP *group, EC_POINT *r, const BIGNUM *scalar,
+int __cdecl EC_POINTs_mul(const EC_GROUP *group, EC_POINT *r, const BIGNUM *scalar,
                   size_t num, const EC_POINT *points[],
                   const BIGNUM *scalars[], BN_CTX *ctx)
 {
@@ -1037,7 +1037,7 @@ int EC_POINTs_mul(const EC_GROUP *group, EC_POINT *r, const BIGNUM *scalar,
     return ret;
 }
 
-int EC_POINT_mul(const EC_GROUP *group, EC_POINT *r, const BIGNUM *g_scalar,
+int __cdecl EC_POINT_mul(const EC_GROUP *group, EC_POINT *r, const BIGNUM *g_scalar,
                  const EC_POINT *point, const BIGNUM *p_scalar, BN_CTX *ctx)
 {
     /* just a convenient interface to EC_POINTs_mul() */
@@ -1053,7 +1053,7 @@ int EC_POINT_mul(const EC_GROUP *group, EC_POINT *r, const BIGNUM *g_scalar,
                           && p_scalar != NULL), points, scalars, ctx);
 }
 
-int EC_GROUP_precompute_mult(EC_GROUP *group, BN_CTX *ctx)
+int __cdecl EC_GROUP_precompute_mult(EC_GROUP *group, BN_CTX *ctx)
 {
     if (group->meth->mul == 0)
         /* use default */
@@ -1065,7 +1065,7 @@ int EC_GROUP_precompute_mult(EC_GROUP *group, BN_CTX *ctx)
         return 1;               /* nothing to do, so report success */
 }
 
-int EC_GROUP_have_precompute_mult(const EC_GROUP *group)
+int __cdecl EC_GROUP_have_precompute_mult(const EC_GROUP *group)
 {
     if (group->meth->mul == 0)
         /* use default */
@@ -1111,12 +1111,12 @@ static int ec_precompute_mont_data(EC_GROUP *group)
     return ret;
 }
 
-int EC_KEY_set_ex_data(EC_KEY *key, int idx, void *arg)
+int __cdecl EC_KEY_set_ex_data(EC_KEY *key, int idx, void *arg)
 {
     return CRYPTO_set_ex_data(&key->ex_data, idx, arg);
 }
 
-void *EC_KEY_get_ex_data(const EC_KEY *key, int idx)
+void * __cdecl EC_KEY_get_ex_data(const EC_KEY *key, int idx)
 {
     return CRYPTO_get_ex_data(&key->ex_data, idx);
 }
diff --git a/crypto/ec/ec_oct.c b/crypto/ec/ec_oct.c
index 522f79e673..8ce78e8084 100644
--- a/crypto/ec/ec_oct.c
+++ b/crypto/ec/ec_oct.c
@@ -15,7 +15,7 @@
 
 #include "ec_lcl.h"
 
-int EC_POINT_set_compressed_coordinates(const EC_GROUP *group, EC_POINT *point,
+int __cdecl EC_POINT_set_compressed_coordinates(const EC_GROUP *group, EC_POINT *point,
                                         const BIGNUM *x, int y_bit, BN_CTX *ctx)
 {
     if (group->meth->point_set_compressed_coordinates == NULL
@@ -50,7 +50,7 @@ int EC_POINT_set_compressed_coordinates(const EC_GROUP *group, EC_POINT *point,
 }
 
 #if OPENSSL_API_COMPAT < 0x10200000L
-int EC_POINT_set_compressed_coordinates_GFp(const EC_GROUP *group,
+int __cdecl EC_POINT_set_compressed_coordinates_GFp(const EC_GROUP *group,
                                             EC_POINT *point, const BIGNUM *x,
                                             int y_bit, BN_CTX *ctx)
 {
@@ -58,7 +58,7 @@ int EC_POINT_set_compressed_coordinates_GFp(const EC_GROUP *group,
 }
 
 # ifndef OPENSSL_NO_EC2M
-int EC_POINT_set_compressed_coordinates_GF2m(const EC_GROUP *group,
+int __cdecl EC_POINT_set_compressed_coordinates_GF2m(const EC_GROUP *group,
                                              EC_POINT *point, const BIGNUM *x,
                                              int y_bit, BN_CTX *ctx)
 {
@@ -67,7 +67,7 @@ int EC_POINT_set_compressed_coordinates_GF2m(const EC_GROUP *group,
 # endif
 #endif
 
-size_t EC_POINT_point2oct(const EC_GROUP *group, const EC_POINT *point,
+size_t __cdecl EC_POINT_point2oct(const EC_GROUP *group, const EC_POINT *point,
                           point_conversion_form_t form, unsigned char *buf,
                           size_t len, BN_CTX *ctx)
 {
@@ -98,7 +98,7 @@ size_t EC_POINT_point2oct(const EC_GROUP *group, const EC_POINT *point,
     return group->meth->point2oct(group, point, form, buf, len, ctx);
 }
 
-int EC_POINT_oct2point(const EC_GROUP *group, EC_POINT *point,
+int __cdecl EC_POINT_oct2point(const EC_GROUP *group, EC_POINT *point,
                        const unsigned char *buf, size_t len, BN_CTX *ctx)
 {
     if (group->meth->oct2point == 0
@@ -126,7 +126,7 @@ int EC_POINT_oct2point(const EC_GROUP *group, EC_POINT *point,
     return group->meth->oct2point(group, point, buf, len, ctx);
 }
 
-size_t EC_POINT_point2buf(const EC_GROUP *group, const EC_POINT *point,
+size_t __cdecl EC_POINT_point2buf(const EC_GROUP *group, const EC_POINT *point,
                           point_conversion_form_t form,
                           unsigned char **pbuf, BN_CTX *ctx)
 {
diff --git a/crypto/ec/ec_print.c b/crypto/ec/ec_print.c
index 027a51928a..4e9ec1f2df 100644
--- a/crypto/ec/ec_print.c
+++ b/crypto/ec/ec_print.c
@@ -11,7 +11,7 @@
 #include <openssl/err.h>
 #include "ec_lcl.h"
 
-BIGNUM *EC_POINT_point2bn(const EC_GROUP *group,
+BIGNUM * __cdecl EC_POINT_point2bn(const EC_GROUP *group,
                           const EC_POINT *point,
                           point_conversion_form_t form,
                           BIGNUM *ret, BN_CTX *ctx)
@@ -31,7 +31,7 @@ BIGNUM *EC_POINT_point2bn(const EC_GROUP *group,
     return ret;
 }
 
-EC_POINT *EC_POINT_bn2point(const EC_GROUP *group,
+EC_POINT * __cdecl EC_POINT_bn2point(const EC_GROUP *group,
                             const BIGNUM *bn, EC_POINT *point, BN_CTX *ctx)
 {
     size_t buf_len = 0;
@@ -72,7 +72,7 @@ EC_POINT *EC_POINT_bn2point(const EC_GROUP *group,
 static const char *HEX_DIGITS = "0123456789ABCDEF";
 
 /* the return value must be freed (using OPENSSL_free()) */
-char *EC_POINT_point2hex(const EC_GROUP *group,
+char * __cdecl EC_POINT_point2hex(const EC_GROUP *group,
                          const EC_POINT *point,
                          point_conversion_form_t form, BN_CTX *ctx)
 {
@@ -104,7 +104,7 @@ char *EC_POINT_point2hex(const EC_GROUP *group,
     return ret;
 }
 
-EC_POINT *EC_POINT_hex2point(const EC_GROUP *group,
+EC_POINT * __cdecl EC_POINT_hex2point(const EC_GROUP *group,
                              const char *buf, EC_POINT *point, BN_CTX *ctx)
 {
     EC_POINT *ret = NULL;
diff --git a/crypto/ec/ecdh_kdf.c b/crypto/ec/ecdh_kdf.c
index d686f9d897..ee9a659d30 100644
--- a/crypto/ec/ecdh_kdf.c
+++ b/crypto/ec/ecdh_kdf.c
@@ -72,7 +72,7 @@ int ecdh_KDF_X9_63(unsigned char *out, size_t outlen,
  * The old name for ecdh_KDF_X9_63
  * Retained for ABI compatibility
  */
-int ECDH_KDF_X9_62(unsigned char *out, size_t outlen,
+int __cdecl ECDH_KDF_X9_62(unsigned char *out, size_t outlen,
                    const unsigned char *Z, size_t Zlen,
                    const unsigned char *sinfo, size_t sinfolen,
                    const EVP_MD *md)
diff --git a/crypto/ec/ecdsa_sign.c b/crypto/ec/ecdsa_sign.c
index aee06e991b..63885b23ab 100644
--- a/crypto/ec/ecdsa_sign.c
+++ b/crypto/ec/ecdsa_sign.c
@@ -11,12 +11,12 @@
 #include "ec_lcl.h"
 #include <openssl/err.h>
 
-ECDSA_SIG *ECDSA_do_sign(const unsigned char *dgst, int dlen, EC_KEY *eckey)
+ECDSA_SIG * __cdecl ECDSA_do_sign(const unsigned char *dgst, int dlen, EC_KEY *eckey)
 {
     return ECDSA_do_sign_ex(dgst, dlen, NULL, NULL, eckey);
 }
 
-ECDSA_SIG *ECDSA_do_sign_ex(const unsigned char *dgst, int dlen,
+ECDSA_SIG * __cdecl ECDSA_do_sign_ex(const unsigned char *dgst, int dlen,
                             const BIGNUM *kinv, const BIGNUM *rp,
                             EC_KEY *eckey)
 {
@@ -26,13 +26,13 @@ ECDSA_SIG *ECDSA_do_sign_ex(const unsigned char *dgst, int dlen,
     return NULL;
 }
 
-int ECDSA_sign(int type, const unsigned char *dgst, int dlen, unsigned char
+int __cdecl ECDSA_sign(int type, const unsigned char *dgst, int dlen, unsigned char
                *sig, unsigned int *siglen, EC_KEY *eckey)
 {
     return ECDSA_sign_ex(type, dgst, dlen, sig, siglen, NULL, NULL, eckey);
 }
 
-int ECDSA_sign_ex(int type, const unsigned char *dgst, int dlen,
+int __cdecl ECDSA_sign_ex(int type, const unsigned char *dgst, int dlen,
                   unsigned char *sig, unsigned int *siglen, const BIGNUM *kinv,
                   const BIGNUM *r, EC_KEY *eckey)
 {
@@ -42,7 +42,7 @@ int ECDSA_sign_ex(int type, const unsigned char *dgst, int dlen,
     return 0;
 }
 
-int ECDSA_sign_setup(EC_KEY *eckey, BN_CTX *ctx_in, BIGNUM **kinvp,
+int __cdecl ECDSA_sign_setup(EC_KEY *eckey, BN_CTX *ctx_in, BIGNUM **kinvp,
                      BIGNUM **rp)
 {
     if (eckey->meth->sign_setup != NULL)
diff --git a/crypto/ec/ecdsa_vrf.c b/crypto/ec/ecdsa_vrf.c
index f61a20063e..1ad144e08c 100644
--- a/crypto/ec/ecdsa_vrf.c
+++ b/crypto/ec/ecdsa_vrf.c
@@ -17,7 +17,7 @@
  *      0: incorrect signature
  *     -1: error
  */
-int ECDSA_do_verify(const unsigned char *dgst, int dgst_len,
+int __cdecl ECDSA_do_verify(const unsigned char *dgst, int dgst_len,
                     const ECDSA_SIG *sig, EC_KEY *eckey)
 {
     if (eckey->meth->verify_sig != NULL)
@@ -32,7 +32,7 @@ int ECDSA_do_verify(const unsigned char *dgst, int dgst_len,
  *      0: incorrect signature
  *     -1: error
  */
-int ECDSA_verify(int type, const unsigned char *dgst, int dgst_len,
+int __cdecl ECDSA_verify(int type, const unsigned char *dgst, int dgst_len,
                  const unsigned char *sigbuf, int sig_len, EC_KEY *eckey)
 {
     if (eckey->meth->verify != NULL)
diff --git a/crypto/ec/eck_prn.c b/crypto/ec/eck_prn.c
index b538fadcb1..01c5909842 100644
--- a/crypto/ec/eck_prn.c
+++ b/crypto/ec/eck_prn.c
@@ -15,7 +15,7 @@
 #include <openssl/bn.h>
 
 #ifndef OPENSSL_NO_STDIO
-int ECPKParameters_print_fp(FILE *fp, const EC_GROUP *x, int off)
+int __cdecl ECPKParameters_print_fp(FILE *fp, const EC_GROUP *x, int off)
 {
     BIO *b;
     int ret;
@@ -30,7 +30,7 @@ int ECPKParameters_print_fp(FILE *fp, const EC_GROUP *x, int off)
     return ret;
 }
 
-int EC_KEY_print_fp(FILE *fp, const EC_KEY *x, int off)
+int __cdecl EC_KEY_print_fp(FILE *fp, const EC_KEY *x, int off)
 {
     BIO *b;
     int ret;
@@ -45,7 +45,7 @@ int EC_KEY_print_fp(FILE *fp, const EC_KEY *x, int off)
     return ret;
 }
 
-int ECParameters_print_fp(FILE *fp, const EC_KEY *x)
+int __cdecl ECParameters_print_fp(FILE *fp, const EC_KEY *x)
 {
     BIO *b;
     int ret;
@@ -64,7 +64,7 @@ int ECParameters_print_fp(FILE *fp, const EC_KEY *x)
 static int print_bin(BIO *fp, const char *str, const unsigned char *num,
                      size_t len, int off);
 
-int ECPKParameters_print(BIO *bp, const EC_GROUP *x, int off)
+int __cdecl ECPKParameters_print(BIO *bp, const EC_GROUP *x, int off)
 {
     int ret = 0, reason = ERR_R_BIO_LIB;
     BN_CTX *ctx = NULL;
diff --git a/crypto/ec/ecp_mont.c b/crypto/ec/ecp_mont.c
index 252e66ef37..2e7a831802 100644
--- a/crypto/ec/ecp_mont.c
+++ b/crypto/ec/ecp_mont.c
@@ -12,7 +12,7 @@
 
 #include "ec_lcl.h"
 
-const EC_METHOD *EC_GFp_mont_method(void)
+const EC_METHOD * __cdecl EC_GFp_mont_method(void)
 {
     static const EC_METHOD ret = {
         EC_FLAGS_DEFAULT_OCT,
diff --git a/crypto/ec/ecp_nist.c b/crypto/ec/ecp_nist.c
index 5eaa99d840..2b0a10f17b 100644
--- a/crypto/ec/ecp_nist.c
+++ b/crypto/ec/ecp_nist.c
@@ -14,7 +14,7 @@
 #include <openssl/obj_mac.h>
 #include "ec_lcl.h"
 
-const EC_METHOD *EC_GFp_nist_method(void)
+const EC_METHOD * __cdecl EC_GFp_nist_method(void)
 {
     static const EC_METHOD ret = {
         EC_FLAGS_DEFAULT_OCT,
diff --git a/crypto/ec/ecp_nistp224.c b/crypto/ec/ecp_nistp224.c
index fbbdb9d938..2634056570 100644
--- a/crypto/ec/ecp_nistp224.c
+++ b/crypto/ec/ecp_nistp224.c
@@ -239,7 +239,7 @@ struct nistp224_pre_comp_st {
     CRYPTO_RWLOCK *lock;
 };
 
-const EC_METHOD *EC_GFp_nistp224_method(void)
+const EC_METHOD * __cdecl EC_GFp_nistp224_method(void)
 {
     static const EC_METHOD ret = {
         EC_FLAGS_DEFAULT_OCT,
diff --git a/crypto/ec/ecp_nistp256.c b/crypto/ec/ecp_nistp256.c
index 22ba69aa44..2af40d97eb 100644
--- a/crypto/ec/ecp_nistp256.c
+++ b/crypto/ec/ecp_nistp256.c
@@ -1756,7 +1756,7 @@ struct nistp256_pre_comp_st {
     CRYPTO_RWLOCK *lock;
 };
 
-const EC_METHOD *EC_GFp_nistp256_method(void)
+const EC_METHOD * __cdecl EC_GFp_nistp256_method(void)
 {
     static const EC_METHOD ret = {
         EC_FLAGS_DEFAULT_OCT,
diff --git a/crypto/ec/ecp_nistp521.c b/crypto/ec/ecp_nistp521.c
index 6340f48279..ce6e39510b 100644
--- a/crypto/ec/ecp_nistp521.c
+++ b/crypto/ec/ecp_nistp521.c
@@ -1598,7 +1598,7 @@ struct nistp521_pre_comp_st {
     CRYPTO_RWLOCK *lock;
 };
 
-const EC_METHOD *EC_GFp_nistp521_method(void)
+const EC_METHOD * __cdecl EC_GFp_nistp521_method(void)
 {
     static const EC_METHOD ret = {
         EC_FLAGS_DEFAULT_OCT,
diff --git a/crypto/ec/ecp_smpl.c b/crypto/ec/ecp_smpl.c
index e6e4c9d2cb..3aab2f0220 100644
--- a/crypto/ec/ecp_smpl.c
+++ b/crypto/ec/ecp_smpl.c
@@ -13,7 +13,7 @@
 
 #include "ec_lcl.h"
 
-const EC_METHOD *EC_GFp_simple_method(void)
+const EC_METHOD * __cdecl EC_GFp_simple_method(void)
 {
     static const EC_METHOD ret = {
         EC_FLAGS_DEFAULT_OCT,
diff --git a/crypto/engine/eng_all.c b/crypto/engine/eng_all.c
index af306ccffc..c37fb7859b 100644
--- a/crypto/engine/eng_all.c
+++ b/crypto/engine/eng_all.c
@@ -10,7 +10,7 @@
 #include "internal/cryptlib.h"
 #include "eng_int.h"
 
-void ENGINE_load_builtin_engines(void)
+void __cdecl ENGINE_load_builtin_engines(void)
 {
     /* Some ENGINEs need this */
     OPENSSL_cpuid_setup();
diff --git a/crypto/engine/eng_cnf.c b/crypto/engine/eng_cnf.c
index 6f0a066d06..3a19b8511c 100644
--- a/crypto/engine/eng_cnf.c
+++ b/crypto/engine/eng_cnf.c
@@ -185,7 +185,7 @@ static void int_engine_module_finish(CONF_IMODULE *md)
     initialized_engines = NULL;
 }
 
-void ENGINE_add_conf_module(void)
+void __cdecl ENGINE_add_conf_module(void)
 {
     CONF_module_add("engines",
                     int_engine_module_init, int_engine_module_finish);
diff --git a/crypto/engine/eng_ctrl.c b/crypto/engine/eng_ctrl.c
index 3bc4aab16f..57a306616e 100644
--- a/crypto/engine/eng_ctrl.c
+++ b/crypto/engine/eng_ctrl.c
@@ -122,7 +122,7 @@ static int int_ctrl_helper(ENGINE *e, int cmd, long i, void *p,
     return -1;
 }
 
-int ENGINE_ctrl(ENGINE *e, int cmd, long i, void *p, void (*f) (void))
+int __cdecl ENGINE_ctrl(ENGINE *e, int cmd, long i, void *p, void (*f) (void))
 {
     int ctrl_exists, ref_exists;
     if (e == NULL) {
@@ -174,7 +174,7 @@ int ENGINE_ctrl(ENGINE *e, int cmd, long i, void *p, void (*f) (void))
     return e->ctrl(e, cmd, i, p, f);
 }
 
-int ENGINE_cmd_is_executable(ENGINE *e, int cmd)
+int __cdecl ENGINE_cmd_is_executable(ENGINE *e, int cmd)
 {
     int flags;
     if ((flags =
@@ -190,7 +190,7 @@ int ENGINE_cmd_is_executable(ENGINE *e, int cmd)
     return 1;
 }
 
-int ENGINE_ctrl_cmd(ENGINE *e, const char *cmd_name,
+int __cdecl ENGINE_ctrl_cmd(ENGINE *e, const char *cmd_name,
                     long i, void *p, void (*f) (void), int cmd_optional)
 {
     int num;
@@ -226,7 +226,7 @@ int ENGINE_ctrl_cmd(ENGINE *e, const char *cmd_name,
     return 0;
 }
 
-int ENGINE_ctrl_cmd_string(ENGINE *e, const char *cmd_name, const char *arg,
+int __cdecl ENGINE_ctrl_cmd_string(ENGINE *e, const char *cmd_name, const char *arg,
                            int cmd_optional)
 {
     int num, flags;
diff --git a/crypto/engine/eng_dyn.c b/crypto/engine/eng_dyn.c
index 843226c077..8844659541 100644
--- a/crypto/engine/eng_dyn.c
+++ b/crypto/engine/eng_dyn.c
@@ -117,7 +117,7 @@ struct st_dynamic_data_ctx {
  */
 static int dynamic_ex_data_idx = -1;
 
-static void int_free_str(char *s)
+static void __cdecl int_free_str(char *s)
 {
     OPENSSL_free(s);
 }
diff --git a/crypto/engine/eng_err.c b/crypto/engine/eng_err.c
index bd1aefa185..eec773c105 100644
--- a/crypto/engine/eng_err.c
+++ b/crypto/engine/eng_err.c
@@ -142,7 +142,7 @@ static const ERR_STRING_DATA ENGINE_str_reasons[] = {
 
 #endif
 
-int ERR_load_ENGINE_strings(void)
+int __cdecl ERR_load_ENGINE_strings(void)
 {
 #ifndef OPENSSL_NO_ERR
     if (ERR_func_error_string(ENGINE_str_functs[0].error) == NULL) {
diff --git a/crypto/engine/eng_fat.c b/crypto/engine/eng_fat.c
index 591fddc8e4..a7d5050732 100644
--- a/crypto/engine/eng_fat.c
+++ b/crypto/engine/eng_fat.c
@@ -11,7 +11,7 @@
 #include "eng_int.h"
 #include <openssl/conf.h>
 
-int ENGINE_set_default(ENGINE *e, unsigned int flags)
+int __cdecl ENGINE_set_default(ENGINE *e, unsigned int flags)
 {
     if ((flags & ENGINE_METHOD_CIPHERS) && !ENGINE_set_default_ciphers(e))
         return 0;
@@ -78,7 +78,7 @@ static int int_def_cb(const char *alg, int len, void *arg)
     return 1;
 }
 
-int ENGINE_set_default_string(ENGINE *e, const char *def_list)
+int __cdecl ENGINE_set_default_string(ENGINE *e, const char *def_list)
 {
     unsigned int flags = 0;
     if (!CONF_parse_list(def_list, ',', 1, int_def_cb, &flags)) {
@@ -90,7 +90,7 @@ int ENGINE_set_default_string(ENGINE *e, const char *def_list)
     return ENGINE_set_default(e, flags);
 }
 
-int ENGINE_register_complete(ENGINE *e)
+int __cdecl ENGINE_register_complete(ENGINE *e)
 {
     ENGINE_register_ciphers(e);
     ENGINE_register_digests(e);
@@ -112,7 +112,7 @@ int ENGINE_register_complete(ENGINE *e)
     return 1;
 }
 
-int ENGINE_register_all_complete(void)
+int __cdecl ENGINE_register_all_complete(void)
 {
     ENGINE *e;
 
diff --git a/crypto/engine/eng_init.c b/crypto/engine/eng_init.c
index 7c235fc472..f21b08fdf2 100644
--- a/crypto/engine/eng_init.c
+++ b/crypto/engine/eng_init.c
@@ -74,7 +74,7 @@ int engine_unlocked_finish(ENGINE *e, int unlock_for_handlers)
 }
 
 /* The API (locked) version of "init" */
-int ENGINE_init(ENGINE *e)
+int __cdecl ENGINE_init(ENGINE *e)
 {
     int ret;
     if (e == NULL) {
@@ -92,7 +92,7 @@ int ENGINE_init(ENGINE *e)
 }
 
 /* The API (locked) version of "finish" */
-int ENGINE_finish(ENGINE *e)
+int __cdecl ENGINE_finish(ENGINE *e)
 {
     int to_return = 1;
 
diff --git a/crypto/engine/eng_lib.c b/crypto/engine/eng_lib.c
index d7f2026fac..62853b561b 100644
--- a/crypto/engine/eng_lib.c
+++ b/crypto/engine/eng_lib.c
@@ -26,7 +26,7 @@ DEFINE_RUN_ONCE(do_engine_lock_init)
     return global_engine_lock != NULL;
 }
 
-ENGINE *ENGINE_new(void)
+ENGINE * __cdecl ENGINE_new(void)
 {
     ENGINE *ret;
 
@@ -97,7 +97,7 @@ int engine_free_util(ENGINE *e, int not_locked)
     return 1;
 }
 
-int ENGINE_free(ENGINE *e)
+int __cdecl ENGINE_free(ENGINE *e)
 {
     return engine_free_util(e, 1);
 }
@@ -157,7 +157,7 @@ void engine_cleanup_add_last(ENGINE_CLEANUP_CB *cb)
 }
 
 /* The API function that performs all cleanup */
-static void engine_cleanup_cb_free(ENGINE_CLEANUP_ITEM *item)
+static void __cdecl engine_cleanup_cb_free(ENGINE_CLEANUP_ITEM *item)
 {
     (*(item->cb)) ();
     OPENSSL_free(item);
@@ -175,12 +175,12 @@ void engine_cleanup_int(void)
 
 /* Now the "ex_data" support */
 
-int ENGINE_set_ex_data(ENGINE *e, int idx, void *arg)
+int __cdecl ENGINE_set_ex_data(ENGINE *e, int idx, void *arg)
 {
     return CRYPTO_set_ex_data(&e->ex_data, idx, arg);
 }
 
-void *ENGINE_get_ex_data(const ENGINE *e, int idx)
+void * __cdecl ENGINE_get_ex_data(const ENGINE *e, int idx)
 {
     return CRYPTO_get_ex_data(&e->ex_data, idx);
 }
@@ -190,7 +190,7 @@ void *ENGINE_get_ex_data(const ENGINE *e, int idx)
  * ENGINE structure itself.
  */
 
-int ENGINE_set_id(ENGINE *e, const char *id)
+int __cdecl ENGINE_set_id(ENGINE *e, const char *id)
 {
     if (id == NULL) {
         ENGINEerr(ENGINE_F_ENGINE_SET_ID, ERR_R_PASSED_NULL_PARAMETER);
@@ -200,7 +200,7 @@ int ENGINE_set_id(ENGINE *e, const char *id)
     return 1;
 }
 
-int ENGINE_set_name(ENGINE *e, const char *name)
+int __cdecl ENGINE_set_name(ENGINE *e, const char *name)
 {
     if (name == NULL) {
         ENGINEerr(ENGINE_F_ENGINE_SET_NAME, ERR_R_PASSED_NULL_PARAMETER);
@@ -210,78 +210,78 @@ int ENGINE_set_name(ENGINE *e, const char *name)
     return 1;
 }
 
-int ENGINE_set_destroy_function(ENGINE *e, ENGINE_GEN_INT_FUNC_PTR destroy_f)
+int __cdecl ENGINE_set_destroy_function(ENGINE *e, ENGINE_GEN_INT_FUNC_PTR destroy_f)
 {
     e->destroy = destroy_f;
     return 1;
 }
 
-int ENGINE_set_init_function(ENGINE *e, ENGINE_GEN_INT_FUNC_PTR init_f)
+int __cdecl ENGINE_set_init_function(ENGINE *e, ENGINE_GEN_INT_FUNC_PTR init_f)
 {
     e->init = init_f;
     return 1;
 }
 
-int ENGINE_set_finish_function(ENGINE *e, ENGINE_GEN_INT_FUNC_PTR finish_f)
+int __cdecl ENGINE_set_finish_function(ENGINE *e, ENGINE_GEN_INT_FUNC_PTR finish_f)
 {
     e->finish = finish_f;
     return 1;
 }
 
-int ENGINE_set_ctrl_function(ENGINE *e, ENGINE_CTRL_FUNC_PTR ctrl_f)
+int __cdecl ENGINE_set_ctrl_function(ENGINE *e, ENGINE_CTRL_FUNC_PTR ctrl_f)
 {
     e->ctrl = ctrl_f;
     return 1;
 }
 
-int ENGINE_set_flags(ENGINE *e, int flags)
+int __cdecl ENGINE_set_flags(ENGINE *e, int flags)
 {
     e->flags = flags;
     return 1;
 }
 
-int ENGINE_set_cmd_defns(ENGINE *e, const ENGINE_CMD_DEFN *defns)
+int __cdecl ENGINE_set_cmd_defns(ENGINE *e, const ENGINE_CMD_DEFN *defns)
 {
     e->cmd_defns = defns;
     return 1;
 }
 
-const char *ENGINE_get_id(const ENGINE *e)
+const char * __cdecl ENGINE_get_id(const ENGINE *e)
 {
     return e->id;
 }
 
-const char *ENGINE_get_name(const ENGINE *e)
+const char * __cdecl ENGINE_get_name(const ENGINE *e)
 {
     return e->name;
 }
 
-ENGINE_GEN_INT_FUNC_PTR ENGINE_get_destroy_function(const ENGINE *e)
+ENGINE_GEN_INT_FUNC_PTR __cdecl ENGINE_get_destroy_function(const ENGINE *e)
 {
     return e->destroy;
 }
 
-ENGINE_GEN_INT_FUNC_PTR ENGINE_get_init_function(const ENGINE *e)
+ENGINE_GEN_INT_FUNC_PTR __cdecl ENGINE_get_init_function(const ENGINE *e)
 {
     return e->init;
 }
 
-ENGINE_GEN_INT_FUNC_PTR ENGINE_get_finish_function(const ENGINE *e)
+ENGINE_GEN_INT_FUNC_PTR __cdecl ENGINE_get_finish_function(const ENGINE *e)
 {
     return e->finish;
 }
 
-ENGINE_CTRL_FUNC_PTR ENGINE_get_ctrl_function(const ENGINE *e)
+ENGINE_CTRL_FUNC_PTR __cdecl ENGINE_get_ctrl_function(const ENGINE *e)
 {
     return e->ctrl;
 }
 
-int ENGINE_get_flags(const ENGINE *e)
+int __cdecl ENGINE_get_flags(const ENGINE *e)
 {
     return e->flags;
 }
 
-const ENGINE_CMD_DEFN *ENGINE_get_cmd_defns(const ENGINE *e)
+const ENGINE_CMD_DEFN * __cdecl ENGINE_get_cmd_defns(const ENGINE *e)
 {
     return e->cmd_defns;
 }
@@ -293,7 +293,7 @@ const ENGINE_CMD_DEFN *ENGINE_get_cmd_defns(const ENGINE *e)
 
 static int internal_static_hack = 0;
 
-void *ENGINE_get_static_state(void)
+void * __cdecl ENGINE_get_static_state(void)
 {
     return &internal_static_hack;
 }
diff --git a/crypto/engine/eng_list.c b/crypto/engine/eng_list.c
index 45c339c541..e1eef752c8 100644
--- a/crypto/engine/eng_list.c
+++ b/crypto/engine/eng_list.c
@@ -127,7 +127,7 @@ static int engine_list_remove(ENGINE *e)
 }
 
 /* Get the first/last "ENGINE" type available. */
-ENGINE *ENGINE_get_first(void)
+ENGINE * __cdecl ENGINE_get_first(void)
 {
     ENGINE *ret;
 
@@ -146,7 +146,7 @@ ENGINE *ENGINE_get_first(void)
     return ret;
 }
 
-ENGINE *ENGINE_get_last(void)
+ENGINE * __cdecl ENGINE_get_last(void)
 {
     ENGINE *ret;
 
@@ -166,7 +166,7 @@ ENGINE *ENGINE_get_last(void)
 }
 
 /* Iterate to the next/previous "ENGINE" type (NULL = end of the list). */
-ENGINE *ENGINE_get_next(ENGINE *e)
+ENGINE * __cdecl ENGINE_get_next(ENGINE *e)
 {
     ENGINE *ret = NULL;
     if (e == NULL) {
@@ -186,7 +186,7 @@ ENGINE *ENGINE_get_next(ENGINE *e)
     return ret;
 }
 
-ENGINE *ENGINE_get_prev(ENGINE *e)
+ENGINE * __cdecl ENGINE_get_prev(ENGINE *e)
 {
     ENGINE *ret = NULL;
     if (e == NULL) {
@@ -207,7 +207,7 @@ ENGINE *ENGINE_get_prev(ENGINE *e)
 }
 
 /* Add another "ENGINE" type into the list. */
-int ENGINE_add(ENGINE *e)
+int __cdecl ENGINE_add(ENGINE *e)
 {
     int to_return = 1;
     if (e == NULL) {
@@ -228,7 +228,7 @@ int ENGINE_add(ENGINE *e)
 }
 
 /* Remove an existing "ENGINE" type from the array. */
-int ENGINE_remove(ENGINE *e)
+int __cdecl ENGINE_remove(ENGINE *e)
 {
     int to_return = 1;
     if (e == NULL) {
@@ -274,7 +274,7 @@ static void engine_cpy(ENGINE *dest, const ENGINE *src)
     dest->flags = src->flags;
 }
 
-ENGINE *ENGINE_by_id(const char *id)
+ENGINE * __cdecl ENGINE_by_id(const char *id)
 {
     ENGINE *iterator;
     char *load_dir = NULL;
@@ -337,7 +337,7 @@ ENGINE *ENGINE_by_id(const char *id)
     /* EEK! Experimental code ends */
 }
 
-int ENGINE_up_ref(ENGINE *e)
+int __cdecl ENGINE_up_ref(ENGINE *e)
 {
     int i;
     if (e == NULL) {
diff --git a/crypto/engine/eng_pkey.c b/crypto/engine/eng_pkey.c
index 305a648feb..2f0118985a 100644
--- a/crypto/engine/eng_pkey.c
+++ b/crypto/engine/eng_pkey.c
@@ -11,20 +11,20 @@
 
 /* Basic get/set stuff */
 
-int ENGINE_set_load_privkey_function(ENGINE *e,
+int __cdecl ENGINE_set_load_privkey_function(ENGINE *e,
                                      ENGINE_LOAD_KEY_PTR loadpriv_f)
 {
     e->load_privkey = loadpriv_f;
     return 1;
 }
 
-int ENGINE_set_load_pubkey_function(ENGINE *e, ENGINE_LOAD_KEY_PTR loadpub_f)
+int __cdecl ENGINE_set_load_pubkey_function(ENGINE *e, ENGINE_LOAD_KEY_PTR loadpub_f)
 {
     e->load_pubkey = loadpub_f;
     return 1;
 }
 
-int ENGINE_set_load_ssl_client_cert_function(ENGINE *e,
+int __cdecl ENGINE_set_load_ssl_client_cert_function(ENGINE *e,
                                              ENGINE_SSL_CLIENT_CERT_PTR
                                              loadssl_f)
 {
@@ -32,17 +32,17 @@ int ENGINE_set_load_ssl_client_cert_function(ENGINE *e,
     return 1;
 }
 
-ENGINE_LOAD_KEY_PTR ENGINE_get_load_privkey_function(const ENGINE *e)
+ENGINE_LOAD_KEY_PTR __cdecl ENGINE_get_load_privkey_function(const ENGINE *e)
 {
     return e->load_privkey;
 }
 
-ENGINE_LOAD_KEY_PTR ENGINE_get_load_pubkey_function(const ENGINE *e)
+ENGINE_LOAD_KEY_PTR __cdecl ENGINE_get_load_pubkey_function(const ENGINE *e)
 {
     return e->load_pubkey;
 }
 
-ENGINE_SSL_CLIENT_CERT_PTR ENGINE_get_ssl_client_cert_function(const ENGINE
+ENGINE_SSL_CLIENT_CERT_PTR __cdecl ENGINE_get_ssl_client_cert_function(const ENGINE
                                                                *e)
 {
     return e->load_ssl_client_cert;
@@ -50,7 +50,7 @@ ENGINE_SSL_CLIENT_CERT_PTR ENGINE_get_ssl_client_cert_function(const ENGINE
 
 /* API functions to load public/private keys */
 
-EVP_PKEY *ENGINE_load_private_key(ENGINE *e, const char *key_id,
+EVP_PKEY * __cdecl ENGINE_load_private_key(ENGINE *e, const char *key_id,
                                   UI_METHOD *ui_method, void *callback_data)
 {
     EVP_PKEY *pkey;
@@ -81,7 +81,7 @@ EVP_PKEY *ENGINE_load_private_key(ENGINE *e, const char *key_id,
     return pkey;
 }
 
-EVP_PKEY *ENGINE_load_public_key(ENGINE *e, const char *key_id,
+EVP_PKEY * __cdecl ENGINE_load_public_key(ENGINE *e, const char *key_id,
                                  UI_METHOD *ui_method, void *callback_data)
 {
     EVP_PKEY *pkey;
@@ -111,7 +111,7 @@ EVP_PKEY *ENGINE_load_public_key(ENGINE *e, const char *key_id,
     return pkey;
 }
 
-int ENGINE_load_ssl_client_cert(ENGINE *e, SSL *s,
+int __cdecl ENGINE_load_ssl_client_cert(ENGINE *e, SSL *s,
                                 STACK_OF(X509_NAME) *ca_dn, X509 **pcert,
                                 EVP_PKEY **ppkey, STACK_OF(X509) **pother,
                                 UI_METHOD *ui_method, void *callback_data)
diff --git a/crypto/engine/eng_table.c b/crypto/engine/eng_table.c
index ac4b02fc12..e3b10448dd 100644
--- a/crypto/engine/eng_table.c
+++ b/crypto/engine/eng_table.c
@@ -40,12 +40,12 @@ typedef struct st_engine_pile_doall {
 static unsigned int table_flags = 0;
 
 /* API function manipulating 'table_flags' */
-unsigned int ENGINE_get_table_flags(void)
+unsigned int __cdecl ENGINE_get_table_flags(void)
 {
     return table_flags;
 }
 
-void ENGINE_set_table_flags(unsigned int flags)
+void __cdecl ENGINE_set_table_flags(unsigned int flags)
 {
     table_flags = flags;
 }
@@ -56,7 +56,7 @@ static unsigned long engine_pile_hash(const ENGINE_PILE *c)
     return c->nid;
 }
 
-static int engine_pile_cmp(const ENGINE_PILE *a, const ENGINE_PILE *b)
+static int __cdecl engine_pile_cmp(const ENGINE_PILE *a, const ENGINE_PILE *b)
 {
     return a->nid - b->nid;
 }
diff --git a/crypto/engine/tb_asnmth.c b/crypto/engine/tb_asnmth.c
index 4bcc76136a..5d56cfade2 100644
--- a/crypto/engine/tb_asnmth.c
+++ b/crypto/engine/tb_asnmth.c
@@ -22,7 +22,7 @@
 
 static ENGINE_TABLE *pkey_asn1_meth_table = NULL;
 
-void ENGINE_unregister_pkey_asn1_meths(ENGINE *e)
+void __cdecl ENGINE_unregister_pkey_asn1_meths(ENGINE *e)
 {
     engine_table_unregister(&pkey_asn1_meth_table, e);
 }
@@ -32,7 +32,7 @@ static void engine_unregister_all_pkey_asn1_meths(void)
     engine_table_cleanup(&pkey_asn1_meth_table);
 }
 
-int ENGINE_register_pkey_asn1_meths(ENGINE *e)
+int __cdecl ENGINE_register_pkey_asn1_meths(ENGINE *e)
 {
     if (e->pkey_asn1_meths) {
         const int *nids;
@@ -45,7 +45,7 @@ int ENGINE_register_pkey_asn1_meths(ENGINE *e)
     return 1;
 }
 
-void ENGINE_register_all_pkey_asn1_meths(void)
+void __cdecl ENGINE_register_all_pkey_asn1_meths(void)
 {
     ENGINE *e;
 
@@ -53,7 +53,7 @@ void ENGINE_register_all_pkey_asn1_meths(void)
         ENGINE_register_pkey_asn1_meths(e);
 }
 
-int ENGINE_set_default_pkey_asn1_meths(ENGINE *e)
+int __cdecl ENGINE_set_default_pkey_asn1_meths(ENGINE *e)
 {
     if (e->pkey_asn1_meths) {
         const int *nids;
@@ -71,7 +71,7 @@ int ENGINE_set_default_pkey_asn1_meths(ENGINE *e)
  * table (ie. try to get a functional reference from the tabled structural
  * references) for a given pkey_asn1_meth 'nid'
  */
-ENGINE *ENGINE_get_pkey_asn1_meth_engine(int nid)
+ENGINE * __cdecl ENGINE_get_pkey_asn1_meth_engine(int nid)
 {
     return engine_table_select(&pkey_asn1_meth_table, nid);
 }
@@ -80,7 +80,7 @@ ENGINE *ENGINE_get_pkey_asn1_meth_engine(int nid)
  * Obtains a pkey_asn1_meth implementation from an ENGINE functional
  * reference
  */
-const EVP_PKEY_ASN1_METHOD *ENGINE_get_pkey_asn1_meth(ENGINE *e, int nid)
+const EVP_PKEY_ASN1_METHOD * __cdecl ENGINE_get_pkey_asn1_meth(ENGINE *e, int nid)
 {
     EVP_PKEY_ASN1_METHOD *ret;
     ENGINE_PKEY_ASN1_METHS_PTR fn = ENGINE_get_pkey_asn1_meths(e);
@@ -93,13 +93,13 @@ const EVP_PKEY_ASN1_METHOD *ENGINE_get_pkey_asn1_meth(ENGINE *e, int nid)
 }
 
 /* Gets the pkey_asn1_meth callback from an ENGINE structure */
-ENGINE_PKEY_ASN1_METHS_PTR ENGINE_get_pkey_asn1_meths(const ENGINE *e)
+ENGINE_PKEY_ASN1_METHS_PTR __cdecl ENGINE_get_pkey_asn1_meths(const ENGINE *e)
 {
     return e->pkey_asn1_meths;
 }
 
 /* Sets the pkey_asn1_meth callback in an ENGINE structure */
-int ENGINE_set_pkey_asn1_meths(ENGINE *e, ENGINE_PKEY_ASN1_METHS_PTR f)
+int __cdecl ENGINE_set_pkey_asn1_meths(ENGINE *e, ENGINE_PKEY_ASN1_METHS_PTR f)
 {
     e->pkey_asn1_meths = f;
     return 1;
@@ -133,7 +133,7 @@ void engine_pkey_asn1_meths_free(ENGINE *e)
  * for speed critical operations.
  */
 
-const EVP_PKEY_ASN1_METHOD *ENGINE_get_pkey_asn1_meth_str(ENGINE *e,
+const EVP_PKEY_ASN1_METHOD * __cdecl ENGINE_get_pkey_asn1_meth_str(ENGINE *e,
                                                           const char *str,
                                                           int len)
 {
@@ -181,7 +181,7 @@ static void look_str_cb(int nid, STACK_OF(ENGINE) *sk, ENGINE *def, void *arg)
     }
 }
 
-const EVP_PKEY_ASN1_METHOD *ENGINE_pkey_asn1_find_str(ENGINE **pe,
+const EVP_PKEY_ASN1_METHOD * __cdecl ENGINE_pkey_asn1_find_str(ENGINE **pe,
                                                       const char *str,
                                                       int len)
 {
diff --git a/crypto/engine/tb_cipher.c b/crypto/engine/tb_cipher.c
index faa967c475..99888b2bf8 100644
--- a/crypto/engine/tb_cipher.c
+++ b/crypto/engine/tb_cipher.c
@@ -11,7 +11,7 @@
 
 static ENGINE_TABLE *cipher_table = NULL;
 
-void ENGINE_unregister_ciphers(ENGINE *e)
+void __cdecl ENGINE_unregister_ciphers(ENGINE *e)
 {
     engine_table_unregister(&cipher_table, e);
 }
@@ -21,7 +21,7 @@ static void engine_unregister_all_ciphers(void)
     engine_table_cleanup(&cipher_table);
 }
 
-int ENGINE_register_ciphers(ENGINE *e)
+int __cdecl ENGINE_register_ciphers(ENGINE *e)
 {
     if (e->ciphers) {
         const int *nids;
@@ -34,7 +34,7 @@ int ENGINE_register_ciphers(ENGINE *e)
     return 1;
 }
 
-void ENGINE_register_all_ciphers(void)
+void __cdecl ENGINE_register_all_ciphers(void)
 {
     ENGINE *e;
 
@@ -42,7 +42,7 @@ void ENGINE_register_all_ciphers(void)
         ENGINE_register_ciphers(e);
 }
 
-int ENGINE_set_default_ciphers(ENGINE *e)
+int __cdecl ENGINE_set_default_ciphers(ENGINE *e)
 {
     if (e->ciphers) {
         const int *nids;
@@ -60,13 +60,13 @@ int ENGINE_set_default_ciphers(ENGINE *e)
  * table (ie. try to get a functional reference from the tabled structural
  * references) for a given cipher 'nid'
  */
-ENGINE *ENGINE_get_cipher_engine(int nid)
+ENGINE * __cdecl ENGINE_get_cipher_engine(int nid)
 {
     return engine_table_select(&cipher_table, nid);
 }
 
 /* Obtains a cipher implementation from an ENGINE functional reference */
-const EVP_CIPHER *ENGINE_get_cipher(ENGINE *e, int nid)
+const EVP_CIPHER * __cdecl ENGINE_get_cipher(ENGINE *e, int nid)
 {
     const EVP_CIPHER *ret;
     ENGINE_CIPHERS_PTR fn = ENGINE_get_ciphers(e);
@@ -78,13 +78,13 @@ const EVP_CIPHER *ENGINE_get_cipher(ENGINE *e, int nid)
 }
 
 /* Gets the cipher callback from an ENGINE structure */
-ENGINE_CIPHERS_PTR ENGINE_get_ciphers(const ENGINE *e)
+ENGINE_CIPHERS_PTR __cdecl ENGINE_get_ciphers(const ENGINE *e)
 {
     return e->ciphers;
 }
 
 /* Sets the cipher callback in an ENGINE structure */
-int ENGINE_set_ciphers(ENGINE *e, ENGINE_CIPHERS_PTR f)
+int __cdecl ENGINE_set_ciphers(ENGINE *e, ENGINE_CIPHERS_PTR f)
 {
     e->ciphers = f;
     return 1;
diff --git a/crypto/engine/tb_dh.c b/crypto/engine/tb_dh.c
index 785119f65a..8824be9eca 100644
--- a/crypto/engine/tb_dh.c
+++ b/crypto/engine/tb_dh.c
@@ -12,7 +12,7 @@
 static ENGINE_TABLE *dh_table = NULL;
 static const int dummy_nid = 1;
 
-void ENGINE_unregister_DH(ENGINE *e)
+void __cdecl ENGINE_unregister_DH(ENGINE *e)
 {
     engine_table_unregister(&dh_table, e);
 }
@@ -22,7 +22,7 @@ static void engine_unregister_all_DH(void)
     engine_table_cleanup(&dh_table);
 }
 
-int ENGINE_register_DH(ENGINE *e)
+int __cdecl ENGINE_register_DH(ENGINE *e)
 {
     if (e->dh_meth)
         return engine_table_register(&dh_table,
@@ -31,7 +31,7 @@ int ENGINE_register_DH(ENGINE *e)
     return 1;
 }
 
-void ENGINE_register_all_DH(void)
+void __cdecl ENGINE_register_all_DH(void)
 {
     ENGINE *e;
 
@@ -39,7 +39,7 @@ void ENGINE_register_all_DH(void)
         ENGINE_register_DH(e);
 }
 
-int ENGINE_set_default_DH(ENGINE *e)
+int __cdecl ENGINE_set_default_DH(ENGINE *e)
 {
     if (e->dh_meth)
         return engine_table_register(&dh_table,
@@ -53,19 +53,19 @@ int ENGINE_set_default_DH(ENGINE *e)
  * table (ie. try to get a functional reference from the tabled structural
  * references).
  */
-ENGINE *ENGINE_get_default_DH(void)
+ENGINE * __cdecl ENGINE_get_default_DH(void)
 {
     return engine_table_select(&dh_table, dummy_nid);
 }
 
 /* Obtains an DH implementation from an ENGINE functional reference */
-const DH_METHOD *ENGINE_get_DH(const ENGINE *e)
+const DH_METHOD * __cdecl ENGINE_get_DH(const ENGINE *e)
 {
     return e->dh_meth;
 }
 
 /* Sets an DH implementation in an ENGINE structure */
-int ENGINE_set_DH(ENGINE *e, const DH_METHOD *dh_meth)
+int __cdecl ENGINE_set_DH(ENGINE *e, const DH_METHOD *dh_meth)
 {
     e->dh_meth = dh_meth;
     return 1;
diff --git a/crypto/engine/tb_digest.c b/crypto/engine/tb_digest.c
index d644b1b0a8..995376b3e2 100644
--- a/crypto/engine/tb_digest.c
+++ b/crypto/engine/tb_digest.c
@@ -11,7 +11,7 @@
 
 static ENGINE_TABLE *digest_table = NULL;
 
-void ENGINE_unregister_digests(ENGINE *e)
+void __cdecl ENGINE_unregister_digests(ENGINE *e)
 {
     engine_table_unregister(&digest_table, e);
 }
@@ -21,7 +21,7 @@ static void engine_unregister_all_digests(void)
     engine_table_cleanup(&digest_table);
 }
 
-int ENGINE_register_digests(ENGINE *e)
+int __cdecl ENGINE_register_digests(ENGINE *e)
 {
     if (e->digests) {
         const int *nids;
@@ -34,7 +34,7 @@ int ENGINE_register_digests(ENGINE *e)
     return 1;
 }
 
-void ENGINE_register_all_digests(void)
+void __cdecl ENGINE_register_all_digests(void)
 {
     ENGINE *e;
 
@@ -42,7 +42,7 @@ void ENGINE_register_all_digests(void)
         ENGINE_register_digests(e);
 }
 
-int ENGINE_set_default_digests(ENGINE *e)
+int __cdecl ENGINE_set_default_digests(ENGINE *e)
 {
     if (e->digests) {
         const int *nids;
@@ -60,13 +60,13 @@ int ENGINE_set_default_digests(ENGINE *e)
  * table (ie. try to get a functional reference from the tabled structural
  * references) for a given digest 'nid'
  */
-ENGINE *ENGINE_get_digest_engine(int nid)
+ENGINE * __cdecl ENGINE_get_digest_engine(int nid)
 {
     return engine_table_select(&digest_table, nid);
 }
 
 /* Obtains a digest implementation from an ENGINE functional reference */
-const EVP_MD *ENGINE_get_digest(ENGINE *e, int nid)
+const EVP_MD * __cdecl ENGINE_get_digest(ENGINE *e, int nid)
 {
     const EVP_MD *ret;
     ENGINE_DIGESTS_PTR fn = ENGINE_get_digests(e);
@@ -78,13 +78,13 @@ const EVP_MD *ENGINE_get_digest(ENGINE *e, int nid)
 }
 
 /* Gets the digest callback from an ENGINE structure */
-ENGINE_DIGESTS_PTR ENGINE_get_digests(const ENGINE *e)
+ENGINE_DIGESTS_PTR __cdecl ENGINE_get_digests(const ENGINE *e)
 {
     return e->digests;
 }
 
 /* Sets the digest callback in an ENGINE structure */
-int ENGINE_set_digests(ENGINE *e, ENGINE_DIGESTS_PTR f)
+int __cdecl ENGINE_set_digests(ENGINE *e, ENGINE_DIGESTS_PTR f)
 {
     e->digests = f;
     return 1;
diff --git a/crypto/engine/tb_dsa.c b/crypto/engine/tb_dsa.c
index 65b6ea8d3a..f4d45d28d2 100644
--- a/crypto/engine/tb_dsa.c
+++ b/crypto/engine/tb_dsa.c
@@ -12,7 +12,7 @@
 static ENGINE_TABLE *dsa_table = NULL;
 static const int dummy_nid = 1;
 
-void ENGINE_unregister_DSA(ENGINE *e)
+void __cdecl ENGINE_unregister_DSA(ENGINE *e)
 {
     engine_table_unregister(&dsa_table, e);
 }
@@ -22,7 +22,7 @@ static void engine_unregister_all_DSA(void)
     engine_table_cleanup(&dsa_table);
 }
 
-int ENGINE_register_DSA(ENGINE *e)
+int __cdecl ENGINE_register_DSA(ENGINE *e)
 {
     if (e->dsa_meth)
         return engine_table_register(&dsa_table,
@@ -31,7 +31,7 @@ int ENGINE_register_DSA(ENGINE *e)
     return 1;
 }
 
-void ENGINE_register_all_DSA(void)
+void __cdecl ENGINE_register_all_DSA(void)
 {
     ENGINE *e;
 
@@ -39,7 +39,7 @@ void ENGINE_register_all_DSA(void)
         ENGINE_register_DSA(e);
 }
 
-int ENGINE_set_default_DSA(ENGINE *e)
+int __cdecl ENGINE_set_default_DSA(ENGINE *e)
 {
     if (e->dsa_meth)
         return engine_table_register(&dsa_table,
@@ -53,19 +53,19 @@ int ENGINE_set_default_DSA(ENGINE *e)
  * table (ie. try to get a functional reference from the tabled structural
  * references).
  */
-ENGINE *ENGINE_get_default_DSA(void)
+ENGINE * __cdecl ENGINE_get_default_DSA(void)
 {
     return engine_table_select(&dsa_table, dummy_nid);
 }
 
 /* Obtains an DSA implementation from an ENGINE functional reference */
-const DSA_METHOD *ENGINE_get_DSA(const ENGINE *e)
+const DSA_METHOD * __cdecl ENGINE_get_DSA(const ENGINE *e)
 {
     return e->dsa_meth;
 }
 
 /* Sets an DSA implementation in an ENGINE structure */
-int ENGINE_set_DSA(ENGINE *e, const DSA_METHOD *dsa_meth)
+int __cdecl ENGINE_set_DSA(ENGINE *e, const DSA_METHOD *dsa_meth)
 {
     e->dsa_meth = dsa_meth;
     return 1;
diff --git a/crypto/engine/tb_eckey.c b/crypto/engine/tb_eckey.c
index 1e50736854..d558908aa7 100644
--- a/crypto/engine/tb_eckey.c
+++ b/crypto/engine/tb_eckey.c
@@ -12,7 +12,7 @@
 static ENGINE_TABLE *dh_table = NULL;
 static const int dummy_nid = 1;
 
-void ENGINE_unregister_EC(ENGINE *e)
+void __cdecl ENGINE_unregister_EC(ENGINE *e)
 {
     engine_table_unregister(&dh_table, e);
 }
@@ -22,7 +22,7 @@ static void engine_unregister_all_EC(void)
     engine_table_cleanup(&dh_table);
 }
 
-int ENGINE_register_EC(ENGINE *e)
+int __cdecl ENGINE_register_EC(ENGINE *e)
 {
     if (e->ec_meth != NULL)
         return engine_table_register(&dh_table,
@@ -31,7 +31,7 @@ int ENGINE_register_EC(ENGINE *e)
     return 1;
 }
 
-void ENGINE_register_all_EC(void)
+void __cdecl ENGINE_register_all_EC(void)
 {
     ENGINE *e;
 
@@ -39,7 +39,7 @@ void ENGINE_register_all_EC(void)
         ENGINE_register_EC(e);
 }
 
-int ENGINE_set_default_EC(ENGINE *e)
+int __cdecl ENGINE_set_default_EC(ENGINE *e)
 {
     if (e->ec_meth != NULL)
         return engine_table_register(&dh_table,
@@ -53,19 +53,19 @@ int ENGINE_set_default_EC(ENGINE *e)
  * table (ie. try to get a functional reference from the tabled structural
  * references).
  */
-ENGINE *ENGINE_get_default_EC(void)
+ENGINE * __cdecl ENGINE_get_default_EC(void)
 {
     return engine_table_select(&dh_table, dummy_nid);
 }
 
 /* Obtains an EC_KEY implementation from an ENGINE functional reference */
-const EC_KEY_METHOD *ENGINE_get_EC(const ENGINE *e)
+const EC_KEY_METHOD * __cdecl ENGINE_get_EC(const ENGINE *e)
 {
     return e->ec_meth;
 }
 
 /* Sets an EC_KEY implementation in an ENGINE structure */
-int ENGINE_set_EC(ENGINE *e, const EC_KEY_METHOD *ec_meth)
+int __cdecl ENGINE_set_EC(ENGINE *e, const EC_KEY_METHOD *ec_meth)
 {
     e->ec_meth = ec_meth;
     return 1;
diff --git a/crypto/engine/tb_pkmeth.c b/crypto/engine/tb_pkmeth.c
index 03cd1e69dd..2ec8ca0288 100644
--- a/crypto/engine/tb_pkmeth.c
+++ b/crypto/engine/tb_pkmeth.c
@@ -12,7 +12,7 @@
 
 static ENGINE_TABLE *pkey_meth_table = NULL;
 
-void ENGINE_unregister_pkey_meths(ENGINE *e)
+void __cdecl ENGINE_unregister_pkey_meths(ENGINE *e)
 {
     engine_table_unregister(&pkey_meth_table, e);
 }
@@ -22,7 +22,7 @@ static void engine_unregister_all_pkey_meths(void)
     engine_table_cleanup(&pkey_meth_table);
 }
 
-int ENGINE_register_pkey_meths(ENGINE *e)
+int __cdecl ENGINE_register_pkey_meths(ENGINE *e)
 {
     if (e->pkey_meths) {
         const int *nids;
@@ -35,7 +35,7 @@ int ENGINE_register_pkey_meths(ENGINE *e)
     return 1;
 }
 
-void ENGINE_register_all_pkey_meths(void)
+void __cdecl ENGINE_register_all_pkey_meths(void)
 {
     ENGINE *e;
 
@@ -43,7 +43,7 @@ void ENGINE_register_all_pkey_meths(void)
         ENGINE_register_pkey_meths(e);
 }
 
-int ENGINE_set_default_pkey_meths(ENGINE *e)
+int __cdecl ENGINE_set_default_pkey_meths(ENGINE *e)
 {
     if (e->pkey_meths) {
         const int *nids;
@@ -61,13 +61,13 @@ int ENGINE_set_default_pkey_meths(ENGINE *e)
  * table (ie. try to get a functional reference from the tabled structural
  * references) for a given pkey_meth 'nid'
  */
-ENGINE *ENGINE_get_pkey_meth_engine(int nid)
+ENGINE * __cdecl ENGINE_get_pkey_meth_engine(int nid)
 {
     return engine_table_select(&pkey_meth_table, nid);
 }
 
 /* Obtains a pkey_meth implementation from an ENGINE functional reference */
-const EVP_PKEY_METHOD *ENGINE_get_pkey_meth(ENGINE *e, int nid)
+const EVP_PKEY_METHOD * __cdecl ENGINE_get_pkey_meth(ENGINE *e, int nid)
 {
     EVP_PKEY_METHOD *ret;
     ENGINE_PKEY_METHS_PTR fn = ENGINE_get_pkey_meths(e);
@@ -80,13 +80,13 @@ const EVP_PKEY_METHOD *ENGINE_get_pkey_meth(ENGINE *e, int nid)
 }
 
 /* Gets the pkey_meth callback from an ENGINE structure */
-ENGINE_PKEY_METHS_PTR ENGINE_get_pkey_meths(const ENGINE *e)
+ENGINE_PKEY_METHS_PTR __cdecl ENGINE_get_pkey_meths(const ENGINE *e)
 {
     return e->pkey_meths;
 }
 
 /* Sets the pkey_meth callback in an ENGINE structure */
-int ENGINE_set_pkey_meths(ENGINE *e, ENGINE_PKEY_METHS_PTR f)
+int __cdecl ENGINE_set_pkey_meths(ENGINE *e, ENGINE_PKEY_METHS_PTR f)
 {
     e->pkey_meths = f;
     return 1;
diff --git a/crypto/engine/tb_rand.c b/crypto/engine/tb_rand.c
index 98a98073cd..19f2ef0149 100644
--- a/crypto/engine/tb_rand.c
+++ b/crypto/engine/tb_rand.c
@@ -12,7 +12,7 @@
 static ENGINE_TABLE *rand_table = NULL;
 static const int dummy_nid = 1;
 
-void ENGINE_unregister_RAND(ENGINE *e)
+void __cdecl ENGINE_unregister_RAND(ENGINE *e)
 {
     engine_table_unregister(&rand_table, e);
 }
@@ -22,7 +22,7 @@ static void engine_unregister_all_RAND(void)
     engine_table_cleanup(&rand_table);
 }
 
-int ENGINE_register_RAND(ENGINE *e)
+int __cdecl ENGINE_register_RAND(ENGINE *e)
 {
     if (e->rand_meth)
         return engine_table_register(&rand_table,
@@ -31,7 +31,7 @@ int ENGINE_register_RAND(ENGINE *e)
     return 1;
 }
 
-void ENGINE_register_all_RAND(void)
+void __cdecl ENGINE_register_all_RAND(void)
 {
     ENGINE *e;
 
@@ -39,7 +39,7 @@ void ENGINE_register_all_RAND(void)
         ENGINE_register_RAND(e);
 }
 
-int ENGINE_set_default_RAND(ENGINE *e)
+int __cdecl ENGINE_set_default_RAND(ENGINE *e)
 {
     if (e->rand_meth)
         return engine_table_register(&rand_table,
@@ -53,19 +53,19 @@ int ENGINE_set_default_RAND(ENGINE *e)
  * table (ie. try to get a functional reference from the tabled structural
  * references).
  */
-ENGINE *ENGINE_get_default_RAND(void)
+ENGINE * __cdecl ENGINE_get_default_RAND(void)
 {
     return engine_table_select(&rand_table, dummy_nid);
 }
 
 /* Obtains an RAND implementation from an ENGINE functional reference */
-const RAND_METHOD *ENGINE_get_RAND(const ENGINE *e)
+const RAND_METHOD * __cdecl ENGINE_get_RAND(const ENGINE *e)
 {
     return e->rand_meth;
 }
 
 /* Sets an RAND implementation in an ENGINE structure */
-int ENGINE_set_RAND(ENGINE *e, const RAND_METHOD *rand_meth)
+int __cdecl ENGINE_set_RAND(ENGINE *e, const RAND_METHOD *rand_meth)
 {
     e->rand_meth = rand_meth;
     return 1;
diff --git a/crypto/engine/tb_rsa.c b/crypto/engine/tb_rsa.c
index d8d2e34f84..1bb83c773e 100644
--- a/crypto/engine/tb_rsa.c
+++ b/crypto/engine/tb_rsa.c
@@ -12,7 +12,7 @@
 static ENGINE_TABLE *rsa_table = NULL;
 static const int dummy_nid = 1;
 
-void ENGINE_unregister_RSA(ENGINE *e)
+void __cdecl ENGINE_unregister_RSA(ENGINE *e)
 {
     engine_table_unregister(&rsa_table, e);
 }
@@ -22,7 +22,7 @@ static void engine_unregister_all_RSA(void)
     engine_table_cleanup(&rsa_table);
 }
 
-int ENGINE_register_RSA(ENGINE *e)
+int __cdecl ENGINE_register_RSA(ENGINE *e)
 {
     if (e->rsa_meth)
         return engine_table_register(&rsa_table,
@@ -31,7 +31,7 @@ int ENGINE_register_RSA(ENGINE *e)
     return 1;
 }
 
-void ENGINE_register_all_RSA(void)
+void __cdecl ENGINE_register_all_RSA(void)
 {
     ENGINE *e;
 
@@ -39,7 +39,7 @@ void ENGINE_register_all_RSA(void)
         ENGINE_register_RSA(e);
 }
 
-int ENGINE_set_default_RSA(ENGINE *e)
+int __cdecl ENGINE_set_default_RSA(ENGINE *e)
 {
     if (e->rsa_meth)
         return engine_table_register(&rsa_table,
@@ -53,19 +53,19 @@ int ENGINE_set_default_RSA(ENGINE *e)
  * table (ie. try to get a functional reference from the tabled structural
  * references).
  */
-ENGINE *ENGINE_get_default_RSA(void)
+ENGINE * __cdecl ENGINE_get_default_RSA(void)
 {
     return engine_table_select(&rsa_table, dummy_nid);
 }
 
 /* Obtains an RSA implementation from an ENGINE functional reference */
-const RSA_METHOD *ENGINE_get_RSA(const ENGINE *e)
+const RSA_METHOD * __cdecl ENGINE_get_RSA(const ENGINE *e)
 {
     return e->rsa_meth;
 }
 
 /* Sets an RSA implementation in an ENGINE structure */
-int ENGINE_set_RSA(ENGINE *e, const RSA_METHOD *rsa_meth)
+int __cdecl ENGINE_set_RSA(ENGINE *e, const RSA_METHOD *rsa_meth)
 {
     e->rsa_meth = rsa_meth;
     return 1;
diff --git a/crypto/err/err.c b/crypto/err/err.c
index 3a58ccb958..1fe1d67397 100644
--- a/crypto/err/err.c
+++ b/crypto/err/err.c
@@ -164,7 +164,7 @@ static unsigned long err_string_data_hash(const ERR_STRING_DATA *a)
     return (ret ^ ret % 19 * 13);
 }
 
-static int err_string_data_cmp(const ERR_STRING_DATA *a,
+static int __cdecl err_string_data_cmp(const ERR_STRING_DATA *a,
                                const ERR_STRING_DATA *b)
 {
     if (a->error == b->error)
@@ -342,7 +342,7 @@ static int err_load_strings(const ERR_STRING_DATA *str)
     return 1;
 }
 
-int ERR_load_ERR_strings(void)
+int __cdecl ERR_load_ERR_strings(void)
 {
 #ifndef OPENSSL_NO_ERR
     if (!RUN_ONCE(&err_string_init, do_err_strings_init))
@@ -357,7 +357,7 @@ int ERR_load_ERR_strings(void)
     return 1;
 }
 
-int ERR_load_strings(int lib, ERR_STRING_DATA *str)
+int __cdecl ERR_load_strings(int lib, ERR_STRING_DATA *str)
 {
     if (ERR_load_ERR_strings() == 0)
         return 0;
@@ -367,7 +367,7 @@ int ERR_load_strings(int lib, ERR_STRING_DATA *str)
     return 1;
 }
 
-int ERR_load_strings_const(const ERR_STRING_DATA *str)
+int __cdecl ERR_load_strings_const(const ERR_STRING_DATA *str)
 {
     if (ERR_load_ERR_strings() == 0)
         return 0;
@@ -375,7 +375,7 @@ int ERR_load_strings_const(const ERR_STRING_DATA *str)
     return 1;
 }
 
-int ERR_unload_strings(int lib, ERR_STRING_DATA *str)
+int __cdecl ERR_unload_strings(int lib, ERR_STRING_DATA *str)
 {
     if (!RUN_ONCE(&err_string_init, do_err_strings_init))
         return 0;
@@ -392,7 +392,7 @@ int ERR_unload_strings(int lib, ERR_STRING_DATA *str)
     return 1;
 }
 
-void err_free_strings_int(void)
+void __cdecl err_free_strings_int(void)
 {
     if (!RUN_ONCE(&err_string_init, do_err_strings_init))
         return;
@@ -400,7 +400,7 @@ void err_free_strings_int(void)
 
 /********************************************************/
 
-void ERR_put_error(int lib, int func, int reason, const char *file, int line)
+void __cdecl ERR_put_error(int lib, int func, int reason, const char *file, int line)
 {
     ERR_STATE *es;
 
@@ -437,7 +437,7 @@ void ERR_put_error(int lib, int func, int reason, const char *file, int line)
     err_clear_data(es, es->top);
 }
 
-void ERR_clear_error(void)
+void __cdecl ERR_clear_error(void)
 {
     int i;
     ERR_STATE *es;
@@ -452,49 +452,49 @@ void ERR_clear_error(void)
     es->top = es->bottom = 0;
 }
 
-unsigned long ERR_get_error(void)
+unsigned long __cdecl ERR_get_error(void)
 {
     return get_error_values(1, 0, NULL, NULL, NULL, NULL);
 }
 
-unsigned long ERR_get_error_line(const char **file, int *line)
+unsigned long __cdecl ERR_get_error_line(const char **file, int *line)
 {
     return get_error_values(1, 0, file, line, NULL, NULL);
 }
 
-unsigned long ERR_get_error_line_data(const char **file, int *line,
+unsigned long __cdecl ERR_get_error_line_data(const char **file, int *line,
                                       const char **data, int *flags)
 {
     return get_error_values(1, 0, file, line, data, flags);
 }
 
-unsigned long ERR_peek_error(void)
+unsigned long __cdecl ERR_peek_error(void)
 {
     return get_error_values(0, 0, NULL, NULL, NULL, NULL);
 }
 
-unsigned long ERR_peek_error_line(const char **file, int *line)
+unsigned long __cdecl ERR_peek_error_line(const char **file, int *line)
 {
     return get_error_values(0, 0, file, line, NULL, NULL);
 }
 
-unsigned long ERR_peek_error_line_data(const char **file, int *line,
+unsigned long __cdecl ERR_peek_error_line_data(const char **file, int *line,
                                        const char **data, int *flags)
 {
     return get_error_values(0, 0, file, line, data, flags);
 }
 
-unsigned long ERR_peek_last_error(void)
+unsigned long __cdecl ERR_peek_last_error(void)
 {
     return get_error_values(0, 1, NULL, NULL, NULL, NULL);
 }
 
-unsigned long ERR_peek_last_error_line(const char **file, int *line)
+unsigned long __cdecl ERR_peek_last_error_line(const char **file, int *line)
 {
     return get_error_values(0, 1, file, line, NULL, NULL);
 }
 
-unsigned long ERR_peek_last_error_line_data(const char **file, int *line,
+unsigned long __cdecl ERR_peek_last_error_line_data(const char **file, int *line,
                                             const char **data, int *flags)
 {
     return get_error_values(0, 1, file, line, data, flags);
@@ -582,7 +582,7 @@ static unsigned long get_error_values(int inc, int top, const char **file,
     return ret;
 }
 
-void ERR_error_string_n(unsigned long e, char *buf, size_t len)
+void __cdecl ERR_error_string_n(unsigned long e, char *buf, size_t len)
 {
     char lsbuf[64], fsbuf[64], rsbuf[64];
     const char *ls, *fs, *rs;
@@ -623,7 +623,7 @@ void ERR_error_string_n(unsigned long e, char *buf, size_t len)
  * ERR_error_string_n should be used instead for ret != NULL as
  * ERR_error_string cannot know how large the buffer is
  */
-char *ERR_error_string(unsigned long e, char *ret)
+char * __cdecl ERR_error_string(unsigned long e, char *ret)
 {
     static char buf[256];
 
@@ -633,7 +633,7 @@ char *ERR_error_string(unsigned long e, char *ret)
     return ret;
 }
 
-const char *ERR_lib_error_string(unsigned long e)
+const char * __cdecl ERR_lib_error_string(unsigned long e)
 {
     ERR_STRING_DATA d, *p;
     unsigned long l;
@@ -648,7 +648,7 @@ const char *ERR_lib_error_string(unsigned long e)
     return ((p == NULL) ? NULL : p->string);
 }
 
-const char *ERR_func_error_string(unsigned long e)
+const char * __cdecl ERR_func_error_string(unsigned long e)
 {
     ERR_STRING_DATA d, *p;
     unsigned long l, f;
@@ -664,7 +664,7 @@ const char *ERR_func_error_string(unsigned long e)
     return ((p == NULL) ? NULL : p->string);
 }
 
-const char *ERR_reason_error_string(unsigned long e)
+const char * __cdecl ERR_reason_error_string(unsigned long e)
 {
     ERR_STRING_DATA d, *p = NULL;
     unsigned long l, r;
@@ -712,7 +712,7 @@ DEFINE_RUN_ONCE_STATIC(err_do_init)
     return CRYPTO_THREAD_init_local(&err_thread_local, NULL);
 }
 
-ERR_STATE *ERR_get_state(void)
+ERR_STATE *__cdecl ERR_get_state(void)
 {
     ERR_STATE *state;
     int saveerrno = get_last_sys_error();
@@ -795,7 +795,7 @@ void err_unshelve_state(void* state)
         CRYPTO_THREAD_set_local(&err_thread_local, (ERR_STATE*)state);
 }
 
-int ERR_get_next_error_library(void)
+int __cdecl ERR_get_next_error_library(void)
 {
     int ret;
 
@@ -826,7 +826,7 @@ static int err_set_error_data_int(char *data, int flags)
     return 1;
 }
 
-void ERR_set_error_data(char *data, int flags)
+void __cdecl ERR_set_error_data(char *data, int flags)
 {
     /*
      * This function is void so we cannot propagate the error return. Since it
@@ -835,7 +835,7 @@ void ERR_set_error_data(char *data, int flags)
     err_set_error_data_int(data, flags);
 }
 
-void ERR_add_error_data(int num, ...)
+void __cdecl ERR_add_error_data(int num, ...)
 {
     va_list args;
     va_start(args, num);
@@ -843,7 +843,7 @@ void ERR_add_error_data(int num, ...)
     va_end(args);
 }
 
-void ERR_add_error_vdata(int num, va_list args)
+void __cdecl ERR_add_error_vdata(int num, va_list args)
 {
     int i, n, s;
     char *str, *p, *a;
@@ -876,7 +876,7 @@ void ERR_add_error_vdata(int num, va_list args)
         OPENSSL_free(str);
 }
 
-int ERR_set_mark(void)
+int __cdecl ERR_set_mark(void)
 {
     ERR_STATE *es;
 
@@ -890,7 +890,7 @@ int ERR_set_mark(void)
     return 1;
 }
 
-int ERR_pop_to_mark(void)
+int __cdecl ERR_pop_to_mark(void)
 {
     ERR_STATE *es;
 
@@ -910,7 +910,7 @@ int ERR_pop_to_mark(void)
     return 1;
 }
 
-int ERR_clear_last_mark(void)
+int __cdecl ERR_clear_last_mark(void)
 {
     ERR_STATE *es;
     int top;
diff --git a/crypto/err/err_all.c b/crypto/err/err_all.c
index d9ec04b606..ad86eaab70 100644
--- a/crypto/err/err_all.c
+++ b/crypto/err/err_all.c
@@ -39,7 +39,7 @@
 #include <openssl/kdferr.h>
 #include <openssl/storeerr.h>
 
-int err_load_crypto_strings_int(void)
+int __cdecl err_load_crypto_strings_int(void)
 {
     if (
 #ifndef OPENSSL_NO_ERR
diff --git a/crypto/err/err_prn.c b/crypto/err/err_prn.c
index c82e62947e..0691fec995 100644
--- a/crypto/err/err_prn.c
+++ b/crypto/err/err_prn.c
@@ -13,7 +13,7 @@
 #include <openssl/buffer.h>
 #include <openssl/err.h>
 
-void ERR_print_errors_cb(int (*cb) (const char *str, size_t len, void *u),
+void __cdecl ERR_print_errors_cb(int (*cb) (const char *str, size_t len, void *u),
                          void *u)
 {
     unsigned long l;
@@ -47,13 +47,13 @@ static int print_bio(const char *str, size_t len, void *bp)
     return BIO_write((BIO *)bp, str, len);
 }
 
-void ERR_print_errors(BIO *bp)
+void __cdecl ERR_print_errors(BIO *bp)
 {
     ERR_print_errors_cb(print_bio, bp);
 }
 
 #ifndef OPENSSL_NO_STDIO
-void ERR_print_errors_fp(FILE *fp)
+void __cdecl ERR_print_errors_fp(FILE *fp)
 {
     BIO *bio = BIO_new_fp(fp, BIO_NOCLOSE);
     if (bio == NULL)
diff --git a/crypto/evp/bio_b64.c b/crypto/evp/bio_b64.c
index 9f891f7626..6427cfaf46 100644
--- a/crypto/evp/bio_b64.c
+++ b/crypto/evp/bio_b64.c
@@ -61,7 +61,7 @@ static const BIO_METHOD methods_b64 = {
 };
 
 
-const BIO_METHOD *BIO_f_base64(void)
+const BIO_METHOD * __cdecl BIO_f_base64(void)
 {
     return &methods_b64;
 }
diff --git a/crypto/evp/bio_enc.c b/crypto/evp/bio_enc.c
index 6639061eae..fa367e02e2 100644
--- a/crypto/evp/bio_enc.c
+++ b/crypto/evp/bio_enc.c
@@ -56,7 +56,7 @@ static const BIO_METHOD methods_enc = {
     enc_callback_ctrl,
 };
 
-const BIO_METHOD *BIO_f_cipher(void)
+const BIO_METHOD * __cdecl BIO_f_cipher(void)
 {
     return &methods_enc;
 }
@@ -401,11 +401,11 @@ static long enc_callback_ctrl(BIO *b, int cmd, BIO_info_cb *fp)
     return ret;
 }
 
-int BIO_set_cipher(BIO *b, const EVP_CIPHER *c, const unsigned char *k,
+int __cdecl BIO_set_cipher(BIO *b, const EVP_CIPHER *c, const unsigned char *k,
                    const unsigned char *i, int e)
 {
     BIO_ENC_CTX *ctx;
-    long (*callback) (struct bio_st *, int, const char *, int, long, long);
+    long (__cdecl *callback) (struct bio_st *, int, const char *, int, long, long);
 
     ctx = BIO_get_data(b);
     if (ctx == NULL)
diff --git a/crypto/evp/bio_md.c b/crypto/evp/bio_md.c
index 288dee01b2..228c15561f 100644
--- a/crypto/evp/bio_md.c
+++ b/crypto/evp/bio_md.c
@@ -45,7 +45,7 @@ static const BIO_METHOD methods_md = {
     md_callback_ctrl,
 };
 
-const BIO_METHOD *BIO_f_md(void)
+const BIO_METHOD * __cdecl BIO_f_md(void)
 {
     return &methods_md;
 }
diff --git a/crypto/evp/bio_ok.c b/crypto/evp/bio_ok.c
index 300db6cd32..1731a97e3e 100644
--- a/crypto/evp/bio_ok.c
+++ b/crypto/evp/bio_ok.c
@@ -124,7 +124,7 @@ static const BIO_METHOD methods_ok = {
     ok_callback_ctrl,
 };
 
-const BIO_METHOD *BIO_f_reliable(void)
+const BIO_METHOD * __cdecl BIO_f_reliable(void)
 {
     return &methods_ok;
 }
diff --git a/crypto/evp/cmeth_lib.c b/crypto/evp/cmeth_lib.c
index e2295c4dc5..c4bf1482f8 100644
--- a/crypto/evp/cmeth_lib.c
+++ b/crypto/evp/cmeth_lib.c
@@ -13,7 +13,7 @@
 #include "internal/evp_int.h"
 #include "evp_locl.h"
 
-EVP_CIPHER *EVP_CIPHER_meth_new(int cipher_type, int block_size, int key_len)
+EVP_CIPHER * __cdecl EVP_CIPHER_meth_new(int cipher_type, int block_size, int key_len)
 {
     EVP_CIPHER *cipher = OPENSSL_zalloc(sizeof(EVP_CIPHER));
 
@@ -25,7 +25,7 @@ EVP_CIPHER *EVP_CIPHER_meth_new(int cipher_type, int block_size, int key_len)
     return cipher;
 }
 
-EVP_CIPHER *EVP_CIPHER_meth_dup(const EVP_CIPHER *cipher)
+EVP_CIPHER * __cdecl EVP_CIPHER_meth_dup(const EVP_CIPHER *cipher)
 {
     EVP_CIPHER *to = EVP_CIPHER_meth_new(cipher->nid, cipher->block_size,
                                          cipher->key_len);
@@ -35,30 +35,30 @@ EVP_CIPHER *EVP_CIPHER_meth_dup(const EVP_CIPHER *cipher)
     return to;
 }
 
-void EVP_CIPHER_meth_free(EVP_CIPHER *cipher)
+void __cdecl EVP_CIPHER_meth_free(EVP_CIPHER *cipher)
 {
     OPENSSL_free(cipher);
 }
 
-int EVP_CIPHER_meth_set_iv_length(EVP_CIPHER *cipher, int iv_len)
+int __cdecl EVP_CIPHER_meth_set_iv_length(EVP_CIPHER *cipher, int iv_len)
 {
     cipher->iv_len = iv_len;
     return 1;
 }
 
-int EVP_CIPHER_meth_set_flags(EVP_CIPHER *cipher, unsigned long flags)
+int __cdecl EVP_CIPHER_meth_set_flags(EVP_CIPHER *cipher, unsigned long flags)
 {
     cipher->flags = flags;
     return 1;
 }
 
-int EVP_CIPHER_meth_set_impl_ctx_size(EVP_CIPHER *cipher, int ctx_size)
+int __cdecl EVP_CIPHER_meth_set_impl_ctx_size(EVP_CIPHER *cipher, int ctx_size)
 {
     cipher->ctx_size = ctx_size;
     return 1;
 }
 
-int EVP_CIPHER_meth_set_init(EVP_CIPHER *cipher,
+int __cdecl EVP_CIPHER_meth_set_init(EVP_CIPHER *cipher,
                              int (*init) (EVP_CIPHER_CTX *ctx,
                                           const unsigned char *key,
                                           const unsigned char *iv,
@@ -68,7 +68,7 @@ int EVP_CIPHER_meth_set_init(EVP_CIPHER *cipher,
     return 1;
 }
 
-int EVP_CIPHER_meth_set_do_cipher(EVP_CIPHER *cipher,
+int __cdecl EVP_CIPHER_meth_set_do_cipher(EVP_CIPHER *cipher,
                                   int (*do_cipher) (EVP_CIPHER_CTX *ctx,
                                                     unsigned char *out,
                                                     const unsigned char *in,
@@ -78,30 +78,30 @@ int EVP_CIPHER_meth_set_do_cipher(EVP_CIPHER *cipher,
     return 1;
 }
 
-int EVP_CIPHER_meth_set_cleanup(EVP_CIPHER *cipher,
+int __cdecl EVP_CIPHER_meth_set_cleanup(EVP_CIPHER *cipher,
                                 int (*cleanup) (EVP_CIPHER_CTX *))
 {
     cipher->cleanup = cleanup;
     return 1;
 }
 
-int EVP_CIPHER_meth_set_set_asn1_params(EVP_CIPHER *cipher,
-                                        int (*set_asn1_parameters) (EVP_CIPHER_CTX *,
+int __cdecl EVP_CIPHER_meth_set_set_asn1_params(EVP_CIPHER *cipher,
+                                        int (__cdecl *set_asn1_parameters) (EVP_CIPHER_CTX *,
                                                                     ASN1_TYPE *))
 {
     cipher->set_asn1_parameters = set_asn1_parameters;
     return 1;
 }
 
-int EVP_CIPHER_meth_set_get_asn1_params(EVP_CIPHER *cipher,
-                                        int (*get_asn1_parameters) (EVP_CIPHER_CTX *,
+int __cdecl EVP_CIPHER_meth_set_get_asn1_params(EVP_CIPHER *cipher,
+                                        int (__cdecl *get_asn1_parameters) (EVP_CIPHER_CTX *,
                                                                     ASN1_TYPE *))
 {
     cipher->get_asn1_parameters = get_asn1_parameters;
     return 1;
 }
 
-int EVP_CIPHER_meth_set_ctrl(EVP_CIPHER *cipher,
+int __cdecl EVP_CIPHER_meth_set_ctrl(EVP_CIPHER *cipher,
                              int (*ctrl) (EVP_CIPHER_CTX *, int type,
                                           int arg, void *ptr))
 {
@@ -110,14 +110,14 @@ int EVP_CIPHER_meth_set_ctrl(EVP_CIPHER *cipher,
 }
 
 
-int (*EVP_CIPHER_meth_get_init(const EVP_CIPHER *cipher))(EVP_CIPHER_CTX *ctx,
+int (* __cdecl EVP_CIPHER_meth_get_init(const EVP_CIPHER *cipher))(EVP_CIPHER_CTX *ctx,
                                                           const unsigned char *key,
                                                           const unsigned char *iv,
                                                           int enc)
 {
     return cipher->init;
 }
-int (*EVP_CIPHER_meth_get_do_cipher(const EVP_CIPHER *cipher))(EVP_CIPHER_CTX *ctx,
+int (* __cdecl EVP_CIPHER_meth_get_do_cipher(const EVP_CIPHER *cipher))(EVP_CIPHER_CTX *ctx,
                                                                unsigned char *out,
                                                                const unsigned char *in,
                                                                size_t inl)
@@ -125,24 +125,24 @@ int (*EVP_CIPHER_meth_get_do_cipher(const EVP_CIPHER *cipher))(EVP_CIPHER_CTX *c
     return cipher->do_cipher;
 }
 
-int (*EVP_CIPHER_meth_get_cleanup(const EVP_CIPHER *cipher))(EVP_CIPHER_CTX *)
+int (* __cdecl EVP_CIPHER_meth_get_cleanup(const EVP_CIPHER *cipher))(EVP_CIPHER_CTX *)
 {
     return cipher->cleanup;
 }
 
-int (*EVP_CIPHER_meth_get_set_asn1_params(const EVP_CIPHER *cipher))(EVP_CIPHER_CTX *,
+int (__cdecl * EVP_CIPHER_meth_get_set_asn1_params(const EVP_CIPHER *cipher))(EVP_CIPHER_CTX *,
                                                                      ASN1_TYPE *)
 {
     return cipher->set_asn1_parameters;
 }
 
-int (*EVP_CIPHER_meth_get_get_asn1_params(const EVP_CIPHER *cipher))(EVP_CIPHER_CTX *,
+int (__cdecl * EVP_CIPHER_meth_get_get_asn1_params(const EVP_CIPHER *cipher))(EVP_CIPHER_CTX *,
                                                                ASN1_TYPE *)
 {
     return cipher->get_asn1_parameters;
 }
 
-int (*EVP_CIPHER_meth_get_ctrl(const EVP_CIPHER *cipher))(EVP_CIPHER_CTX *,
+int (* __cdecl EVP_CIPHER_meth_get_ctrl(const EVP_CIPHER *cipher))(EVP_CIPHER_CTX *,
                                                           int type, int arg,
                                                           void *ptr)
 {
diff --git a/crypto/evp/digest.c b/crypto/evp/digest.c
index 6693f270b6..e13a6b99af 100644
--- a/crypto/evp/digest.c
+++ b/crypto/evp/digest.c
@@ -16,7 +16,7 @@
 #include "evp_locl.h"
 
 /* This call frees resources associated with the context */
-int EVP_MD_CTX_reset(EVP_MD_CTX *ctx)
+int __cdecl EVP_MD_CTX_reset(EVP_MD_CTX *ctx)
 {
     if (ctx == NULL)
         return 1;
@@ -46,24 +46,24 @@ int EVP_MD_CTX_reset(EVP_MD_CTX *ctx)
     return 1;
 }
 
-EVP_MD_CTX *EVP_MD_CTX_new(void)
+EVP_MD_CTX * __cdecl EVP_MD_CTX_new(void)
 {
     return OPENSSL_zalloc(sizeof(EVP_MD_CTX));
 }
 
-void EVP_MD_CTX_free(EVP_MD_CTX *ctx)
+void __cdecl EVP_MD_CTX_free(EVP_MD_CTX *ctx)
 {
     EVP_MD_CTX_reset(ctx);
     OPENSSL_free(ctx);
 }
 
-int EVP_DigestInit(EVP_MD_CTX *ctx, const EVP_MD *type)
+int __cdecl EVP_DigestInit(EVP_MD_CTX *ctx, const EVP_MD *type)
 {
     EVP_MD_CTX_reset(ctx);
     return EVP_DigestInit_ex(ctx, type, NULL);
 }
 
-int EVP_DigestInit_ex(EVP_MD_CTX *ctx, const EVP_MD *type, ENGINE *impl)
+int __cdecl EVP_DigestInit_ex(EVP_MD_CTX *ctx, const EVP_MD *type, ENGINE *impl)
 {
     EVP_MD_CTX_clear_flags(ctx, EVP_MD_CTX_FLAG_CLEANED);
 #ifndef OPENSSL_NO_ENGINE
@@ -148,7 +148,7 @@ int EVP_DigestInit_ex(EVP_MD_CTX *ctx, const EVP_MD *type, ENGINE *impl)
     return ctx->digest->init(ctx);
 }
 
-int EVP_DigestUpdate(EVP_MD_CTX *ctx, const void *data, size_t count)
+int __cdecl EVP_DigestUpdate(EVP_MD_CTX *ctx, const void *data, size_t count)
 {
     if (count == 0)
         return 1;
@@ -157,7 +157,7 @@ int EVP_DigestUpdate(EVP_MD_CTX *ctx, const void *data, size_t count)
 }
 
 /* The caller can assume that this removes any secret data from the context */
-int EVP_DigestFinal(EVP_MD_CTX *ctx, unsigned char *md, unsigned int *size)
+int __cdecl EVP_DigestFinal(EVP_MD_CTX *ctx, unsigned char *md, unsigned int *size)
 {
     int ret;
     ret = EVP_DigestFinal_ex(ctx, md, size);
@@ -166,7 +166,7 @@ int EVP_DigestFinal(EVP_MD_CTX *ctx, unsigned char *md, unsigned int *size)
 }
 
 /* The caller can assume that this removes any secret data from the context */
-int EVP_DigestFinal_ex(EVP_MD_CTX *ctx, unsigned char *md, unsigned int *size)
+int __cdecl EVP_DigestFinal_ex(EVP_MD_CTX *ctx, unsigned char *md, unsigned int *size)
 {
     int ret;
 
@@ -182,7 +182,7 @@ int EVP_DigestFinal_ex(EVP_MD_CTX *ctx, unsigned char *md, unsigned int *size)
     return ret;
 }
 
-int EVP_DigestFinalXOF(EVP_MD_CTX *ctx, unsigned char *md, size_t size)
+int __cdecl EVP_DigestFinalXOF(EVP_MD_CTX *ctx, unsigned char *md, size_t size)
 {
     int ret = 0;
 
@@ -203,13 +203,13 @@ int EVP_DigestFinalXOF(EVP_MD_CTX *ctx, unsigned char *md, size_t size)
     return ret;
 }
 
-int EVP_MD_CTX_copy(EVP_MD_CTX *out, const EVP_MD_CTX *in)
+int __cdecl EVP_MD_CTX_copy(EVP_MD_CTX *out, const EVP_MD_CTX *in)
 {
     EVP_MD_CTX_reset(out);
     return EVP_MD_CTX_copy_ex(out, in);
 }
 
-int EVP_MD_CTX_copy_ex(EVP_MD_CTX *out, const EVP_MD_CTX *in)
+int __cdecl EVP_MD_CTX_copy_ex(EVP_MD_CTX *out, const EVP_MD_CTX *in)
 {
     unsigned char *tmp_buf;
     if ((in == NULL) || (in->digest == NULL)) {
@@ -271,7 +271,7 @@ int EVP_MD_CTX_copy_ex(EVP_MD_CTX *out, const EVP_MD_CTX *in)
     return 1;
 }
 
-int EVP_Digest(const void *data, size_t count,
+int __cdecl EVP_Digest(const void *data, size_t count,
                unsigned char *md, unsigned int *size, const EVP_MD *type,
                ENGINE *impl)
 {
@@ -289,7 +289,7 @@ int EVP_Digest(const void *data, size_t count,
     return ret;
 }
 
-int EVP_MD_CTX_ctrl(EVP_MD_CTX *ctx, int cmd, int p1, void *p2)
+int __cdecl EVP_MD_CTX_ctrl(EVP_MD_CTX *ctx, int cmd, int p1, void *p2)
 {
     if (ctx->digest && ctx->digest->md_ctrl) {
         int ret = ctx->digest->md_ctrl(ctx, cmd, p1, p2);
diff --git a/crypto/evp/e_aes.c b/crypto/evp/e_aes.c
index 1db346fc86..b80fcbb481 100644
--- a/crypto/evp/e_aes.c
+++ b/crypto/evp/e_aes.c
@@ -548,7 +548,7 @@ static const EVP_CIPHER aes_##keylen##_##mode = { \
         NULL,                           \
         sizeof(EVP_AES_KEY),            \
         NULL,NULL,NULL,NULL }; \
-const EVP_CIPHER *EVP_aes_##keylen##_##mode(void) \
+const EVP_CIPHER * __cdecl EVP_aes_##keylen##_##mode(void) \
 { return AESNI_CAPABLE?&aesni_##keylen##_##mode:&aes_##keylen##_##mode; }
 
 # define BLOCK_CIPHER_custom(nid,keylen,blocksize,ivlen,mode,MODE,flags) \
@@ -570,7 +570,7 @@ static const EVP_CIPHER aes_##keylen##_##mode = { \
         aes_##mode##_cleanup,           \
         sizeof(EVP_AES_##MODE##_CTX),   \
         NULL,NULL,aes_##mode##_ctrl,NULL }; \
-const EVP_CIPHER *EVP_aes_##keylen##_##mode(void) \
+const EVP_CIPHER * __cdecl EVP_aes_##keylen##_##mode(void) \
 { return AESNI_CAPABLE?&aesni_##keylen##_##mode:&aes_##keylen##_##mode; }
 
 #elif   defined(AES_ASM) && (defined(__sparc) || defined(__sparc__))
@@ -971,7 +971,7 @@ static const EVP_CIPHER aes_##keylen##_##mode = { \
         NULL,                           \
         sizeof(EVP_AES_KEY),            \
         NULL,NULL,NULL,NULL }; \
-const EVP_CIPHER *EVP_aes_##keylen##_##mode(void) \
+const EVP_CIPHER * __cdecl EVP_aes_##keylen##_##mode(void) \
 { return SPARC_AES_CAPABLE?&aes_t4_##keylen##_##mode:&aes_##keylen##_##mode; }
 
 # define BLOCK_CIPHER_custom(nid,keylen,blocksize,ivlen,mode,MODE,flags) \
@@ -993,7 +993,7 @@ static const EVP_CIPHER aes_##keylen##_##mode = { \
         aes_##mode##_cleanup,           \
         sizeof(EVP_AES_##MODE##_CTX),   \
         NULL,NULL,aes_##mode##_ctrl,NULL }; \
-const EVP_CIPHER *EVP_aes_##keylen##_##mode(void) \
+const EVP_CIPHER * __cdecl EVP_aes_##keylen##_##mode(void) \
 { return SPARC_AES_CAPABLE?&aes_t4_##keylen##_##mode:&aes_##keylen##_##mode; }
 
 #elif defined(OPENSSL_CPUID_OBJ) && defined(__s390__)
@@ -2478,7 +2478,7 @@ static const EVP_CIPHER aes_##keylen##_##mode = {			\
     NULL,								\
     NULL								\
 };									\
-const EVP_CIPHER *EVP_aes_##keylen##_##mode(void)			\
+const EVP_CIPHER * __cdecl EVP_aes_##keylen##_##mode(void)			\
 {									\
     return S390X_aes_##keylen##_##mode##_CAPABLE ?			\
            &s390x_aes_##keylen##_##mode : &aes_##keylen##_##mode;	\
@@ -2514,7 +2514,7 @@ static const EVP_CIPHER aes_##keylen##_##mode = {			\
     aes_##mode##_ctrl,							\
     NULL								\
 };									\
-const EVP_CIPHER *EVP_aes_##keylen##_##mode(void)			\
+const EVP_CIPHER * __cdecl EVP_aes_##keylen##_##mode(void)			\
 {									\
     return S390X_aes_##keylen##_##mode##_CAPABLE ?			\
            &s390x_aes_##keylen##_##mode : &aes_##keylen##_##mode;	\
@@ -2531,7 +2531,7 @@ static const EVP_CIPHER aes_##keylen##_##mode = { \
         NULL,                           \
         sizeof(EVP_AES_KEY),            \
         NULL,NULL,NULL,NULL }; \
-const EVP_CIPHER *EVP_aes_##keylen##_##mode(void) \
+const EVP_CIPHER * __cdecl EVP_aes_##keylen##_##mode(void) \
 { return &aes_##keylen##_##mode; }
 
 # define BLOCK_CIPHER_custom(nid,keylen,blocksize,ivlen,mode,MODE,flags) \
@@ -2544,7 +2544,7 @@ static const EVP_CIPHER aes_##keylen##_##mode = { \
         aes_##mode##_cleanup,           \
         sizeof(EVP_AES_##MODE##_CTX),   \
         NULL,NULL,aes_##mode##_ctrl,NULL }; \
-const EVP_CIPHER *EVP_aes_##keylen##_##mode(void) \
+const EVP_CIPHER * __cdecl EVP_aes_##keylen##_##mode(void) \
 { return &aes_##keylen##_##mode; }
 
 #endif
@@ -3882,7 +3882,7 @@ static const EVP_CIPHER aes_128_wrap = {
     NULL, NULL, NULL, NULL
 };
 
-const EVP_CIPHER *EVP_aes_128_wrap(void)
+const EVP_CIPHER * __cdecl EVP_aes_128_wrap(void)
 {
     return &aes_128_wrap;
 }
@@ -3896,7 +3896,7 @@ static const EVP_CIPHER aes_192_wrap = {
     NULL, NULL, NULL, NULL
 };
 
-const EVP_CIPHER *EVP_aes_192_wrap(void)
+const EVP_CIPHER * __cdecl EVP_aes_192_wrap(void)
 {
     return &aes_192_wrap;
 }
@@ -3910,7 +3910,7 @@ static const EVP_CIPHER aes_256_wrap = {
     NULL, NULL, NULL, NULL
 };
 
-const EVP_CIPHER *EVP_aes_256_wrap(void)
+const EVP_CIPHER * __cdecl EVP_aes_256_wrap(void)
 {
     return &aes_256_wrap;
 }
@@ -3924,7 +3924,7 @@ static const EVP_CIPHER aes_128_wrap_pad = {
     NULL, NULL, NULL, NULL
 };
 
-const EVP_CIPHER *EVP_aes_128_wrap_pad(void)
+const EVP_CIPHER * __cdecl EVP_aes_128_wrap_pad(void)
 {
     return &aes_128_wrap_pad;
 }
@@ -3938,7 +3938,7 @@ static const EVP_CIPHER aes_192_wrap_pad = {
     NULL, NULL, NULL, NULL
 };
 
-const EVP_CIPHER *EVP_aes_192_wrap_pad(void)
+const EVP_CIPHER * __cdecl EVP_aes_192_wrap_pad(void)
 {
     return &aes_192_wrap_pad;
 }
@@ -3952,7 +3952,7 @@ static const EVP_CIPHER aes_256_wrap_pad = {
     NULL, NULL, NULL, NULL
 };
 
-const EVP_CIPHER *EVP_aes_256_wrap_pad(void)
+const EVP_CIPHER * __cdecl EVP_aes_256_wrap_pad(void)
 {
     return &aes_256_wrap_pad;
 }
diff --git a/crypto/evp/e_aes_cbc_hmac_sha1.c b/crypto/evp/e_aes_cbc_hmac_sha1.c
index 09d24dc3d0..dd726040e1 100644
--- a/crypto/evp/e_aes_cbc_hmac_sha1.c
+++ b/crypto/evp/e_aes_cbc_hmac_sha1.c
@@ -940,24 +940,24 @@ static EVP_CIPHER aesni_256_cbc_hmac_sha1_cipher = {
     NULL
 };
 
-const EVP_CIPHER *EVP_aes_128_cbc_hmac_sha1(void)
+const EVP_CIPHER * __cdecl EVP_aes_128_cbc_hmac_sha1(void)
 {
     return (OPENSSL_ia32cap_P[1] & AESNI_CAPABLE ?
             &aesni_128_cbc_hmac_sha1_cipher : NULL);
 }
 
-const EVP_CIPHER *EVP_aes_256_cbc_hmac_sha1(void)
+const EVP_CIPHER * __cdecl EVP_aes_256_cbc_hmac_sha1(void)
 {
     return (OPENSSL_ia32cap_P[1] & AESNI_CAPABLE ?
             &aesni_256_cbc_hmac_sha1_cipher : NULL);
 }
 #else
-const EVP_CIPHER *EVP_aes_128_cbc_hmac_sha1(void)
+const EVP_CIPHER * __cdecl EVP_aes_128_cbc_hmac_sha1(void)
 {
     return NULL;
 }
 
-const EVP_CIPHER *EVP_aes_256_cbc_hmac_sha1(void)
+const EVP_CIPHER * __cdecl EVP_aes_256_cbc_hmac_sha1(void)
 {
     return NULL;
 }
diff --git a/crypto/evp/e_aes_cbc_hmac_sha256.c b/crypto/evp/e_aes_cbc_hmac_sha256.c
index caac0c9d3d..9d6c1faa08 100644
--- a/crypto/evp/e_aes_cbc_hmac_sha256.c
+++ b/crypto/evp/e_aes_cbc_hmac_sha256.c
@@ -924,26 +924,26 @@ static EVP_CIPHER aesni_256_cbc_hmac_sha256_cipher = {
     NULL
 };
 
-const EVP_CIPHER *EVP_aes_128_cbc_hmac_sha256(void)
+const EVP_CIPHER * __cdecl EVP_aes_128_cbc_hmac_sha256(void)
 {
     return ((OPENSSL_ia32cap_P[1] & AESNI_CAPABLE) &&
             aesni_cbc_sha256_enc(NULL, NULL, 0, NULL, NULL, NULL, NULL) ?
             &aesni_128_cbc_hmac_sha256_cipher : NULL);
 }
 
-const EVP_CIPHER *EVP_aes_256_cbc_hmac_sha256(void)
+const EVP_CIPHER * __cdecl EVP_aes_256_cbc_hmac_sha256(void)
 {
     return ((OPENSSL_ia32cap_P[1] & AESNI_CAPABLE) &&
             aesni_cbc_sha256_enc(NULL, NULL, 0, NULL, NULL, NULL, NULL) ?
             &aesni_256_cbc_hmac_sha256_cipher : NULL);
 }
 #else
-const EVP_CIPHER *EVP_aes_128_cbc_hmac_sha256(void)
+const EVP_CIPHER * __cdecl EVP_aes_128_cbc_hmac_sha256(void)
 {
     return NULL;
 }
 
-const EVP_CIPHER *EVP_aes_256_cbc_hmac_sha256(void)
+const EVP_CIPHER * __cdecl EVP_aes_256_cbc_hmac_sha256(void)
 {
     return NULL;
 }
diff --git a/crypto/evp/e_aria.c b/crypto/evp/e_aria.c
index fcaceb3bca..c5fb482e17 100644
--- a/crypto/evp/e_aria.c
+++ b/crypto/evp/e_aria.c
@@ -165,7 +165,7 @@ static const EVP_CIPHER aria_##keylen##_##mode = { \
         NULL,                           \
         sizeof(EVP_ARIA_KEY),           \
         NULL,NULL,NULL,NULL };          \
-const EVP_CIPHER *EVP_aria_##keylen##_##mode(void) \
+const EVP_CIPHER * __cdecl EVP_aria_##keylen##_##mode(void) \
 { return &aria_##keylen##_##mode; }
 
 static int aria_ctr_cipher(EVP_CIPHER_CTX *ctx, unsigned char *out,
@@ -763,7 +763,7 @@ static const EVP_CIPHER aria_##keylen##_##mode = { \
         aria_##mode##_cleanup,                     \
         sizeof(EVP_ARIA_##MODE##_CTX),             \
         NULL,NULL,aria_##mode##_ctrl,NULL };       \
-const EVP_CIPHER *EVP_aria_##keylen##_##mode(void) \
+const EVP_CIPHER *__cdecl EVP_aria_##keylen##_##mode(void) \
 { return (EVP_CIPHER*)&aria_##keylen##_##mode; }
 
 BLOCK_CIPHER_aead(NID_aria, 128, 1, 12, gcm, gcm, GCM, 0)
diff --git a/crypto/evp/e_camellia.c b/crypto/evp/e_camellia.c
index 2df4a6e3e0..63396e69f2 100644
--- a/crypto/evp/e_camellia.c
+++ b/crypto/evp/e_camellia.c
@@ -195,7 +195,7 @@ static const EVP_CIPHER camellia_##keylen##_##mode = { \
         NULL,                           \
         sizeof(EVP_CAMELLIA_KEY),       \
         NULL,NULL,NULL,NULL }; \
-const EVP_CIPHER *EVP_camellia_##keylen##_##mode(void) \
+const EVP_CIPHER * __cdecl EVP_camellia_##keylen##_##mode(void) \
 { return &camellia_##keylen##_##mode; }
 
 # endif
diff --git a/crypto/evp/e_chacha20_poly1305.c b/crypto/evp/e_chacha20_poly1305.c
index 435a38d365..36b73d81f0 100644
--- a/crypto/evp/e_chacha20_poly1305.c
+++ b/crypto/evp/e_chacha20_poly1305.c
@@ -140,7 +140,7 @@ static const EVP_CIPHER chacha20 = {
     NULL
 };
 
-const EVP_CIPHER *EVP_chacha20(void)
+const EVP_CIPHER * __cdecl EVP_chacha20(void)
 {
     return &chacha20;
 }
@@ -629,7 +629,7 @@ static EVP_CIPHER chacha20_poly1305 = {
     NULL        /* app_data */
 };
 
-const EVP_CIPHER *EVP_chacha20_poly1305(void)
+const EVP_CIPHER * __cdecl EVP_chacha20_poly1305(void)
 {
     return(&chacha20_poly1305);
 }
diff --git a/crypto/evp/e_des3.c b/crypto/evp/e_des3.c
index 6b492ce470..f1df4c8542 100644
--- a/crypto/evp/e_des3.c
+++ b/crypto/evp/e_des3.c
@@ -297,12 +297,12 @@ static int des3_ctrl(EVP_CIPHER_CTX *ctx, int type, int arg, void *ptr)
     }
 }
 
-const EVP_CIPHER *EVP_des_ede(void)
+const EVP_CIPHER * __cdecl EVP_des_ede(void)
 {
     return &des_ede_ecb;
 }
 
-const EVP_CIPHER *EVP_des_ede3(void)
+const EVP_CIPHER * __cdecl EVP_des_ede3(void)
 {
     return &des_ede3_ecb;
 }
@@ -416,7 +416,7 @@ static const EVP_CIPHER des3_wrap = {
     NULL, NULL, NULL, NULL
 };
 
-const EVP_CIPHER *EVP_des_ede3_wrap(void)
+const EVP_CIPHER * __cdecl EVP_des_ede3_wrap(void)
 {
     return &des3_wrap;
 }
diff --git a/crypto/evp/e_null.c b/crypto/evp/e_null.c
index 18a8468216..8da2bf4527 100644
--- a/crypto/evp/e_null.c
+++ b/crypto/evp/e_null.c
@@ -30,7 +30,7 @@ static const EVP_CIPHER n_cipher = {
     NULL
 };
 
-const EVP_CIPHER *EVP_enc_null(void)
+const EVP_CIPHER * __cdecl EVP_enc_null(void)
 {
     return &n_cipher;
 }
diff --git a/crypto/evp/e_rc2.c b/crypto/evp/e_rc2.c
index aa0d140186..d0546ba9bf 100644
--- a/crypto/evp/e_rc2.c
+++ b/crypto/evp/e_rc2.c
@@ -21,8 +21,8 @@ static int rc2_init_key(EVP_CIPHER_CTX *ctx, const unsigned char *key,
                         const unsigned char *iv, int enc);
 static int rc2_meth_to_magic(EVP_CIPHER_CTX *ctx);
 static int rc2_magic_to_meth(int i);
-static int rc2_set_asn1_type_and_iv(EVP_CIPHER_CTX *c, ASN1_TYPE *type);
-static int rc2_get_asn1_type_and_iv(EVP_CIPHER_CTX *c, ASN1_TYPE *type);
+static int __cdecl rc2_set_asn1_type_and_iv(EVP_CIPHER_CTX *c, ASN1_TYPE *type);
+static int __cdecl rc2_get_asn1_type_and_iv(EVP_CIPHER_CTX *c, ASN1_TYPE *type);
 static int rc2_ctrl(EVP_CIPHER_CTX *c, int type, int arg, void *ptr);
 
 typedef struct {
@@ -70,12 +70,12 @@ static const EVP_CIPHER r2_40_cbc_cipher = {
     NULL
 };
 
-const EVP_CIPHER *EVP_rc2_64_cbc(void)
+const EVP_CIPHER * __cdecl EVP_rc2_64_cbc(void)
 {
     return &r2_64_cbc_cipher;
 }
 
-const EVP_CIPHER *EVP_rc2_40_cbc(void)
+const EVP_CIPHER * __cdecl EVP_rc2_40_cbc(void)
 {
     return &r2_40_cbc_cipher;
 }
@@ -118,7 +118,7 @@ static int rc2_magic_to_meth(int i)
     }
 }
 
-static int rc2_get_asn1_type_and_iv(EVP_CIPHER_CTX *c, ASN1_TYPE *type)
+static int __cdecl rc2_get_asn1_type_and_iv(EVP_CIPHER_CTX *c, ASN1_TYPE *type)
 {
     long num = 0;
     int i = 0;
@@ -145,7 +145,7 @@ static int rc2_get_asn1_type_and_iv(EVP_CIPHER_CTX *c, ASN1_TYPE *type)
     return i;
 }
 
-static int rc2_set_asn1_type_and_iv(EVP_CIPHER_CTX *c, ASN1_TYPE *type)
+static int __cdecl rc2_set_asn1_type_and_iv(EVP_CIPHER_CTX *c, ASN1_TYPE *type)
 {
     long num;
     int i = 0, j;
diff --git a/crypto/evp/e_rc4.c b/crypto/evp/e_rc4.c
index d16abdd0d2..92361852fd 100644
--- a/crypto/evp/e_rc4.c
+++ b/crypto/evp/e_rc4.c
@@ -56,12 +56,12 @@ static const EVP_CIPHER r4_40_cipher = {
     NULL
 };
 
-const EVP_CIPHER *EVP_rc4(void)
+const EVP_CIPHER * __cdecl EVP_rc4(void)
 {
     return &r4_cipher;
 }
 
-const EVP_CIPHER *EVP_rc4_40(void)
+const EVP_CIPHER * __cdecl EVP_rc4_40(void)
 {
     return &r4_40_cipher;
 }
diff --git a/crypto/evp/e_rc4_hmac_md5.c b/crypto/evp/e_rc4_hmac_md5.c
index b1e8ccd6dd..580d2ecf8e 100644
--- a/crypto/evp/e_rc4_hmac_md5.c
+++ b/crypto/evp/e_rc4_hmac_md5.c
@@ -255,7 +255,7 @@ static EVP_CIPHER r4_hmac_md5_cipher = {
     NULL
 };
 
-const EVP_CIPHER *EVP_rc4_hmac_md5(void)
+const EVP_CIPHER * __cdecl EVP_rc4_hmac_md5(void)
 {
     return &r4_hmac_md5_cipher;
 }
diff --git a/crypto/evp/e_sm4.c b/crypto/evp/e_sm4.c
index 79deb65636..296f303516 100644
--- a/crypto/evp/e_sm4.c
+++ b/crypto/evp/e_sm4.c
@@ -92,7 +92,7 @@ static const EVP_CIPHER sm4_ctr_mode = {
     NULL, NULL, NULL, NULL
 };
 
-const EVP_CIPHER *EVP_sm4_ctr(void)
+const EVP_CIPHER * __cdecl EVP_sm4_ctr(void)
 {
     return &sm4_ctr_mode;
 }
diff --git a/crypto/evp/e_xcbc_d.c b/crypto/evp/e_xcbc_d.c
index 57ce813da8..a4058ad432 100644
--- a/crypto/evp/e_xcbc_d.c
+++ b/crypto/evp/e_xcbc_d.c
@@ -44,7 +44,7 @@ static const EVP_CIPHER d_xcbc_cipher = {
     NULL
 };
 
-const EVP_CIPHER *EVP_desx_cbc(void)
+const EVP_CIPHER * __cdecl EVP_desx_cbc(void)
 {
     return &d_xcbc_cipher;
 }
diff --git a/crypto/evp/encode.c b/crypto/evp/encode.c
index da32d4fd19..33c88b5878 100644
--- a/crypto/evp/encode.c
+++ b/crypto/evp/encode.c
@@ -124,24 +124,24 @@ static unsigned char conv_ascii2bin(unsigned char a, const unsigned char *table)
 }
 #endif
 
-EVP_ENCODE_CTX *EVP_ENCODE_CTX_new(void)
+EVP_ENCODE_CTX * __cdecl EVP_ENCODE_CTX_new(void)
 {
     return OPENSSL_zalloc(sizeof(EVP_ENCODE_CTX));
 }
 
-void EVP_ENCODE_CTX_free(EVP_ENCODE_CTX *ctx)
+void __cdecl EVP_ENCODE_CTX_free(EVP_ENCODE_CTX *ctx)
 {
     OPENSSL_free(ctx);
 }
 
-int EVP_ENCODE_CTX_copy(EVP_ENCODE_CTX *dctx, EVP_ENCODE_CTX *sctx)
+int __cdecl EVP_ENCODE_CTX_copy(EVP_ENCODE_CTX *dctx, EVP_ENCODE_CTX *sctx)
 {
     memcpy(dctx, sctx, sizeof(EVP_ENCODE_CTX));
 
     return 1;
 }
 
-int EVP_ENCODE_CTX_num(EVP_ENCODE_CTX *ctx)
+int __cdecl EVP_ENCODE_CTX_num(EVP_ENCODE_CTX *ctx)
 {
     return ctx->num;
 }
@@ -151,7 +151,7 @@ void evp_encode_ctx_set_flags(EVP_ENCODE_CTX *ctx, unsigned int flags)
     ctx->flags = flags;
 }
 
-void EVP_EncodeInit(EVP_ENCODE_CTX *ctx)
+void __cdecl EVP_EncodeInit(EVP_ENCODE_CTX *ctx)
 {
     ctx->length = 48;
     ctx->num = 0;
@@ -159,7 +159,7 @@ void EVP_EncodeInit(EVP_ENCODE_CTX *ctx)
     ctx->flags = 0;
 }
 
-int EVP_EncodeUpdate(EVP_ENCODE_CTX *ctx, unsigned char *out, int *outl,
+int __cdecl EVP_EncodeUpdate(EVP_ENCODE_CTX *ctx, unsigned char *out, int *outl,
                       const unsigned char *in, int inl)
 {
     int i, j;
@@ -214,7 +214,7 @@ int EVP_EncodeUpdate(EVP_ENCODE_CTX *ctx, unsigned char *out, int *outl,
     return 1;
 }
 
-void EVP_EncodeFinal(EVP_ENCODE_CTX *ctx, unsigned char *out, int *outl)
+void __cdecl EVP_EncodeFinal(EVP_ENCODE_CTX *ctx, unsigned char *out, int *outl)
 {
     unsigned int ret = 0;
 
@@ -266,12 +266,12 @@ static int evp_encodeblock_int(EVP_ENCODE_CTX *ctx, unsigned char *t,
     return ret;
 }
 
-int EVP_EncodeBlock(unsigned char *t, const unsigned char *f, int dlen)
+int __cdecl EVP_EncodeBlock(unsigned char *t, const unsigned char *f, int dlen)
 {
     return evp_encodeblock_int(NULL, t, f, dlen);
 }
 
-void EVP_DecodeInit(EVP_ENCODE_CTX *ctx)
+void __cdecl EVP_DecodeInit(EVP_ENCODE_CTX *ctx)
 {
     /* Only ctx->num and ctx->flags are used during decoding. */
     ctx->num = 0;
@@ -300,7 +300,7 @@ void EVP_DecodeInit(EVP_ENCODE_CTX *ctx)
  *   - There is extra trailing padding, or data after padding.
  *   - B64_EOF is detected after an incomplete base64 block.
  */
-int EVP_DecodeUpdate(EVP_ENCODE_CTX *ctx, unsigned char *out, int *outl,
+int __cdecl EVP_DecodeUpdate(EVP_ENCODE_CTX *ctx, unsigned char *out, int *outl,
                      const unsigned char *in, int inl)
 {
     int seof = 0, eof = 0, rv = -1, ret = 0, i, v, tmp, n, decoded_len;
@@ -456,12 +456,12 @@ static int evp_decodeblock_int(EVP_ENCODE_CTX *ctx, unsigned char *t,
     return ret;
 }
 
-int EVP_DecodeBlock(unsigned char *t, const unsigned char *f, int n)
+int __cdecl EVP_DecodeBlock(unsigned char *t, const unsigned char *f, int n)
 {
     return evp_decodeblock_int(NULL, t, f, n);
 }
 
-int EVP_DecodeFinal(EVP_ENCODE_CTX *ctx, unsigned char *out, int *outl)
+int __cdecl EVP_DecodeFinal(EVP_ENCODE_CTX *ctx, unsigned char *out, int *outl)
 {
     int i;
 
diff --git a/crypto/evp/evp_cnf.c b/crypto/evp/evp_cnf.c
index 8df2c06e1f..c0a6f69cbb 100644
--- a/crypto/evp/evp_cnf.c
+++ b/crypto/evp/evp_cnf.c
@@ -50,7 +50,7 @@ static int alg_module_init(CONF_IMODULE *md, const CONF *cnf)
     return 1;
 }
 
-void EVP_add_alg_module(void)
+void __cdecl EVP_add_alg_module(void)
 {
     CONF_module_add("alg_section", alg_module_init, 0);
 }
diff --git a/crypto/evp/evp_enc.c b/crypto/evp/evp_enc.c
index 05dd791b6c..9a559bccf4 100644
--- a/crypto/evp/evp_enc.c
+++ b/crypto/evp/evp_enc.c
@@ -18,7 +18,7 @@
 #include "internal/evp_int.h"
 #include "evp_locl.h"
 
-int EVP_CIPHER_CTX_reset(EVP_CIPHER_CTX *c)
+int __cdecl EVP_CIPHER_CTX_reset(EVP_CIPHER_CTX *c)
 {
     if (c == NULL)
         return 1;
@@ -37,18 +37,18 @@ int EVP_CIPHER_CTX_reset(EVP_CIPHER_CTX *c)
     return 1;
 }
 
-EVP_CIPHER_CTX *EVP_CIPHER_CTX_new(void)
+EVP_CIPHER_CTX * __cdecl EVP_CIPHER_CTX_new(void)
 {
     return OPENSSL_zalloc(sizeof(EVP_CIPHER_CTX));
 }
 
-void EVP_CIPHER_CTX_free(EVP_CIPHER_CTX *ctx)
+void __cdecl EVP_CIPHER_CTX_free(EVP_CIPHER_CTX *ctx)
 {
     EVP_CIPHER_CTX_reset(ctx);
     OPENSSL_free(ctx);
 }
 
-int EVP_CipherInit(EVP_CIPHER_CTX *ctx, const EVP_CIPHER *cipher,
+int __cdecl EVP_CipherInit(EVP_CIPHER_CTX *ctx, const EVP_CIPHER *cipher,
                    const unsigned char *key, const unsigned char *iv, int enc)
 {
     if (cipher != NULL)
@@ -56,7 +56,7 @@ int EVP_CipherInit(EVP_CIPHER_CTX *ctx, const EVP_CIPHER *cipher,
     return EVP_CipherInit_ex(ctx, cipher, NULL, key, iv, enc);
 }
 
-int EVP_CipherInit_ex(EVP_CIPHER_CTX *ctx, const EVP_CIPHER *cipher,
+int __cdecl EVP_CipherInit_ex(EVP_CIPHER_CTX *ctx, const EVP_CIPHER *cipher,
                       ENGINE *impl, const unsigned char *key,
                       const unsigned char *iv, int enc)
 {
@@ -206,7 +206,7 @@ int EVP_CipherInit_ex(EVP_CIPHER_CTX *ctx, const EVP_CIPHER *cipher,
     return 1;
 }
 
-int EVP_CipherUpdate(EVP_CIPHER_CTX *ctx, unsigned char *out, int *outl,
+int __cdecl EVP_CipherUpdate(EVP_CIPHER_CTX *ctx, unsigned char *out, int *outl,
                      const unsigned char *in, int inl)
 {
     if (ctx->encrypt)
@@ -215,7 +215,7 @@ int EVP_CipherUpdate(EVP_CIPHER_CTX *ctx, unsigned char *out, int *outl,
         return EVP_DecryptUpdate(ctx, out, outl, in, inl);
 }
 
-int EVP_CipherFinal_ex(EVP_CIPHER_CTX *ctx, unsigned char *out, int *outl)
+int __cdecl EVP_CipherFinal_ex(EVP_CIPHER_CTX *ctx, unsigned char *out, int *outl)
 {
     if (ctx->encrypt)
         return EVP_EncryptFinal_ex(ctx, out, outl);
@@ -223,7 +223,7 @@ int EVP_CipherFinal_ex(EVP_CIPHER_CTX *ctx, unsigned char *out, int *outl)
         return EVP_DecryptFinal_ex(ctx, out, outl);
 }
 
-int EVP_CipherFinal(EVP_CIPHER_CTX *ctx, unsigned char *out, int *outl)
+int __cdecl EVP_CipherFinal(EVP_CIPHER_CTX *ctx, unsigned char *out, int *outl)
 {
     if (ctx->encrypt)
         return EVP_EncryptFinal(ctx, out, outl);
@@ -231,26 +231,26 @@ int EVP_CipherFinal(EVP_CIPHER_CTX *ctx, unsigned char *out, int *outl)
         return EVP_DecryptFinal(ctx, out, outl);
 }
 
-int EVP_EncryptInit(EVP_CIPHER_CTX *ctx, const EVP_CIPHER *cipher,
+int __cdecl EVP_EncryptInit(EVP_CIPHER_CTX *ctx, const EVP_CIPHER *cipher,
                     const unsigned char *key, const unsigned char *iv)
 {
     return EVP_CipherInit(ctx, cipher, key, iv, 1);
 }
 
-int EVP_EncryptInit_ex(EVP_CIPHER_CTX *ctx, const EVP_CIPHER *cipher,
+int __cdecl EVP_EncryptInit_ex(EVP_CIPHER_CTX *ctx, const EVP_CIPHER *cipher,
                        ENGINE *impl, const unsigned char *key,
                        const unsigned char *iv)
 {
     return EVP_CipherInit_ex(ctx, cipher, impl, key, iv, 1);
 }
 
-int EVP_DecryptInit(EVP_CIPHER_CTX *ctx, const EVP_CIPHER *cipher,
+int __cdecl EVP_DecryptInit(EVP_CIPHER_CTX *ctx, const EVP_CIPHER *cipher,
                     const unsigned char *key, const unsigned char *iv)
 {
     return EVP_CipherInit(ctx, cipher, key, iv, 0);
 }
 
-int EVP_DecryptInit_ex(EVP_CIPHER_CTX *ctx, const EVP_CIPHER *cipher,
+int __cdecl EVP_DecryptInit_ex(EVP_CIPHER_CTX *ctx, const EVP_CIPHER *cipher,
                        ENGINE *impl, const unsigned char *key,
                        const unsigned char *iv)
 {
@@ -373,7 +373,7 @@ static int evp_EncryptDecryptUpdate(EVP_CIPHER_CTX *ctx,
 }
 
 
-int EVP_EncryptUpdate(EVP_CIPHER_CTX *ctx, unsigned char *out, int *outl,
+int __cdecl EVP_EncryptUpdate(EVP_CIPHER_CTX *ctx, unsigned char *out, int *outl,
                       const unsigned char *in, int inl)
 {
     /* Prevent accidental use of decryption context when encrypting */
@@ -385,14 +385,14 @@ int EVP_EncryptUpdate(EVP_CIPHER_CTX *ctx, unsigned char *out, int *outl,
     return evp_EncryptDecryptUpdate(ctx, out, outl, in, inl);
 }
 
-int EVP_EncryptFinal(EVP_CIPHER_CTX *ctx, unsigned char *out, int *outl)
+int __cdecl EVP_EncryptFinal(EVP_CIPHER_CTX *ctx, unsigned char *out, int *outl)
 {
     int ret;
     ret = EVP_EncryptFinal_ex(ctx, out, outl);
     return ret;
 }
 
-int EVP_EncryptFinal_ex(EVP_CIPHER_CTX *ctx, unsigned char *out, int *outl)
+int __cdecl EVP_EncryptFinal_ex(EVP_CIPHER_CTX *ctx, unsigned char *out, int *outl)
 {
     int n, ret;
     unsigned int i, b, bl;
@@ -440,7 +440,7 @@ int EVP_EncryptFinal_ex(EVP_CIPHER_CTX *ctx, unsigned char *out, int *outl)
     return ret;
 }
 
-int EVP_DecryptUpdate(EVP_CIPHER_CTX *ctx, unsigned char *out, int *outl,
+int __cdecl EVP_DecryptUpdate(EVP_CIPHER_CTX *ctx, unsigned char *out, int *outl,
                       const unsigned char *in, int inl)
 {
     int fix_len, cmpl = inl;
@@ -515,14 +515,14 @@ int EVP_DecryptUpdate(EVP_CIPHER_CTX *ctx, unsigned char *out, int *outl,
     return 1;
 }
 
-int EVP_DecryptFinal(EVP_CIPHER_CTX *ctx, unsigned char *out, int *outl)
+int __cdecl EVP_DecryptFinal(EVP_CIPHER_CTX *ctx, unsigned char *out, int *outl)
 {
     int ret;
     ret = EVP_DecryptFinal_ex(ctx, out, outl);
     return ret;
 }
 
-int EVP_DecryptFinal_ex(EVP_CIPHER_CTX *ctx, unsigned char *out, int *outl)
+int __cdecl EVP_DecryptFinal_ex(EVP_CIPHER_CTX *ctx, unsigned char *out, int *outl)
 {
     int i, n;
     unsigned int b;
@@ -585,7 +585,7 @@ int EVP_DecryptFinal_ex(EVP_CIPHER_CTX *ctx, unsigned char *out, int *outl)
     return 1;
 }
 
-int EVP_CIPHER_CTX_set_key_length(EVP_CIPHER_CTX *c, int keylen)
+int __cdecl EVP_CIPHER_CTX_set_key_length(EVP_CIPHER_CTX *c, int keylen)
 {
     if (c->cipher->flags & EVP_CIPH_CUSTOM_KEY_LENGTH)
         return EVP_CIPHER_CTX_ctrl(c, EVP_CTRL_SET_KEY_LENGTH, keylen, NULL);
@@ -599,7 +599,7 @@ int EVP_CIPHER_CTX_set_key_length(EVP_CIPHER_CTX *c, int keylen)
     return 0;
 }
 
-int EVP_CIPHER_CTX_set_padding(EVP_CIPHER_CTX *ctx, int pad)
+int __cdecl EVP_CIPHER_CTX_set_padding(EVP_CIPHER_CTX *ctx, int pad)
 {
     if (pad)
         ctx->flags &= ~EVP_CIPH_NO_PADDING;
@@ -608,7 +608,7 @@ int EVP_CIPHER_CTX_set_padding(EVP_CIPHER_CTX *ctx, int pad)
     return 1;
 }
 
-int EVP_CIPHER_CTX_ctrl(EVP_CIPHER_CTX *ctx, int type, int arg, void *ptr)
+int __cdecl EVP_CIPHER_CTX_ctrl(EVP_CIPHER_CTX *ctx, int type, int arg, void *ptr)
 {
     int ret;
 
@@ -631,7 +631,7 @@ int EVP_CIPHER_CTX_ctrl(EVP_CIPHER_CTX *ctx, int type, int arg, void *ptr)
     return ret;
 }
 
-int EVP_CIPHER_CTX_rand_key(EVP_CIPHER_CTX *ctx, unsigned char *key)
+int __cdecl EVP_CIPHER_CTX_rand_key(EVP_CIPHER_CTX *ctx, unsigned char *key)
 {
     if (ctx->cipher->flags & EVP_CIPH_RAND_KEY)
         return EVP_CIPHER_CTX_ctrl(ctx, EVP_CTRL_RAND_KEY, 0, key);
@@ -640,7 +640,7 @@ int EVP_CIPHER_CTX_rand_key(EVP_CIPHER_CTX *ctx, unsigned char *key)
     return 1;
 }
 
-int EVP_CIPHER_CTX_copy(EVP_CIPHER_CTX *out, const EVP_CIPHER_CTX *in)
+int __cdecl EVP_CIPHER_CTX_copy(EVP_CIPHER_CTX *out, const EVP_CIPHER_CTX *in)
 {
     if ((in == NULL) || (in->cipher == NULL)) {
         EVPerr(EVP_F_EVP_CIPHER_CTX_COPY, EVP_R_INPUT_NOT_INITIALIZED);
diff --git a/crypto/evp/evp_err.c b/crypto/evp/evp_err.c
index 84bd3c2dab..6de4bf484f 100644
--- a/crypto/evp/evp_err.c
+++ b/crypto/evp/evp_err.c
@@ -280,7 +280,7 @@ static const ERR_STRING_DATA EVP_str_reasons[] = {
 
 #endif
 
-int ERR_load_EVP_strings(void)
+int __cdecl ERR_load_EVP_strings(void)
 {
 #ifndef OPENSSL_NO_ERR
     if (ERR_func_error_string(EVP_str_functs[0].error) == NULL) {
diff --git a/crypto/evp/evp_key.c b/crypto/evp/evp_key.c
index e5ac107c38..b82216458b 100644
--- a/crypto/evp/evp_key.c
+++ b/crypto/evp/evp_key.c
@@ -17,7 +17,7 @@
 /* should be init to zeros. */
 static char prompt_string[80];
 
-void EVP_set_pw_prompt(const char *prompt)
+void __cdecl EVP_set_pw_prompt(const char *prompt)
 {
     if (prompt == NULL)
         prompt_string[0] = '\0';
@@ -27,7 +27,7 @@ void EVP_set_pw_prompt(const char *prompt)
     }
 }
 
-char *EVP_get_pw_prompt(void)
+char * __cdecl EVP_get_pw_prompt(void)
 {
     if (prompt_string[0] == '\0')
         return NULL;
@@ -40,12 +40,12 @@ char *EVP_get_pw_prompt(void)
  * the DES library -- if someone ever wants to disable DES, this function
  * will fail
  */
-int EVP_read_pw_string(char *buf, int len, const char *prompt, int verify)
+int __cdecl EVP_read_pw_string(char *buf, int len, const char *prompt, int verify)
 {
     return EVP_read_pw_string_min(buf, 0, len, prompt, verify);
 }
 
-int EVP_read_pw_string_min(char *buf, int min, int len, const char *prompt,
+int __cdecl EVP_read_pw_string_min(char *buf, int min, int len, const char *prompt,
                            int verify)
 {
     int ret = -1;
@@ -71,7 +71,7 @@ int EVP_read_pw_string_min(char *buf, int min, int len, const char *prompt,
     return ret;
 }
 
-int EVP_BytesToKey(const EVP_CIPHER *type, const EVP_MD *md,
+int __cdecl EVP_BytesToKey(const EVP_CIPHER *type, const EVP_MD *md,
                    const unsigned char *salt, const unsigned char *data,
                    int datal, int count, unsigned char *key,
                    unsigned char *iv)
diff --git a/crypto/evp/evp_lib.c b/crypto/evp/evp_lib.c
index 4935c2a94a..fce2e27b5c 100644
--- a/crypto/evp/evp_lib.c
+++ b/crypto/evp/evp_lib.c
@@ -14,7 +14,7 @@
 #include "internal/evp_int.h"
 #include "evp_locl.h"
 
-int EVP_CIPHER_param_to_asn1(EVP_CIPHER_CTX *c, ASN1_TYPE *type)
+int __cdecl EVP_CIPHER_param_to_asn1(EVP_CIPHER_CTX *c, ASN1_TYPE *type)
 {
     int ret;
 
@@ -49,7 +49,7 @@ int EVP_CIPHER_param_to_asn1(EVP_CIPHER_CTX *c, ASN1_TYPE *type)
     return ret;
 }
 
-int EVP_CIPHER_asn1_to_param(EVP_CIPHER_CTX *c, ASN1_TYPE *type)
+int __cdecl EVP_CIPHER_asn1_to_param(EVP_CIPHER_CTX *c, ASN1_TYPE *type)
 {
     int ret;
 
@@ -84,7 +84,7 @@ int EVP_CIPHER_asn1_to_param(EVP_CIPHER_CTX *c, ASN1_TYPE *type)
     return ret;
 }
 
-int EVP_CIPHER_get_asn1_iv(EVP_CIPHER_CTX *c, ASN1_TYPE *type)
+int __cdecl EVP_CIPHER_get_asn1_iv(EVP_CIPHER_CTX *c, ASN1_TYPE *type)
 {
     int i = 0;
     unsigned int l;
@@ -101,7 +101,7 @@ int EVP_CIPHER_get_asn1_iv(EVP_CIPHER_CTX *c, ASN1_TYPE *type)
     return i;
 }
 
-int EVP_CIPHER_set_asn1_iv(EVP_CIPHER_CTX *c, ASN1_TYPE *type)
+int __cdecl EVP_CIPHER_set_asn1_iv(EVP_CIPHER_CTX *c, ASN1_TYPE *type)
 {
     int i = 0;
     unsigned int j;
@@ -115,7 +115,7 @@ int EVP_CIPHER_set_asn1_iv(EVP_CIPHER_CTX *c, ASN1_TYPE *type)
 }
 
 /* Convert the various cipher NIDs and dummies to a proper OID NID */
-int EVP_CIPHER_type(const EVP_CIPHER *ctx)
+int __cdecl EVP_CIPHER_type(const EVP_CIPHER *ctx)
 {
     int nid;
     ASN1_OBJECT *otmp;
@@ -174,58 +174,58 @@ int EVP_CIPHER_type(const EVP_CIPHER *ctx)
     }
 }
 
-int EVP_CIPHER_block_size(const EVP_CIPHER *e)
+int __cdecl EVP_CIPHER_block_size(const EVP_CIPHER *e)
 {
     return e->block_size;
 }
 
-int EVP_CIPHER_CTX_block_size(const EVP_CIPHER_CTX *ctx)
+int __cdecl EVP_CIPHER_CTX_block_size(const EVP_CIPHER_CTX *ctx)
 {
     return ctx->cipher->block_size;
 }
 
-int EVP_CIPHER_impl_ctx_size(const EVP_CIPHER *e)
+int __cdecl EVP_CIPHER_impl_ctx_size(const EVP_CIPHER *e)
 {
     return e->ctx_size;
 }
 
-int EVP_Cipher(EVP_CIPHER_CTX *ctx, unsigned char *out,
+int __cdecl EVP_Cipher(EVP_CIPHER_CTX *ctx, unsigned char *out,
                const unsigned char *in, unsigned int inl)
 {
     return ctx->cipher->do_cipher(ctx, out, in, inl);
 }
 
-const EVP_CIPHER *EVP_CIPHER_CTX_cipher(const EVP_CIPHER_CTX *ctx)
+const EVP_CIPHER * __cdecl EVP_CIPHER_CTX_cipher(const EVP_CIPHER_CTX *ctx)
 {
     return ctx->cipher;
 }
 
-int EVP_CIPHER_CTX_encrypting(const EVP_CIPHER_CTX *ctx)
+int __cdecl EVP_CIPHER_CTX_encrypting(const EVP_CIPHER_CTX *ctx)
 {
     return ctx->encrypt;
 }
 
-unsigned long EVP_CIPHER_flags(const EVP_CIPHER *cipher)
+unsigned long __cdecl EVP_CIPHER_flags(const EVP_CIPHER *cipher)
 {
     return cipher->flags;
 }
 
-void *EVP_CIPHER_CTX_get_app_data(const EVP_CIPHER_CTX *ctx)
+void * __cdecl EVP_CIPHER_CTX_get_app_data(const EVP_CIPHER_CTX *ctx)
 {
     return ctx->app_data;
 }
 
-void EVP_CIPHER_CTX_set_app_data(EVP_CIPHER_CTX *ctx, void *data)
+void __cdecl EVP_CIPHER_CTX_set_app_data(EVP_CIPHER_CTX *ctx, void *data)
 {
     ctx->app_data = data;
 }
 
-void *EVP_CIPHER_CTX_get_cipher_data(const EVP_CIPHER_CTX *ctx)
+void * __cdecl EVP_CIPHER_CTX_get_cipher_data(const EVP_CIPHER_CTX *ctx)
 {
     return ctx->cipher_data;
 }
 
-void *EVP_CIPHER_CTX_set_cipher_data(EVP_CIPHER_CTX *ctx, void *cipher_data)
+void * __cdecl EVP_CIPHER_CTX_set_cipher_data(EVP_CIPHER_CTX *ctx, void *cipher_data)
 {
     void *old_cipher_data;
 
@@ -235,12 +235,12 @@ void *EVP_CIPHER_CTX_set_cipher_data(EVP_CIPHER_CTX *ctx, void *cipher_data)
     return old_cipher_data;
 }
 
-int EVP_CIPHER_iv_length(const EVP_CIPHER *cipher)
+int __cdecl EVP_CIPHER_iv_length(const EVP_CIPHER *cipher)
 {
     return cipher->iv_len;
 }
 
-int EVP_CIPHER_CTX_iv_length(const EVP_CIPHER_CTX *ctx)
+int __cdecl EVP_CIPHER_CTX_iv_length(const EVP_CIPHER_CTX *ctx)
 {
     int i, rv;
 
@@ -252,72 +252,72 @@ int EVP_CIPHER_CTX_iv_length(const EVP_CIPHER_CTX *ctx)
     return ctx->cipher->iv_len;
 }
 
-const unsigned char *EVP_CIPHER_CTX_original_iv(const EVP_CIPHER_CTX *ctx)
+const unsigned char * __cdecl EVP_CIPHER_CTX_original_iv(const EVP_CIPHER_CTX *ctx)
 {
     return ctx->oiv;
 }
 
-const unsigned char *EVP_CIPHER_CTX_iv(const EVP_CIPHER_CTX *ctx)
+const unsigned char * __cdecl EVP_CIPHER_CTX_iv(const EVP_CIPHER_CTX *ctx)
 {
     return ctx->iv;
 }
 
-unsigned char *EVP_CIPHER_CTX_iv_noconst(EVP_CIPHER_CTX *ctx)
+unsigned char * __cdecl EVP_CIPHER_CTX_iv_noconst(EVP_CIPHER_CTX *ctx)
 {
     return ctx->iv;
 }
 
-unsigned char *EVP_CIPHER_CTX_buf_noconst(EVP_CIPHER_CTX *ctx)
+unsigned char * __cdecl EVP_CIPHER_CTX_buf_noconst(EVP_CIPHER_CTX *ctx)
 {
     return ctx->buf;
 }
 
-int EVP_CIPHER_CTX_num(const EVP_CIPHER_CTX *ctx)
+int __cdecl EVP_CIPHER_CTX_num(const EVP_CIPHER_CTX *ctx)
 {
     return ctx->num;
 }
 
-void EVP_CIPHER_CTX_set_num(EVP_CIPHER_CTX *ctx, int num)
+void __cdecl EVP_CIPHER_CTX_set_num(EVP_CIPHER_CTX *ctx, int num)
 {
     ctx->num = num;
 }
 
-int EVP_CIPHER_key_length(const EVP_CIPHER *cipher)
+int __cdecl EVP_CIPHER_key_length(const EVP_CIPHER *cipher)
 {
     return cipher->key_len;
 }
 
-int EVP_CIPHER_CTX_key_length(const EVP_CIPHER_CTX *ctx)
+int __cdecl EVP_CIPHER_CTX_key_length(const EVP_CIPHER_CTX *ctx)
 {
     return ctx->key_len;
 }
 
-int EVP_CIPHER_nid(const EVP_CIPHER *cipher)
+int __cdecl EVP_CIPHER_nid(const EVP_CIPHER *cipher)
 {
     return cipher->nid;
 }
 
-int EVP_CIPHER_CTX_nid(const EVP_CIPHER_CTX *ctx)
+int __cdecl EVP_CIPHER_CTX_nid(const EVP_CIPHER_CTX *ctx)
 {
     return ctx->cipher->nid;
 }
 
-int EVP_MD_block_size(const EVP_MD *md)
+int __cdecl EVP_MD_block_size(const EVP_MD *md)
 {
     return md->block_size;
 }
 
-int EVP_MD_type(const EVP_MD *md)
+int __cdecl EVP_MD_type(const EVP_MD *md)
 {
     return md->type;
 }
 
-int EVP_MD_pkey_type(const EVP_MD *md)
+int __cdecl EVP_MD_pkey_type(const EVP_MD *md)
 {
     return md->pkey_type;
 }
 
-int EVP_MD_size(const EVP_MD *md)
+int __cdecl EVP_MD_size(const EVP_MD *md)
 {
     if (!md) {
         EVPerr(EVP_F_EVP_MD_SIZE, EVP_R_MESSAGE_DIGEST_IS_NULL);
@@ -326,12 +326,12 @@ int EVP_MD_size(const EVP_MD *md)
     return md->md_size;
 }
 
-unsigned long EVP_MD_flags(const EVP_MD *md)
+unsigned long __cdecl EVP_MD_flags(const EVP_MD *md)
 {
     return md->flags;
 }
 
-EVP_MD *EVP_MD_meth_new(int md_type, int pkey_type)
+EVP_MD * __cdecl EVP_MD_meth_new(int md_type, int pkey_type)
 {
     EVP_MD *md = OPENSSL_zalloc(sizeof(*md));
 
@@ -341,7 +341,7 @@ EVP_MD *EVP_MD_meth_new(int md_type, int pkey_type)
     }
     return md;
 }
-EVP_MD *EVP_MD_meth_dup(const EVP_MD *md)
+EVP_MD * __cdecl EVP_MD_meth_dup(const EVP_MD *md)
 {
     EVP_MD *to = EVP_MD_meth_new(md->type, md->pkey_type);
 
@@ -349,125 +349,125 @@ EVP_MD *EVP_MD_meth_dup(const EVP_MD *md)
         memcpy(to, md, sizeof(*to));
     return to;
 }
-void EVP_MD_meth_free(EVP_MD *md)
+void __cdecl EVP_MD_meth_free(EVP_MD *md)
 {
     OPENSSL_free(md);
 }
-int EVP_MD_meth_set_input_blocksize(EVP_MD *md, int blocksize)
+int __cdecl EVP_MD_meth_set_input_blocksize(EVP_MD *md, int blocksize)
 {
     md->block_size = blocksize;
     return 1;
 }
-int EVP_MD_meth_set_result_size(EVP_MD *md, int resultsize)
+int __cdecl EVP_MD_meth_set_result_size(EVP_MD *md, int resultsize)
 {
     md->md_size = resultsize;
     return 1;
 }
-int EVP_MD_meth_set_app_datasize(EVP_MD *md, int datasize)
+int __cdecl EVP_MD_meth_set_app_datasize(EVP_MD *md, int datasize)
 {
     md->ctx_size = datasize;
     return 1;
 }
-int EVP_MD_meth_set_flags(EVP_MD *md, unsigned long flags)
+int __cdecl EVP_MD_meth_set_flags(EVP_MD *md, unsigned long flags)
 {
     md->flags = flags;
     return 1;
 }
-int EVP_MD_meth_set_init(EVP_MD *md, int (*init)(EVP_MD_CTX *ctx))
+int __cdecl EVP_MD_meth_set_init(EVP_MD *md, int (*init)(EVP_MD_CTX *ctx))
 {
     md->init = init;
     return 1;
 }
-int EVP_MD_meth_set_update(EVP_MD *md, int (*update)(EVP_MD_CTX *ctx,
+int __cdecl EVP_MD_meth_set_update(EVP_MD *md, int (*update)(EVP_MD_CTX *ctx,
                                                      const void *data,
                                                      size_t count))
 {
     md->update = update;
     return 1;
 }
-int EVP_MD_meth_set_final(EVP_MD *md, int (*final)(EVP_MD_CTX *ctx,
+int __cdecl EVP_MD_meth_set_final(EVP_MD *md, int (*final)(EVP_MD_CTX *ctx,
                                                    unsigned char *md))
 {
     md->final = final;
     return 1;
 }
-int EVP_MD_meth_set_copy(EVP_MD *md, int (*copy)(EVP_MD_CTX *to,
+int __cdecl EVP_MD_meth_set_copy(EVP_MD *md, int (*copy)(EVP_MD_CTX *to,
                                                  const EVP_MD_CTX *from))
 {
     md->copy = copy;
     return 1;
 }
-int EVP_MD_meth_set_cleanup(EVP_MD *md, int (*cleanup)(EVP_MD_CTX *ctx))
+int __cdecl EVP_MD_meth_set_cleanup(EVP_MD *md, int (*cleanup)(EVP_MD_CTX *ctx))
 {
     md->cleanup = cleanup;
     return 1;
 }
-int EVP_MD_meth_set_ctrl(EVP_MD *md, int (*ctrl)(EVP_MD_CTX *ctx, int cmd,
+int __cdecl EVP_MD_meth_set_ctrl(EVP_MD *md, int (*ctrl)(EVP_MD_CTX *ctx, int cmd,
                                                  int p1, void *p2))
 {
     md->md_ctrl = ctrl;
     return 1;
 }
 
-int EVP_MD_meth_get_input_blocksize(const EVP_MD *md)
+int __cdecl EVP_MD_meth_get_input_blocksize(const EVP_MD *md)
 {
     return md->block_size;
 }
-int EVP_MD_meth_get_result_size(const EVP_MD *md)
+int __cdecl EVP_MD_meth_get_result_size(const EVP_MD *md)
 {
     return md->md_size;
 }
-int EVP_MD_meth_get_app_datasize(const EVP_MD *md)
+int __cdecl EVP_MD_meth_get_app_datasize(const EVP_MD *md)
 {
     return md->ctx_size;
 }
-unsigned long EVP_MD_meth_get_flags(const EVP_MD *md)
+unsigned long __cdecl EVP_MD_meth_get_flags(const EVP_MD *md)
 {
     return md->flags;
 }
-int (*EVP_MD_meth_get_init(const EVP_MD *md))(EVP_MD_CTX *ctx)
+int (* __cdecl EVP_MD_meth_get_init(const EVP_MD *md))(EVP_MD_CTX *ctx)
 {
     return md->init;
 }
-int (*EVP_MD_meth_get_update(const EVP_MD *md))(EVP_MD_CTX *ctx,
+int (* __cdecl EVP_MD_meth_get_update(const EVP_MD *md))(EVP_MD_CTX *ctx,
                                                 const void *data,
                                                 size_t count)
 {
     return md->update;
 }
-int (*EVP_MD_meth_get_final(const EVP_MD *md))(EVP_MD_CTX *ctx,
+int (* __cdecl EVP_MD_meth_get_final(const EVP_MD *md))(EVP_MD_CTX *ctx,
                                                unsigned char *md)
 {
     return md->final;
 }
-int (*EVP_MD_meth_get_copy(const EVP_MD *md))(EVP_MD_CTX *to,
+int (* __cdecl EVP_MD_meth_get_copy(const EVP_MD *md))(EVP_MD_CTX *to,
                                               const EVP_MD_CTX *from)
 {
     return md->copy;
 }
-int (*EVP_MD_meth_get_cleanup(const EVP_MD *md))(EVP_MD_CTX *ctx)
+int (* __cdecl EVP_MD_meth_get_cleanup(const EVP_MD *md))(EVP_MD_CTX *ctx)
 {
     return md->cleanup;
 }
-int (*EVP_MD_meth_get_ctrl(const EVP_MD *md))(EVP_MD_CTX *ctx, int cmd,
+int (* __cdecl EVP_MD_meth_get_ctrl(const EVP_MD *md))(EVP_MD_CTX *ctx, int cmd,
                                               int p1, void *p2)
 {
     return md->md_ctrl;
 }
 
-const EVP_MD *EVP_MD_CTX_md(const EVP_MD_CTX *ctx)
+const EVP_MD * __cdecl EVP_MD_CTX_md(const EVP_MD_CTX *ctx)
 {
     if (!ctx)
         return NULL;
     return ctx->digest;
 }
 
-EVP_PKEY_CTX *EVP_MD_CTX_pkey_ctx(const EVP_MD_CTX *ctx)
+EVP_PKEY_CTX * __cdecl EVP_MD_CTX_pkey_ctx(const EVP_MD_CTX *ctx)
 {
     return ctx->pctx;
 }
 
-void EVP_MD_CTX_set_pkey_ctx(EVP_MD_CTX *ctx, EVP_PKEY_CTX *pctx)
+void __cdecl EVP_MD_CTX_set_pkey_ctx(EVP_MD_CTX *ctx, EVP_PKEY_CTX *pctx)
 {
     /*
      * it's reasonable to set NULL pctx (a.k.a clear the ctx->pctx), so
@@ -486,50 +486,50 @@ void EVP_MD_CTX_set_pkey_ctx(EVP_MD_CTX *ctx, EVP_PKEY_CTX *pctx)
     }
 }
 
-void *EVP_MD_CTX_md_data(const EVP_MD_CTX *ctx)
+void * __cdecl EVP_MD_CTX_md_data(const EVP_MD_CTX *ctx)
 {
     return ctx->md_data;
 }
 
-int (*EVP_MD_CTX_update_fn(EVP_MD_CTX *ctx))(EVP_MD_CTX *ctx,
+int (* __cdecl EVP_MD_CTX_update_fn(EVP_MD_CTX *ctx))(EVP_MD_CTX *ctx,
                                              const void *data, size_t count)
 {
     return ctx->update;
 }
 
-void EVP_MD_CTX_set_update_fn(EVP_MD_CTX *ctx,
+void __cdecl EVP_MD_CTX_set_update_fn(EVP_MD_CTX *ctx,
                               int (*update) (EVP_MD_CTX *ctx,
                                              const void *data, size_t count))
 {
     ctx->update = update;
 }
 
-void EVP_MD_CTX_set_flags(EVP_MD_CTX *ctx, int flags)
+void __cdecl EVP_MD_CTX_set_flags(EVP_MD_CTX *ctx, int flags)
 {
     ctx->flags |= flags;
 }
 
-void EVP_MD_CTX_clear_flags(EVP_MD_CTX *ctx, int flags)
+void __cdecl EVP_MD_CTX_clear_flags(EVP_MD_CTX *ctx, int flags)
 {
     ctx->flags &= ~flags;
 }
 
-int EVP_MD_CTX_test_flags(const EVP_MD_CTX *ctx, int flags)
+int __cdecl EVP_MD_CTX_test_flags(const EVP_MD_CTX *ctx, int flags)
 {
     return (ctx->flags & flags);
 }
 
-void EVP_CIPHER_CTX_set_flags(EVP_CIPHER_CTX *ctx, int flags)
+void __cdecl EVP_CIPHER_CTX_set_flags(EVP_CIPHER_CTX *ctx, int flags)
 {
     ctx->flags |= flags;
 }
 
-void EVP_CIPHER_CTX_clear_flags(EVP_CIPHER_CTX *ctx, int flags)
+void __cdecl EVP_CIPHER_CTX_clear_flags(EVP_CIPHER_CTX *ctx, int flags)
 {
     ctx->flags &= ~flags;
 }
 
-int EVP_CIPHER_CTX_test_flags(const EVP_CIPHER_CTX *ctx, int flags)
+int __cdecl EVP_CIPHER_CTX_test_flags(const EVP_CIPHER_CTX *ctx, int flags)
 {
     return (ctx->flags & flags);
 }
diff --git a/crypto/evp/evp_locl.h b/crypto/evp/evp_locl.h
index f1589d6828..487e639f07 100644
--- a/crypto/evp/evp_locl.h
+++ b/crypto/evp/evp_locl.h
@@ -41,7 +41,7 @@ struct evp_cipher_ctx_st {
     unsigned char final[EVP_MAX_BLOCK_LENGTH]; /* possible final block */
 } /* EVP_CIPHER_CTX */ ;
 
-int PKCS5_v2_PBKDF2_keyivgen(EVP_CIPHER_CTX *ctx, const char *pass,
+int __cdecl PKCS5_v2_PBKDF2_keyivgen(EVP_CIPHER_CTX *ctx, const char *pass,
                              int passlen, ASN1_TYPE *param,
                              const EVP_CIPHER *c, const EVP_MD *md,
                              int en_de);
diff --git a/crypto/evp/evp_pbe.c b/crypto/evp/evp_pbe.c
index 5a88817b4a..a2a63dbd3b 100644
--- a/crypto/evp/evp_pbe.c
+++ b/crypto/evp/evp_pbe.c
@@ -81,7 +81,7 @@ static const EVP_PBE_CTL builtin_pbe[] = {
 #endif
 };
 
-int EVP_PBE_CipherInit(ASN1_OBJECT *pbe_obj, const char *pass, int passlen,
+int __cdecl EVP_PBE_CipherInit(ASN1_OBJECT *pbe_obj, const char *pass, int passlen,
                        ASN1_TYPE *param, EVP_CIPHER_CTX *ctx, int en_de)
 {
     const EVP_CIPHER *cipher;
@@ -135,7 +135,7 @@ int EVP_PBE_CipherInit(ASN1_OBJECT *pbe_obj, const char *pass, int passlen,
 
 DECLARE_OBJ_BSEARCH_CMP_FN(EVP_PBE_CTL, EVP_PBE_CTL, pbe2);
 
-static int pbe2_cmp(const EVP_PBE_CTL *pbe1, const EVP_PBE_CTL *pbe2)
+static int __cdecl pbe2_cmp(const EVP_PBE_CTL *pbe1, const EVP_PBE_CTL *pbe2)
 {
     int ret = pbe1->pbe_type - pbe2->pbe_type;
     if (ret)
@@ -146,7 +146,7 @@ static int pbe2_cmp(const EVP_PBE_CTL *pbe1, const EVP_PBE_CTL *pbe2)
 
 IMPLEMENT_OBJ_BSEARCH_CMP_FN(EVP_PBE_CTL, EVP_PBE_CTL, pbe2);
 
-static int pbe_cmp(const EVP_PBE_CTL *const *a, const EVP_PBE_CTL *const *b)
+static int __cdecl pbe_cmp(const EVP_PBE_CTL *const *a, const EVP_PBE_CTL *const *b)
 {
     int ret = (*a)->pbe_type - (*b)->pbe_type;
     if (ret)
@@ -157,7 +157,7 @@ static int pbe_cmp(const EVP_PBE_CTL *const *a, const EVP_PBE_CTL *const *b)
 
 /* Add a PBE algorithm */
 
-int EVP_PBE_alg_add_type(int pbe_type, int pbe_nid, int cipher_nid,
+int __cdecl EVP_PBE_alg_add_type(int pbe_type, int pbe_nid, int cipher_nid,
                          int md_nid, EVP_PBE_KEYGEN *keygen)
 {
     EVP_PBE_CTL *pbe_tmp;
@@ -188,7 +188,7 @@ int EVP_PBE_alg_add_type(int pbe_type, int pbe_nid, int cipher_nid,
     return 0;
 }
 
-int EVP_PBE_alg_add(int nid, const EVP_CIPHER *cipher, const EVP_MD *md,
+int __cdecl EVP_PBE_alg_add(int nid, const EVP_CIPHER *cipher, const EVP_MD *md,
                     EVP_PBE_KEYGEN *keygen)
 {
     int cipher_nid, md_nid;
@@ -206,7 +206,7 @@ int EVP_PBE_alg_add(int nid, const EVP_CIPHER *cipher, const EVP_MD *md,
                                 cipher_nid, md_nid, keygen);
 }
 
-int EVP_PBE_find(int type, int pbe_nid,
+int __cdecl EVP_PBE_find(int type, int pbe_nid,
                  int *pcnid, int *pmnid, EVP_PBE_KEYGEN **pkeygen)
 {
     EVP_PBE_CTL *pbetmp = NULL, pbelu;
@@ -235,18 +235,18 @@ int EVP_PBE_find(int type, int pbe_nid,
     return 1;
 }
 
-static void free_evp_pbe_ctl(EVP_PBE_CTL *pbe)
+static void __cdecl free_evp_pbe_ctl(EVP_PBE_CTL *pbe)
 {
     OPENSSL_free(pbe);
 }
 
-void EVP_PBE_cleanup(void)
+void __cdecl EVP_PBE_cleanup(void)
 {
     sk_EVP_PBE_CTL_pop_free(pbe_algs, free_evp_pbe_ctl);
     pbe_algs = NULL;
 }
 
-int EVP_PBE_get(int *ptype, int *ppbe_nid, size_t num)
+int __cdecl EVP_PBE_get(int *ptype, int *ppbe_nid, size_t num)
 {
     const EVP_PBE_CTL *tpbe;
 
diff --git a/crypto/evp/m_md2.c b/crypto/evp/m_md2.c
index c4e28ae17a..7df0eb8e61 100644
--- a/crypto/evp/m_md2.c
+++ b/crypto/evp/m_md2.c
@@ -49,7 +49,7 @@ static const EVP_MD md2_md = {
     sizeof(EVP_MD *) + sizeof(MD2_CTX),
 };
 
-const EVP_MD *EVP_md2(void)
+const EVP_MD * __cdecl EVP_md2(void)
 {
     return &md2_md;
 }
diff --git a/crypto/evp/m_md4.c b/crypto/evp/m_md4.c
index 0efc586dba..d9631e8629 100644
--- a/crypto/evp/m_md4.c
+++ b/crypto/evp/m_md4.c
@@ -48,7 +48,7 @@ static const EVP_MD md4_md = {
     sizeof(EVP_MD *) + sizeof(MD4_CTX),
 };
 
-const EVP_MD *EVP_md4(void)
+const EVP_MD * __cdecl EVP_md4(void)
 {
     return &md4_md;
 }
diff --git a/crypto/evp/m_md5.c b/crypto/evp/m_md5.c
index 3d96ae93b6..f68ee7a8fa 100644
--- a/crypto/evp/m_md5.c
+++ b/crypto/evp/m_md5.c
@@ -48,7 +48,7 @@ static const EVP_MD md5_md = {
     sizeof(EVP_MD *) + sizeof(MD5_CTX),
 };
 
-const EVP_MD *EVP_md5(void)
+const EVP_MD * __cdecl EVP_md5(void)
 {
     return &md5_md;
 }
diff --git a/crypto/evp/m_md5_sha1.c b/crypto/evp/m_md5_sha1.c
index 2d98886ba0..7e764d3d2b 100644
--- a/crypto/evp/m_md5_sha1.c
+++ b/crypto/evp/m_md5_sha1.c
@@ -135,7 +135,7 @@ static const EVP_MD md5_sha1_md = {
     ctrl
 };
 
-const EVP_MD *EVP_md5_sha1(void)
+const EVP_MD * __cdecl EVP_md5_sha1(void)
 {
     return &md5_sha1_md;
 }
diff --git a/crypto/evp/m_mdc2.c b/crypto/evp/m_mdc2.c
index 1051a9070f..8aa768163c 100644
--- a/crypto/evp/m_mdc2.c
+++ b/crypto/evp/m_mdc2.c
@@ -48,7 +48,7 @@ static const EVP_MD mdc2_md = {
     sizeof(EVP_MD *) + sizeof(MDC2_CTX),
 };
 
-const EVP_MD *EVP_mdc2(void)
+const EVP_MD * __cdecl EVP_mdc2(void)
 {
     return &mdc2_md;
 }
diff --git a/crypto/evp/m_null.c b/crypto/evp/m_null.c
index 5dce1d510e..44c45fceb9 100644
--- a/crypto/evp/m_null.c
+++ b/crypto/evp/m_null.c
@@ -43,7 +43,7 @@ static const EVP_MD null_md = {
     sizeof(EVP_MD *),
 };
 
-const EVP_MD *EVP_md_null(void)
+const EVP_MD * __cdecl EVP_md_null(void)
 {
     return &null_md;
 }
diff --git a/crypto/evp/m_ripemd.c b/crypto/evp/m_ripemd.c
index 7ab320843c..4b6af9f3eb 100644
--- a/crypto/evp/m_ripemd.c
+++ b/crypto/evp/m_ripemd.c
@@ -48,7 +48,7 @@ static const EVP_MD ripemd160_md = {
     sizeof(EVP_MD *) + sizeof(RIPEMD160_CTX),
 };
 
-const EVP_MD *EVP_ripemd160(void)
+const EVP_MD * __cdecl EVP_ripemd160(void)
 {
     return &ripemd160_md;
 }
diff --git a/crypto/evp/m_sha1.c b/crypto/evp/m_sha1.c
index ac52417855..d527e7018e 100644
--- a/crypto/evp/m_sha1.c
+++ b/crypto/evp/m_sha1.c
@@ -106,7 +106,7 @@ static const EVP_MD sha1_md = {
     ctrl
 };
 
-const EVP_MD *EVP_sha1(void)
+const EVP_MD * __cdecl EVP_sha1(void)
 {
     return &sha1_md;
 }
@@ -155,7 +155,7 @@ static const EVP_MD sha224_md = {
     sizeof(EVP_MD *) + sizeof(SHA256_CTX),
 };
 
-const EVP_MD *EVP_sha224(void)
+const EVP_MD * __cdecl EVP_sha224(void)
 {
     return &sha224_md;
 }
@@ -174,7 +174,7 @@ static const EVP_MD sha256_md = {
     sizeof(EVP_MD *) + sizeof(SHA256_CTX),
 };
 
-const EVP_MD *EVP_sha256(void)
+const EVP_MD * __cdecl EVP_sha256(void)
 {
     return &sha256_md;
 }
@@ -234,7 +234,7 @@ static const EVP_MD sha512_224_md = {
     sizeof(EVP_MD *) + sizeof(SHA512_CTX),
 };
 
-const EVP_MD *EVP_sha512_224(void)
+const EVP_MD * __cdecl EVP_sha512_224(void)
 {
     return &sha512_224_md;
 }
@@ -253,7 +253,7 @@ static const EVP_MD sha512_256_md = {
     sizeof(EVP_MD *) + sizeof(SHA512_CTX),
 };
 
-const EVP_MD *EVP_sha512_256(void)
+const EVP_MD * __cdecl EVP_sha512_256(void)
 {
     return &sha512_256_md;
 }
@@ -272,7 +272,7 @@ static const EVP_MD sha384_md = {
     sizeof(EVP_MD *) + sizeof(SHA512_CTX),
 };
 
-const EVP_MD *EVP_sha384(void)
+const EVP_MD * __cdecl EVP_sha384(void)
 {
     return &sha384_md;
 }
@@ -291,7 +291,7 @@ static const EVP_MD sha512_md = {
     sizeof(EVP_MD *) + sizeof(SHA512_CTX),
 };
 
-const EVP_MD *EVP_sha512(void)
+const EVP_MD * __cdecl EVP_sha512(void)
 {
     return &sha512_md;
 }
diff --git a/crypto/evp/m_sha3.c b/crypto/evp/m_sha3.c
index 01cf57d313..03bb1baccc 100644
--- a/crypto/evp/m_sha3.c
+++ b/crypto/evp/m_sha3.c
@@ -361,7 +361,7 @@ const EVP_MD *EVP_shake##bitlen(void)                \
 #else
 
 # define EVP_MD_SHA3(bitlen)                    \
-const EVP_MD *EVP_sha3_##bitlen(void)           \
+const EVP_MD * __cdecl EVP_sha3_##bitlen(void)           \
 {                                               \
     static const EVP_MD sha3_##bitlen##_md = {  \
         NID_sha3_##bitlen,                      \
@@ -380,7 +380,7 @@ const EVP_MD *EVP_sha3_##bitlen(void)           \
 }
 
 # define EVP_MD_SHAKE(bitlen)                   \
-const EVP_MD *EVP_shake##bitlen(void)           \
+const EVP_MD * __cdecl EVP_shake##bitlen(void)           \
 {                                               \
     static const EVP_MD shake##bitlen##_md = {  \
         NID_shake##bitlen,                      \
diff --git a/crypto/evp/m_sigver.c b/crypto/evp/m_sigver.c
index 94e37f02b2..2427ca13fd 100644
--- a/crypto/evp/m_sigver.c
+++ b/crypto/evp/m_sigver.c
@@ -85,19 +85,19 @@ static int do_sigver_init(EVP_MD_CTX *ctx, EVP_PKEY_CTX **pctx,
     return 1;
 }
 
-int EVP_DigestSignInit(EVP_MD_CTX *ctx, EVP_PKEY_CTX **pctx,
+int __cdecl EVP_DigestSignInit(EVP_MD_CTX *ctx, EVP_PKEY_CTX **pctx,
                        const EVP_MD *type, ENGINE *e, EVP_PKEY *pkey)
 {
     return do_sigver_init(ctx, pctx, type, e, pkey, 0);
 }
 
-int EVP_DigestVerifyInit(EVP_MD_CTX *ctx, EVP_PKEY_CTX **pctx,
+int __cdecl EVP_DigestVerifyInit(EVP_MD_CTX *ctx, EVP_PKEY_CTX **pctx,
                          const EVP_MD *type, ENGINE *e, EVP_PKEY *pkey)
 {
     return do_sigver_init(ctx, pctx, type, e, pkey, 1);
 }
 
-int EVP_DigestSignFinal(EVP_MD_CTX *ctx, unsigned char *sigret,
+int __cdecl EVP_DigestSignFinal(EVP_MD_CTX *ctx, unsigned char *sigret,
                         size_t *siglen)
 {
     int sctx = 0, r = 0;
@@ -160,7 +160,7 @@ int EVP_DigestSignFinal(EVP_MD_CTX *ctx, unsigned char *sigret,
     return 1;
 }
 
-int EVP_DigestSign(EVP_MD_CTX *ctx, unsigned char *sigret, size_t *siglen,
+int __cdecl EVP_DigestSign(EVP_MD_CTX *ctx, unsigned char *sigret, size_t *siglen,
                    const unsigned char *tbs, size_t tbslen)
 {
     if (ctx->pctx->pmeth->digestsign != NULL)
@@ -170,7 +170,7 @@ int EVP_DigestSign(EVP_MD_CTX *ctx, unsigned char *sigret, size_t *siglen,
     return EVP_DigestSignFinal(ctx, sigret, siglen);
 }
 
-int EVP_DigestVerifyFinal(EVP_MD_CTX *ctx, const unsigned char *sig,
+int __cdecl EVP_DigestVerifyFinal(EVP_MD_CTX *ctx, const unsigned char *sig,
                           size_t siglen)
 {
     unsigned char md[EVP_MAX_MD_SIZE];
@@ -207,7 +207,7 @@ int EVP_DigestVerifyFinal(EVP_MD_CTX *ctx, const unsigned char *sig,
     return EVP_PKEY_verify(ctx->pctx, sig, siglen, md, mdlen);
 }
 
-int EVP_DigestVerify(EVP_MD_CTX *ctx, const unsigned char *sigret,
+int __cdecl EVP_DigestVerify(EVP_MD_CTX *ctx, const unsigned char *sigret,
                      size_t siglen, const unsigned char *tbs, size_t tbslen)
 {
     if (ctx->pctx->pmeth->digestverify != NULL)
diff --git a/crypto/evp/m_wp.c b/crypto/evp/m_wp.c
index 27e2b3c5ca..8d7b42f7bd 100644
--- a/crypto/evp/m_wp.c
+++ b/crypto/evp/m_wp.c
@@ -47,7 +47,7 @@ static const EVP_MD whirlpool_md = {
     sizeof(EVP_MD *) + sizeof(WHIRLPOOL_CTX),
 };
 
-const EVP_MD *EVP_whirlpool(void)
+const EVP_MD * __cdecl EVP_whirlpool(void)
 {
     return &whirlpool_md;
 }
diff --git a/crypto/evp/names.c b/crypto/evp/names.c
index 077c2a6c4b..96328f94de 100644
--- a/crypto/evp/names.c
+++ b/crypto/evp/names.c
@@ -14,7 +14,7 @@
 #include <openssl/x509.h>
 #include "internal/evp_int.h"
 
-int EVP_add_cipher(const EVP_CIPHER *c)
+int __cdecl EVP_add_cipher(const EVP_CIPHER *c)
 {
     int r;
 
@@ -30,7 +30,7 @@ int EVP_add_cipher(const EVP_CIPHER *c)
     return r;
 }
 
-int EVP_add_digest(const EVP_MD *md)
+int __cdecl EVP_add_digest(const EVP_MD *md)
 {
     int r;
     const char *name;
@@ -55,7 +55,7 @@ int EVP_add_digest(const EVP_MD *md)
     return r;
 }
 
-const EVP_CIPHER *EVP_get_cipherbyname(const char *name)
+const EVP_CIPHER * __cdecl EVP_get_cipherbyname(const char *name)
 {
     const EVP_CIPHER *cp;
 
@@ -66,7 +66,7 @@ const EVP_CIPHER *EVP_get_cipherbyname(const char *name)
     return cp;
 }
 
-const EVP_MD *EVP_get_digestbyname(const char *name)
+const EVP_MD * __cdecl EVP_get_digestbyname(const char *name)
 {
     const EVP_MD *cp;
 
@@ -109,7 +109,7 @@ static void do_all_cipher_fn(const OBJ_NAME *nm, void *arg)
         dc->fn((const EVP_CIPHER *)nm->data, nm->name, NULL, dc->arg);
 }
 
-void EVP_CIPHER_do_all(void (*fn) (const EVP_CIPHER *ciph,
+void __cdecl EVP_CIPHER_do_all(void (*fn) (const EVP_CIPHER *ciph,
                                    const char *from, const char *to, void *x),
                        void *arg)
 {
@@ -123,7 +123,7 @@ void EVP_CIPHER_do_all(void (*fn) (const EVP_CIPHER *ciph,
     OBJ_NAME_do_all(OBJ_NAME_TYPE_CIPHER_METH, do_all_cipher_fn, &dc);
 }
 
-void EVP_CIPHER_do_all_sorted(void (*fn) (const EVP_CIPHER *ciph,
+void __cdecl EVP_CIPHER_do_all_sorted(void (*fn) (const EVP_CIPHER *ciph,
                                           const char *from, const char *to,
                                           void *x), void *arg)
 {
@@ -152,7 +152,7 @@ static void do_all_md_fn(const OBJ_NAME *nm, void *arg)
         dc->fn((const EVP_MD *)nm->data, nm->name, NULL, dc->arg);
 }
 
-void EVP_MD_do_all(void (*fn) (const EVP_MD *md,
+void __cdecl EVP_MD_do_all(void (*fn) (const EVP_MD *md,
                                const char *from, const char *to, void *x),
                    void *arg)
 {
@@ -166,7 +166,7 @@ void EVP_MD_do_all(void (*fn) (const EVP_MD *md,
     OBJ_NAME_do_all(OBJ_NAME_TYPE_MD_METH, do_all_md_fn, &dc);
 }
 
-void EVP_MD_do_all_sorted(void (*fn) (const EVP_MD *md,
+void __cdecl EVP_MD_do_all_sorted(void (*fn) (const EVP_MD *md,
                                       const char *from, const char *to,
                                       void *x), void *arg)
 {
diff --git a/crypto/evp/p5_crpt.c b/crypto/evp/p5_crpt.c
index 7e55d0bfb8..0d8873ce08 100644
--- a/crypto/evp/p5_crpt.c
+++ b/crypto/evp/p5_crpt.c
@@ -17,11 +17,11 @@
  * Doesn't do anything now: Builtin PBE algorithms in static table.
  */
 
-void PKCS5_PBE_add(void)
+void __cdecl PKCS5_PBE_add(void)
 {
 }
 
-int PKCS5_PBE_keyivgen(EVP_CIPHER_CTX *cctx, const char *pass, int passlen,
+int __cdecl PKCS5_PBE_keyivgen(EVP_CIPHER_CTX *cctx, const char *pass, int passlen,
                        ASN1_TYPE *param, const EVP_CIPHER *cipher,
                        const EVP_MD *md, int en_de)
 {
diff --git a/crypto/evp/p5_crpt2.c b/crypto/evp/p5_crpt2.c
index e819eb9b47..3e9a57c9c8 100644
--- a/crypto/evp/p5_crpt2.c
+++ b/crypto/evp/p5_crpt2.c
@@ -28,7 +28,7 @@ static void h__dump(const unsigned char *p, int len);
  * posted by Peter Gutmann to the PKCS-TNG mailing list.
  */
 
-int PKCS5_PBKDF2_HMAC(const char *pass, int passlen,
+int __cdecl PKCS5_PBKDF2_HMAC(const char *pass, int passlen,
                       const unsigned char *salt, int saltlen, int iter,
                       const EVP_MD *digest, int keylen, unsigned char *out)
 {
@@ -121,7 +121,7 @@ int PKCS5_PBKDF2_HMAC(const char *pass, int passlen,
     return 1;
 }
 
-int PKCS5_PBKDF2_HMAC_SHA1(const char *pass, int passlen,
+int __cdecl PKCS5_PBKDF2_HMAC_SHA1(const char *pass, int passlen,
                            const unsigned char *salt, int saltlen, int iter,
                            int keylen, unsigned char *out)
 {
@@ -135,7 +135,7 @@ int PKCS5_PBKDF2_HMAC_SHA1(const char *pass, int passlen,
  * them...
  */
 
-int PKCS5_v2_PBE_keyivgen(EVP_CIPHER_CTX *ctx, const char *pass, int passlen,
+int __cdecl PKCS5_v2_PBE_keyivgen(EVP_CIPHER_CTX *ctx, const char *pass, int passlen,
                           ASN1_TYPE *param, const EVP_CIPHER *c,
                           const EVP_MD *md, int en_de)
 {
@@ -183,7 +183,7 @@ int PKCS5_v2_PBE_keyivgen(EVP_CIPHER_CTX *ctx, const char *pass, int passlen,
     return rv;
 }
 
-int PKCS5_v2_PBKDF2_keyivgen(EVP_CIPHER_CTX *ctx, const char *pass,
+int __cdecl PKCS5_v2_PBKDF2_keyivgen(EVP_CIPHER_CTX *ctx, const char *pass,
                              int passlen, ASN1_TYPE *param,
                              const EVP_CIPHER *c, const EVP_MD *md, int en_de)
 {
diff --git a/crypto/evp/p_dec.c b/crypto/evp/p_dec.c
index a150a26e09..2694dbd1cc 100644
--- a/crypto/evp/p_dec.c
+++ b/crypto/evp/p_dec.c
@@ -14,7 +14,7 @@
 #include <openssl/objects.h>
 #include <openssl/x509.h>
 
-int EVP_PKEY_decrypt_old(unsigned char *key, const unsigned char *ek, int ekl,
+int __cdecl EVP_PKEY_decrypt_old(unsigned char *key, const unsigned char *ek, int ekl,
                          EVP_PKEY *priv)
 {
     int ret = -1;
diff --git a/crypto/evp/p_enc.c b/crypto/evp/p_enc.c
index 04d67cb50f..10b2d3d224 100644
--- a/crypto/evp/p_enc.c
+++ b/crypto/evp/p_enc.c
@@ -14,7 +14,7 @@
 #include <openssl/objects.h>
 #include <openssl/x509.h>
 
-int EVP_PKEY_encrypt_old(unsigned char *ek, const unsigned char *key,
+int __cdecl EVP_PKEY_encrypt_old(unsigned char *ek, const unsigned char *key,
                          int key_len, EVP_PKEY *pubk)
 {
     int ret = 0;
diff --git a/crypto/evp/p_lib.c b/crypto/evp/p_lib.c
index 3cd7ca8d54..217e4b8768 100644
--- a/crypto/evp/p_lib.c
+++ b/crypto/evp/p_lib.c
@@ -26,14 +26,14 @@
 
 static void EVP_PKEY_free_it(EVP_PKEY *x);
 
-int EVP_PKEY_bits(const EVP_PKEY *pkey)
+int __cdecl EVP_PKEY_bits(const EVP_PKEY *pkey)
 {
     if (pkey && pkey->ameth && pkey->ameth->pkey_bits)
         return pkey->ameth->pkey_bits(pkey);
     return 0;
 }
 
-int EVP_PKEY_security_bits(const EVP_PKEY *pkey)
+int __cdecl EVP_PKEY_security_bits(const EVP_PKEY *pkey)
 {
     if (pkey == NULL)
         return 0;
@@ -42,14 +42,14 @@ int EVP_PKEY_security_bits(const EVP_PKEY *pkey)
     return pkey->ameth->pkey_security_bits(pkey);
 }
 
-int EVP_PKEY_size(const EVP_PKEY *pkey)
+int __cdecl EVP_PKEY_size(const EVP_PKEY *pkey)
 {
     if (pkey && pkey->ameth && pkey->ameth->pkey_size)
         return pkey->ameth->pkey_size(pkey);
     return 0;
 }
 
-int EVP_PKEY_save_parameters(EVP_PKEY *pkey, int mode)
+int __cdecl EVP_PKEY_save_parameters(EVP_PKEY *pkey, int mode)
 {
 #ifndef OPENSSL_NO_DSA
     if (pkey->type == EVP_PKEY_DSA) {
@@ -72,7 +72,7 @@ int EVP_PKEY_save_parameters(EVP_PKEY *pkey, int mode)
     return 0;
 }
 
-int EVP_PKEY_copy_parameters(EVP_PKEY *to, const EVP_PKEY *from)
+int __cdecl EVP_PKEY_copy_parameters(EVP_PKEY *to, const EVP_PKEY *from)
 {
     if (to->type == EVP_PKEY_NONE) {
         if (EVP_PKEY_set_type(to, from->type) == 0)
@@ -100,14 +100,14 @@ int EVP_PKEY_copy_parameters(EVP_PKEY *to, const EVP_PKEY *from)
     return 0;
 }
 
-int EVP_PKEY_missing_parameters(const EVP_PKEY *pkey)
+int __cdecl EVP_PKEY_missing_parameters(const EVP_PKEY *pkey)
 {
     if (pkey->ameth && pkey->ameth->param_missing)
         return pkey->ameth->param_missing(pkey);
     return 0;
 }
 
-int EVP_PKEY_cmp_parameters(const EVP_PKEY *a, const EVP_PKEY *b)
+int __cdecl EVP_PKEY_cmp_parameters(const EVP_PKEY *a, const EVP_PKEY *b)
 {
     if (a->type != b->type)
         return -1;
@@ -116,7 +116,7 @@ int EVP_PKEY_cmp_parameters(const EVP_PKEY *a, const EVP_PKEY *b)
     return -2;
 }
 
-int EVP_PKEY_cmp(const EVP_PKEY *a, const EVP_PKEY *b)
+int __cdecl EVP_PKEY_cmp(const EVP_PKEY *a, const EVP_PKEY *b)
 {
     if (a->type != b->type)
         return -1;
@@ -137,7 +137,7 @@ int EVP_PKEY_cmp(const EVP_PKEY *a, const EVP_PKEY *b)
     return -2;
 }
 
-EVP_PKEY *EVP_PKEY_new(void)
+EVP_PKEY * __cdecl EVP_PKEY_new(void)
 {
     EVP_PKEY *ret = OPENSSL_zalloc(sizeof(*ret));
 
@@ -158,7 +158,7 @@ EVP_PKEY *EVP_PKEY_new(void)
     return ret;
 }
 
-int EVP_PKEY_up_ref(EVP_PKEY *pkey)
+int __cdecl EVP_PKEY_up_ref(EVP_PKEY *pkey)
 {
     int i;
 
@@ -220,7 +220,7 @@ static int pkey_set_type(EVP_PKEY *pkey, ENGINE *e, int type, const char *str,
     return 1;
 }
 
-EVP_PKEY *EVP_PKEY_new_raw_private_key(int type, ENGINE *e,
+EVP_PKEY * __cdecl EVP_PKEY_new_raw_private_key(int type, ENGINE *e,
                                        const unsigned char *priv,
                                        size_t len)
 {
@@ -250,7 +250,7 @@ EVP_PKEY *EVP_PKEY_new_raw_private_key(int type, ENGINE *e,
     return NULL;
 }
 
-EVP_PKEY *EVP_PKEY_new_raw_public_key(int type, ENGINE *e,
+EVP_PKEY * __cdecl EVP_PKEY_new_raw_public_key(int type, ENGINE *e,
                                       const unsigned char *pub,
                                       size_t len)
 {
@@ -280,7 +280,7 @@ EVP_PKEY *EVP_PKEY_new_raw_public_key(int type, ENGINE *e,
     return NULL;
 }
 
-int EVP_PKEY_get_raw_private_key(const EVP_PKEY *pkey, unsigned char *priv,
+int __cdecl EVP_PKEY_get_raw_private_key(const EVP_PKEY *pkey, unsigned char *priv,
                                  size_t *len)
 {
      if (pkey->ameth->get_priv_key == NULL) {
@@ -297,7 +297,7 @@ int EVP_PKEY_get_raw_private_key(const EVP_PKEY *pkey, unsigned char *priv,
     return 1;
 }
 
-int EVP_PKEY_get_raw_public_key(const EVP_PKEY *pkey, unsigned char *pub,
+int __cdecl EVP_PKEY_get_raw_public_key(const EVP_PKEY *pkey, unsigned char *pub,
                                 size_t *len)
 {
      if (pkey->ameth->get_pub_key == NULL) {
@@ -314,7 +314,7 @@ int EVP_PKEY_get_raw_public_key(const EVP_PKEY *pkey, unsigned char *pub,
     return 1;
 }
 
-EVP_PKEY *EVP_PKEY_new_CMAC_key(ENGINE *e, const unsigned char *priv,
+EVP_PKEY * __cdecl EVP_PKEY_new_CMAC_key(ENGINE *e, const unsigned char *priv,
                                 size_t len, const EVP_CIPHER *cipher)
 {
 #ifndef OPENSSL_NO_CMAC
@@ -347,17 +347,17 @@ EVP_PKEY *EVP_PKEY_new_CMAC_key(ENGINE *e, const unsigned char *priv,
 #endif
 }
 
-int EVP_PKEY_set_type(EVP_PKEY *pkey, int type)
+int __cdecl EVP_PKEY_set_type(EVP_PKEY *pkey, int type)
 {
     return pkey_set_type(pkey, NULL, type, NULL, -1);
 }
 
-int EVP_PKEY_set_type_str(EVP_PKEY *pkey, const char *str, int len)
+int __cdecl EVP_PKEY_set_type_str(EVP_PKEY *pkey, const char *str, int len)
 {
     return pkey_set_type(pkey, NULL, EVP_PKEY_NONE, str, len);
 }
 
-int EVP_PKEY_set_alias_type(EVP_PKEY *pkey, int type)
+int __cdecl EVP_PKEY_set_alias_type(EVP_PKEY *pkey, int type)
 {
     if (pkey->type == type) {
         return 1; /* it already is that type */
@@ -377,7 +377,7 @@ int EVP_PKEY_set_alias_type(EVP_PKEY *pkey, int type)
 }
 
 #ifndef OPENSSL_NO_ENGINE
-int EVP_PKEY_set1_engine(EVP_PKEY *pkey, ENGINE *e)
+int __cdecl EVP_PKEY_set1_engine(EVP_PKEY *pkey, ENGINE *e)
 {
     if (e != NULL) {
         if (!ENGINE_init(e)) {
@@ -395,12 +395,12 @@ int EVP_PKEY_set1_engine(EVP_PKEY *pkey, ENGINE *e)
     return 1;
 }
 
-ENGINE *EVP_PKEY_get0_engine(const EVP_PKEY *pkey)
+ENGINE * __cdecl EVP_PKEY_get0_engine(const EVP_PKEY *pkey)
 {
     return pkey->engine;
 }
 #endif
-int EVP_PKEY_assign(EVP_PKEY *pkey, int type, void *key)
+int __cdecl EVP_PKEY_assign(EVP_PKEY *pkey, int type, void *key)
 {
     if (pkey == NULL || !EVP_PKEY_set_type(pkey, type))
         return 0;
@@ -408,12 +408,12 @@ int EVP_PKEY_assign(EVP_PKEY *pkey, int type, void *key)
     return (key != NULL);
 }
 
-void *EVP_PKEY_get0(const EVP_PKEY *pkey)
+void * __cdecl EVP_PKEY_get0(const EVP_PKEY *pkey)
 {
     return pkey->pkey.ptr;
 }
 
-const unsigned char *EVP_PKEY_get0_hmac(const EVP_PKEY *pkey, size_t *len)
+const unsigned char * __cdecl EVP_PKEY_get0_hmac(const EVP_PKEY *pkey, size_t *len)
 {
     ASN1_OCTET_STRING *os = NULL;
     if (pkey->type != EVP_PKEY_HMAC) {
@@ -426,7 +426,7 @@ const unsigned char *EVP_PKEY_get0_hmac(const EVP_PKEY *pkey, size_t *len)
 }
 
 #ifndef OPENSSL_NO_POLY1305
-const unsigned char *EVP_PKEY_get0_poly1305(const EVP_PKEY *pkey, size_t *len)
+const unsigned char * __cdecl EVP_PKEY_get0_poly1305(const EVP_PKEY *pkey, size_t *len)
 {
     ASN1_OCTET_STRING *os = NULL;
     if (pkey->type != EVP_PKEY_POLY1305) {
@@ -440,7 +440,7 @@ const unsigned char *EVP_PKEY_get0_poly1305(const EVP_PKEY *pkey, size_t *len)
 #endif
 
 #ifndef OPENSSL_NO_SIPHASH
-const unsigned char *EVP_PKEY_get0_siphash(const EVP_PKEY *pkey, size_t *len)
+const unsigned char * __cdecl EVP_PKEY_get0_siphash(const EVP_PKEY *pkey, size_t *len)
 {
     ASN1_OCTET_STRING *os = NULL;
 
@@ -455,7 +455,7 @@ const unsigned char *EVP_PKEY_get0_siphash(const EVP_PKEY *pkey, size_t *len)
 #endif
 
 #ifndef OPENSSL_NO_RSA
-int EVP_PKEY_set1_RSA(EVP_PKEY *pkey, RSA *key)
+int __cdecl EVP_PKEY_set1_RSA(EVP_PKEY *pkey, RSA *key)
 {
     int ret = EVP_PKEY_assign_RSA(pkey, key);
     if (ret)
@@ -463,7 +463,7 @@ int EVP_PKEY_set1_RSA(EVP_PKEY *pkey, RSA *key)
     return ret;
 }
 
-RSA *EVP_PKEY_get0_RSA(EVP_PKEY *pkey)
+RSA * __cdecl EVP_PKEY_get0_RSA(EVP_PKEY *pkey)
 {
     if (pkey->type != EVP_PKEY_RSA) {
         EVPerr(EVP_F_EVP_PKEY_GET0_RSA, EVP_R_EXPECTING_AN_RSA_KEY);
@@ -472,7 +472,7 @@ RSA *EVP_PKEY_get0_RSA(EVP_PKEY *pkey)
     return pkey->pkey.rsa;
 }
 
-RSA *EVP_PKEY_get1_RSA(EVP_PKEY *pkey)
+RSA * __cdecl EVP_PKEY_get1_RSA(EVP_PKEY *pkey)
 {
     RSA *ret = EVP_PKEY_get0_RSA(pkey);
     if (ret != NULL)
@@ -482,7 +482,7 @@ RSA *EVP_PKEY_get1_RSA(EVP_PKEY *pkey)
 #endif
 
 #ifndef OPENSSL_NO_DSA
-int EVP_PKEY_set1_DSA(EVP_PKEY *pkey, DSA *key)
+int __cdecl EVP_PKEY_set1_DSA(EVP_PKEY *pkey, DSA *key)
 {
     int ret = EVP_PKEY_assign_DSA(pkey, key);
     if (ret)
@@ -490,7 +490,7 @@ int EVP_PKEY_set1_DSA(EVP_PKEY *pkey, DSA *key)
     return ret;
 }
 
-DSA *EVP_PKEY_get0_DSA(EVP_PKEY *pkey)
+DSA * __cdecl EVP_PKEY_get0_DSA(EVP_PKEY *pkey)
 {
     if (pkey->type != EVP_PKEY_DSA) {
         EVPerr(EVP_F_EVP_PKEY_GET0_DSA, EVP_R_EXPECTING_A_DSA_KEY);
@@ -499,7 +499,7 @@ DSA *EVP_PKEY_get0_DSA(EVP_PKEY *pkey)
     return pkey->pkey.dsa;
 }
 
-DSA *EVP_PKEY_get1_DSA(EVP_PKEY *pkey)
+DSA * __cdecl EVP_PKEY_get1_DSA(EVP_PKEY *pkey)
 {
     DSA *ret = EVP_PKEY_get0_DSA(pkey);
     if (ret != NULL)
@@ -510,7 +510,7 @@ DSA *EVP_PKEY_get1_DSA(EVP_PKEY *pkey)
 
 #ifndef OPENSSL_NO_EC
 
-int EVP_PKEY_set1_EC_KEY(EVP_PKEY *pkey, EC_KEY *key)
+int __cdecl EVP_PKEY_set1_EC_KEY(EVP_PKEY *pkey, EC_KEY *key)
 {
     int ret = EVP_PKEY_assign_EC_KEY(pkey, key);
     if (ret)
@@ -518,7 +518,7 @@ int EVP_PKEY_set1_EC_KEY(EVP_PKEY *pkey, EC_KEY *key)
     return ret;
 }
 
-EC_KEY *EVP_PKEY_get0_EC_KEY(EVP_PKEY *pkey)
+EC_KEY * __cdecl EVP_PKEY_get0_EC_KEY(EVP_PKEY *pkey)
 {
     if (pkey->type != EVP_PKEY_EC) {
         EVPerr(EVP_F_EVP_PKEY_GET0_EC_KEY, EVP_R_EXPECTING_A_EC_KEY);
@@ -527,7 +527,7 @@ EC_KEY *EVP_PKEY_get0_EC_KEY(EVP_PKEY *pkey)
     return pkey->pkey.ec;
 }
 
-EC_KEY *EVP_PKEY_get1_EC_KEY(EVP_PKEY *pkey)
+EC_KEY * __cdecl EVP_PKEY_get1_EC_KEY(EVP_PKEY *pkey)
 {
     EC_KEY *ret = EVP_PKEY_get0_EC_KEY(pkey);
     if (ret != NULL)
@@ -538,7 +538,7 @@ EC_KEY *EVP_PKEY_get1_EC_KEY(EVP_PKEY *pkey)
 
 #ifndef OPENSSL_NO_DH
 
-int EVP_PKEY_set1_DH(EVP_PKEY *pkey, DH *key)
+int __cdecl EVP_PKEY_set1_DH(EVP_PKEY *pkey, DH *key)
 {
     int ret = EVP_PKEY_assign_DH(pkey, key);
     if (ret)
@@ -546,7 +546,7 @@ int EVP_PKEY_set1_DH(EVP_PKEY *pkey, DH *key)
     return ret;
 }
 
-DH *EVP_PKEY_get0_DH(EVP_PKEY *pkey)
+DH * __cdecl EVP_PKEY_get0_DH(EVP_PKEY *pkey)
 {
     if (pkey->type != EVP_PKEY_DH && pkey->type != EVP_PKEY_DHX) {
         EVPerr(EVP_F_EVP_PKEY_GET0_DH, EVP_R_EXPECTING_A_DH_KEY);
@@ -555,7 +555,7 @@ DH *EVP_PKEY_get0_DH(EVP_PKEY *pkey)
     return pkey->pkey.dh;
 }
 
-DH *EVP_PKEY_get1_DH(EVP_PKEY *pkey)
+DH * __cdecl EVP_PKEY_get1_DH(EVP_PKEY *pkey)
 {
     DH *ret = EVP_PKEY_get0_DH(pkey);
     if (ret != NULL)
@@ -564,7 +564,7 @@ DH *EVP_PKEY_get1_DH(EVP_PKEY *pkey)
 }
 #endif
 
-int EVP_PKEY_type(int type)
+int __cdecl EVP_PKEY_type(int type)
 {
     int ret;
     const EVP_PKEY_ASN1_METHOD *ameth;
@@ -580,17 +580,17 @@ int EVP_PKEY_type(int type)
     return ret;
 }
 
-int EVP_PKEY_id(const EVP_PKEY *pkey)
+int __cdecl EVP_PKEY_id(const EVP_PKEY *pkey)
 {
     return pkey->type;
 }
 
-int EVP_PKEY_base_id(const EVP_PKEY *pkey)
+int __cdecl EVP_PKEY_base_id(const EVP_PKEY *pkey)
 {
     return EVP_PKEY_type(pkey->type);
 }
 
-void EVP_PKEY_free(EVP_PKEY *x)
+void __cdecl EVP_PKEY_free(EVP_PKEY *x)
 {
     int i;
 
@@ -632,7 +632,7 @@ static int unsup_alg(BIO *out, const EVP_PKEY *pkey, int indent,
     return 1;
 }
 
-int EVP_PKEY_print_public(BIO *out, const EVP_PKEY *pkey,
+int __cdecl EVP_PKEY_print_public(BIO *out, const EVP_PKEY *pkey,
                           int indent, ASN1_PCTX *pctx)
 {
     if (pkey->ameth && pkey->ameth->pub_print)
@@ -641,7 +641,7 @@ int EVP_PKEY_print_public(BIO *out, const EVP_PKEY *pkey,
     return unsup_alg(out, pkey, indent, "Public Key");
 }
 
-int EVP_PKEY_print_private(BIO *out, const EVP_PKEY *pkey,
+int __cdecl EVP_PKEY_print_private(BIO *out, const EVP_PKEY *pkey,
                            int indent, ASN1_PCTX *pctx)
 {
     if (pkey->ameth && pkey->ameth->priv_print)
@@ -650,7 +650,7 @@ int EVP_PKEY_print_private(BIO *out, const EVP_PKEY *pkey,
     return unsup_alg(out, pkey, indent, "Private Key");
 }
 
-int EVP_PKEY_print_params(BIO *out, const EVP_PKEY *pkey,
+int __cdecl EVP_PKEY_print_params(BIO *out, const EVP_PKEY *pkey,
                           int indent, ASN1_PCTX *pctx)
 {
     if (pkey->ameth && pkey->ameth->param_print)
@@ -665,12 +665,12 @@ static int evp_pkey_asn1_ctrl(EVP_PKEY *pkey, int op, int arg1, void *arg2)
     return pkey->ameth->pkey_ctrl(pkey, op, arg1, arg2);
 }
 
-int EVP_PKEY_get_default_digest_nid(EVP_PKEY *pkey, int *pnid)
+int __cdecl EVP_PKEY_get_default_digest_nid(EVP_PKEY *pkey, int *pnid)
 {
     return evp_pkey_asn1_ctrl(pkey, ASN1_PKEY_CTRL_DEFAULT_MD_NID, 0, pnid);
 }
 
-int EVP_PKEY_set1_tls_encodedpoint(EVP_PKEY *pkey,
+int __cdecl EVP_PKEY_set1_tls_encodedpoint(EVP_PKEY *pkey,
                                const unsigned char *pt, size_t ptlen)
 {
     if (ptlen > INT_MAX)
@@ -681,7 +681,7 @@ int EVP_PKEY_set1_tls_encodedpoint(EVP_PKEY *pkey,
     return 1;
 }
 
-size_t EVP_PKEY_get1_tls_encodedpoint(EVP_PKEY *pkey, unsigned char **ppt)
+size_t __cdecl EVP_PKEY_get1_tls_encodedpoint(EVP_PKEY *pkey, unsigned char **ppt)
 {
     int rv;
     rv = evp_pkey_asn1_ctrl(pkey, ASN1_PKEY_CTRL_GET1_TLS_ENCPT, 0, ppt);
diff --git a/crypto/evp/p_open.c b/crypto/evp/p_open.c
index 1ce87454bd..a2ce6d7e0b 100644
--- a/crypto/evp/p_open.c
+++ b/crypto/evp/p_open.c
@@ -18,7 +18,7 @@ NON_EMPTY_TRANSLATION_UNIT
 # include <openssl/x509.h>
 # include <openssl/rsa.h>
 
-int EVP_OpenInit(EVP_CIPHER_CTX *ctx, const EVP_CIPHER *type,
+int __cdecl EVP_OpenInit(EVP_CIPHER_CTX *ctx, const EVP_CIPHER *type,
                  const unsigned char *ek, int ekl, const unsigned char *iv,
                  EVP_PKEY *priv)
 {
@@ -61,7 +61,7 @@ int EVP_OpenInit(EVP_CIPHER_CTX *ctx, const EVP_CIPHER *type,
     return ret;
 }
 
-int EVP_OpenFinal(EVP_CIPHER_CTX *ctx, unsigned char *out, int *outl)
+int __cdecl EVP_OpenFinal(EVP_CIPHER_CTX *ctx, unsigned char *out, int *outl)
 {
     int i;
 
diff --git a/crypto/evp/p_seal.c b/crypto/evp/p_seal.c
index e851d7ab8b..5024f3a482 100644
--- a/crypto/evp/p_seal.c
+++ b/crypto/evp/p_seal.c
@@ -15,7 +15,7 @@
 #include <openssl/objects.h>
 #include <openssl/x509.h>
 
-int EVP_SealInit(EVP_CIPHER_CTX *ctx, const EVP_CIPHER *type,
+int __cdecl EVP_SealInit(EVP_CIPHER_CTX *ctx, const EVP_CIPHER *type,
                  unsigned char **ek, int *ekl, unsigned char *iv,
                  EVP_PKEY **pubk, int npubk)
 {
@@ -55,7 +55,7 @@ err:
     return rv;
 }
 
-int EVP_SealFinal(EVP_CIPHER_CTX *ctx, unsigned char *out, int *outl)
+int __cdecl EVP_SealFinal(EVP_CIPHER_CTX *ctx, unsigned char *out, int *outl)
 {
     int i;
     i = EVP_EncryptFinal_ex(ctx, out, outl);
diff --git a/crypto/evp/p_sign.c b/crypto/evp/p_sign.c
index 6cb442e4f9..0dbd21677f 100644
--- a/crypto/evp/p_sign.c
+++ b/crypto/evp/p_sign.c
@@ -14,7 +14,7 @@
 #include <openssl/x509.h>
 #include "internal/evp_int.h"
 
-int EVP_SignFinal(EVP_MD_CTX *ctx, unsigned char *sigret,
+int __cdecl EVP_SignFinal(EVP_MD_CTX *ctx, unsigned char *sigret,
                   unsigned int *siglen, EVP_PKEY *pkey)
 {
     unsigned char m[EVP_MAX_MD_SIZE];
diff --git a/crypto/evp/p_verify.c b/crypto/evp/p_verify.c
index 6e8c565dfd..41418ce44b 100644
--- a/crypto/evp/p_verify.c
+++ b/crypto/evp/p_verify.c
@@ -14,7 +14,7 @@
 #include <openssl/x509.h>
 #include "internal/evp_int.h"
 
-int EVP_VerifyFinal(EVP_MD_CTX *ctx, const unsigned char *sigbuf,
+int __cdecl EVP_VerifyFinal(EVP_MD_CTX *ctx, const unsigned char *sigbuf,
                     unsigned int siglen, EVP_PKEY *pkey)
 {
     unsigned char m[EVP_MAX_MD_SIZE];
diff --git a/crypto/evp/pbe_scrypt.c b/crypto/evp/pbe_scrypt.c
index 57da82f3fe..6b3c363e17 100644
--- a/crypto/evp/pbe_scrypt.c
+++ b/crypto/evp/pbe_scrypt.c
@@ -155,7 +155,7 @@ static void scryptROMix(unsigned char *B, uint64_t r, uint64_t N,
 # define SCRYPT_MAX_MEM  (1024 * 1024 * 32)
 #endif
 
-int EVP_PBE_scrypt(const char *pass, size_t passlen,
+int __cdecl EVP_PBE_scrypt(const char *pass, size_t passlen,
                    const unsigned char *salt, size_t saltlen,
                    uint64_t N, uint64_t r, uint64_t p, uint64_t maxmem,
                    unsigned char *key, size_t keylen)
diff --git a/crypto/evp/pmeth_fn.c b/crypto/evp/pmeth_fn.c
index de1c07e171..5a0cc2562d 100644
--- a/crypto/evp/pmeth_fn.c
+++ b/crypto/evp/pmeth_fn.c
@@ -32,7 +32,7 @@
         }                                                         \
     }
 
-int EVP_PKEY_sign_init(EVP_PKEY_CTX *ctx)
+int __cdecl EVP_PKEY_sign_init(EVP_PKEY_CTX *ctx)
 {
     int ret;
     if (!ctx || !ctx->pmeth || !ctx->pmeth->sign) {
@@ -49,7 +49,7 @@ int EVP_PKEY_sign_init(EVP_PKEY_CTX *ctx)
     return ret;
 }
 
-int EVP_PKEY_sign(EVP_PKEY_CTX *ctx,
+int __cdecl EVP_PKEY_sign(EVP_PKEY_CTX *ctx,
                   unsigned char *sig, size_t *siglen,
                   const unsigned char *tbs, size_t tbslen)
 {
@@ -66,7 +66,7 @@ int EVP_PKEY_sign(EVP_PKEY_CTX *ctx,
         return ctx->pmeth->sign(ctx, sig, siglen, tbs, tbslen);
 }
 
-int EVP_PKEY_verify_init(EVP_PKEY_CTX *ctx)
+int __cdecl EVP_PKEY_verify_init(EVP_PKEY_CTX *ctx)
 {
     int ret;
     if (!ctx || !ctx->pmeth || !ctx->pmeth->verify) {
@@ -83,7 +83,7 @@ int EVP_PKEY_verify_init(EVP_PKEY_CTX *ctx)
     return ret;
 }
 
-int EVP_PKEY_verify(EVP_PKEY_CTX *ctx,
+int __cdecl EVP_PKEY_verify(EVP_PKEY_CTX *ctx,
                     const unsigned char *sig, size_t siglen,
                     const unsigned char *tbs, size_t tbslen)
 {
@@ -99,7 +99,7 @@ int EVP_PKEY_verify(EVP_PKEY_CTX *ctx,
     return ctx->pmeth->verify(ctx, sig, siglen, tbs, tbslen);
 }
 
-int EVP_PKEY_verify_recover_init(EVP_PKEY_CTX *ctx)
+int __cdecl EVP_PKEY_verify_recover_init(EVP_PKEY_CTX *ctx)
 {
     int ret;
     if (!ctx || !ctx->pmeth || !ctx->pmeth->verify_recover) {
@@ -116,7 +116,7 @@ int EVP_PKEY_verify_recover_init(EVP_PKEY_CTX *ctx)
     return ret;
 }
 
-int EVP_PKEY_verify_recover(EVP_PKEY_CTX *ctx,
+int __cdecl EVP_PKEY_verify_recover(EVP_PKEY_CTX *ctx,
                             unsigned char *rout, size_t *routlen,
                             const unsigned char *sig, size_t siglen)
 {
@@ -133,7 +133,7 @@ int EVP_PKEY_verify_recover(EVP_PKEY_CTX *ctx,
         return ctx->pmeth->verify_recover(ctx, rout, routlen, sig, siglen);
 }
 
-int EVP_PKEY_encrypt_init(EVP_PKEY_CTX *ctx)
+int __cdecl EVP_PKEY_encrypt_init(EVP_PKEY_CTX *ctx)
 {
     int ret;
     if (!ctx || !ctx->pmeth || !ctx->pmeth->encrypt) {
@@ -150,7 +150,7 @@ int EVP_PKEY_encrypt_init(EVP_PKEY_CTX *ctx)
     return ret;
 }
 
-int EVP_PKEY_encrypt(EVP_PKEY_CTX *ctx,
+int __cdecl EVP_PKEY_encrypt(EVP_PKEY_CTX *ctx,
                      unsigned char *out, size_t *outlen,
                      const unsigned char *in, size_t inlen)
 {
@@ -167,7 +167,7 @@ int EVP_PKEY_encrypt(EVP_PKEY_CTX *ctx,
         return ctx->pmeth->encrypt(ctx, out, outlen, in, inlen);
 }
 
-int EVP_PKEY_decrypt_init(EVP_PKEY_CTX *ctx)
+int __cdecl EVP_PKEY_decrypt_init(EVP_PKEY_CTX *ctx)
 {
     int ret;
     if (!ctx || !ctx->pmeth || !ctx->pmeth->decrypt) {
@@ -184,7 +184,7 @@ int EVP_PKEY_decrypt_init(EVP_PKEY_CTX *ctx)
     return ret;
 }
 
-int EVP_PKEY_decrypt(EVP_PKEY_CTX *ctx,
+int __cdecl EVP_PKEY_decrypt(EVP_PKEY_CTX *ctx,
                      unsigned char *out, size_t *outlen,
                      const unsigned char *in, size_t inlen)
 {
@@ -201,7 +201,7 @@ int EVP_PKEY_decrypt(EVP_PKEY_CTX *ctx,
         return ctx->pmeth->decrypt(ctx, out, outlen, in, inlen);
 }
 
-int EVP_PKEY_derive_init(EVP_PKEY_CTX *ctx)
+int __cdecl EVP_PKEY_derive_init(EVP_PKEY_CTX *ctx)
 {
     int ret;
     if (!ctx || !ctx->pmeth || !ctx->pmeth->derive) {
@@ -218,7 +218,7 @@ int EVP_PKEY_derive_init(EVP_PKEY_CTX *ctx)
     return ret;
 }
 
-int EVP_PKEY_derive_set_peer(EVP_PKEY_CTX *ctx, EVP_PKEY *peer)
+int __cdecl EVP_PKEY_derive_set_peer(EVP_PKEY_CTX *ctx, EVP_PKEY *peer)
 {
     int ret;
     if (!ctx || !ctx->pmeth
@@ -281,7 +281,7 @@ int EVP_PKEY_derive_set_peer(EVP_PKEY_CTX *ctx, EVP_PKEY *peer)
     return 1;
 }
 
-int EVP_PKEY_derive(EVP_PKEY_CTX *ctx, unsigned char *key, size_t *pkeylen)
+int __cdecl EVP_PKEY_derive(EVP_PKEY_CTX *ctx, unsigned char *key, size_t *pkeylen)
 {
     if (!ctx || !ctx->pmeth || !ctx->pmeth->derive) {
         EVPerr(EVP_F_EVP_PKEY_DERIVE,
diff --git a/crypto/evp/pmeth_gn.c b/crypto/evp/pmeth_gn.c
index e14965f333..0a780ae144 100644
--- a/crypto/evp/pmeth_gn.c
+++ b/crypto/evp/pmeth_gn.c
@@ -16,7 +16,7 @@
 #include "internal/asn1_int.h"
 #include "internal/evp_int.h"
 
-int EVP_PKEY_paramgen_init(EVP_PKEY_CTX *ctx)
+int __cdecl EVP_PKEY_paramgen_init(EVP_PKEY_CTX *ctx)
 {
     int ret;
     if (!ctx || !ctx->pmeth || !ctx->pmeth->paramgen) {
@@ -33,7 +33,7 @@ int EVP_PKEY_paramgen_init(EVP_PKEY_CTX *ctx)
     return ret;
 }
 
-int EVP_PKEY_paramgen(EVP_PKEY_CTX *ctx, EVP_PKEY **ppkey)
+int __cdecl EVP_PKEY_paramgen(EVP_PKEY_CTX *ctx, EVP_PKEY **ppkey)
 {
     int ret;
     if (!ctx || !ctx->pmeth || !ctx->pmeth->paramgen) {
@@ -66,7 +66,7 @@ int EVP_PKEY_paramgen(EVP_PKEY_CTX *ctx, EVP_PKEY **ppkey)
     return ret;
 }
 
-int EVP_PKEY_keygen_init(EVP_PKEY_CTX *ctx)
+int __cdecl EVP_PKEY_keygen_init(EVP_PKEY_CTX *ctx)
 {
     int ret;
     if (!ctx || !ctx->pmeth || !ctx->pmeth->keygen) {
@@ -83,7 +83,7 @@ int EVP_PKEY_keygen_init(EVP_PKEY_CTX *ctx)
     return ret;
 }
 
-int EVP_PKEY_keygen(EVP_PKEY_CTX *ctx, EVP_PKEY **ppkey)
+int __cdecl EVP_PKEY_keygen(EVP_PKEY_CTX *ctx, EVP_PKEY **ppkey)
 {
     int ret;
 
@@ -113,12 +113,12 @@ int EVP_PKEY_keygen(EVP_PKEY_CTX *ctx, EVP_PKEY **ppkey)
     return ret;
 }
 
-void EVP_PKEY_CTX_set_cb(EVP_PKEY_CTX *ctx, EVP_PKEY_gen_cb *cb)
+void __cdecl EVP_PKEY_CTX_set_cb(EVP_PKEY_CTX *ctx, EVP_PKEY_gen_cb *cb)
 {
     ctx->pkey_gencb = cb;
 }
 
-EVP_PKEY_gen_cb *EVP_PKEY_CTX_get_cb(EVP_PKEY_CTX *ctx)
+EVP_PKEY_gen_cb * __cdecl EVP_PKEY_CTX_get_cb(EVP_PKEY_CTX *ctx)
 {
     return ctx->pkey_gencb;
 }
@@ -141,7 +141,7 @@ void evp_pkey_set_cb_translate(BN_GENCB *cb, EVP_PKEY_CTX *ctx)
     BN_GENCB_set(cb, trans_cb, ctx);
 }
 
-int EVP_PKEY_CTX_get_keygen_info(EVP_PKEY_CTX *ctx, int idx)
+int __cdecl EVP_PKEY_CTX_get_keygen_info(EVP_PKEY_CTX *ctx, int idx)
 {
     if (idx == -1)
         return ctx->keygen_info_count;
@@ -150,7 +150,7 @@ int EVP_PKEY_CTX_get_keygen_info(EVP_PKEY_CTX *ctx, int idx)
     return ctx->keygen_info[idx];
 }
 
-EVP_PKEY *EVP_PKEY_new_mac_key(int type, ENGINE *e,
+EVP_PKEY * __cdecl EVP_PKEY_new_mac_key(int type, ENGINE *e,
                                const unsigned char *key, int keylen)
 {
     EVP_PKEY_CTX *mac_ctx = NULL;
@@ -169,7 +169,7 @@ EVP_PKEY *EVP_PKEY_new_mac_key(int type, ENGINE *e,
     return mac_key;
 }
 
-int EVP_PKEY_check(EVP_PKEY_CTX *ctx)
+int __cdecl EVP_PKEY_check(EVP_PKEY_CTX *ctx)
 {
     EVP_PKEY *pkey = ctx->pkey;
 
@@ -192,7 +192,7 @@ int EVP_PKEY_check(EVP_PKEY_CTX *ctx)
     return pkey->ameth->pkey_check(pkey);
 }
 
-int EVP_PKEY_public_check(EVP_PKEY_CTX *ctx)
+int __cdecl EVP_PKEY_public_check(EVP_PKEY_CTX *ctx)
 {
     EVP_PKEY *pkey = ctx->pkey;
 
@@ -215,7 +215,7 @@ int EVP_PKEY_public_check(EVP_PKEY_CTX *ctx)
     return pkey->ameth->pkey_public_check(pkey);
 }
 
-int EVP_PKEY_param_check(EVP_PKEY_CTX *ctx)
+int __cdecl EVP_PKEY_param_check(EVP_PKEY_CTX *ctx)
 {
     EVP_PKEY *pkey = ctx->pkey;
 
diff --git a/crypto/evp/pmeth_lib.c b/crypto/evp/pmeth_lib.c
index 7fbf895e07..019d2045e6 100644
--- a/crypto/evp/pmeth_lib.c
+++ b/crypto/evp/pmeth_lib.c
@@ -17,7 +17,7 @@
 #include "internal/evp_int.h"
 #include "internal/numbers.h"
 
-typedef int sk_cmp_fn_type(const char *const *a, const char *const *b);
+typedef int __cdecl sk_cmp_fn_type(const char *const *a, const char *const *b);
 
 static STACK_OF(EVP_PKEY_METHOD) *app_pkey_methods = NULL;
 
@@ -72,7 +72,7 @@ static const EVP_PKEY_METHOD *standard_methods[] = {
 DECLARE_OBJ_BSEARCH_CMP_FN(const EVP_PKEY_METHOD *, const EVP_PKEY_METHOD *,
                            pmeth);
 
-static int pmeth_cmp(const EVP_PKEY_METHOD *const *a,
+static int __cdecl pmeth_cmp(const EVP_PKEY_METHOD *const *a,
                      const EVP_PKEY_METHOD *const *b)
 {
     return ((*a)->pkey_id - (*b)->pkey_id);
@@ -81,7 +81,7 @@ static int pmeth_cmp(const EVP_PKEY_METHOD *const *a,
 IMPLEMENT_OBJ_BSEARCH_CMP_FN(const EVP_PKEY_METHOD *, const EVP_PKEY_METHOD *,
                              pmeth);
 
-const EVP_PKEY_METHOD *EVP_PKEY_meth_find(int type)
+const EVP_PKEY_METHOD * __cdecl EVP_PKEY_meth_find(int type)
 {
     EVP_PKEY_METHOD tmp;
     const EVP_PKEY_METHOD *t = &tmp, **ret;
@@ -167,7 +167,7 @@ static EVP_PKEY_CTX *int_ctx_new(EVP_PKEY *pkey, ENGINE *e, int id)
     return ret;
 }
 
-EVP_PKEY_METHOD *EVP_PKEY_meth_new(int id, int flags)
+EVP_PKEY_METHOD * __cdecl EVP_PKEY_meth_new(int id, int flags)
 {
     EVP_PKEY_METHOD *pmeth;
 
@@ -182,7 +182,7 @@ EVP_PKEY_METHOD *EVP_PKEY_meth_new(int id, int flags)
     return pmeth;
 }
 
-void EVP_PKEY_meth_get0_info(int *ppkey_id, int *pflags,
+void __cdecl EVP_PKEY_meth_get0_info(int *ppkey_id, int *pflags,
                              const EVP_PKEY_METHOD *meth)
 {
     if (ppkey_id)
@@ -191,7 +191,7 @@ void EVP_PKEY_meth_get0_info(int *ppkey_id, int *pflags,
         *pflags = meth->flags;
 }
 
-void EVP_PKEY_meth_copy(EVP_PKEY_METHOD *dst, const EVP_PKEY_METHOD *src)
+void __cdecl EVP_PKEY_meth_copy(EVP_PKEY_METHOD *dst, const EVP_PKEY_METHOD *src)
 {
 
     dst->init = src->init;
@@ -234,23 +234,23 @@ void EVP_PKEY_meth_copy(EVP_PKEY_METHOD *dst, const EVP_PKEY_METHOD *src)
     dst->check = src->check;
 }
 
-void EVP_PKEY_meth_free(EVP_PKEY_METHOD *pmeth)
+void __cdecl EVP_PKEY_meth_free(EVP_PKEY_METHOD *pmeth)
 {
     if (pmeth && (pmeth->flags & EVP_PKEY_FLAG_DYNAMIC))
         OPENSSL_free(pmeth);
 }
 
-EVP_PKEY_CTX *EVP_PKEY_CTX_new(EVP_PKEY *pkey, ENGINE *e)
+EVP_PKEY_CTX * __cdecl EVP_PKEY_CTX_new(EVP_PKEY *pkey, ENGINE *e)
 {
     return int_ctx_new(pkey, e, -1);
 }
 
-EVP_PKEY_CTX *EVP_PKEY_CTX_new_id(int id, ENGINE *e)
+EVP_PKEY_CTX * __cdecl EVP_PKEY_CTX_new_id(int id, ENGINE *e)
 {
     return int_ctx_new(NULL, e, id);
 }
 
-EVP_PKEY_CTX *EVP_PKEY_CTX_dup(EVP_PKEY_CTX *pctx)
+EVP_PKEY_CTX * __cdecl EVP_PKEY_CTX_dup(EVP_PKEY_CTX *pctx)
 {
     EVP_PKEY_CTX *rctx;
     if (!pctx->pmeth || !pctx->pmeth->copy)
@@ -296,7 +296,7 @@ EVP_PKEY_CTX *EVP_PKEY_CTX_dup(EVP_PKEY_CTX *pctx)
 
 }
 
-int EVP_PKEY_meth_add0(const EVP_PKEY_METHOD *pmeth)
+int __cdecl EVP_PKEY_meth_add0(const EVP_PKEY_METHOD *pmeth)
 {
     if (app_pkey_methods == NULL) {
         app_pkey_methods = sk_EVP_PKEY_METHOD_new(pmeth_cmp);
@@ -319,7 +319,7 @@ void evp_app_cleanup_int(void)
         sk_EVP_PKEY_METHOD_pop_free(app_pkey_methods, EVP_PKEY_meth_free);
 }
 
-int EVP_PKEY_meth_remove(const EVP_PKEY_METHOD *pmeth)
+int __cdecl EVP_PKEY_meth_remove(const EVP_PKEY_METHOD *pmeth)
 {
     const EVP_PKEY_METHOD *ret;
 
@@ -328,7 +328,7 @@ int EVP_PKEY_meth_remove(const EVP_PKEY_METHOD *pmeth)
     return ret == NULL ? 0 : 1;
 }
 
-size_t EVP_PKEY_meth_get_count(void)
+size_t __cdecl EVP_PKEY_meth_get_count(void)
 {
     size_t rv = OSSL_NELEM(standard_methods);
 
@@ -337,7 +337,7 @@ size_t EVP_PKEY_meth_get_count(void)
     return rv;
 }
 
-const EVP_PKEY_METHOD *EVP_PKEY_meth_get0(size_t idx)
+const EVP_PKEY_METHOD * __cdecl EVP_PKEY_meth_get0(size_t idx)
 {
     if (idx < OSSL_NELEM(standard_methods))
         return standard_methods[idx];
@@ -349,7 +349,7 @@ const EVP_PKEY_METHOD *EVP_PKEY_meth_get0(size_t idx)
     return sk_EVP_PKEY_METHOD_value(app_pkey_methods, idx);
 }
 
-void EVP_PKEY_CTX_free(EVP_PKEY_CTX *ctx)
+void __cdecl EVP_PKEY_CTX_free(EVP_PKEY_CTX *ctx)
 {
     if (ctx == NULL)
         return;
@@ -363,7 +363,7 @@ void EVP_PKEY_CTX_free(EVP_PKEY_CTX *ctx)
     OPENSSL_free(ctx);
 }
 
-int EVP_PKEY_CTX_ctrl(EVP_PKEY_CTX *ctx, int keytype, int optype,
+int __cdecl EVP_PKEY_CTX_ctrl(EVP_PKEY_CTX *ctx, int keytype, int optype,
                       int cmd, int p1, void *p2)
 {
     int ret;
@@ -398,13 +398,13 @@ int EVP_PKEY_CTX_ctrl(EVP_PKEY_CTX *ctx, int keytype, int optype,
     return ret;
 }
 
-int EVP_PKEY_CTX_ctrl_uint64(EVP_PKEY_CTX *ctx, int keytype, int optype,
+int __cdecl EVP_PKEY_CTX_ctrl_uint64(EVP_PKEY_CTX *ctx, int keytype, int optype,
                              int cmd, uint64_t value)
 {
     return EVP_PKEY_CTX_ctrl(ctx, keytype, optype, cmd, 0, &value);
 }
 
-int EVP_PKEY_CTX_ctrl_str(EVP_PKEY_CTX *ctx,
+int __cdecl EVP_PKEY_CTX_ctrl_str(EVP_PKEY_CTX *ctx,
                           const char *name, const char *value)
 {
     if (!ctx || !ctx->pmeth || !ctx->pmeth->ctrl_str) {
@@ -419,7 +419,7 @@ int EVP_PKEY_CTX_ctrl_str(EVP_PKEY_CTX *ctx,
 
 /* Utility functions to send a string of hex string to a ctrl */
 
-int EVP_PKEY_CTX_str2ctrl(EVP_PKEY_CTX *ctx, int cmd, const char *str)
+int __cdecl EVP_PKEY_CTX_str2ctrl(EVP_PKEY_CTX *ctx, int cmd, const char *str)
 {
     size_t len;
 
@@ -429,7 +429,7 @@ int EVP_PKEY_CTX_str2ctrl(EVP_PKEY_CTX *ctx, int cmd, const char *str)
     return ctx->pmeth->ctrl(ctx, cmd, len, (void *)str);
 }
 
-int EVP_PKEY_CTX_hex2ctrl(EVP_PKEY_CTX *ctx, int cmd, const char *hex)
+int __cdecl EVP_PKEY_CTX_hex2ctrl(EVP_PKEY_CTX *ctx, int cmd, const char *hex)
 {
     unsigned char *bin;
     long binlen;
@@ -445,7 +445,7 @@ int EVP_PKEY_CTX_hex2ctrl(EVP_PKEY_CTX *ctx, int cmd, const char *hex)
 }
 
 /* Pass a message digest to a ctrl */
-int EVP_PKEY_CTX_md(EVP_PKEY_CTX *ctx, int optype, int cmd, const char *md)
+int __cdecl EVP_PKEY_CTX_md(EVP_PKEY_CTX *ctx, int optype, int cmd, const char *md)
 {
     const EVP_MD *m;
 
@@ -456,67 +456,67 @@ int EVP_PKEY_CTX_md(EVP_PKEY_CTX *ctx, int optype, int cmd, const char *md)
     return EVP_PKEY_CTX_ctrl(ctx, -1, optype, cmd, 0, (void *)m);
 }
 
-int EVP_PKEY_CTX_get_operation(EVP_PKEY_CTX *ctx)
+int __cdecl EVP_PKEY_CTX_get_operation(EVP_PKEY_CTX *ctx)
 {
     return ctx->operation;
 }
 
-void EVP_PKEY_CTX_set0_keygen_info(EVP_PKEY_CTX *ctx, int *dat, int datlen)
+void __cdecl EVP_PKEY_CTX_set0_keygen_info(EVP_PKEY_CTX *ctx, int *dat, int datlen)
 {
     ctx->keygen_info = dat;
     ctx->keygen_info_count = datlen;
 }
 
-void EVP_PKEY_CTX_set_data(EVP_PKEY_CTX *ctx, void *data)
+void __cdecl EVP_PKEY_CTX_set_data(EVP_PKEY_CTX *ctx, void *data)
 {
     ctx->data = data;
 }
 
-void *EVP_PKEY_CTX_get_data(EVP_PKEY_CTX *ctx)
+void * __cdecl EVP_PKEY_CTX_get_data(EVP_PKEY_CTX *ctx)
 {
     return ctx->data;
 }
 
-EVP_PKEY *EVP_PKEY_CTX_get0_pkey(EVP_PKEY_CTX *ctx)
+EVP_PKEY * __cdecl EVP_PKEY_CTX_get0_pkey(EVP_PKEY_CTX *ctx)
 {
     return ctx->pkey;
 }
 
-EVP_PKEY *EVP_PKEY_CTX_get0_peerkey(EVP_PKEY_CTX *ctx)
+EVP_PKEY * __cdecl EVP_PKEY_CTX_get0_peerkey(EVP_PKEY_CTX *ctx)
 {
     return ctx->peerkey;
 }
 
-void EVP_PKEY_CTX_set_app_data(EVP_PKEY_CTX *ctx, void *data)
+void __cdecl EVP_PKEY_CTX_set_app_data(EVP_PKEY_CTX *ctx, void *data)
 {
     ctx->app_data = data;
 }
 
-void *EVP_PKEY_CTX_get_app_data(EVP_PKEY_CTX *ctx)
+void * __cdecl EVP_PKEY_CTX_get_app_data(EVP_PKEY_CTX *ctx)
 {
     return ctx->app_data;
 }
 
-void EVP_PKEY_meth_set_init(EVP_PKEY_METHOD *pmeth,
+void __cdecl EVP_PKEY_meth_set_init(EVP_PKEY_METHOD *pmeth,
                             int (*init) (EVP_PKEY_CTX *ctx))
 {
     pmeth->init = init;
 }
 
-void EVP_PKEY_meth_set_copy(EVP_PKEY_METHOD *pmeth,
+void __cdecl EVP_PKEY_meth_set_copy(EVP_PKEY_METHOD *pmeth,
                             int (*copy) (EVP_PKEY_CTX *dst,
                                          EVP_PKEY_CTX *src))
 {
     pmeth->copy = copy;
 }
 
-void EVP_PKEY_meth_set_cleanup(EVP_PKEY_METHOD *pmeth,
+void __cdecl EVP_PKEY_meth_set_cleanup(EVP_PKEY_METHOD *pmeth,
                                void (*cleanup) (EVP_PKEY_CTX *ctx))
 {
     pmeth->cleanup = cleanup;
 }
 
-void EVP_PKEY_meth_set_paramgen(EVP_PKEY_METHOD *pmeth,
+void __cdecl EVP_PKEY_meth_set_paramgen(EVP_PKEY_METHOD *pmeth,
                                 int (*paramgen_init) (EVP_PKEY_CTX *ctx),
                                 int (*paramgen) (EVP_PKEY_CTX *ctx,
                                                  EVP_PKEY *pkey))
@@ -525,7 +525,7 @@ void EVP_PKEY_meth_set_paramgen(EVP_PKEY_METHOD *pmeth,
     pmeth->paramgen = paramgen;
 }
 
-void EVP_PKEY_meth_set_keygen(EVP_PKEY_METHOD *pmeth,
+void __cdecl EVP_PKEY_meth_set_keygen(EVP_PKEY_METHOD *pmeth,
                               int (*keygen_init) (EVP_PKEY_CTX *ctx),
                               int (*keygen) (EVP_PKEY_CTX *ctx,
                                              EVP_PKEY *pkey))
@@ -534,7 +534,7 @@ void EVP_PKEY_meth_set_keygen(EVP_PKEY_METHOD *pmeth,
     pmeth->keygen = keygen;
 }
 
-void EVP_PKEY_meth_set_sign(EVP_PKEY_METHOD *pmeth,
+void __cdecl EVP_PKEY_meth_set_sign(EVP_PKEY_METHOD *pmeth,
                             int (*sign_init) (EVP_PKEY_CTX *ctx),
                             int (*sign) (EVP_PKEY_CTX *ctx,
                                          unsigned char *sig, size_t *siglen,
@@ -545,7 +545,7 @@ void EVP_PKEY_meth_set_sign(EVP_PKEY_METHOD *pmeth,
     pmeth->sign = sign;
 }
 
-void EVP_PKEY_meth_set_verify(EVP_PKEY_METHOD *pmeth,
+void __cdecl EVP_PKEY_meth_set_verify(EVP_PKEY_METHOD *pmeth,
                               int (*verify_init) (EVP_PKEY_CTX *ctx),
                               int (*verify) (EVP_PKEY_CTX *ctx,
                                              const unsigned char *sig,
@@ -557,7 +557,7 @@ void EVP_PKEY_meth_set_verify(EVP_PKEY_METHOD *pmeth,
     pmeth->verify = verify;
 }
 
-void EVP_PKEY_meth_set_verify_recover(EVP_PKEY_METHOD *pmeth,
+void __cdecl EVP_PKEY_meth_set_verify_recover(EVP_PKEY_METHOD *pmeth,
                                       int (*verify_recover_init) (EVP_PKEY_CTX
                                                                   *ctx),
                                       int (*verify_recover) (EVP_PKEY_CTX
@@ -573,7 +573,7 @@ void EVP_PKEY_meth_set_verify_recover(EVP_PKEY_METHOD *pmeth,
     pmeth->verify_recover = verify_recover;
 }
 
-void EVP_PKEY_meth_set_signctx(EVP_PKEY_METHOD *pmeth,
+void __cdecl EVP_PKEY_meth_set_signctx(EVP_PKEY_METHOD *pmeth,
                                int (*signctx_init) (EVP_PKEY_CTX *ctx,
                                                     EVP_MD_CTX *mctx),
                                int (*signctx) (EVP_PKEY_CTX *ctx,
@@ -585,7 +585,7 @@ void EVP_PKEY_meth_set_signctx(EVP_PKEY_METHOD *pmeth,
     pmeth->signctx = signctx;
 }
 
-void EVP_PKEY_meth_set_verifyctx(EVP_PKEY_METHOD *pmeth,
+void __cdecl EVP_PKEY_meth_set_verifyctx(EVP_PKEY_METHOD *pmeth,
                                  int (*verifyctx_init) (EVP_PKEY_CTX *ctx,
                                                         EVP_MD_CTX *mctx),
                                  int (*verifyctx) (EVP_PKEY_CTX *ctx,
@@ -597,7 +597,7 @@ void EVP_PKEY_meth_set_verifyctx(EVP_PKEY_METHOD *pmeth,
     pmeth->verifyctx = verifyctx;
 }
 
-void EVP_PKEY_meth_set_encrypt(EVP_PKEY_METHOD *pmeth,
+void __cdecl EVP_PKEY_meth_set_encrypt(EVP_PKEY_METHOD *pmeth,
                                int (*encrypt_init) (EVP_PKEY_CTX *ctx),
                                int (*encryptfn) (EVP_PKEY_CTX *ctx,
                                                  unsigned char *out,
@@ -609,7 +609,7 @@ void EVP_PKEY_meth_set_encrypt(EVP_PKEY_METHOD *pmeth,
     pmeth->encrypt = encryptfn;
 }
 
-void EVP_PKEY_meth_set_decrypt(EVP_PKEY_METHOD *pmeth,
+void __cdecl EVP_PKEY_meth_set_decrypt(EVP_PKEY_METHOD *pmeth,
                                int (*decrypt_init) (EVP_PKEY_CTX *ctx),
                                int (*decrypt) (EVP_PKEY_CTX *ctx,
                                                unsigned char *out,
@@ -621,7 +621,7 @@ void EVP_PKEY_meth_set_decrypt(EVP_PKEY_METHOD *pmeth,
     pmeth->decrypt = decrypt;
 }
 
-void EVP_PKEY_meth_set_derive(EVP_PKEY_METHOD *pmeth,
+void __cdecl EVP_PKEY_meth_set_derive(EVP_PKEY_METHOD *pmeth,
                               int (*derive_init) (EVP_PKEY_CTX *ctx),
                               int (*derive) (EVP_PKEY_CTX *ctx,
                                              unsigned char *key,
@@ -631,7 +631,7 @@ void EVP_PKEY_meth_set_derive(EVP_PKEY_METHOD *pmeth,
     pmeth->derive = derive;
 }
 
-void EVP_PKEY_meth_set_ctrl(EVP_PKEY_METHOD *pmeth,
+void __cdecl EVP_PKEY_meth_set_ctrl(EVP_PKEY_METHOD *pmeth,
                             int (*ctrl) (EVP_PKEY_CTX *ctx, int type, int p1,
                                          void *p2),
                             int (*ctrl_str) (EVP_PKEY_CTX *ctx,
@@ -642,51 +642,51 @@ void EVP_PKEY_meth_set_ctrl(EVP_PKEY_METHOD *pmeth,
     pmeth->ctrl_str = ctrl_str;
 }
 
-void EVP_PKEY_meth_set_check(EVP_PKEY_METHOD *pmeth,
+void __cdecl EVP_PKEY_meth_set_check(EVP_PKEY_METHOD *pmeth,
                              int (*check) (EVP_PKEY *pkey))
 {
     pmeth->check = check;
 }
 
-void EVP_PKEY_meth_set_public_check(EVP_PKEY_METHOD *pmeth,
+void __cdecl EVP_PKEY_meth_set_public_check(EVP_PKEY_METHOD *pmeth,
                                     int (*check) (EVP_PKEY *pkey))
 {
     pmeth->public_check = check;
 }
 
-void EVP_PKEY_meth_set_param_check(EVP_PKEY_METHOD *pmeth,
+void __cdecl EVP_PKEY_meth_set_param_check(EVP_PKEY_METHOD *pmeth,
                                    int (*check) (EVP_PKEY *pkey))
 {
     pmeth->param_check = check;
 }
 
-void EVP_PKEY_meth_set_digest_custom(EVP_PKEY_METHOD *pmeth,
+void __cdecl EVP_PKEY_meth_set_digest_custom(EVP_PKEY_METHOD *pmeth,
                                      int (*digest_custom) (EVP_PKEY_CTX *ctx,
                                                            EVP_MD_CTX *mctx))
 {
     pmeth->digest_custom = digest_custom;
 }
 
-void EVP_PKEY_meth_get_init(const EVP_PKEY_METHOD *pmeth,
+void __cdecl EVP_PKEY_meth_get_init(const EVP_PKEY_METHOD *pmeth,
                             int (**pinit) (EVP_PKEY_CTX *ctx))
 {
     *pinit = pmeth->init;
 }
 
-void EVP_PKEY_meth_get_copy(const EVP_PKEY_METHOD *pmeth,
+void __cdecl EVP_PKEY_meth_get_copy(const EVP_PKEY_METHOD *pmeth,
                             int (**pcopy) (EVP_PKEY_CTX *dst,
                                            EVP_PKEY_CTX *src))
 {
     *pcopy = pmeth->copy;
 }
 
-void EVP_PKEY_meth_get_cleanup(const EVP_PKEY_METHOD *pmeth,
+void __cdecl EVP_PKEY_meth_get_cleanup(const EVP_PKEY_METHOD *pmeth,
                                void (**pcleanup) (EVP_PKEY_CTX *ctx))
 {
     *pcleanup = pmeth->cleanup;
 }
 
-void EVP_PKEY_meth_get_paramgen(const EVP_PKEY_METHOD *pmeth,
+void __cdecl EVP_PKEY_meth_get_paramgen(const EVP_PKEY_METHOD *pmeth,
                                 int (**pparamgen_init) (EVP_PKEY_CTX *ctx),
                                 int (**pparamgen) (EVP_PKEY_CTX *ctx,
                                                    EVP_PKEY *pkey))
@@ -697,7 +697,7 @@ void EVP_PKEY_meth_get_paramgen(const EVP_PKEY_METHOD *pmeth,
         *pparamgen = pmeth->paramgen;
 }
 
-void EVP_PKEY_meth_get_keygen(const EVP_PKEY_METHOD *pmeth,
+void __cdecl EVP_PKEY_meth_get_keygen(const EVP_PKEY_METHOD *pmeth,
                               int (**pkeygen_init) (EVP_PKEY_CTX *ctx),
                               int (**pkeygen) (EVP_PKEY_CTX *ctx,
                                                EVP_PKEY *pkey))
@@ -708,7 +708,7 @@ void EVP_PKEY_meth_get_keygen(const EVP_PKEY_METHOD *pmeth,
         *pkeygen = pmeth->keygen;
 }
 
-void EVP_PKEY_meth_get_sign(const EVP_PKEY_METHOD *pmeth,
+void __cdecl EVP_PKEY_meth_get_sign(const EVP_PKEY_METHOD *pmeth,
                             int (**psign_init) (EVP_PKEY_CTX *ctx),
                             int (**psign) (EVP_PKEY_CTX *ctx,
                                            unsigned char *sig, size_t *siglen,
@@ -721,7 +721,7 @@ void EVP_PKEY_meth_get_sign(const EVP_PKEY_METHOD *pmeth,
         *psign = pmeth->sign;
 }
 
-void EVP_PKEY_meth_get_verify(const EVP_PKEY_METHOD *pmeth,
+void __cdecl EVP_PKEY_meth_get_verify(const EVP_PKEY_METHOD *pmeth,
                               int (**pverify_init) (EVP_PKEY_CTX *ctx),
                               int (**pverify) (EVP_PKEY_CTX *ctx,
                                                const unsigned char *sig,
@@ -735,7 +735,7 @@ void EVP_PKEY_meth_get_verify(const EVP_PKEY_METHOD *pmeth,
         *pverify = pmeth->verify;
 }
 
-void EVP_PKEY_meth_get_verify_recover(const EVP_PKEY_METHOD *pmeth,
+void __cdecl EVP_PKEY_meth_get_verify_recover(const EVP_PKEY_METHOD *pmeth,
                                       int (**pverify_recover_init) (EVP_PKEY_CTX
                                                                     *ctx),
                                       int (**pverify_recover) (EVP_PKEY_CTX
@@ -753,7 +753,7 @@ void EVP_PKEY_meth_get_verify_recover(const EVP_PKEY_METHOD *pmeth,
         *pverify_recover = pmeth->verify_recover;
 }
 
-void EVP_PKEY_meth_get_signctx(const EVP_PKEY_METHOD *pmeth,
+void __cdecl EVP_PKEY_meth_get_signctx(const EVP_PKEY_METHOD *pmeth,
                                int (**psignctx_init) (EVP_PKEY_CTX *ctx,
                                                       EVP_MD_CTX *mctx),
                                int (**psignctx) (EVP_PKEY_CTX *ctx,
@@ -767,7 +767,7 @@ void EVP_PKEY_meth_get_signctx(const EVP_PKEY_METHOD *pmeth,
         *psignctx = pmeth->signctx;
 }
 
-void EVP_PKEY_meth_get_verifyctx(const EVP_PKEY_METHOD *pmeth,
+void __cdecl EVP_PKEY_meth_get_verifyctx(const EVP_PKEY_METHOD *pmeth,
                                  int (**pverifyctx_init) (EVP_PKEY_CTX *ctx,
                                                           EVP_MD_CTX *mctx),
                                  int (**pverifyctx) (EVP_PKEY_CTX *ctx,
@@ -781,7 +781,7 @@ void EVP_PKEY_meth_get_verifyctx(const EVP_PKEY_METHOD *pmeth,
         *pverifyctx = pmeth->verifyctx;
 }
 
-void EVP_PKEY_meth_get_encrypt(const EVP_PKEY_METHOD *pmeth,
+void __cdecl EVP_PKEY_meth_get_encrypt(const EVP_PKEY_METHOD *pmeth,
                                int (**pencrypt_init) (EVP_PKEY_CTX *ctx),
                                int (**pencryptfn) (EVP_PKEY_CTX *ctx,
                                                    unsigned char *out,
@@ -795,7 +795,7 @@ void EVP_PKEY_meth_get_encrypt(const EVP_PKEY_METHOD *pmeth,
         *pencryptfn = pmeth->encrypt;
 }
 
-void EVP_PKEY_meth_get_decrypt(const EVP_PKEY_METHOD *pmeth,
+void __cdecl EVP_PKEY_meth_get_decrypt(const EVP_PKEY_METHOD *pmeth,
                                int (**pdecrypt_init) (EVP_PKEY_CTX *ctx),
                                int (**pdecrypt) (EVP_PKEY_CTX *ctx,
                                                  unsigned char *out,
@@ -809,7 +809,7 @@ void EVP_PKEY_meth_get_decrypt(const EVP_PKEY_METHOD *pmeth,
         *pdecrypt = pmeth->decrypt;
 }
 
-void EVP_PKEY_meth_get_derive(const EVP_PKEY_METHOD *pmeth,
+void __cdecl EVP_PKEY_meth_get_derive(const EVP_PKEY_METHOD *pmeth,
                               int (**pderive_init) (EVP_PKEY_CTX *ctx),
                               int (**pderive) (EVP_PKEY_CTX *ctx,
                                                unsigned char *key,
@@ -821,7 +821,7 @@ void EVP_PKEY_meth_get_derive(const EVP_PKEY_METHOD *pmeth,
         *pderive = pmeth->derive;
 }
 
-void EVP_PKEY_meth_get_ctrl(const EVP_PKEY_METHOD *pmeth,
+void __cdecl EVP_PKEY_meth_get_ctrl(const EVP_PKEY_METHOD *pmeth,
                             int (**pctrl) (EVP_PKEY_CTX *ctx, int type, int p1,
                                            void *p2),
                             int (**pctrl_str) (EVP_PKEY_CTX *ctx,
@@ -834,28 +834,28 @@ void EVP_PKEY_meth_get_ctrl(const EVP_PKEY_METHOD *pmeth,
         *pctrl_str = pmeth->ctrl_str;
 }
 
-void EVP_PKEY_meth_get_check(const EVP_PKEY_METHOD *pmeth,
+void __cdecl EVP_PKEY_meth_get_check(const EVP_PKEY_METHOD *pmeth,
                              int (**pcheck) (EVP_PKEY *pkey))
 {
     if (pcheck != NULL)
         *pcheck = pmeth->check;
 }
 
-void EVP_PKEY_meth_get_public_check(const EVP_PKEY_METHOD *pmeth,
+void __cdecl EVP_PKEY_meth_get_public_check(const EVP_PKEY_METHOD *pmeth,
                                     int (**pcheck) (EVP_PKEY *pkey))
 {
     if (pcheck != NULL)
         *pcheck = pmeth->public_check;
 }
 
-void EVP_PKEY_meth_get_param_check(const EVP_PKEY_METHOD *pmeth,
+void __cdecl EVP_PKEY_meth_get_param_check(const EVP_PKEY_METHOD *pmeth,
                                    int (**pcheck) (EVP_PKEY *pkey))
 {
     if (pcheck != NULL)
         *pcheck = pmeth->param_check;
 }
 
-void EVP_PKEY_meth_get_digest_custom(EVP_PKEY_METHOD *pmeth,
+void __cdecl EVP_PKEY_meth_get_digest_custom(EVP_PKEY_METHOD *pmeth,
                                      int (**pdigest_custom) (EVP_PKEY_CTX *ctx,
                                                              EVP_MD_CTX *mctx))
 {
diff --git a/crypto/ex_data.c b/crypto/ex_data.c
index 08dc7c4073..db440eeb06 100644
--- a/crypto/ex_data.c
+++ b/crypto/ex_data.c
@@ -79,7 +79,7 @@ static EX_CALLBACKS *get_and_lock(int class_index)
     return ip;
 }
 
-static void cleanup_cb(EX_CALLBACK *funcs)
+static void __cdecl cleanup_cb(EX_CALLBACK *funcs)
 {
     OPENSSL_free(funcs);
 }
@@ -127,7 +127,7 @@ static int dummy_dup(CRYPTO_EX_DATA *to, const CRYPTO_EX_DATA *from,
     return 1;
 }
 
-int CRYPTO_free_ex_index(int class_index, int idx)
+int __cdecl CRYPTO_free_ex_index(int class_index, int idx)
 {
     EX_CALLBACKS *ip = get_and_lock(class_index);
     EX_CALLBACK *a;
@@ -152,7 +152,7 @@ err:
 /*
  * Register a new index.
  */
-int CRYPTO_get_ex_new_index(int class_index, long argl, void *argp,
+int __cdecl CRYPTO_get_ex_new_index(int class_index, long argl, void *argp,
                             CRYPTO_EX_new *new_func, CRYPTO_EX_dup *dup_func,
                             CRYPTO_EX_free *free_func)
 {
@@ -205,7 +205,7 @@ int CRYPTO_get_ex_new_index(int class_index, long argl, void *argp,
  * in the lock, then using them outside the lock. Note this only applies
  * to the global "ex_data" state (ie. class definitions), not 'ad' itself.
  */
-int CRYPTO_new_ex_data(int class_index, void *obj, CRYPTO_EX_DATA *ad)
+int __cdecl CRYPTO_new_ex_data(int class_index, void *obj, CRYPTO_EX_DATA *ad)
 {
     int mx, i;
     void *ptr;
@@ -250,7 +250,7 @@ int CRYPTO_new_ex_data(int class_index, void *obj, CRYPTO_EX_DATA *ad)
  * Duplicate a CRYPTO_EX_DATA variable - including calling dup() callbacks
  * for each index in the class used by this variable
  */
-int CRYPTO_dup_ex_data(int class_index, CRYPTO_EX_DATA *to,
+int __cdecl CRYPTO_dup_ex_data(int class_index, CRYPTO_EX_DATA *to,
                        const CRYPTO_EX_DATA *from)
 {
     int mx, j, i;
@@ -317,7 +317,7 @@ int CRYPTO_dup_ex_data(int class_index, CRYPTO_EX_DATA *to,
  * Cleanup a CRYPTO_EX_DATA variable - including calling free() callbacks for
  * each index in the class used by this variable
  */
-void CRYPTO_free_ex_data(int class_index, void *obj, CRYPTO_EX_DATA *ad)
+void __cdecl CRYPTO_free_ex_data(int class_index, void *obj, CRYPTO_EX_DATA *ad)
 {
     int mx, i;
     EX_CALLBACKS *ip;
@@ -366,7 +366,7 @@ void CRYPTO_free_ex_data(int class_index, void *obj, CRYPTO_EX_DATA *ad)
  * For a given CRYPTO_EX_DATA variable, set the value corresponding to a
  * particular index in the class used by this variable
  */
-int CRYPTO_set_ex_data(CRYPTO_EX_DATA *ad, int idx, void *val)
+int __cdecl CRYPTO_set_ex_data(CRYPTO_EX_DATA *ad, int idx, void *val)
 {
     int i;
 
@@ -391,7 +391,7 @@ int CRYPTO_set_ex_data(CRYPTO_EX_DATA *ad, int idx, void *val)
  * For a given CRYPTO_EX_DATA_ variable, get the value corresponding to a
  * particular index in the class used by this variable
  */
-void *CRYPTO_get_ex_data(const CRYPTO_EX_DATA *ad, int idx)
+void * __cdecl CRYPTO_get_ex_data(const CRYPTO_EX_DATA *ad, int idx)
 {
     if (ad->sk == NULL || idx >= sk_void_num(ad->sk))
         return NULL;
diff --git a/crypto/hmac/hmac.c b/crypto/hmac/hmac.c
index 0c0a7133fb..1ad3c7602b 100644
--- a/crypto/hmac/hmac.c
+++ b/crypto/hmac/hmac.c
@@ -15,7 +15,7 @@
 #include <openssl/opensslconf.h>
 #include "hmac_lcl.h"
 
-int HMAC_Init_ex(HMAC_CTX *ctx, const void *key, int len,
+int __cdecl HMAC_Init_ex(HMAC_CTX *ctx, const void *key, int len,
                  const EVP_MD *md, ENGINE *impl)
 {
     int rv = 0;
@@ -95,14 +95,14 @@ int HMAC_Init(HMAC_CTX *ctx, const void *key, int len, const EVP_MD *md)
 }
 #endif
 
-int HMAC_Update(HMAC_CTX *ctx, const unsigned char *data, size_t len)
+int __cdecl HMAC_Update(HMAC_CTX *ctx, const unsigned char *data, size_t len)
 {
     if (!ctx->md)
         return 0;
     return EVP_DigestUpdate(ctx->md_ctx, data, len);
 }
 
-int HMAC_Final(HMAC_CTX *ctx, unsigned char *md, unsigned int *len)
+int __cdecl HMAC_Final(HMAC_CTX *ctx, unsigned char *md, unsigned int *len)
 {
     unsigned int i;
     unsigned char buf[EVP_MAX_MD_SIZE];
@@ -123,14 +123,14 @@ int HMAC_Final(HMAC_CTX *ctx, unsigned char *md, unsigned int *len)
     return 0;
 }
 
-size_t HMAC_size(const HMAC_CTX *ctx)
+size_t __cdecl HMAC_size(const HMAC_CTX *ctx)
 {
     int size = EVP_MD_size((ctx)->md);
 
     return (size < 0) ? 0 : size;
 }
 
-HMAC_CTX *HMAC_CTX_new(void)
+HMAC_CTX * __cdecl HMAC_CTX_new(void)
 {
     HMAC_CTX *ctx = OPENSSL_zalloc(sizeof(HMAC_CTX));
 
@@ -153,7 +153,7 @@ static void hmac_ctx_cleanup(HMAC_CTX *ctx)
     OPENSSL_cleanse(ctx->key, sizeof(ctx->key));
 }
 
-void HMAC_CTX_free(HMAC_CTX *ctx)
+void __cdecl HMAC_CTX_free(HMAC_CTX *ctx)
 {
     if (ctx != NULL) {
         hmac_ctx_cleanup(ctx);
@@ -181,7 +181,7 @@ static int hmac_ctx_alloc_mds(HMAC_CTX *ctx)
     return 1;
 }
 
-int HMAC_CTX_reset(HMAC_CTX *ctx)
+int __cdecl HMAC_CTX_reset(HMAC_CTX *ctx)
 {
     hmac_ctx_cleanup(ctx);
     if (!hmac_ctx_alloc_mds(ctx)) {
@@ -191,7 +191,7 @@ int HMAC_CTX_reset(HMAC_CTX *ctx)
     return 1;
 }
 
-int HMAC_CTX_copy(HMAC_CTX *dctx, HMAC_CTX *sctx)
+int __cdecl HMAC_CTX_copy(HMAC_CTX *dctx, HMAC_CTX *sctx)
 {
     if (!hmac_ctx_alloc_mds(dctx))
         goto err;
@@ -210,7 +210,7 @@ int HMAC_CTX_copy(HMAC_CTX *dctx, HMAC_CTX *sctx)
     return 0;
 }
 
-unsigned char *HMAC(const EVP_MD *evp_md, const void *key, int key_len,
+unsigned char * __cdecl HMAC(const EVP_MD *evp_md, const void *key, int key_len,
                     const unsigned char *d, size_t n, unsigned char *md,
                     unsigned int *md_len)
 {
@@ -241,14 +241,14 @@ unsigned char *HMAC(const EVP_MD *evp_md, const void *key, int key_len,
     return NULL;
 }
 
-void HMAC_CTX_set_flags(HMAC_CTX *ctx, unsigned long flags)
+void __cdecl HMAC_CTX_set_flags(HMAC_CTX *ctx, unsigned long flags)
 {
     EVP_MD_CTX_set_flags(ctx->i_ctx, flags);
     EVP_MD_CTX_set_flags(ctx->o_ctx, flags);
     EVP_MD_CTX_set_flags(ctx->md_ctx, flags);
 }
 
-const EVP_MD *HMAC_CTX_get_md(const HMAC_CTX *ctx)
+const EVP_MD * __cdecl HMAC_CTX_get_md(const HMAC_CTX *ctx)
 {
     return ctx->md;
 }
diff --git a/crypto/idea/i_cbc.c b/crypto/idea/i_cbc.c
index a70a8682a7..151597a3d5 100644
--- a/crypto/idea/i_cbc.c
+++ b/crypto/idea/i_cbc.c
@@ -10,7 +10,7 @@
 #include <openssl/idea.h>
 #include "idea_lcl.h"
 
-void IDEA_cbc_encrypt(const unsigned char *in, unsigned char *out,
+void __cdecl IDEA_cbc_encrypt(const unsigned char *in, unsigned char *out,
                       long length, IDEA_KEY_SCHEDULE *ks, unsigned char *iv,
                       int encrypt)
 {
@@ -86,7 +86,7 @@ void IDEA_cbc_encrypt(const unsigned char *in, unsigned char *out,
     tin[0] = tin[1] = 0;
 }
 
-void IDEA_encrypt(unsigned long *d, IDEA_KEY_SCHEDULE *key)
+void __cdecl IDEA_encrypt(unsigned long *d, IDEA_KEY_SCHEDULE *key)
 {
     register IDEA_INT *p;
     register unsigned long x1, x2, x3, x4, t0, t1, ul;
diff --git a/crypto/idea/i_cfb64.c b/crypto/idea/i_cfb64.c
index daf467eb5c..676510e6a2 100644
--- a/crypto/idea/i_cfb64.c
+++ b/crypto/idea/i_cfb64.c
@@ -16,7 +16,7 @@
  * used is contained in *num;
  */
 
-void IDEA_cfb64_encrypt(const unsigned char *in, unsigned char *out,
+void __cdecl IDEA_cfb64_encrypt(const unsigned char *in, unsigned char *out,
                         long length, IDEA_KEY_SCHEDULE *schedule,
                         unsigned char *ivec, int *num, int encrypt)
 {
diff --git a/crypto/idea/i_ecb.c b/crypto/idea/i_ecb.c
index 058d0c14c0..da98c3976b 100644
--- a/crypto/idea/i_ecb.c
+++ b/crypto/idea/i_ecb.c
@@ -11,12 +11,12 @@
 #include "idea_lcl.h"
 #include <openssl/opensslv.h>
 
-const char *IDEA_options(void)
+const char * __cdecl IDEA_options(void)
 {
     return "idea(int)";
 }
 
-void IDEA_ecb_encrypt(const unsigned char *in, unsigned char *out,
+void __cdecl IDEA_ecb_encrypt(const unsigned char *in, unsigned char *out,
                       IDEA_KEY_SCHEDULE *ks)
 {
     unsigned long l0, l1, d[2];
diff --git a/crypto/idea/i_ofb64.c b/crypto/idea/i_ofb64.c
index 997a7b88ed..6e72c6232c 100644
--- a/crypto/idea/i_ofb64.c
+++ b/crypto/idea/i_ofb64.c
@@ -15,7 +15,7 @@
  * The extra state information to record how much of the 64bit block we have
  * used is contained in *num;
  */
-void IDEA_ofb64_encrypt(const unsigned char *in, unsigned char *out,
+void __cdecl IDEA_ofb64_encrypt(const unsigned char *in, unsigned char *out,
                         long length, IDEA_KEY_SCHEDULE *schedule,
                         unsigned char *ivec, int *num)
 {
diff --git a/crypto/idea/i_skey.c b/crypto/idea/i_skey.c
index 9d9145580f..25f98c82e5 100644
--- a/crypto/idea/i_skey.c
+++ b/crypto/idea/i_skey.c
@@ -11,7 +11,7 @@
 #include "idea_lcl.h"
 
 static IDEA_INT inverse(unsigned int xin);
-void IDEA_set_encrypt_key(const unsigned char *key, IDEA_KEY_SCHEDULE *ks)
+void __cdecl IDEA_set_encrypt_key(const unsigned char *key, IDEA_KEY_SCHEDULE *ks)
 {
     int i;
     register IDEA_INT *kt, *kf, r0, r1, r2;
@@ -51,7 +51,7 @@ void IDEA_set_encrypt_key(const unsigned char *key, IDEA_KEY_SCHEDULE *ks)
     }
 }
 
-void IDEA_set_decrypt_key(IDEA_KEY_SCHEDULE *ek, IDEA_KEY_SCHEDULE *dk)
+void __cdecl IDEA_set_decrypt_key(IDEA_KEY_SCHEDULE *ek, IDEA_KEY_SCHEDULE *dk)
 {
     int r;
     register IDEA_INT *fp, *tp, t;
diff --git a/crypto/include/internal/err_int.h b/crypto/include/internal/err_int.h
index 44ac944627..574d2e780f 100644
--- a/crypto/include/internal/err_int.h
+++ b/crypto/include/internal/err_int.h
@@ -10,7 +10,7 @@
 #ifndef INTERNAL_ERR_INT_H
 # define INTERNAL_ERR_INT_H
 
-int err_load_crypto_strings_int(void);
+int __cdecl err_load_crypto_strings_int(void);
 void err_cleanup(void);
 void err_delete_thread_state(void);
 int err_shelve_state(void **);
diff --git a/crypto/include/internal/evp_int.h b/crypto/include/internal/evp_int.h
index d86aed36f0..bce3e21171 100644
--- a/crypto/include/internal/evp_int.h
+++ b/crypto/include/internal/evp_int.h
@@ -147,9 +147,9 @@ struct evp_cipher_st {
     /* how big ctx->cipher_data needs to be */
     int ctx_size;
     /* Populate a ASN1_TYPE with parameters */
-    int (*set_asn1_parameters) (EVP_CIPHER_CTX *, ASN1_TYPE *);
+    int (__cdecl *set_asn1_parameters) (EVP_CIPHER_CTX *, ASN1_TYPE *);
     /* Get parameters from a ASN1_TYPE */
-    int (*get_asn1_parameters) (EVP_CIPHER_CTX *, ASN1_TYPE *);
+    int (__cdecl *get_asn1_parameters) (EVP_CIPHER_CTX *, ASN1_TYPE *);
     /* Miscellaneous operations */
     int (*ctrl) (EVP_CIPHER_CTX *, int type, int arg, void *ptr);
     /* Application data */
@@ -258,7 +258,7 @@ static const EVP_CIPHER cname##_##mode = { \
         ctrl, \
         NULL \
 }; \
-const EVP_CIPHER *EVP_##cname##_##mode(void) { return &cname##_##mode; }
+const EVP_CIPHER * __cdecl EVP_##cname##_##mode(void) { return &cname##_##mode; }
 
 #define BLOCK_CIPHER_def_cbc(cname, kstruct, nid, block_size, key_len, \
                              iv_len, flags, init_key, cleanup, set_asn1, \
diff --git a/crypto/include/internal/md32_common.h b/crypto/include/internal/md32_common.h
index 1124e9c24b..5f54c7a6b8 100644
--- a/crypto/include/internal/md32_common.h
+++ b/crypto/include/internal/md32_common.h
@@ -125,7 +125,7 @@
  * Time for some action :-)
  */
 
-int HASH_UPDATE(HASH_CTX *c, const void *data_, size_t len)
+int __cdecl HASH_UPDATE(HASH_CTX *c, const void *data_, size_t len)
 {
     const unsigned char *data = data_;
     unsigned char *p;
@@ -183,12 +183,12 @@ int HASH_UPDATE(HASH_CTX *c, const void *data_, size_t len)
     return 1;
 }
 
-void HASH_TRANSFORM(HASH_CTX *c, const unsigned char *data)
+void __cdecl HASH_TRANSFORM(HASH_CTX *c, const unsigned char *data)
 {
     HASH_BLOCK_DATA_ORDER(c, data, 1);
 }
 
-int HASH_FINAL(unsigned char *md, HASH_CTX *c)
+int __cdecl HASH_FINAL(unsigned char *md, HASH_CTX *c)
 {
     unsigned char *p = (unsigned char *)c->data;
     size_t n = c->num;
diff --git a/crypto/include/internal/sm3.h b/crypto/include/internal/sm3.h
index 27eb471c28..f9fda6966d 100644
--- a/crypto/include/internal/sm3.h
+++ b/crypto/include/internal/sm3.h
@@ -30,9 +30,9 @@ typedef struct SM3state_st {
    unsigned int num;
 } SM3_CTX;
 
-int sm3_init(SM3_CTX *c);
-int sm3_update(SM3_CTX *c, const void *data, size_t len);
-int sm3_final(unsigned char *md, SM3_CTX *c);
+int __cdecl sm3_init(SM3_CTX *c);
+int __cdecl sm3_update(SM3_CTX *c, const void *data, size_t len);
+int __cdecl sm3_final(unsigned char *md, SM3_CTX *c);
 
 void sm3_block_data_order(SM3_CTX *c, const void *p, size_t num);
 
diff --git a/crypto/init.c b/crypto/init.c
index 9fc0e8ef68..c87de50e62 100644
--- a/crypto/init.c
+++ b/crypto/init.c
@@ -119,7 +119,7 @@ err:
 
 static CRYPTO_ONCE register_atexit = CRYPTO_ONCE_STATIC_INIT;
 #if !defined(OPENSSL_SYS_UEFI) && defined(_WIN32)
-static int win32atexit(void)
+static int __cdecl win32atexit(void)
 {
     OPENSSL_cleanup();
     return 0;
@@ -449,7 +449,7 @@ static void ossl_init_thread_stop(struct thread_local_inits_st *locals)
     OPENSSL_free(locals);
 }
 
-void OPENSSL_thread_stop(void)
+void __cdecl OPENSSL_thread_stop(void)
 {
     if (destructor_key.sane != -1)
         ossl_init_thread_stop(ossl_init_get_thread_local(0));
@@ -494,7 +494,7 @@ int ossl_init_thread_start(uint64_t opts)
     return 1;
 }
 
-void OPENSSL_cleanup(void)
+void __cdecl OPENSSL_cleanup(void)
 {
     OPENSSL_INIT_STOP *currhandler, *lasthandler;
     CRYPTO_THREAD_LOCAL key;
@@ -617,7 +617,7 @@ void OPENSSL_cleanup(void)
  * called prior to any threads making calls to any OpenSSL functions,
  * i.e. passing a non-null settings value is assumed to be single-threaded.
  */
-int OPENSSL_init_crypto(uint64_t opts, const OPENSSL_INIT_SETTINGS *settings)
+int __cdecl OPENSSL_init_crypto(uint64_t opts, const OPENSSL_INIT_SETTINGS *settings)
 {
     if (stopped) {
         if (!(opts & OPENSSL_INIT_BASE_ONLY))
@@ -759,7 +759,7 @@ int OPENSSL_init_crypto(uint64_t opts, const OPENSSL_INIT_SETTINGS *settings)
     return 1;
 }
 
-int OPENSSL_atexit(void (*handler)(void))
+int __cdecl OPENSSL_atexit(void (*handler)(void))
 {
     OPENSSL_INIT_STOP *newhand;
 
@@ -837,15 +837,15 @@ int OPENSSL_atexit(void (*handler)(void))
  *      http://man7.org/linux/man-pages/man7/signal-safety.7.html
  */
 
-void OPENSSL_fork_prepare(void)
+void __cdecl OPENSSL_fork_prepare(void)
 {
 }
 
-void OPENSSL_fork_parent(void)
+void __cdecl OPENSSL_fork_parent(void)
 {
 }
 
-void OPENSSL_fork_child(void)
+void __cdecl OPENSSL_fork_child(void)
 {
 }
 #endif
diff --git a/crypto/kdf/kdf_err.c b/crypto/kdf/kdf_err.c
index 1627c0a394..a999d0f2db 100644
--- a/crypto/kdf/kdf_err.c
+++ b/crypto/kdf/kdf_err.c
@@ -55,7 +55,7 @@ static const ERR_STRING_DATA KDF_str_reasons[] = {
 
 #endif
 
-int ERR_load_KDF_strings(void)
+int __cdecl ERR_load_KDF_strings(void)
 {
 #ifndef OPENSSL_NO_ERR
     if (ERR_func_error_string(KDF_str_functs[0].error) == NULL) {
diff --git a/crypto/lhash/lh_stats.c b/crypto/lhash/lh_stats.c
index 65b91e1ef4..7381cae119 100644
--- a/crypto/lhash/lh_stats.c
+++ b/crypto/lhash/lh_stats.c
@@ -21,7 +21,7 @@
 #include "lhash_lcl.h"
 
 # ifndef OPENSSL_NO_STDIO
-void OPENSSL_LH_stats(const OPENSSL_LHASH *lh, FILE *fp)
+void __cdecl OPENSSL_LH_stats(const OPENSSL_LHASH *lh, FILE *fp)
 {
     BIO *bp;
 
@@ -33,7 +33,7 @@ void OPENSSL_LH_stats(const OPENSSL_LHASH *lh, FILE *fp)
     BIO_free(bp);
 }
 
-void OPENSSL_LH_node_stats(const OPENSSL_LHASH *lh, FILE *fp)
+void __cdecl OPENSSL_LH_node_stats(const OPENSSL_LHASH *lh, FILE *fp)
 {
     BIO *bp;
 
@@ -45,7 +45,7 @@ void OPENSSL_LH_node_stats(const OPENSSL_LHASH *lh, FILE *fp)
     BIO_free(bp);
 }
 
-void OPENSSL_LH_node_usage_stats(const OPENSSL_LHASH *lh, FILE *fp)
+void __cdecl OPENSSL_LH_node_usage_stats(const OPENSSL_LHASH *lh, FILE *fp)
 {
     BIO *bp;
 
@@ -59,7 +59,7 @@ void OPENSSL_LH_node_usage_stats(const OPENSSL_LHASH *lh, FILE *fp)
 
 # endif
 
-void OPENSSL_LH_stats_bio(const OPENSSL_LHASH *lh, BIO *out)
+void __cdecl OPENSSL_LH_stats_bio(const OPENSSL_LHASH *lh, BIO *out)
 {
     BIO_printf(out, "num_items             = %lu\n", lh->num_items);
     BIO_printf(out, "num_nodes             = %u\n",  lh->num_nodes);
@@ -79,7 +79,7 @@ void OPENSSL_LH_stats_bio(const OPENSSL_LHASH *lh, BIO *out)
     BIO_printf(out, "num_hash_comps        = %lu\n", lh->num_hash_comps);
 }
 
-void OPENSSL_LH_node_stats_bio(const OPENSSL_LHASH *lh, BIO *out)
+void __cdecl OPENSSL_LH_node_stats_bio(const OPENSSL_LHASH *lh, BIO *out)
 {
     OPENSSL_LH_NODE *n;
     unsigned int i, num;
@@ -91,7 +91,7 @@ void OPENSSL_LH_node_stats_bio(const OPENSSL_LHASH *lh, BIO *out)
     }
 }
 
-void OPENSSL_LH_node_usage_stats_bio(const OPENSSL_LHASH *lh, BIO *out)
+void __cdecl OPENSSL_LH_node_usage_stats_bio(const OPENSSL_LHASH *lh, BIO *out)
 {
     OPENSSL_LH_NODE *n;
     unsigned long num;
diff --git a/crypto/lhash/lhash.c b/crypto/lhash/lhash.c
index 485d4c3fff..fa3d7ae252 100644
--- a/crypto/lhash/lhash.c
+++ b/crypto/lhash/lhash.c
@@ -44,7 +44,7 @@ static int expand(OPENSSL_LHASH *lh);
 static void contract(OPENSSL_LHASH *lh);
 static OPENSSL_LH_NODE **getrn(OPENSSL_LHASH *lh, const void *data, unsigned long *rhash);
 
-OPENSSL_LHASH *OPENSSL_LH_new(OPENSSL_LH_HASHFUNC h, OPENSSL_LH_COMPFUNC c)
+OPENSSL_LHASH * __cdecl OPENSSL_LH_new(OPENSSL_LH_HASHFUNC h, OPENSSL_LH_COMPFUNC c)
 {
     OPENSSL_LHASH *ret;
 
@@ -73,7 +73,7 @@ err:
     return NULL;
 }
 
-void OPENSSL_LH_free(OPENSSL_LHASH *lh)
+void __cdecl OPENSSL_LH_free(OPENSSL_LHASH *lh)
 {
     unsigned int i;
     OPENSSL_LH_NODE *n, *nn;
@@ -93,7 +93,7 @@ void OPENSSL_LH_free(OPENSSL_LHASH *lh)
     OPENSSL_free(lh);
 }
 
-void *OPENSSL_LH_insert(OPENSSL_LHASH *lh, void *data)
+void * __cdecl OPENSSL_LH_insert(OPENSSL_LHASH *lh, void *data)
 {
     unsigned long hash;
     OPENSSL_LH_NODE *nn, **rn;
@@ -125,7 +125,7 @@ void *OPENSSL_LH_insert(OPENSSL_LHASH *lh, void *data)
     return ret;
 }
 
-void *OPENSSL_LH_delete(OPENSSL_LHASH *lh, const void *data)
+void * __cdecl OPENSSL_LH_delete(OPENSSL_LHASH *lh, const void *data)
 {
     unsigned long hash;
     OPENSSL_LH_NODE *nn, **rn;
@@ -153,7 +153,7 @@ void *OPENSSL_LH_delete(OPENSSL_LHASH *lh, const void *data)
     return ret;
 }
 
-void *OPENSSL_LH_retrieve(OPENSSL_LHASH *lh, const void *data)
+void * __cdecl OPENSSL_LH_retrieve(OPENSSL_LHASH *lh, const void *data)
 {
     unsigned long hash;
     OPENSSL_LH_NODE **rn;
@@ -201,12 +201,12 @@ static void doall_util_fn(OPENSSL_LHASH *lh, int use_arg,
     }
 }
 
-void OPENSSL_LH_doall(OPENSSL_LHASH *lh, OPENSSL_LH_DOALL_FUNC func)
+void __cdecl OPENSSL_LH_doall(OPENSSL_LHASH *lh, OPENSSL_LH_DOALL_FUNC func)
 {
     doall_util_fn(lh, 0, func, (OPENSSL_LH_DOALL_FUNCARG)0, NULL);
 }
 
-void OPENSSL_LH_doall_arg(OPENSSL_LHASH *lh, OPENSSL_LH_DOALL_FUNCARG func, void *arg)
+void __cdecl OPENSSL_LH_doall_arg(OPENSSL_LHASH *lh, OPENSSL_LH_DOALL_FUNCARG func, void *arg)
 {
     doall_util_fn(lh, 1, (OPENSSL_LH_DOALL_FUNC)0, func, arg);
 }
@@ -328,7 +328,7 @@ static OPENSSL_LH_NODE **getrn(OPENSSL_LHASH *lh,
  * collisions on /usr/dict/words and it distributes on %2^n quite well, not
  * as good as MD5, but still good.
  */
-unsigned long OPENSSL_LH_strhash(const char *c)
+unsigned long __cdecl OPENSSL_LH_strhash(const char *c)
 {
     unsigned long ret = 0;
     long n;
@@ -372,22 +372,22 @@ unsigned long openssl_lh_strcasehash(const char *c)
     return (ret >> 16) ^ ret;
 }
 
-unsigned long OPENSSL_LH_num_items(const OPENSSL_LHASH *lh)
+unsigned long __cdecl OPENSSL_LH_num_items(const OPENSSL_LHASH *lh)
 {
     return lh ? lh->num_items : 0;
 }
 
-unsigned long OPENSSL_LH_get_down_load(const OPENSSL_LHASH *lh)
+unsigned long __cdecl OPENSSL_LH_get_down_load(const OPENSSL_LHASH *lh)
 {
     return lh->down_load;
 }
 
-void OPENSSL_LH_set_down_load(OPENSSL_LHASH *lh, unsigned long down_load)
+void __cdecl OPENSSL_LH_set_down_load(OPENSSL_LHASH *lh, unsigned long down_load)
 {
     lh->down_load = down_load;
 }
 
-int OPENSSL_LH_error(OPENSSL_LHASH *lh)
+int __cdecl OPENSSL_LH_error(OPENSSL_LHASH *lh)
 {
     return lh->error;
 }
diff --git a/crypto/md2/md2_dgst.c b/crypto/md2/md2_dgst.c
index faa9393f2e..9a39b17691 100644
--- a/crypto/md2/md2_dgst.c
+++ b/crypto/md2/md2_dgst.c
@@ -60,7 +60,7 @@ static const MD2_INT S[256] = {
     0xDB, 0x99, 0x8D, 0x33, 0x9F, 0x11, 0x83, 0x14,
 };
 
-const char *MD2_options(void)
+const char * __cdecl MD2_options(void)
 {
     if (sizeof(MD2_INT) == 1)
         return "md2(char)";
@@ -68,7 +68,7 @@ const char *MD2_options(void)
         return "md2(int)";
 }
 
-int MD2_Init(MD2_CTX *c)
+int __cdecl MD2_Init(MD2_CTX *c)
 {
     c->num = 0;
     memset(c->state, 0, sizeof(c->state));
@@ -77,7 +77,7 @@ int MD2_Init(MD2_CTX *c)
     return 1;
 }
 
-int MD2_Update(MD2_CTX *c, const unsigned char *data, size_t len)
+int __cdecl MD2_Update(MD2_CTX *c, const unsigned char *data, size_t len)
 {
     register UCHAR *p;
 
@@ -147,7 +147,7 @@ static void md2_block(MD2_CTX *c, const unsigned char *d)
     OPENSSL_cleanse(state, 48 * sizeof(MD2_INT));
 }
 
-int MD2_Final(unsigned char *md, MD2_CTX *c)
+int __cdecl MD2_Final(unsigned char *md, MD2_CTX *c)
 {
     int i, v;
     register UCHAR *cp;
diff --git a/crypto/md2/md2_one.c b/crypto/md2/md2_one.c
index 5502b21696..dccf23bf88 100644
--- a/crypto/md2/md2_one.c
+++ b/crypto/md2/md2_one.c
@@ -16,7 +16,7 @@
  * functions to different names
  */
 
-unsigned char *MD2(const unsigned char *d, size_t n, unsigned char *md)
+unsigned char * __cdecl MD2(const unsigned char *d, size_t n, unsigned char *md)
 {
     MD2_CTX c;
     static unsigned char m[MD2_DIGEST_LENGTH];
diff --git a/crypto/md4/md4_dgst.c b/crypto/md4/md4_dgst.c
index 5319618615..e7ec9d1381 100644
--- a/crypto/md4/md4_dgst.c
+++ b/crypto/md4/md4_dgst.c
@@ -20,7 +20,7 @@
 #define INIT_DATA_C (unsigned long)0x98badcfeL
 #define INIT_DATA_D (unsigned long)0x10325476L
 
-int MD4_Init(MD4_CTX *c)
+int __cdecl MD4_Init(MD4_CTX *c)
 {
     memset(c, 0, sizeof(*c));
     c->A = INIT_DATA_A;
diff --git a/crypto/md4/md4_one.c b/crypto/md4/md4_one.c
index 9e52303c2f..ad2b87b724 100644
--- a/crypto/md4/md4_one.c
+++ b/crypto/md4/md4_one.c
@@ -16,7 +16,7 @@
 # include <openssl/ebcdic.h>
 #endif
 
-unsigned char *MD4(const unsigned char *d, size_t n, unsigned char *md)
+unsigned char * __cdecl MD4(const unsigned char *d, size_t n, unsigned char *md)
 {
     MD4_CTX c;
     static unsigned char m[MD4_DIGEST_LENGTH];
diff --git a/crypto/md5/md5_dgst.c b/crypto/md5/md5_dgst.c
index fbede6742a..64b2f17eca 100644
--- a/crypto/md5/md5_dgst.c
+++ b/crypto/md5/md5_dgst.c
@@ -20,7 +20,7 @@
 #define INIT_DATA_C (unsigned long)0x98badcfeL
 #define INIT_DATA_D (unsigned long)0x10325476L
 
-int MD5_Init(MD5_CTX *c)
+int __cdecl MD5_Init(MD5_CTX *c)
 {
     memset(c, 0, sizeof(*c));
     c->A = INIT_DATA_A;
diff --git a/crypto/md5/md5_one.c b/crypto/md5/md5_one.c
index c3bf2f88f0..3c34b57615 100644
--- a/crypto/md5/md5_one.c
+++ b/crypto/md5/md5_one.c
@@ -16,7 +16,7 @@
 # include <openssl/ebcdic.h>
 #endif
 
-unsigned char *MD5(const unsigned char *d, size_t n, unsigned char *md)
+unsigned char * __cdecl MD5(const unsigned char *d, size_t n, unsigned char *md)
 {
     MD5_CTX c;
     static unsigned char m[MD5_DIGEST_LENGTH];
diff --git a/crypto/mdc2/mdc2_one.c b/crypto/mdc2/mdc2_one.c
index 58e1e0fdf6..1290ebf705 100644
--- a/crypto/mdc2/mdc2_one.c
+++ b/crypto/mdc2/mdc2_one.c
@@ -11,7 +11,7 @@
 #include "internal/cryptlib.h"
 #include <openssl/mdc2.h>
 
-unsigned char *MDC2(const unsigned char *d, size_t n, unsigned char *md)
+unsigned char * __cdecl MDC2(const unsigned char *d, size_t n, unsigned char *md)
 {
     MDC2_CTX c;
     static unsigned char m[MDC2_DIGEST_LENGTH];
diff --git a/crypto/mdc2/mdc2dgst.c b/crypto/mdc2/mdc2dgst.c
index 14233b9aba..2dceffa1cb 100644
--- a/crypto/mdc2/mdc2dgst.c
+++ b/crypto/mdc2/mdc2dgst.c
@@ -27,7 +27,7 @@
                         *((c)++)=(unsigned char)(((l)>>24L)&0xff))
 
 static void mdc2_body(MDC2_CTX *c, const unsigned char *in, size_t len);
-int MDC2_Init(MDC2_CTX *c)
+int __cdecl MDC2_Init(MDC2_CTX *c)
 {
     c->num = 0;
     c->pad_type = 1;
@@ -36,7 +36,7 @@ int MDC2_Init(MDC2_CTX *c)
     return 1;
 }
 
-int MDC2_Update(MDC2_CTX *c, const unsigned char *in, size_t len)
+int __cdecl MDC2_Update(MDC2_CTX *c, const unsigned char *in, size_t len)
 {
     size_t i, j;
 
@@ -107,7 +107,7 @@ static void mdc2_body(MDC2_CTX *c, const unsigned char *in, size_t len)
     }
 }
 
-int MDC2_Final(unsigned char *md, MDC2_CTX *c)
+int __cdecl MDC2_Final(unsigned char *md, MDC2_CTX *c)
 {
     unsigned int i;
     int j;
diff --git a/crypto/mem.c b/crypto/mem.c
index 780053ffef..56c02305ea 100644
--- a/crypto/mem.c
+++ b/crypto/mem.c
@@ -23,11 +23,11 @@
  */
 static int allow_customize = 1;
 
-static void *(*malloc_impl)(size_t, const char *, int)
+static void *(__cdecl *malloc_impl)(size_t, const char *, int)
     = CRYPTO_malloc;
-static void *(*realloc_impl)(void *, size_t, const char *, int)
+static void *(__cdecl *realloc_impl)(void *, size_t, const char *, int)
     = CRYPTO_realloc;
-static void (*free_impl)(void *, const char *, int)
+static void (__cdecl *free_impl)(void *, const char *, int)
     = CRYPTO_free;
 
 #ifndef OPENSSL_NO_CRYPTO_MDEBUG
@@ -57,10 +57,10 @@ static int call_malloc_debug = 0;
 # define FAILTEST() /* empty */
 #endif
 
-int CRYPTO_set_mem_functions(
-        void *(*m)(size_t, const char *, int),
-        void *(*r)(void *, size_t, const char *, int),
-        void (*f)(void *, const char *, int))
+int __cdecl CRYPTO_set_mem_functions(
+        void *(__cdecl *m)(size_t, const char *, int),
+        void *(__cdecl *r)(void *, size_t, const char *, int),
+        void (__cdecl *f)(void *, const char *, int))
 {
     if (!allow_customize)
         return 0;
@@ -73,7 +73,7 @@ int CRYPTO_set_mem_functions(
     return 1;
 }
 
-int CRYPTO_set_mem_debug(int flag)
+int __cdecl CRYPTO_set_mem_debug(int flag)
 {
     if (!allow_customize)
         return 0;
@@ -81,10 +81,10 @@ int CRYPTO_set_mem_debug(int flag)
     return 1;
 }
 
-void CRYPTO_get_mem_functions(
-        void *(**m)(size_t, const char *, int),
-        void *(**r)(void *, size_t, const char *, int),
-        void (**f)(void *, const char *, int))
+void __cdecl CRYPTO_get_mem_functions(
+        void *(__cdecl **m)(size_t, const char *, int),
+        void *(__cdecl **r)(void *, size_t, const char *, int),
+        void (__cdecl **f)(void *, const char *, int))
 {
     if (m != NULL)
         *m = malloc_impl;
@@ -95,7 +95,7 @@ void CRYPTO_get_mem_functions(
 }
 
 #ifndef OPENSSL_NO_CRYPTO_MDEBUG
-void CRYPTO_get_alloc_counts(int *mcount, int *rcount, int *fcount)
+void __cdecl CRYPTO_get_alloc_counts(int *mcount, int *rcount, int *fcount)
 {
     if (mcount != NULL)
         *mcount = tsan_load(&malloc_count);
@@ -189,7 +189,7 @@ void ossl_malloc_setup_failures(void)
 }
 #endif
 
-void *CRYPTO_malloc(size_t num, const char *file, int line)
+void * __cdecl CRYPTO_malloc(size_t num, const char *file, int line)
 {
     void *ret = NULL;
 
@@ -225,7 +225,7 @@ void *CRYPTO_malloc(size_t num, const char *file, int line)
     return ret;
 }
 
-void *CRYPTO_zalloc(size_t num, const char *file, int line)
+void * __cdecl CRYPTO_zalloc(size_t num, const char *file, int line)
 {
     void *ret = CRYPTO_malloc(num, file, line);
 
@@ -235,7 +235,7 @@ void *CRYPTO_zalloc(size_t num, const char *file, int line)
     return ret;
 }
 
-void *CRYPTO_realloc(void *str, size_t num, const char *file, int line)
+void * __cdecl CRYPTO_realloc(void *str, size_t num, const char *file, int line)
 {
     INCREMENT(realloc_count);
     if (realloc_impl != NULL && realloc_impl != &CRYPTO_realloc)
@@ -265,7 +265,7 @@ void *CRYPTO_realloc(void *str, size_t num, const char *file, int line)
 
 }
 
-void *CRYPTO_clear_realloc(void *str, size_t old_len, size_t num,
+void * __cdecl CRYPTO_clear_realloc(void *str, size_t old_len, size_t num,
                            const char *file, int line)
 {
     void *ret = NULL;
@@ -292,7 +292,7 @@ void *CRYPTO_clear_realloc(void *str, size_t old_len, size_t num,
     return ret;
 }
 
-void CRYPTO_free(void *str, const char *file, int line)
+void __cdecl CRYPTO_free(void *str, const char *file, int line)
 {
     INCREMENT(free_count);
     if (free_impl != NULL && free_impl != &CRYPTO_free) {
@@ -313,7 +313,7 @@ void CRYPTO_free(void *str, const char *file, int line)
 #endif
 }
 
-void CRYPTO_clear_free(void *str, size_t num, const char *file, int line)
+void __cdecl CRYPTO_clear_free(void *str, size_t num, const char *file, int line)
 {
     if (str == NULL)
         return;
diff --git a/crypto/mem_clr.c b/crypto/mem_clr.c
index 35bfb74eae..c9310edccd 100644
--- a/crypto/mem_clr.c
+++ b/crypto/mem_clr.c
@@ -15,11 +15,11 @@
  * the pointer and can't assume that it points to any function in
  * particular (such as memset, which it then might further "optimize")
  */
-typedef void *(*memset_t)(void *, int, size_t);
+typedef void *(__cdecl *memset_t)(void *, int, size_t);
 
 static volatile memset_t memset_func = memset;
 
-void OPENSSL_cleanse(void *ptr, size_t len)
+void __cdecl OPENSSL_cleanse(void *ptr, size_t len)
 {
     memset_func(ptr, 0, len);
 }
diff --git a/crypto/mem_dbg.c b/crypto/mem_dbg.c
index 0489e97adb..9d4d5e5dc1 100644
--- a/crypto/mem_dbg.c
+++ b/crypto/mem_dbg.c
@@ -117,7 +117,7 @@ static void app_info_free(APP_INFO *inf)
 }
 #endif
 
-int CRYPTO_mem_ctrl(int mode)
+int __cdecl CRYPTO_mem_ctrl(int mode)
 {
 #ifdef OPENSSL_NO_CRYPTO_MDEBUG
     return mode - mode;
@@ -266,7 +266,7 @@ static int pop_info(void)
     return 0;
 }
 
-int CRYPTO_mem_debug_push(const char *info, const char *file, int line)
+int __cdecl CRYPTO_mem_debug_push(const char *info, const char *file, int line)
 {
     APP_INFO *ami, *amim;
     int ret = 0;
@@ -298,7 +298,7 @@ int CRYPTO_mem_debug_push(const char *info, const char *file, int line)
     return ret;
 }
 
-int CRYPTO_mem_debug_pop(void)
+int __cdecl CRYPTO_mem_debug_pop(void)
 {
     int ret = 0;
 
@@ -312,7 +312,7 @@ int CRYPTO_mem_debug_pop(void)
 
 static unsigned long break_order_num = 0;
 
-void CRYPTO_mem_debug_malloc(void *addr, size_t num, int before_p,
+void __cdecl CRYPTO_mem_debug_malloc(void *addr, size_t num, int before_p,
                              const char *file, int line)
 {
     MEM *m, *mm;
@@ -379,7 +379,7 @@ void CRYPTO_mem_debug_malloc(void *addr, size_t num, int before_p,
     return;
 }
 
-void CRYPTO_mem_debug_free(void *addr, int before_p,
+void __cdecl CRYPTO_mem_debug_free(void *addr, int before_p,
         const char *file, int line)
 {
     MEM m, *mp;
@@ -407,7 +407,7 @@ void CRYPTO_mem_debug_free(void *addr, int before_p,
     }
 }
 
-void CRYPTO_mem_debug_realloc(void *addr1, void *addr2, size_t num,
+void __cdecl CRYPTO_mem_debug_realloc(void *addr1, void *addr2, size_t num,
                               int before_p, const char *file, int line)
 {
     MEM m, *mp;
@@ -566,7 +566,7 @@ static void print_leak(const MEM *m, MEM_LEAK *l)
 
 IMPLEMENT_LHASH_DOALL_ARG_CONST(MEM, MEM_LEAK);
 
-int CRYPTO_mem_leaks_cb(int (*cb) (const char *str, size_t len, void *u),
+int __cdecl CRYPTO_mem_leaks_cb(int (*cb) (const char *str, size_t len, void *u),
                         void *u)
 {
     MEM_LEAK ml;
@@ -633,7 +633,7 @@ static int print_bio(const char *str, size_t len, void *b)
     return BIO_write((BIO *)b, str, len);
 }
 
-int CRYPTO_mem_leaks(BIO *b)
+int __cdecl CRYPTO_mem_leaks(BIO *b)
 {
     /*
      * OPENSSL_cleanup() will free the ex_data locks so we can't have any
@@ -645,7 +645,7 @@ int CRYPTO_mem_leaks(BIO *b)
 }
 
 # ifndef OPENSSL_NO_STDIO
-int CRYPTO_mem_leaks_fp(FILE *fp)
+int __cdecl CRYPTO_mem_leaks_fp(FILE *fp)
 {
     BIO *b;
     int ret;
diff --git a/crypto/mem_sec.c b/crypto/mem_sec.c
index 9e0f6702f4..ec7000fd8c 100644
--- a/crypto/mem_sec.c
+++ b/crypto/mem_sec.c
@@ -65,7 +65,7 @@ static size_t sh_actual_size(char *ptr);
 static int sh_allocated(const char *ptr);
 #endif
 
-int CRYPTO_secure_malloc_init(size_t size, int minsize)
+int __cdecl CRYPTO_secure_malloc_init(size_t size, int minsize)
 {
 #ifdef OPENSSL_SECURE_MEMORY
     int ret = 0;
@@ -88,7 +88,7 @@ int CRYPTO_secure_malloc_init(size_t size, int minsize)
 #endif /* OPENSSL_SECURE_MEMORY */
 }
 
-int CRYPTO_secure_malloc_done(void)
+int __cdecl CRYPTO_secure_malloc_done(void)
 {
 #ifdef OPENSSL_SECURE_MEMORY
     if (secure_mem_used == 0) {
@@ -102,7 +102,7 @@ int CRYPTO_secure_malloc_done(void)
     return 0;
 }
 
-int CRYPTO_secure_malloc_initialized(void)
+int __cdecl CRYPTO_secure_malloc_initialized(void)
 {
 #ifdef OPENSSL_SECURE_MEMORY
     return secure_mem_initialized;
@@ -111,7 +111,7 @@ int CRYPTO_secure_malloc_initialized(void)
 #endif /* OPENSSL_SECURE_MEMORY */
 }
 
-void *CRYPTO_secure_malloc(size_t num, const char *file, int line)
+void * __cdecl CRYPTO_secure_malloc(size_t num, const char *file, int line)
 {
 #ifdef OPENSSL_SECURE_MEMORY
     void *ret;
@@ -131,7 +131,7 @@ void *CRYPTO_secure_malloc(size_t num, const char *file, int line)
 #endif /* OPENSSL_SECURE_MEMORY */
 }
 
-void *CRYPTO_secure_zalloc(size_t num, const char *file, int line)
+void * __cdecl CRYPTO_secure_zalloc(size_t num, const char *file, int line)
 {
 #ifdef OPENSSL_SECURE_MEMORY
     if (secure_mem_initialized)
@@ -141,7 +141,7 @@ void *CRYPTO_secure_zalloc(size_t num, const char *file, int line)
     return CRYPTO_zalloc(num, file, line);
 }
 
-void CRYPTO_secure_free(void *ptr, const char *file, int line)
+void __cdecl CRYPTO_secure_free(void *ptr, const char *file, int line)
 {
 #ifdef OPENSSL_SECURE_MEMORY
     size_t actual_size;
@@ -163,7 +163,7 @@ void CRYPTO_secure_free(void *ptr, const char *file, int line)
 #endif /* OPENSSL_SECURE_MEMORY */
 }
 
-void CRYPTO_secure_clear_free(void *ptr, size_t num,
+void __cdecl CRYPTO_secure_clear_free(void *ptr, size_t num,
                               const char *file, int line)
 {
 #ifdef OPENSSL_SECURE_MEMORY
@@ -190,7 +190,7 @@ void CRYPTO_secure_clear_free(void *ptr, size_t num,
 #endif /* OPENSSL_SECURE_MEMORY */
 }
 
-int CRYPTO_secure_allocated(const void *ptr)
+int __cdecl CRYPTO_secure_allocated(const void *ptr)
 {
 #ifdef OPENSSL_SECURE_MEMORY
     int ret;
@@ -206,7 +206,7 @@ int CRYPTO_secure_allocated(const void *ptr)
 #endif /* OPENSSL_SECURE_MEMORY */
 }
 
-size_t CRYPTO_secure_used(void)
+size_t __cdecl CRYPTO_secure_used(void)
 {
 #ifdef OPENSSL_SECURE_MEMORY
     return secure_mem_used;
@@ -215,7 +215,7 @@ size_t CRYPTO_secure_used(void)
 #endif /* OPENSSL_SECURE_MEMORY */
 }
 
-size_t CRYPTO_secure_actual_size(void *ptr)
+size_t __cdecl CRYPTO_secure_actual_size(void *ptr)
 {
 #ifdef OPENSSL_SECURE_MEMORY
     size_t actual_size;
diff --git a/crypto/modes/cbc128.c b/crypto/modes/cbc128.c
index 4ce5eb2ae3..4d31026624 100644
--- a/crypto/modes/cbc128.c
+++ b/crypto/modes/cbc128.c
@@ -15,7 +15,7 @@
 # define STRICT_ALIGNMENT 0
 #endif
 
-void CRYPTO_cbc128_encrypt(const unsigned char *in, unsigned char *out,
+void __cdecl CRYPTO_cbc128_encrypt(const unsigned char *in, unsigned char *out,
                            size_t len, const void *key,
                            unsigned char ivec[16], block128_f block)
 {
@@ -66,7 +66,7 @@ void CRYPTO_cbc128_encrypt(const unsigned char *in, unsigned char *out,
     memcpy(ivec, iv, 16);
 }
 
-void CRYPTO_cbc128_decrypt(const unsigned char *in, unsigned char *out,
+void __cdecl CRYPTO_cbc128_decrypt(const unsigned char *in, unsigned char *out,
                            size_t len, const void *key,
                            unsigned char ivec[16], block128_f block)
 {
diff --git a/crypto/modes/ccm128.c b/crypto/modes/ccm128.c
index 05a33239f5..a0cec976f6 100644
--- a/crypto/modes/ccm128.c
+++ b/crypto/modes/ccm128.c
@@ -15,7 +15,7 @@
  * First you setup M and L parameters and pass the key schedule. This is
  * called once per session setup...
  */
-void CRYPTO_ccm128_init(CCM128_CONTEXT *ctx,
+void __cdecl CRYPTO_ccm128_init(CCM128_CONTEXT *ctx,
                         unsigned int M, unsigned int L, void *key,
                         block128_f block)
 {
@@ -29,7 +29,7 @@ void CRYPTO_ccm128_init(CCM128_CONTEXT *ctx,
 /* !!! Following interfaces are to be called *once* per packet !!! */
 
 /* Then you setup per-message nonce and pass the length of the message */
-int CRYPTO_ccm128_setiv(CCM128_CONTEXT *ctx,
+int __cdecl CRYPTO_ccm128_setiv(CCM128_CONTEXT *ctx,
                         const unsigned char *nonce, size_t nlen, size_t mlen)
 {
     unsigned int L = ctx->nonce.c[0] & 7; /* the L parameter */
@@ -57,7 +57,7 @@ int CRYPTO_ccm128_setiv(CCM128_CONTEXT *ctx,
 }
 
 /* Then you pass additional authentication data, this is optional */
-void CRYPTO_ccm128_aad(CCM128_CONTEXT *ctx,
+void __cdecl CRYPTO_ccm128_aad(CCM128_CONTEXT *ctx,
                        const unsigned char *aad, size_t alen)
 {
     unsigned int i;
@@ -126,7 +126,7 @@ static void ctr64_inc(unsigned char *counter)
     } while (n);
 }
 
-int CRYPTO_ccm128_encrypt(CCM128_CONTEXT *ctx,
+int __cdecl CRYPTO_ccm128_encrypt(CCM128_CONTEXT *ctx,
                           const unsigned char *inp, unsigned char *out,
                           size_t len)
 {
@@ -210,7 +210,7 @@ int CRYPTO_ccm128_encrypt(CCM128_CONTEXT *ctx,
     return 0;
 }
 
-int CRYPTO_ccm128_decrypt(CCM128_CONTEXT *ctx,
+int __cdecl CRYPTO_ccm128_decrypt(CCM128_CONTEXT *ctx,
                           const unsigned char *inp, unsigned char *out,
                           size_t len)
 {
@@ -297,7 +297,7 @@ static void ctr64_add(unsigned char *counter, size_t inc)
     } while (n && (inc || val));
 }
 
-int CRYPTO_ccm128_encrypt_ccm64(CCM128_CONTEXT *ctx,
+int __cdecl CRYPTO_ccm128_encrypt_ccm64(CCM128_CONTEXT *ctx,
                                 const unsigned char *inp, unsigned char *out,
                                 size_t len, ccm128_f stream)
 {
@@ -361,7 +361,7 @@ int CRYPTO_ccm128_encrypt_ccm64(CCM128_CONTEXT *ctx,
     return 0;
 }
 
-int CRYPTO_ccm128_decrypt_ccm64(CCM128_CONTEXT *ctx,
+int __cdecl CRYPTO_ccm128_decrypt_ccm64(CCM128_CONTEXT *ctx,
                                 const unsigned char *inp, unsigned char *out,
                                 size_t len, ccm128_f stream)
 {
@@ -419,7 +419,7 @@ int CRYPTO_ccm128_decrypt_ccm64(CCM128_CONTEXT *ctx,
     return 0;
 }
 
-size_t CRYPTO_ccm128_tag(CCM128_CONTEXT *ctx, unsigned char *tag, size_t len)
+size_t __cdecl CRYPTO_ccm128_tag(CCM128_CONTEXT *ctx, unsigned char *tag, size_t len)
 {
     unsigned int M = (ctx->nonce.c[0] >> 3) & 7; /* the M parameter */
 
diff --git a/crypto/modes/cfb128.c b/crypto/modes/cfb128.c
index e439567fe5..14a3acf830 100644
--- a/crypto/modes/cfb128.c
+++ b/crypto/modes/cfb128.c
@@ -16,7 +16,7 @@
  * The extra state information to record how much of the 128bit block we have
  * used is contained in *num;
  */
-void CRYPTO_cfb128_encrypt(const unsigned char *in, unsigned char *out,
+void __cdecl CRYPTO_cfb128_encrypt(const unsigned char *in, unsigned char *out,
                            size_t len, const void *key,
                            unsigned char ivec[16], int *num,
                            int enc, block128_f block)
@@ -170,7 +170,7 @@ static void cfbr_encrypt_block(const unsigned char *in, unsigned char *out,
 }
 
 /* N.B. This expects the input to be packed, MS bit first */
-void CRYPTO_cfb128_1_encrypt(const unsigned char *in, unsigned char *out,
+void __cdecl CRYPTO_cfb128_1_encrypt(const unsigned char *in, unsigned char *out,
                              size_t bits, const void *key,
                              unsigned char ivec[16], int *num,
                              int enc, block128_f block)
@@ -186,7 +186,7 @@ void CRYPTO_cfb128_1_encrypt(const unsigned char *in, unsigned char *out,
     }
 }
 
-void CRYPTO_cfb128_8_encrypt(const unsigned char *in, unsigned char *out,
+void __cdecl CRYPTO_cfb128_8_encrypt(const unsigned char *in, unsigned char *out,
                              size_t length, const void *key,
                              unsigned char ivec[16], int *num,
                              int enc, block128_f block)
diff --git a/crypto/modes/ctr128.c b/crypto/modes/ctr128.c
index 03920b4473..1a588415cc 100644
--- a/crypto/modes/ctr128.c
+++ b/crypto/modes/ctr128.c
@@ -68,7 +68,7 @@ static void ctr128_inc_aligned(unsigned char *counter)
  * implementation takes NO responsibility for checking that the counter
  * doesn't overflow into the rest of the IV when incremented.
  */
-void CRYPTO_ctr128_encrypt(const unsigned char *in, unsigned char *out,
+void __cdecl CRYPTO_ctr128_encrypt(const unsigned char *in, unsigned char *out,
                            size_t len, const void *key,
                            unsigned char ivec[16],
                            unsigned char ecount_buf[16], unsigned int *num,
@@ -144,7 +144,7 @@ static void ctr96_inc(unsigned char *counter)
     } while (n);
 }
 
-void CRYPTO_ctr128_encrypt_ctr32(const unsigned char *in, unsigned char *out,
+void __cdecl CRYPTO_ctr128_encrypt_ctr32(const unsigned char *in, unsigned char *out,
                                  size_t len, const void *key,
                                  unsigned char ivec[16],
                                  unsigned char ecount_buf[16],
diff --git a/crypto/modes/cts128.c b/crypto/modes/cts128.c
index 93826a1e2f..bcbaa65081 100644
--- a/crypto/modes/cts128.c
+++ b/crypto/modes/cts128.c
@@ -24,7 +24,7 @@
  * compliant with the NIST proposal, both extending CBC mode.
  */
 
-size_t CRYPTO_cts128_encrypt_block(const unsigned char *in,
+size_t __cdecl CRYPTO_cts128_encrypt_block(const unsigned char *in,
                                    unsigned char *out, size_t len,
                                    const void *key, unsigned char ivec[16],
                                    block128_f block)
@@ -53,7 +53,7 @@ size_t CRYPTO_cts128_encrypt_block(const unsigned char *in,
     return len + residue;
 }
 
-size_t CRYPTO_nistcts128_encrypt_block(const unsigned char *in,
+size_t __cdecl CRYPTO_nistcts128_encrypt_block(const unsigned char *in,
                                        unsigned char *out, size_t len,
                                        const void *key,
                                        unsigned char ivec[16],
@@ -84,7 +84,7 @@ size_t CRYPTO_nistcts128_encrypt_block(const unsigned char *in,
     return len + residue;
 }
 
-size_t CRYPTO_cts128_encrypt(const unsigned char *in, unsigned char *out,
+size_t __cdecl CRYPTO_cts128_encrypt(const unsigned char *in, unsigned char *out,
                              size_t len, const void *key,
                              unsigned char ivec[16], cbc128_f cbc)
 {
@@ -120,7 +120,7 @@ size_t CRYPTO_cts128_encrypt(const unsigned char *in, unsigned char *out,
     return len + residue;
 }
 
-size_t CRYPTO_nistcts128_encrypt(const unsigned char *in, unsigned char *out,
+size_t __cdecl CRYPTO_nistcts128_encrypt(const unsigned char *in, unsigned char *out,
                                  size_t len, const void *key,
                                  unsigned char ivec[16], cbc128_f cbc)
 {
@@ -155,7 +155,7 @@ size_t CRYPTO_nistcts128_encrypt(const unsigned char *in, unsigned char *out,
     return len + residue;
 }
 
-size_t CRYPTO_cts128_decrypt_block(const unsigned char *in,
+size_t __cdecl CRYPTO_cts128_decrypt_block(const unsigned char *in,
                                    unsigned char *out, size_t len,
                                    const void *key, unsigned char ivec[16],
                                    block128_f block)
@@ -197,7 +197,7 @@ size_t CRYPTO_cts128_decrypt_block(const unsigned char *in,
     return 16 + len + residue;
 }
 
-size_t CRYPTO_nistcts128_decrypt_block(const unsigned char *in,
+size_t __cdecl CRYPTO_nistcts128_decrypt_block(const unsigned char *in,
                                        unsigned char *out, size_t len,
                                        const void *key,
                                        unsigned char ivec[16],
@@ -245,7 +245,7 @@ size_t CRYPTO_nistcts128_decrypt_block(const unsigned char *in,
     return 16 + len + residue;
 }
 
-size_t CRYPTO_cts128_decrypt(const unsigned char *in, unsigned char *out,
+size_t __cdecl CRYPTO_cts128_decrypt(const unsigned char *in, unsigned char *out,
                              size_t len, const void *key,
                              unsigned char ivec[16], cbc128_f cbc)
 {
@@ -285,7 +285,7 @@ size_t CRYPTO_cts128_decrypt(const unsigned char *in, unsigned char *out,
     return 16 + len + residue;
 }
 
-size_t CRYPTO_nistcts128_decrypt(const unsigned char *in, unsigned char *out,
+size_t __cdecl CRYPTO_nistcts128_decrypt(const unsigned char *in, unsigned char *out,
                                  size_t len, const void *key,
                                  unsigned char ivec[16], cbc128_f cbc)
 {
diff --git a/crypto/modes/gcm128.c b/crypto/modes/gcm128.c
index 15f76e3e86..8fd5f4d0af 100644
--- a/crypto/modes/gcm128.c
+++ b/crypto/modes/gcm128.c
@@ -710,7 +710,7 @@ void gcm_ghash_p8(u64 Xi[2], const u128 Htable[16], const u8 *inp,
 # endif
 #endif
 
-void CRYPTO_gcm128_init(GCM128_CONTEXT *ctx, void *key, block128_f block)
+void __cdecl CRYPTO_gcm128_init(GCM128_CONTEXT *ctx, void *key, block128_f block)
 {
     const union {
         long one;
@@ -824,7 +824,7 @@ void CRYPTO_gcm128_init(GCM128_CONTEXT *ctx, void *key, block128_f block)
 #endif
 }
 
-void CRYPTO_gcm128_setiv(GCM128_CONTEXT *ctx, const unsigned char *iv,
+void __cdecl CRYPTO_gcm128_setiv(GCM128_CONTEXT *ctx, const unsigned char *iv,
                          size_t len)
 {
     const union {
@@ -917,7 +917,7 @@ void CRYPTO_gcm128_setiv(GCM128_CONTEXT *ctx, const unsigned char *iv,
         ctx->Yi.d[3] = ctr;
 }
 
-int CRYPTO_gcm128_aad(GCM128_CONTEXT *ctx, const unsigned char *aad,
+int __cdecl CRYPTO_gcm128_aad(GCM128_CONTEXT *ctx, const unsigned char *aad,
                       size_t len)
 {
     size_t i;
@@ -978,7 +978,7 @@ int CRYPTO_gcm128_aad(GCM128_CONTEXT *ctx, const unsigned char *aad,
     return 0;
 }
 
-int CRYPTO_gcm128_encrypt(GCM128_CONTEXT *ctx,
+int __cdecl CRYPTO_gcm128_encrypt(GCM128_CONTEXT *ctx,
                           const unsigned char *in, unsigned char *out,
                           size_t len)
 {
@@ -1213,7 +1213,7 @@ int CRYPTO_gcm128_encrypt(GCM128_CONTEXT *ctx,
     return 0;
 }
 
-int CRYPTO_gcm128_decrypt(GCM128_CONTEXT *ctx,
+int __cdecl CRYPTO_gcm128_decrypt(GCM128_CONTEXT *ctx,
                           const unsigned char *in, unsigned char *out,
                           size_t len)
 {
@@ -1456,7 +1456,7 @@ int CRYPTO_gcm128_decrypt(GCM128_CONTEXT *ctx,
     return 0;
 }
 
-int CRYPTO_gcm128_encrypt_ctr32(GCM128_CONTEXT *ctx,
+int __cdecl CRYPTO_gcm128_encrypt_ctr32(GCM128_CONTEXT *ctx,
                                 const unsigned char *in, unsigned char *out,
                                 size_t len, ctr128_f stream)
 {
@@ -1620,7 +1620,7 @@ int CRYPTO_gcm128_encrypt_ctr32(GCM128_CONTEXT *ctx,
 #endif
 }
 
-int CRYPTO_gcm128_decrypt_ctr32(GCM128_CONTEXT *ctx,
+int __cdecl CRYPTO_gcm128_decrypt_ctr32(GCM128_CONTEXT *ctx,
                                 const unsigned char *in, unsigned char *out,
                                 size_t len, ctr128_f stream)
 {
@@ -1791,7 +1791,7 @@ int CRYPTO_gcm128_decrypt_ctr32(GCM128_CONTEXT *ctx,
 #endif
 }
 
-int CRYPTO_gcm128_finish(GCM128_CONTEXT *ctx, const unsigned char *tag,
+int __cdecl CRYPTO_gcm128_finish(GCM128_CONTEXT *ctx, const unsigned char *tag,
                          size_t len)
 {
     const union {
@@ -1865,14 +1865,14 @@ int CRYPTO_gcm128_finish(GCM128_CONTEXT *ctx, const unsigned char *tag,
         return -1;
 }
 
-void CRYPTO_gcm128_tag(GCM128_CONTEXT *ctx, unsigned char *tag, size_t len)
+void __cdecl CRYPTO_gcm128_tag(GCM128_CONTEXT *ctx, unsigned char *tag, size_t len)
 {
     CRYPTO_gcm128_finish(ctx, NULL, 0);
     memcpy(tag, ctx->Xi.c,
            len <= sizeof(ctx->Xi.c) ? len : sizeof(ctx->Xi.c));
 }
 
-GCM128_CONTEXT *CRYPTO_gcm128_new(void *key, block128_f block)
+GCM128_CONTEXT * __cdecl CRYPTO_gcm128_new(void *key, block128_f block)
 {
     GCM128_CONTEXT *ret;
 
@@ -1882,7 +1882,7 @@ GCM128_CONTEXT *CRYPTO_gcm128_new(void *key, block128_f block)
     return ret;
 }
 
-void CRYPTO_gcm128_release(GCM128_CONTEXT *ctx)
+void __cdecl CRYPTO_gcm128_release(GCM128_CONTEXT *ctx)
 {
     OPENSSL_clear_free(ctx, sizeof(*ctx));
 }
diff --git a/crypto/modes/ocb128.c b/crypto/modes/ocb128.c
index 713b9aaf19..8510da9784 100644
--- a/crypto/modes/ocb128.c
+++ b/crypto/modes/ocb128.c
@@ -127,7 +127,7 @@ static OCB_BLOCK *ocb_lookup_l(OCB128_CONTEXT *ctx, size_t idx)
 /*
  * Create a new OCB128_CONTEXT
  */
-OCB128_CONTEXT *CRYPTO_ocb128_new(void *keyenc, void *keydec,
+OCB128_CONTEXT * __cdecl CRYPTO_ocb128_new(void *keyenc, void *keydec,
                                   block128_f encrypt, block128_f decrypt,
                                   ocb128_f stream)
 {
@@ -148,7 +148,7 @@ OCB128_CONTEXT *CRYPTO_ocb128_new(void *keyenc, void *keydec,
 /*
  * Initialise an existing OCB128_CONTEXT
  */
-int CRYPTO_ocb128_init(OCB128_CONTEXT *ctx, void *keyenc, void *keydec,
+int __cdecl CRYPTO_ocb128_init(OCB128_CONTEXT *ctx, void *keyenc, void *keydec,
                        block128_f encrypt, block128_f decrypt,
                        ocb128_f stream)
 {
@@ -193,7 +193,7 @@ int CRYPTO_ocb128_init(OCB128_CONTEXT *ctx, void *keyenc, void *keydec,
 /*
  * Copy an OCB128_CONTEXT object
  */
-int CRYPTO_ocb128_copy_ctx(OCB128_CONTEXT *dest, OCB128_CONTEXT *src,
+int __cdecl CRYPTO_ocb128_copy_ctx(OCB128_CONTEXT *dest, OCB128_CONTEXT *src,
                            void *keyenc, void *keydec)
 {
     memcpy(dest, src, sizeof(OCB128_CONTEXT));
@@ -214,7 +214,7 @@ int CRYPTO_ocb128_copy_ctx(OCB128_CONTEXT *dest, OCB128_CONTEXT *src,
 /*
  * Set the IV to be used for this operation. Must be 1 - 15 bytes.
  */
-int CRYPTO_ocb128_setiv(OCB128_CONTEXT *ctx, const unsigned char *iv,
+int __cdecl CRYPTO_ocb128_setiv(OCB128_CONTEXT *ctx, const unsigned char *iv,
                         size_t len, size_t taglen)
 {
     unsigned char ktop[16], tmp[16], mask;
@@ -265,7 +265,7 @@ int CRYPTO_ocb128_setiv(OCB128_CONTEXT *ctx, const unsigned char *iv,
  * Provide any AAD. This can be called multiple times. Only the final time can
  * have a partial block
  */
-int CRYPTO_ocb128_aad(OCB128_CONTEXT *ctx, const unsigned char *aad,
+int __cdecl CRYPTO_ocb128_aad(OCB128_CONTEXT *ctx, const unsigned char *aad,
                       size_t len)
 {
     u64 i, all_num_blocks;
@@ -326,7 +326,7 @@ int CRYPTO_ocb128_aad(OCB128_CONTEXT *ctx, const unsigned char *aad,
  * Provide any data to be encrypted. This can be called multiple times. Only
  * the final time can have a partial block
  */
-int CRYPTO_ocb128_encrypt(OCB128_CONTEXT *ctx,
+int __cdecl CRYPTO_ocb128_encrypt(OCB128_CONTEXT *ctx,
                           const unsigned char *in, unsigned char *out,
                           size_t len)
 {
@@ -418,7 +418,7 @@ int CRYPTO_ocb128_encrypt(OCB128_CONTEXT *ctx,
  * Provide any data to be decrypted. This can be called multiple times. Only
  * the final time can have a partial block
  */
-int CRYPTO_ocb128_decrypt(OCB128_CONTEXT *ctx,
+int __cdecl CRYPTO_ocb128_decrypt(OCB128_CONTEXT *ctx,
                           const unsigned char *in, unsigned char *out,
                           size_t len)
 {
@@ -534,7 +534,7 @@ static int ocb_finish(OCB128_CONTEXT *ctx, unsigned char *tag, size_t len,
 /*
  * Calculate the tag and verify it against the supplied tag
  */
-int CRYPTO_ocb128_finish(OCB128_CONTEXT *ctx, const unsigned char *tag,
+int __cdecl CRYPTO_ocb128_finish(OCB128_CONTEXT *ctx, const unsigned char *tag,
                          size_t len)
 {
     return ocb_finish(ctx, (unsigned char*)tag, len, 0);
@@ -543,7 +543,7 @@ int CRYPTO_ocb128_finish(OCB128_CONTEXT *ctx, const unsigned char *tag,
 /*
  * Retrieve the calculated tag
  */
-int CRYPTO_ocb128_tag(OCB128_CONTEXT *ctx, unsigned char *tag, size_t len)
+int __cdecl CRYPTO_ocb128_tag(OCB128_CONTEXT *ctx, unsigned char *tag, size_t len)
 {
     return ocb_finish(ctx, tag, len, 1);
 }
@@ -551,7 +551,7 @@ int CRYPTO_ocb128_tag(OCB128_CONTEXT *ctx, unsigned char *tag, size_t len)
 /*
  * Release all resources
  */
-void CRYPTO_ocb128_cleanup(OCB128_CONTEXT *ctx)
+void __cdecl CRYPTO_ocb128_cleanup(OCB128_CONTEXT *ctx)
 {
     if (ctx) {
         OPENSSL_clear_free(ctx->l, ctx->max_l_index * 16);
diff --git a/crypto/modes/ofb128.c b/crypto/modes/ofb128.c
index 83092564c6..4548c6edbc 100644
--- a/crypto/modes/ofb128.c
+++ b/crypto/modes/ofb128.c
@@ -16,7 +16,7 @@
  * The extra state information to record how much of the 128bit block we have
  * used is contained in *num;
  */
-void CRYPTO_ofb128_encrypt(const unsigned char *in, unsigned char *out,
+void __cdecl CRYPTO_ofb128_encrypt(const unsigned char *in, unsigned char *out,
                            size_t len, const void *key,
                            unsigned char ivec[16], int *num, block128_f block)
 {
diff --git a/crypto/modes/wrap128.c b/crypto/modes/wrap128.c
index d7e56cc260..f773869d37 100644
--- a/crypto/modes/wrap128.c
+++ b/crypto/modes/wrap128.c
@@ -45,7 +45,7 @@ static const unsigned char default_aiv[] = {
  *                     or if inlen > CRYPTO128_WRAP_MAX.
  *                     Output length if wrapping succeeded.
  */
-size_t CRYPTO_128_wrap(void *key, const unsigned char *iv,
+size_t __cdecl CRYPTO_128_wrap(void *key, const unsigned char *iv,
                        unsigned char *out,
                        const unsigned char *in, size_t inlen,
                        block128_f block)
@@ -147,7 +147,7 @@ static size_t crypto_128_unwrap_raw(void *key, unsigned char *iv,
  *                     or if IV doesn't match expected value.
  *                     Output length otherwise.
  */
-size_t CRYPTO_128_unwrap(void *key, const unsigned char *iv,
+size_t __cdecl CRYPTO_128_unwrap(void *key, const unsigned char *iv,
                          unsigned char *out, const unsigned char *in,
                          size_t inlen, block128_f block)
 {
@@ -180,7 +180,7 @@ size_t CRYPTO_128_unwrap(void *key, const unsigned char *iv,
  *  @return            0 if inlen is out of range [1, CRYPTO128_WRAP_MAX].
  *                     Output length if wrapping succeeded.
  */
-size_t CRYPTO_128_wrap_pad(void *key, const unsigned char *icv,
+size_t __cdecl CRYPTO_128_wrap_pad(void *key, const unsigned char *icv,
                            unsigned char *out,
                            const unsigned char *in, size_t inlen,
                            block128_f block)
@@ -248,7 +248,7 @@ size_t CRYPTO_128_wrap_pad(void *key, const unsigned char *icv,
  *                     or if IV and message length indicator doesn't match.
  *                     Output length if unwrapping succeeded and IV matches.
  */
-size_t CRYPTO_128_unwrap_pad(void *key, const unsigned char *icv,
+size_t __cdecl CRYPTO_128_unwrap_pad(void *key, const unsigned char *icv,
                              unsigned char *out,
                              const unsigned char *in, size_t inlen,
                              block128_f block)
diff --git a/crypto/modes/xts128.c b/crypto/modes/xts128.c
index 81b1eacd59..095b9229c2 100644
--- a/crypto/modes/xts128.c
+++ b/crypto/modes/xts128.c
@@ -11,7 +11,7 @@
 #include "modes_lcl.h"
 #include <string.h>
 
-int CRYPTO_xts128_encrypt(const XTS128_CONTEXT *ctx,
+int __cdecl CRYPTO_xts128_encrypt(const XTS128_CONTEXT *ctx,
                           const unsigned char iv[16],
                           const unsigned char *inp, unsigned char *out,
                           size_t len, int enc)
diff --git a/crypto/o_fips.c b/crypto/o_fips.c
index 050ea9c216..f3a1755872 100644
--- a/crypto/o_fips.c
+++ b/crypto/o_fips.c
@@ -9,13 +9,13 @@
 
 #include "internal/cryptlib.h"
 
-int FIPS_mode(void)
+int __cdecl FIPS_mode(void)
 {
     /* This version of the library does not support FIPS mode. */
     return 0;
 }
 
-int FIPS_mode_set(int r)
+int __cdecl FIPS_mode_set(int r)
 {
     if (r == 0)
         return 1;
diff --git a/crypto/o_init.c b/crypto/o_init.c
index ed6b1303d8..e133b629c0 100644
--- a/crypto/o_init.c
+++ b/crypto/o_init.c
@@ -15,7 +15,7 @@
  * nothing.
  */
 
-void OPENSSL_init(void)
+void __cdecl OPENSSL_init(void)
 {
     return;
 }
diff --git a/crypto/o_str.c b/crypto/o_str.c
index 9ad7a89dca..2684c159aa 100644
--- a/crypto/o_str.c
+++ b/crypto/o_str.c
@@ -24,7 +24,7 @@ int OPENSSL_memcmp(const void *v1, const void *v2, size_t n)
     return ret;
 }
 
-char *CRYPTO_strdup(const char *str, const char* file, int line)
+char * __cdecl CRYPTO_strdup(const char *str, const char* file, int line)
 {
     char *ret;
 
@@ -36,7 +36,7 @@ char *CRYPTO_strdup(const char *str, const char* file, int line)
     return ret;
 }
 
-char *CRYPTO_strndup(const char *str, size_t s, const char* file, int line)
+char * __cdecl CRYPTO_strndup(const char *str, size_t s, const char* file, int line)
 {
     size_t maxlen;
     char *ret;
@@ -54,7 +54,7 @@ char *CRYPTO_strndup(const char *str, size_t s, const char* file, int line)
     return ret;
 }
 
-void *CRYPTO_memdup(const void *data, size_t siz, const char* file, int line)
+void * __cdecl CRYPTO_memdup(const void *data, size_t siz, const char* file, int line)
 {
     void *ret;
 
@@ -69,7 +69,7 @@ void *CRYPTO_memdup(const void *data, size_t siz, const char* file, int line)
     return memcpy(ret, data, siz);
 }
 
-size_t OPENSSL_strnlen(const char *str, size_t maxlen)
+size_t __cdecl OPENSSL_strnlen(const char *str, size_t maxlen)
 {
     const char *p;
 
@@ -78,7 +78,7 @@ size_t OPENSSL_strnlen(const char *str, size_t maxlen)
     return p - str;
 }
 
-size_t OPENSSL_strlcpy(char *dst, const char *src, size_t size)
+size_t __cdecl OPENSSL_strlcpy(char *dst, const char *src, size_t size)
 {
     size_t l = 0;
     for (; size > 1 && *src; size--) {
@@ -90,7 +90,7 @@ size_t OPENSSL_strlcpy(char *dst, const char *src, size_t size)
     return l + strlen(src);
 }
 
-size_t OPENSSL_strlcat(char *dst, const char *src, size_t size)
+size_t __cdecl OPENSSL_strlcat(char *dst, const char *src, size_t size)
 {
     size_t l = 0;
     for (; size > 0 && *dst; size--, dst++)
@@ -98,7 +98,7 @@ size_t OPENSSL_strlcat(char *dst, const char *src, size_t size)
     return l + OPENSSL_strlcpy(dst, src, size);
 }
 
-int OPENSSL_hexchar2int(unsigned char c)
+int __cdecl OPENSSL_hexchar2int(unsigned char c)
 {
 #ifdef CHARSET_EBCDIC
     c = os_toebcdic[c];
@@ -144,7 +144,7 @@ int OPENSSL_hexchar2int(unsigned char c)
 /*
  * Give a string of hex digits convert to a buffer
  */
-unsigned char *OPENSSL_hexstr2buf(const char *str, long *len)
+unsigned char * __cdecl OPENSSL_hexstr2buf(const char *str, long *len)
 {
     unsigned char *hexbuf, *q;
     unsigned char ch, cl;
@@ -188,7 +188,7 @@ unsigned char *OPENSSL_hexstr2buf(const char *str, long *len)
  * hex representation @@@ (Contents of buffer are always kept in ASCII, also
  * on EBCDIC machines)
  */
-char *OPENSSL_buf2hexstr(const unsigned char *buffer, long len)
+char * __cdecl OPENSSL_buf2hexstr(const unsigned char *buffer, long len)
 {
     static const char hexdig[] = "0123456789ABCDEF";
     char *tmp, *q;
diff --git a/crypto/o_time.c b/crypto/o_time.c
index 6d764f55e2..8e2a4cd734 100644
--- a/crypto/o_time.c
+++ b/crypto/o_time.c
@@ -11,7 +11,7 @@
 #include <string.h>
 #include <openssl/crypto.h>
 
-struct tm *OPENSSL_gmtime(const time_t *timer, struct tm *result)
+struct tm * __cdecl OPENSSL_gmtime(const time_t *timer, struct tm *result)
 {
     struct tm *ts = NULL;
 
@@ -69,7 +69,7 @@ static void julian_to_date(long jd, int *y, int *m, int *d);
 static int julian_adj(const struct tm *tm, int off_day, long offset_sec,
                       long *pday, int *psec);
 
-int OPENSSL_gmtime_adj(struct tm *tm, int off_day, long offset_sec)
+int __cdecl OPENSSL_gmtime_adj(struct tm *tm, int off_day, long offset_sec)
 {
     int time_sec, time_year, time_month, time_day;
     long time_jd;
@@ -99,7 +99,7 @@ int OPENSSL_gmtime_adj(struct tm *tm, int off_day, long offset_sec)
 
 }
 
-int OPENSSL_gmtime_diff(int *pday, int *psec,
+int __cdecl OPENSSL_gmtime_diff(int *pday, int *psec,
                         const struct tm *from, const struct tm *to)
 {
     int from_sec, to_sec, diff_sec;
diff --git a/crypto/objects/o_names.c b/crypto/objects/o_names.c
index c4355370cb..1f86b5d16f 100644
--- a/crypto/objects/o_names.c
+++ b/crypto/objects/o_names.c
@@ -30,7 +30,7 @@
  * transparently assign function pointers to it.
  */
 #if defined(OPENSSL_SYS_VMS_DECC) || defined(OPENSSL_SYS_UEFI)
-static int obj_strcasecmp(const char *a, const char *b)
+static int __cdecl obj_strcasecmp(const char *a, const char *b)
 {
     return strcasecmp(a, b);
 }
@@ -48,7 +48,7 @@ static CRYPTO_RWLOCK *obj_lock = NULL;
 
 struct name_funcs_st {
     unsigned long (*hash_func) (const char *name);
-    int (*cmp_func) (const char *a, const char *b);
+    int (__cdecl *cmp_func) (const char *a, const char *b);
     void (*free_func) (const char *, int, const char *);
 };
 
@@ -61,7 +61,7 @@ static STACK_OF(NAME_FUNCS) *name_funcs_stack;
  */
 
 static unsigned long obj_name_hash(const OBJ_NAME *a);
-static int obj_name_cmp(const OBJ_NAME *a, const OBJ_NAME *b);
+static int __cdecl obj_name_cmp(const OBJ_NAME *a, const OBJ_NAME *b);
 
 static CRYPTO_ONCE init = CRYPTO_ONCE_STATIC_INIT;
 DEFINE_RUN_ONCE_STATIC(o_names_init)
@@ -73,13 +73,13 @@ DEFINE_RUN_ONCE_STATIC(o_names_init)
     return names_lh != NULL && obj_lock != NULL;
 }
 
-int OBJ_NAME_init(void)
+int __cdecl OBJ_NAME_init(void)
 {
     return RUN_ONCE(&init, o_names_init);
 }
 
-int OBJ_NAME_new_index(unsigned long (*hash_func) (const char *),
-                       int (*cmp_func) (const char *, const char *),
+int __cdecl OBJ_NAME_new_index(unsigned long (*hash_func) (const char *),
+                       int (__cdecl *cmp_func) (const char *, const char *),
                        void (*free_func) (const char *, int, const char *))
 {
     int ret = 0, i, push;
@@ -137,7 +137,7 @@ out:
     return ret;
 }
 
-static int obj_name_cmp(const OBJ_NAME *a, const OBJ_NAME *b)
+static int __cdecl obj_name_cmp(const OBJ_NAME *a, const OBJ_NAME *b)
 {
     int ret;
 
@@ -169,7 +169,7 @@ static unsigned long obj_name_hash(const OBJ_NAME *a)
     return ret;
 }
 
-const char *OBJ_NAME_get(const char *name, int type)
+const char * __cdecl OBJ_NAME_get(const char *name, int type)
 {
     OBJ_NAME on, *ret;
     int num = 0, alias;
@@ -205,7 +205,7 @@ const char *OBJ_NAME_get(const char *name, int type)
     return value;
 }
 
-int OBJ_NAME_add(const char *name, int type, const char *data)
+int __cdecl OBJ_NAME_add(const char *name, int type, const char *data)
 {
     OBJ_NAME *onp, *ret;
     int alias, ok = 0;
@@ -258,7 +258,7 @@ unlock:
     return ok;
 }
 
-int OBJ_NAME_remove(const char *name, int type)
+int __cdecl OBJ_NAME_remove(const char *name, int type)
 {
     OBJ_NAME on, *ret;
     int ok = 0;
@@ -306,7 +306,7 @@ static void do_all_fn(const OBJ_NAME *name, OBJ_DOALL *d)
 
 IMPLEMENT_LHASH_DOALL_ARG_CONST(OBJ_NAME, OBJ_DOALL);
 
-void OBJ_NAME_do_all(int type, void (*fn) (const OBJ_NAME *, void *arg),
+void __cdecl OBJ_NAME_do_all(int type, void (*fn) (const OBJ_NAME *, void *arg),
                      void *arg)
 {
     OBJ_DOALL d;
@@ -334,7 +334,7 @@ static void do_all_sorted_fn(const OBJ_NAME *name, void *d_)
     d->names[d->n++] = name;
 }
 
-static int do_all_sorted_cmp(const void *n1_, const void *n2_)
+static int __cdecl do_all_sorted_cmp(const void *n1_, const void *n2_)
 {
     const OBJ_NAME *const *n1 = n1_;
     const OBJ_NAME *const *n2 = n2_;
@@ -342,7 +342,7 @@ static int do_all_sorted_cmp(const void *n1_, const void *n2_)
     return strcmp((*n1)->name, (*n2)->name);
 }
 
-void OBJ_NAME_do_all_sorted(int type,
+void __cdecl OBJ_NAME_do_all_sorted(int type,
                             void (*fn) (const OBJ_NAME *, void *arg),
                             void *arg)
 {
@@ -377,12 +377,12 @@ static void names_lh_free_doall(OBJ_NAME *onp)
         OBJ_NAME_remove(onp->name, onp->type);
 }
 
-static void name_funcs_free(NAME_FUNCS *ptr)
+static void __cdecl name_funcs_free(NAME_FUNCS *ptr)
 {
     OPENSSL_free(ptr);
 }
 
-void OBJ_NAME_cleanup(int type)
+void __cdecl OBJ_NAME_cleanup(int type)
 {
     unsigned long down_load;
 
diff --git a/crypto/objects/obj_dat.c b/crypto/objects/obj_dat.c
index ef2d1e0dda..35921e3223 100644
--- a/crypto/objects/obj_dat.c
+++ b/crypto/objects/obj_dat.c
@@ -38,14 +38,14 @@ struct added_obj_st {
 static int new_nid = NUM_NID;
 static LHASH_OF(ADDED_OBJ) *added = NULL;
 
-static int sn_cmp(const ASN1_OBJECT *const *a, const unsigned int *b)
+static int __cdecl sn_cmp(const ASN1_OBJECT *const *a, const unsigned int *b)
 {
     return strcmp((*a)->sn, nid_objs[*b].sn);
 }
 
 IMPLEMENT_OBJ_BSEARCH_CMP_FN(const ASN1_OBJECT *, unsigned int, sn);
 
-static int ln_cmp(const ASN1_OBJECT *const *a, const unsigned int *b)
+static int __cdecl ln_cmp(const ASN1_OBJECT *const *a, const unsigned int *b)
 {
     return strcmp((*a)->ln, nid_objs[*b].ln);
 }
@@ -85,7 +85,7 @@ static unsigned long added_obj_hash(const ADDED_OBJ *ca)
     return ret;
 }
 
-static int added_obj_cmp(const ADDED_OBJ *ca, const ADDED_OBJ *cb)
+static int __cdecl added_obj_cmp(const ADDED_OBJ *ca, const ADDED_OBJ *cb)
 {
     ASN1_OBJECT *a, *b;
     int i;
@@ -162,7 +162,7 @@ void obj_cleanup_int(void)
     added = NULL;
 }
 
-int OBJ_new_nid(int num)
+int __cdecl OBJ_new_nid(int num)
 {
     int i;
 
@@ -171,7 +171,7 @@ int OBJ_new_nid(int num)
     return i;
 }
 
-int OBJ_add_object(const ASN1_OBJECT *obj)
+int __cdecl OBJ_add_object(const ASN1_OBJECT *obj)
 {
     ASN1_OBJECT *o;
     ADDED_OBJ *ao[4] = { NULL, NULL, NULL, NULL }, *aop;
@@ -217,7 +217,7 @@ int OBJ_add_object(const ASN1_OBJECT *obj)
     return NID_undef;
 }
 
-ASN1_OBJECT *OBJ_nid2obj(int n)
+ASN1_OBJECT * __cdecl OBJ_nid2obj(int n)
 {
     ADDED_OBJ ad, *adp;
     ASN1_OBJECT ob;
@@ -244,7 +244,7 @@ ASN1_OBJECT *OBJ_nid2obj(int n)
     }
 }
 
-const char *OBJ_nid2sn(int n)
+const char * __cdecl OBJ_nid2sn(int n)
 {
     ADDED_OBJ ad, *adp;
     ASN1_OBJECT ob;
@@ -271,7 +271,7 @@ const char *OBJ_nid2sn(int n)
     }
 }
 
-const char *OBJ_nid2ln(int n)
+const char * __cdecl OBJ_nid2ln(int n)
 {
     ADDED_OBJ ad, *adp;
     ASN1_OBJECT ob;
@@ -298,7 +298,7 @@ const char *OBJ_nid2ln(int n)
     }
 }
 
-static int obj_cmp(const ASN1_OBJECT *const *ap, const unsigned int *bp)
+static int __cdecl obj_cmp(const ASN1_OBJECT *const *ap, const unsigned int *bp)
 {
     int j;
     const ASN1_OBJECT *a = *ap;
@@ -314,7 +314,7 @@ static int obj_cmp(const ASN1_OBJECT *const *ap, const unsigned int *bp)
 
 IMPLEMENT_OBJ_BSEARCH_CMP_FN(const ASN1_OBJECT *, unsigned int, obj);
 
-int OBJ_obj2nid(const ASN1_OBJECT *a)
+int __cdecl OBJ_obj2nid(const ASN1_OBJECT *a)
 {
     const unsigned int *op;
     ADDED_OBJ ad, *adp;
@@ -347,7 +347,7 @@ int OBJ_obj2nid(const ASN1_OBJECT *a)
  * just registered ones.
  */
 
-ASN1_OBJECT *OBJ_txt2obj(const char *s, int no_name)
+ASN1_OBJECT * __cdecl OBJ_txt2obj(const char *s, int no_name)
 {
     int nid = NID_undef;
     ASN1_OBJECT *op;
@@ -393,7 +393,7 @@ ASN1_OBJECT *OBJ_txt2obj(const char *s, int no_name)
     return op;
 }
 
-int OBJ_obj2txt(char *buf, int buf_len, const ASN1_OBJECT *a, int no_name)
+int __cdecl OBJ_obj2txt(char *buf, int buf_len, const ASN1_OBJECT *a, int no_name)
 {
     int i, n = 0, len, nid, first, use_bn;
     BIGNUM *bl;
@@ -527,7 +527,7 @@ int OBJ_obj2txt(char *buf, int buf_len, const ASN1_OBJECT *a, int no_name)
     return -1;
 }
 
-int OBJ_txt2nid(const char *s)
+int __cdecl OBJ_txt2nid(const char *s)
 {
     ASN1_OBJECT *obj;
     int nid;
@@ -537,7 +537,7 @@ int OBJ_txt2nid(const char *s)
     return nid;
 }
 
-int OBJ_ln2nid(const char *s)
+int __cdecl OBJ_ln2nid(const char *s)
 {
     ASN1_OBJECT o;
     const ASN1_OBJECT *oo = &o;
@@ -558,7 +558,7 @@ int OBJ_ln2nid(const char *s)
     return nid_objs[*op].nid;
 }
 
-int OBJ_sn2nid(const char *s)
+int __cdecl OBJ_sn2nid(const char *s)
 {
     ASN1_OBJECT o;
     const ASN1_OBJECT *oo = &o;
@@ -579,15 +579,15 @@ int OBJ_sn2nid(const char *s)
     return nid_objs[*op].nid;
 }
 
-const void *OBJ_bsearch_(const void *key, const void *base, int num, int size,
-                         int (*cmp) (const void *, const void *))
+const void * __cdecl OBJ_bsearch_(const void *key, const void *base, int num, int size,
+                         int (__cdecl *cmp) (const void *, const void *))
 {
     return OBJ_bsearch_ex_(key, base, num, size, cmp, 0);
 }
 
-const void *OBJ_bsearch_ex_(const void *key, const void *base_, int num,
+const void * __cdecl OBJ_bsearch_ex_(const void *key, const void *base_, int num,
                             int size,
-                            int (*cmp) (const void *, const void *),
+                            int (__cdecl *cmp) (const void *, const void *),
                             int flags)
 {
     const char *base = base_;
@@ -638,7 +638,7 @@ const void *OBJ_bsearch_ex_(const void *key, const void *base_, int num,
  * Parse a BIO sink to create some extra oid's objects.
  * Line format:<OID:isdigit or '.']><isspace><SN><isspace><LN>
  */
-int OBJ_create_objects(BIO *in)
+int __cdecl OBJ_create_objects(BIO *in)
 {
     char buf[512];
     int i, num = 0;
@@ -687,7 +687,7 @@ int OBJ_create_objects(BIO *in)
     }
 }
 
-int OBJ_create(const char *oid, const char *sn, const char *ln)
+int __cdecl OBJ_create(const char *oid, const char *sn, const char *ln)
 {
     ASN1_OBJECT *tmpoid = NULL;
     int ok = 0;
@@ -724,14 +724,14 @@ int OBJ_create(const char *oid, const char *sn, const char *ln)
     return ok;
 }
 
-size_t OBJ_length(const ASN1_OBJECT *obj)
+size_t __cdecl OBJ_length(const ASN1_OBJECT *obj)
 {
     if (obj == NULL)
         return 0;
     return obj->length;
 }
 
-const unsigned char *OBJ_get0_data(const ASN1_OBJECT *obj)
+const unsigned char * __cdecl OBJ_get0_data(const ASN1_OBJECT *obj)
 {
     if (obj == NULL)
         return NULL;
diff --git a/crypto/objects/obj_err.c b/crypto/objects/obj_err.c
index be4f11ca20..a223310a61 100644
--- a/crypto/objects/obj_err.c
+++ b/crypto/objects/obj_err.c
@@ -34,7 +34,7 @@ static const ERR_STRING_DATA OBJ_str_reasons[] = {
 
 #endif
 
-int ERR_load_OBJ_strings(void)
+int __cdecl ERR_load_OBJ_strings(void)
 {
 #ifndef OPENSSL_NO_ERR
     if (ERR_func_error_string(OBJ_str_functs[0].error) == NULL) {
diff --git a/crypto/objects/obj_lib.c b/crypto/objects/obj_lib.c
index acbdeec2c9..373d462235 100644
--- a/crypto/objects/obj_lib.c
+++ b/crypto/objects/obj_lib.c
@@ -13,7 +13,7 @@
 #include <openssl/buffer.h>
 #include "internal/asn1_int.h"
 
-ASN1_OBJECT *OBJ_dup(const ASN1_OBJECT *o)
+ASN1_OBJECT * __cdecl OBJ_dup(const ASN1_OBJECT *o)
 {
     ASN1_OBJECT *r;
 
@@ -54,7 +54,7 @@ ASN1_OBJECT *OBJ_dup(const ASN1_OBJECT *o)
     return NULL;
 }
 
-int OBJ_cmp(const ASN1_OBJECT *a, const ASN1_OBJECT *b)
+int __cdecl OBJ_cmp(const ASN1_OBJECT *a, const ASN1_OBJECT *b)
 {
     int ret;
 
diff --git a/crypto/objects/obj_xref.c b/crypto/objects/obj_xref.c
index faf59eb20c..495b9e821b 100644
--- a/crypto/objects/obj_xref.c
+++ b/crypto/objects/obj_xref.c
@@ -14,7 +14,7 @@
 
 static STACK_OF(nid_triple) *sig_app, *sigx_app;
 
-static int sig_cmp(const nid_triple *a, const nid_triple *b)
+static int __cdecl sig_cmp(const nid_triple *a, const nid_triple *b)
 {
     return a->sign_id - b->sign_id;
 }
@@ -22,14 +22,14 @@ static int sig_cmp(const nid_triple *a, const nid_triple *b)
 DECLARE_OBJ_BSEARCH_CMP_FN(nid_triple, nid_triple, sig);
 IMPLEMENT_OBJ_BSEARCH_CMP_FN(nid_triple, nid_triple, sig);
 
-static int sig_sk_cmp(const nid_triple *const *a, const nid_triple *const *b)
+static int __cdecl sig_sk_cmp(const nid_triple *const *a, const nid_triple *const *b)
 {
     return (*a)->sign_id - (*b)->sign_id;
 }
 
 DECLARE_OBJ_BSEARCH_CMP_FN(const nid_triple *, const nid_triple *, sigx);
 
-static int sigx_cmp(const nid_triple *const *a, const nid_triple *const *b)
+static int __cdecl sigx_cmp(const nid_triple *const *a, const nid_triple *const *b)
 {
     int ret;
     ret = (*a)->hash_id - (*b)->hash_id;
@@ -40,7 +40,7 @@ static int sigx_cmp(const nid_triple *const *a, const nid_triple *const *b)
 
 IMPLEMENT_OBJ_BSEARCH_CMP_FN(const nid_triple *, const nid_triple *, sigx);
 
-int OBJ_find_sigid_algs(int signid, int *pdig_nid, int *ppkey_nid)
+int __cdecl OBJ_find_sigid_algs(int signid, int *pdig_nid, int *ppkey_nid)
 {
     nid_triple tmp;
     const nid_triple *rv = NULL;
@@ -64,7 +64,7 @@ int OBJ_find_sigid_algs(int signid, int *pdig_nid, int *ppkey_nid)
     return 1;
 }
 
-int OBJ_find_sigid_by_algs(int *psignid, int dig_nid, int pkey_nid)
+int __cdecl OBJ_find_sigid_by_algs(int *psignid, int dig_nid, int pkey_nid)
 {
     nid_triple tmp;
     const nid_triple *t = &tmp;
@@ -92,7 +92,7 @@ int OBJ_find_sigid_by_algs(int *psignid, int dig_nid, int pkey_nid)
     return 1;
 }
 
-int OBJ_add_sigid(int signid, int dig_id, int pkey_id)
+int __cdecl OBJ_add_sigid(int signid, int dig_id, int pkey_id)
 {
     nid_triple *ntr;
     if (sig_app == NULL)
@@ -125,12 +125,12 @@ int OBJ_add_sigid(int signid, int dig_id, int pkey_id)
     return 1;
 }
 
-static void sid_free(nid_triple *tt)
+static void __cdecl sid_free(nid_triple *tt)
 {
     OPENSSL_free(tt);
 }
 
-void OBJ_sigid_free(void)
+void __cdecl OBJ_sigid_free(void)
 {
     sk_nid_triple_pop_free(sig_app, sid_free);
     sig_app = NULL;
diff --git a/crypto/ocsp/ocsp_cl.c b/crypto/ocsp/ocsp_cl.c
index 739ac01807..a6e26cb903 100644
--- a/crypto/ocsp/ocsp_cl.c
+++ b/crypto/ocsp/ocsp_cl.c
@@ -28,7 +28,7 @@
  * useful if we want to add extensions.
  */
 
-OCSP_ONEREQ *OCSP_request_add0_id(OCSP_REQUEST *req, OCSP_CERTID *cid)
+OCSP_ONEREQ * __cdecl OCSP_request_add0_id(OCSP_REQUEST *req, OCSP_CERTID *cid)
 {
     OCSP_ONEREQ *one = NULL;
 
@@ -48,7 +48,7 @@ OCSP_ONEREQ *OCSP_request_add0_id(OCSP_REQUEST *req, OCSP_CERTID *cid)
 
 /* Set requestorName from an X509_NAME structure */
 
-int OCSP_request_set1_name(OCSP_REQUEST *req, X509_NAME *nm)
+int __cdecl OCSP_request_set1_name(OCSP_REQUEST *req, X509_NAME *nm)
 {
     GENERAL_NAME *gen;
 
@@ -67,7 +67,7 @@ int OCSP_request_set1_name(OCSP_REQUEST *req, X509_NAME *nm)
 
 /* Add a certificate to an OCSP request */
 
-int OCSP_request_add1_cert(OCSP_REQUEST *req, X509 *cert)
+int __cdecl OCSP_request_add1_cert(OCSP_REQUEST *req, X509 *cert)
 {
     OCSP_SIGNATURE *sig;
     if (req->optionalSignature == NULL)
@@ -93,7 +93,7 @@ int OCSP_request_add1_cert(OCSP_REQUEST *req, X509 *cert)
  * in the request. Behaves like PKCS7_sign().
  */
 
-int OCSP_request_sign(OCSP_REQUEST *req,
+int __cdecl OCSP_request_sign(OCSP_REQUEST *req,
                       X509 *signer,
                       EVP_PKEY *key,
                       const EVP_MD *dgst,
@@ -136,7 +136,7 @@ int OCSP_request_sign(OCSP_REQUEST *req,
 
 /* Get response status */
 
-int OCSP_response_status(OCSP_RESPONSE *resp)
+int __cdecl OCSP_response_status(OCSP_RESPONSE *resp)
 {
     return ASN1_ENUMERATED_get(resp->responseStatus);
 }
@@ -146,7 +146,7 @@ int OCSP_response_status(OCSP_RESPONSE *resp)
  * present.
  */
 
-OCSP_BASICRESP *OCSP_response_get1_basic(OCSP_RESPONSE *resp)
+OCSP_BASICRESP * __cdecl OCSP_response_get1_basic(OCSP_RESPONSE *resp)
 {
     OCSP_RESPBYTES *rb;
     rb = resp->responseBytes;
@@ -162,17 +162,17 @@ OCSP_BASICRESP *OCSP_response_get1_basic(OCSP_RESPONSE *resp)
     return ASN1_item_unpack(rb->response, ASN1_ITEM_rptr(OCSP_BASICRESP));
 }
 
-const ASN1_OCTET_STRING *OCSP_resp_get0_signature(const OCSP_BASICRESP *bs)
+const ASN1_OCTET_STRING * __cdecl OCSP_resp_get0_signature(const OCSP_BASICRESP *bs)
 {
     return bs->signature;
 }
 
-const X509_ALGOR *OCSP_resp_get0_tbs_sigalg(const OCSP_BASICRESP *bs)
+const X509_ALGOR * __cdecl OCSP_resp_get0_tbs_sigalg(const OCSP_BASICRESP *bs)
 {
     return &bs->signatureAlgorithm;
 }
 
-const OCSP_RESPDATA *OCSP_resp_get0_respdata(const OCSP_BASICRESP *bs)
+const OCSP_RESPDATA * __cdecl OCSP_resp_get0_respdata(const OCSP_BASICRESP *bs)
 {
     return &bs->tbsResponseData;
 }
@@ -181,7 +181,7 @@ const OCSP_RESPDATA *OCSP_resp_get0_respdata(const OCSP_BASICRESP *bs)
  * Return number of OCSP_SINGLERESP responses present in a basic response.
  */
 
-int OCSP_resp_count(OCSP_BASICRESP *bs)
+int __cdecl OCSP_resp_count(OCSP_BASICRESP *bs)
 {
     if (!bs)
         return -1;
@@ -190,24 +190,24 @@ int OCSP_resp_count(OCSP_BASICRESP *bs)
 
 /* Extract an OCSP_SINGLERESP response with a given index */
 
-OCSP_SINGLERESP *OCSP_resp_get0(OCSP_BASICRESP *bs, int idx)
+OCSP_SINGLERESP * __cdecl OCSP_resp_get0(OCSP_BASICRESP *bs, int idx)
 {
     if (!bs)
         return NULL;
     return sk_OCSP_SINGLERESP_value(bs->tbsResponseData.responses, idx);
 }
 
-const ASN1_GENERALIZEDTIME *OCSP_resp_get0_produced_at(const OCSP_BASICRESP* bs)
+const ASN1_GENERALIZEDTIME * __cdecl OCSP_resp_get0_produced_at(const OCSP_BASICRESP* bs)
 {
     return bs->tbsResponseData.producedAt;
 }
 
-const STACK_OF(X509) *OCSP_resp_get0_certs(const OCSP_BASICRESP *bs)
+const STACK_OF(X509) * __cdecl OCSP_resp_get0_certs(const OCSP_BASICRESP *bs)
 {
     return bs->certs;
 }
 
-int OCSP_resp_get0_id(const OCSP_BASICRESP *bs,
+int __cdecl OCSP_resp_get0_id(const OCSP_BASICRESP *bs,
                       const ASN1_OCTET_STRING **pid,
                       const X509_NAME **pname)
 {
@@ -225,7 +225,7 @@ int OCSP_resp_get0_id(const OCSP_BASICRESP *bs,
     return 1;
 }
 
-int OCSP_resp_get1_id(const OCSP_BASICRESP *bs,
+int __cdecl OCSP_resp_get1_id(const OCSP_BASICRESP *bs,
                       ASN1_OCTET_STRING **pid,
                       X509_NAME **pname)
 {
@@ -247,7 +247,7 @@ int OCSP_resp_get1_id(const OCSP_BASICRESP *bs,
 
 /* Look single response matching a given certificate ID */
 
-int OCSP_resp_find(OCSP_BASICRESP *bs, OCSP_CERTID *id, int last)
+int __cdecl OCSP_resp_find(OCSP_BASICRESP *bs, OCSP_CERTID *id, int last)
 {
     int i;
     STACK_OF(OCSP_SINGLERESP) *sresp;
@@ -273,7 +273,7 @@ int OCSP_resp_find(OCSP_BASICRESP *bs, OCSP_CERTID *id, int last)
  * revoked. Returns numerical value of status.
  */
 
-int OCSP_single_get0_status(OCSP_SINGLERESP *single, int *reason,
+int __cdecl OCSP_single_get0_status(OCSP_SINGLERESP *single, int *reason,
                             ASN1_GENERALIZEDTIME **revtime,
                             ASN1_GENERALIZEDTIME **thisupd,
                             ASN1_GENERALIZEDTIME **nextupd)
@@ -307,7 +307,7 @@ int OCSP_single_get0_status(OCSP_SINGLERESP *single, int *reason,
  * found extract status information. Return 0 is successful.
  */
 
-int OCSP_resp_find_status(OCSP_BASICRESP *bs, OCSP_CERTID *id, int *status,
+int __cdecl OCSP_resp_find_status(OCSP_BASICRESP *bs, OCSP_CERTID *id, int *status,
                           int *reason,
                           ASN1_GENERALIZEDTIME **revtime,
                           ASN1_GENERALIZEDTIME **thisupd,
@@ -335,7 +335,7 @@ int OCSP_resp_find_status(OCSP_BASICRESP *bs, OCSP_CERTID *id, int *status,
  * parameter specifies the maximum age the thisUpdate field can be.
  */
 
-int OCSP_check_validity(ASN1_GENERALIZEDTIME *thisupd,
+int __cdecl OCSP_check_validity(ASN1_GENERALIZEDTIME *thisupd,
                         ASN1_GENERALIZEDTIME *nextupd, long nsec, long maxsec)
 {
     int ret = 1;
@@ -390,7 +390,7 @@ int OCSP_check_validity(ASN1_GENERALIZEDTIME *thisupd,
     return ret;
 }
 
-const OCSP_CERTID *OCSP_SINGLERESP_get0_id(const OCSP_SINGLERESP *single)
+const OCSP_CERTID * __cdecl OCSP_SINGLERESP_get0_id(const OCSP_SINGLERESP *single)
 {
     return single->certId;
 }
diff --git a/crypto/ocsp/ocsp_err.c b/crypto/ocsp/ocsp_err.c
index 660e193665..6b4c8eb9c1 100644
--- a/crypto/ocsp/ocsp_err.c
+++ b/crypto/ocsp/ocsp_err.c
@@ -89,7 +89,7 @@ static const ERR_STRING_DATA OCSP_str_reasons[] = {
 
 #endif
 
-int ERR_load_OCSP_strings(void)
+int __cdecl ERR_load_OCSP_strings(void)
 {
 #ifndef OPENSSL_NO_ERR
     if (ERR_func_error_string(OCSP_str_functs[0].error) == NULL) {
diff --git a/crypto/ocsp/ocsp_ext.c b/crypto/ocsp/ocsp_ext.c
index 3ab5308a12..6e5fb668c5 100644
--- a/crypto/ocsp/ocsp_ext.c
+++ b/crypto/ocsp/ocsp_ext.c
@@ -20,53 +20,53 @@
 
 /* OCSP request extensions */
 
-int OCSP_REQUEST_get_ext_count(OCSP_REQUEST *x)
+int __cdecl OCSP_REQUEST_get_ext_count(OCSP_REQUEST *x)
 {
     return X509v3_get_ext_count(x->tbsRequest.requestExtensions);
 }
 
-int OCSP_REQUEST_get_ext_by_NID(OCSP_REQUEST *x, int nid, int lastpos)
+int __cdecl OCSP_REQUEST_get_ext_by_NID(OCSP_REQUEST *x, int nid, int lastpos)
 {
     return (X509v3_get_ext_by_NID
             (x->tbsRequest.requestExtensions, nid, lastpos));
 }
 
-int OCSP_REQUEST_get_ext_by_OBJ(OCSP_REQUEST *x, const ASN1_OBJECT *obj,
+int __cdecl OCSP_REQUEST_get_ext_by_OBJ(OCSP_REQUEST *x, const ASN1_OBJECT *obj,
                                 int lastpos)
 {
     return (X509v3_get_ext_by_OBJ
             (x->tbsRequest.requestExtensions, obj, lastpos));
 }
 
-int OCSP_REQUEST_get_ext_by_critical(OCSP_REQUEST *x, int crit, int lastpos)
+int __cdecl OCSP_REQUEST_get_ext_by_critical(OCSP_REQUEST *x, int crit, int lastpos)
 {
     return (X509v3_get_ext_by_critical
             (x->tbsRequest.requestExtensions, crit, lastpos));
 }
 
-X509_EXTENSION *OCSP_REQUEST_get_ext(OCSP_REQUEST *x, int loc)
+X509_EXTENSION * __cdecl OCSP_REQUEST_get_ext(OCSP_REQUEST *x, int loc)
 {
     return X509v3_get_ext(x->tbsRequest.requestExtensions, loc);
 }
 
-X509_EXTENSION *OCSP_REQUEST_delete_ext(OCSP_REQUEST *x, int loc)
+X509_EXTENSION * __cdecl OCSP_REQUEST_delete_ext(OCSP_REQUEST *x, int loc)
 {
     return X509v3_delete_ext(x->tbsRequest.requestExtensions, loc);
 }
 
-void *OCSP_REQUEST_get1_ext_d2i(OCSP_REQUEST *x, int nid, int *crit, int *idx)
+void * __cdecl OCSP_REQUEST_get1_ext_d2i(OCSP_REQUEST *x, int nid, int *crit, int *idx)
 {
     return X509V3_get_d2i(x->tbsRequest.requestExtensions, nid, crit, idx);
 }
 
-int OCSP_REQUEST_add1_ext_i2d(OCSP_REQUEST *x, int nid, void *value, int crit,
+int __cdecl OCSP_REQUEST_add1_ext_i2d(OCSP_REQUEST *x, int nid, void *value, int crit,
                               unsigned long flags)
 {
     return X509V3_add1_i2d(&x->tbsRequest.requestExtensions, nid, value,
                            crit, flags);
 }
 
-int OCSP_REQUEST_add_ext(OCSP_REQUEST *x, X509_EXTENSION *ex, int loc)
+int __cdecl OCSP_REQUEST_add_ext(OCSP_REQUEST *x, X509_EXTENSION *ex, int loc)
 {
     return (X509v3_add_ext(&(x->tbsRequest.requestExtensions), ex, loc) !=
             NULL);
@@ -74,107 +74,107 @@ int OCSP_REQUEST_add_ext(OCSP_REQUEST *x, X509_EXTENSION *ex, int loc)
 
 /* Single extensions */
 
-int OCSP_ONEREQ_get_ext_count(OCSP_ONEREQ *x)
+int __cdecl OCSP_ONEREQ_get_ext_count(OCSP_ONEREQ *x)
 {
     return X509v3_get_ext_count(x->singleRequestExtensions);
 }
 
-int OCSP_ONEREQ_get_ext_by_NID(OCSP_ONEREQ *x, int nid, int lastpos)
+int __cdecl OCSP_ONEREQ_get_ext_by_NID(OCSP_ONEREQ *x, int nid, int lastpos)
 {
     return X509v3_get_ext_by_NID(x->singleRequestExtensions, nid, lastpos);
 }
 
-int OCSP_ONEREQ_get_ext_by_OBJ(OCSP_ONEREQ *x, const ASN1_OBJECT *obj,
+int __cdecl OCSP_ONEREQ_get_ext_by_OBJ(OCSP_ONEREQ *x, const ASN1_OBJECT *obj,
                                int lastpos)
 {
     return X509v3_get_ext_by_OBJ(x->singleRequestExtensions, obj, lastpos);
 }
 
-int OCSP_ONEREQ_get_ext_by_critical(OCSP_ONEREQ *x, int crit, int lastpos)
+int __cdecl OCSP_ONEREQ_get_ext_by_critical(OCSP_ONEREQ *x, int crit, int lastpos)
 {
     return (X509v3_get_ext_by_critical
             (x->singleRequestExtensions, crit, lastpos));
 }
 
-X509_EXTENSION *OCSP_ONEREQ_get_ext(OCSP_ONEREQ *x, int loc)
+X509_EXTENSION * __cdecl OCSP_ONEREQ_get_ext(OCSP_ONEREQ *x, int loc)
 {
     return X509v3_get_ext(x->singleRequestExtensions, loc);
 }
 
-X509_EXTENSION *OCSP_ONEREQ_delete_ext(OCSP_ONEREQ *x, int loc)
+X509_EXTENSION * __cdecl OCSP_ONEREQ_delete_ext(OCSP_ONEREQ *x, int loc)
 {
     return X509v3_delete_ext(x->singleRequestExtensions, loc);
 }
 
-void *OCSP_ONEREQ_get1_ext_d2i(OCSP_ONEREQ *x, int nid, int *crit, int *idx)
+void * __cdecl OCSP_ONEREQ_get1_ext_d2i(OCSP_ONEREQ *x, int nid, int *crit, int *idx)
 {
     return X509V3_get_d2i(x->singleRequestExtensions, nid, crit, idx);
 }
 
-int OCSP_ONEREQ_add1_ext_i2d(OCSP_ONEREQ *x, int nid, void *value, int crit,
+int __cdecl OCSP_ONEREQ_add1_ext_i2d(OCSP_ONEREQ *x, int nid, void *value, int crit,
                              unsigned long flags)
 {
     return X509V3_add1_i2d(&x->singleRequestExtensions, nid, value, crit,
                            flags);
 }
 
-int OCSP_ONEREQ_add_ext(OCSP_ONEREQ *x, X509_EXTENSION *ex, int loc)
+int __cdecl OCSP_ONEREQ_add_ext(OCSP_ONEREQ *x, X509_EXTENSION *ex, int loc)
 {
     return (X509v3_add_ext(&(x->singleRequestExtensions), ex, loc) != NULL);
 }
 
 /* OCSP Basic response */
 
-int OCSP_BASICRESP_get_ext_count(OCSP_BASICRESP *x)
+int __cdecl OCSP_BASICRESP_get_ext_count(OCSP_BASICRESP *x)
 {
     return X509v3_get_ext_count(x->tbsResponseData.responseExtensions);
 }
 
-int OCSP_BASICRESP_get_ext_by_NID(OCSP_BASICRESP *x, int nid, int lastpos)
+int __cdecl OCSP_BASICRESP_get_ext_by_NID(OCSP_BASICRESP *x, int nid, int lastpos)
 {
     return (X509v3_get_ext_by_NID
             (x->tbsResponseData.responseExtensions, nid, lastpos));
 }
 
-int OCSP_BASICRESP_get_ext_by_OBJ(OCSP_BASICRESP *x, const ASN1_OBJECT *obj,
+int __cdecl OCSP_BASICRESP_get_ext_by_OBJ(OCSP_BASICRESP *x, const ASN1_OBJECT *obj,
                                   int lastpos)
 {
     return (X509v3_get_ext_by_OBJ
             (x->tbsResponseData.responseExtensions, obj, lastpos));
 }
 
-int OCSP_BASICRESP_get_ext_by_critical(OCSP_BASICRESP *x, int crit,
+int __cdecl OCSP_BASICRESP_get_ext_by_critical(OCSP_BASICRESP *x, int crit,
                                        int lastpos)
 {
     return (X509v3_get_ext_by_critical
             (x->tbsResponseData.responseExtensions, crit, lastpos));
 }
 
-X509_EXTENSION *OCSP_BASICRESP_get_ext(OCSP_BASICRESP *x, int loc)
+X509_EXTENSION * __cdecl OCSP_BASICRESP_get_ext(OCSP_BASICRESP *x, int loc)
 {
     return X509v3_get_ext(x->tbsResponseData.responseExtensions, loc);
 }
 
-X509_EXTENSION *OCSP_BASICRESP_delete_ext(OCSP_BASICRESP *x, int loc)
+X509_EXTENSION * __cdecl OCSP_BASICRESP_delete_ext(OCSP_BASICRESP *x, int loc)
 {
     return X509v3_delete_ext(x->tbsResponseData.responseExtensions, loc);
 }
 
-void *OCSP_BASICRESP_get1_ext_d2i(OCSP_BASICRESP *x, int nid, int *crit,
+void * __cdecl OCSP_BASICRESP_get1_ext_d2i(OCSP_BASICRESP *x, int nid, int *crit,
                                   int *idx)
 {
     return X509V3_get_d2i(x->tbsResponseData.responseExtensions, nid, crit,
                           idx);
 }
 
-int OCSP_BASICRESP_add1_ext_i2d(OCSP_BASICRESP *x, int nid, void *value,
+int __cdecl OCSP_BASICRESP_add1_ext_i2d(OCSP_BASICRESP *x, int nid, void *value,
                                 int crit, unsigned long flags)
 {
     return X509V3_add1_i2d(&x->tbsResponseData.responseExtensions, nid,
                            value, crit, flags);
 }
 
-int OCSP_BASICRESP_add_ext(OCSP_BASICRESP *x, X509_EXTENSION *ex, int loc)
+int __cdecl OCSP_BASICRESP_add_ext(OCSP_BASICRESP *x, X509_EXTENSION *ex, int loc)
 {
     return (X509v3_add_ext(&(x->tbsResponseData.responseExtensions), ex, loc)
             != NULL);
@@ -182,51 +182,51 @@ int OCSP_BASICRESP_add_ext(OCSP_BASICRESP *x, X509_EXTENSION *ex, int loc)
 
 /* OCSP single response extensions */
 
-int OCSP_SINGLERESP_get_ext_count(OCSP_SINGLERESP *x)
+int __cdecl OCSP_SINGLERESP_get_ext_count(OCSP_SINGLERESP *x)
 {
     return X509v3_get_ext_count(x->singleExtensions);
 }
 
-int OCSP_SINGLERESP_get_ext_by_NID(OCSP_SINGLERESP *x, int nid, int lastpos)
+int __cdecl OCSP_SINGLERESP_get_ext_by_NID(OCSP_SINGLERESP *x, int nid, int lastpos)
 {
     return X509v3_get_ext_by_NID(x->singleExtensions, nid, lastpos);
 }
 
-int OCSP_SINGLERESP_get_ext_by_OBJ(OCSP_SINGLERESP *x, const ASN1_OBJECT *obj,
+int __cdecl OCSP_SINGLERESP_get_ext_by_OBJ(OCSP_SINGLERESP *x, const ASN1_OBJECT *obj,
                                    int lastpos)
 {
     return X509v3_get_ext_by_OBJ(x->singleExtensions, obj, lastpos);
 }
 
-int OCSP_SINGLERESP_get_ext_by_critical(OCSP_SINGLERESP *x, int crit,
+int __cdecl OCSP_SINGLERESP_get_ext_by_critical(OCSP_SINGLERESP *x, int crit,
                                         int lastpos)
 {
     return X509v3_get_ext_by_critical(x->singleExtensions, crit, lastpos);
 }
 
-X509_EXTENSION *OCSP_SINGLERESP_get_ext(OCSP_SINGLERESP *x, int loc)
+X509_EXTENSION * __cdecl OCSP_SINGLERESP_get_ext(OCSP_SINGLERESP *x, int loc)
 {
     return X509v3_get_ext(x->singleExtensions, loc);
 }
 
-X509_EXTENSION *OCSP_SINGLERESP_delete_ext(OCSP_SINGLERESP *x, int loc)
+X509_EXTENSION * __cdecl OCSP_SINGLERESP_delete_ext(OCSP_SINGLERESP *x, int loc)
 {
     return X509v3_delete_ext(x->singleExtensions, loc);
 }
 
-void *OCSP_SINGLERESP_get1_ext_d2i(OCSP_SINGLERESP *x, int nid, int *crit,
+void * __cdecl OCSP_SINGLERESP_get1_ext_d2i(OCSP_SINGLERESP *x, int nid, int *crit,
                                    int *idx)
 {
     return X509V3_get_d2i(x->singleExtensions, nid, crit, idx);
 }
 
-int OCSP_SINGLERESP_add1_ext_i2d(OCSP_SINGLERESP *x, int nid, void *value,
+int __cdecl OCSP_SINGLERESP_add1_ext_i2d(OCSP_SINGLERESP *x, int nid, void *value,
                                  int crit, unsigned long flags)
 {
     return X509V3_add1_i2d(&x->singleExtensions, nid, value, crit, flags);
 }
 
-int OCSP_SINGLERESP_add_ext(OCSP_SINGLERESP *x, X509_EXTENSION *ex, int loc)
+int __cdecl OCSP_SINGLERESP_add_ext(OCSP_SINGLERESP *x, X509_EXTENSION *ex, int loc)
 {
     return (X509v3_add_ext(&(x->singleExtensions), ex, loc) != NULL);
 }
@@ -279,14 +279,14 @@ static int ocsp_add1_nonce(STACK_OF(X509_EXTENSION) **exts,
 
 /* Add nonce to an OCSP request */
 
-int OCSP_request_add1_nonce(OCSP_REQUEST *req, unsigned char *val, int len)
+int __cdecl OCSP_request_add1_nonce(OCSP_REQUEST *req, unsigned char *val, int len)
 {
     return ocsp_add1_nonce(&req->tbsRequest.requestExtensions, val, len);
 }
 
 /* Same as above but for a response */
 
-int OCSP_basic_add1_nonce(OCSP_BASICRESP *resp, unsigned char *val, int len)
+int __cdecl OCSP_basic_add1_nonce(OCSP_BASICRESP *resp, unsigned char *val, int len)
 {
     return ocsp_add1_nonce(&resp->tbsResponseData.responseExtensions, val,
                            len);
@@ -306,7 +306,7 @@ int OCSP_basic_add1_nonce(OCSP_BASICRESP *resp, unsigned char *val, int len)
  *  necessary. return == 0 is always an error.
  */
 
-int OCSP_check_nonce(OCSP_REQUEST *req, OCSP_BASICRESP *bs)
+int __cdecl OCSP_check_nonce(OCSP_REQUEST *req, OCSP_BASICRESP *bs)
 {
     /*
      * Since we are only interested in the presence or absence of
@@ -344,7 +344,7 @@ int OCSP_check_nonce(OCSP_REQUEST *req, OCSP_BASICRESP *bs)
  * Copy the nonce value (if any) from an OCSP request to a response.
  */
 
-int OCSP_copy_nonce(OCSP_BASICRESP *resp, OCSP_REQUEST *req)
+int __cdecl OCSP_copy_nonce(OCSP_BASICRESP *resp, OCSP_REQUEST *req)
 {
     X509_EXTENSION *req_ext;
     int req_idx;
@@ -357,7 +357,7 @@ int OCSP_copy_nonce(OCSP_BASICRESP *resp, OCSP_REQUEST *req)
     return OCSP_BASICRESP_add_ext(resp, req_ext, -1);
 }
 
-X509_EXTENSION *OCSP_crlID_new(const char *url, long *n, char *tim)
+X509_EXTENSION * __cdecl OCSP_crlID_new(const char *url, long *n, char *tim)
 {
     X509_EXTENSION *x = NULL;
     OCSP_CRLID *cid = NULL;
@@ -389,7 +389,7 @@ X509_EXTENSION *OCSP_crlID_new(const char *url, long *n, char *tim)
 }
 
 /*   AcceptableResponses ::= SEQUENCE OF OBJECT IDENTIFIER */
-X509_EXTENSION *OCSP_accept_responses_new(char **oids)
+X509_EXTENSION * __cdecl OCSP_accept_responses_new(char **oids)
 {
     int nid;
     STACK_OF(ASN1_OBJECT) *sk = NULL;
@@ -410,7 +410,7 @@ X509_EXTENSION *OCSP_accept_responses_new(char **oids)
 }
 
 /*  ArchiveCutoff ::= GeneralizedTime */
-X509_EXTENSION *OCSP_archive_cutoff_new(char *tim)
+X509_EXTENSION * __cdecl OCSP_archive_cutoff_new(char *tim)
 {
     X509_EXTENSION *x = NULL;
     ASN1_GENERALIZEDTIME *gt = NULL;
@@ -430,7 +430,7 @@ X509_EXTENSION *OCSP_archive_cutoff_new(char *tim)
  * two--NID_ad_ocsp, NID_id_ad_caIssuers--and GeneralName value.  This method
  * forces NID_ad_ocsp and uniformResourceLocator [6] IA5String.
  */
-X509_EXTENSION *OCSP_url_svcloc_new(X509_NAME *issuer, const char **urls)
+X509_EXTENSION * __cdecl OCSP_url_svcloc_new(X509_NAME *issuer, const char **urls)
 {
     X509_EXTENSION *x = NULL;
     ASN1_IA5STRING *ia5 = NULL;
diff --git a/crypto/ocsp/ocsp_ht.c b/crypto/ocsp/ocsp_ht.c
index 42c3686431..b1aabd82f8 100644
--- a/crypto/ocsp/ocsp_ht.c
+++ b/crypto/ocsp/ocsp_ht.c
@@ -61,7 +61,7 @@ struct ocsp_req_ctx_st {
 
 static int parse_http_line1(char *line);
 
-OCSP_REQ_CTX *OCSP_REQ_CTX_new(BIO *io, int maxline)
+OCSP_REQ_CTX * __cdecl OCSP_REQ_CTX_new(BIO *io, int maxline)
 {
     OCSP_REQ_CTX *rctx = OPENSSL_zalloc(sizeof(*rctx));
 
@@ -83,7 +83,7 @@ OCSP_REQ_CTX *OCSP_REQ_CTX_new(BIO *io, int maxline)
     return rctx;
 }
 
-void OCSP_REQ_CTX_free(OCSP_REQ_CTX *rctx)
+void __cdecl OCSP_REQ_CTX_free(OCSP_REQ_CTX *rctx)
 {
     if (!rctx)
         return;
@@ -92,12 +92,12 @@ void OCSP_REQ_CTX_free(OCSP_REQ_CTX *rctx)
     OPENSSL_free(rctx);
 }
 
-BIO *OCSP_REQ_CTX_get0_mem_bio(OCSP_REQ_CTX *rctx)
+BIO * __cdecl OCSP_REQ_CTX_get0_mem_bio(OCSP_REQ_CTX *rctx)
 {
     return rctx->mem;
 }
 
-void OCSP_set_max_response_length(OCSP_REQ_CTX *rctx, unsigned long len)
+void __cdecl OCSP_set_max_response_length(OCSP_REQ_CTX *rctx, unsigned long len)
 {
     if (len == 0)
         rctx->max_resp_len = OCSP_MAX_RESP_LENGTH;
@@ -105,7 +105,7 @@ void OCSP_set_max_response_length(OCSP_REQ_CTX *rctx, unsigned long len)
         rctx->max_resp_len = len;
 }
 
-int OCSP_REQ_CTX_i2d(OCSP_REQ_CTX *rctx, const ASN1_ITEM *it, ASN1_VALUE *val)
+int __cdecl OCSP_REQ_CTX_i2d(OCSP_REQ_CTX *rctx, const ASN1_ITEM *it, ASN1_VALUE *val)
 {
     static const char req_hdr[] =
         "Content-Type: application/ocsp-request\r\n"
@@ -119,7 +119,7 @@ int OCSP_REQ_CTX_i2d(OCSP_REQ_CTX *rctx, const ASN1_ITEM *it, ASN1_VALUE *val)
     return 1;
 }
 
-int OCSP_REQ_CTX_nbio_d2i(OCSP_REQ_CTX *rctx,
+int __cdecl OCSP_REQ_CTX_nbio_d2i(OCSP_REQ_CTX *rctx,
                           ASN1_VALUE **pval, const ASN1_ITEM *it)
 {
     int rv, len;
@@ -138,7 +138,7 @@ int OCSP_REQ_CTX_nbio_d2i(OCSP_REQ_CTX *rctx,
     return 1;
 }
 
-int OCSP_REQ_CTX_http(OCSP_REQ_CTX *rctx, const char *op, const char *path)
+int __cdecl OCSP_REQ_CTX_http(OCSP_REQ_CTX *rctx, const char *op, const char *path)
 {
     static const char http_hdr[] = "%s %s HTTP/1.0\r\n";
 
@@ -151,13 +151,13 @@ int OCSP_REQ_CTX_http(OCSP_REQ_CTX *rctx, const char *op, const char *path)
     return 1;
 }
 
-int OCSP_REQ_CTX_set1_req(OCSP_REQ_CTX *rctx, OCSP_REQUEST *req)
+int __cdecl OCSP_REQ_CTX_set1_req(OCSP_REQ_CTX *rctx, OCSP_REQUEST *req)
 {
     return OCSP_REQ_CTX_i2d(rctx, ASN1_ITEM_rptr(OCSP_REQUEST),
                             (ASN1_VALUE *)req);
 }
 
-int OCSP_REQ_CTX_add1_header(OCSP_REQ_CTX *rctx,
+int __cdecl OCSP_REQ_CTX_add1_header(OCSP_REQ_CTX *rctx,
                              const char *name, const char *value)
 {
     if (!name)
@@ -176,7 +176,7 @@ int OCSP_REQ_CTX_add1_header(OCSP_REQ_CTX *rctx,
     return 1;
 }
 
-OCSP_REQ_CTX *OCSP_sendreq_new(BIO *io, const char *path, OCSP_REQUEST *req,
+OCSP_REQ_CTX * __cdecl OCSP_sendreq_new(BIO *io, const char *path, OCSP_REQUEST *req,
                                int maxline)
 {
 
@@ -269,7 +269,7 @@ static int parse_http_line1(char *line)
 
 }
 
-int OCSP_REQ_CTX_nbio(OCSP_REQ_CTX *rctx)
+int __cdecl OCSP_REQ_CTX_nbio(OCSP_REQ_CTX *rctx)
 {
     int i, n;
     const unsigned char *p;
@@ -469,7 +469,7 @@ int OCSP_REQ_CTX_nbio(OCSP_REQ_CTX *rctx)
 
 }
 
-int OCSP_sendreq_nbio(OCSP_RESPONSE **presp, OCSP_REQ_CTX *rctx)
+int __cdecl OCSP_sendreq_nbio(OCSP_RESPONSE **presp, OCSP_REQ_CTX *rctx)
 {
     return OCSP_REQ_CTX_nbio_d2i(rctx,
                                  (ASN1_VALUE **)presp,
@@ -478,7 +478,7 @@ int OCSP_sendreq_nbio(OCSP_RESPONSE **presp, OCSP_REQ_CTX *rctx)
 
 /* Blocking OCSP request handler: now a special case of non-blocking I/O */
 
-OCSP_RESPONSE *OCSP_sendreq_bio(BIO *b, const char *path, OCSP_REQUEST *req)
+OCSP_RESPONSE * __cdecl OCSP_sendreq_bio(BIO *b, const char *path, OCSP_REQUEST *req)
 {
     OCSP_RESPONSE *resp = NULL;
     OCSP_REQ_CTX *ctx;
diff --git a/crypto/ocsp/ocsp_lib.c b/crypto/ocsp/ocsp_lib.c
index b8b91cc9eb..81084ae167 100644
--- a/crypto/ocsp/ocsp_lib.c
+++ b/crypto/ocsp/ocsp_lib.c
@@ -19,7 +19,7 @@
 
 /* Convert a certificate and its issuer to an OCSP_CERTID */
 
-OCSP_CERTID *OCSP_cert_to_id(const EVP_MD *dgst, const X509 *subject,
+OCSP_CERTID * __cdecl OCSP_cert_to_id(const EVP_MD *dgst, const X509 *subject,
                              const X509 *issuer)
 {
     X509_NAME *iname;
@@ -38,7 +38,7 @@ OCSP_CERTID *OCSP_cert_to_id(const EVP_MD *dgst, const X509 *subject,
     return OCSP_cert_id_new(dgst, iname, ikey, serial);
 }
 
-OCSP_CERTID *OCSP_cert_id_new(const EVP_MD *dgst,
+OCSP_CERTID * __cdecl OCSP_cert_id_new(const EVP_MD *dgst,
                               const X509_NAME *issuerName,
                               const ASN1_BIT_STRING *issuerKey,
                               const ASN1_INTEGER *serialNumber)
@@ -88,7 +88,7 @@ OCSP_CERTID *OCSP_cert_id_new(const EVP_MD *dgst,
     return NULL;
 }
 
-int OCSP_id_issuer_cmp(const OCSP_CERTID *a, const OCSP_CERTID *b)
+int __cdecl OCSP_id_issuer_cmp(const OCSP_CERTID *a, const OCSP_CERTID *b)
 {
     int ret;
     ret = OBJ_cmp(a->hashAlgorithm.algorithm, b->hashAlgorithm.algorithm);
@@ -100,7 +100,7 @@ int OCSP_id_issuer_cmp(const OCSP_CERTID *a, const OCSP_CERTID *b)
     return ASN1_OCTET_STRING_cmp(&a->issuerKeyHash, &b->issuerKeyHash);
 }
 
-int OCSP_id_cmp(const OCSP_CERTID *a, const OCSP_CERTID *b)
+int __cdecl OCSP_id_cmp(const OCSP_CERTID *a, const OCSP_CERTID *b)
 {
     int ret;
     ret = OCSP_id_issuer_cmp(a, b);
@@ -114,7 +114,7 @@ int OCSP_id_cmp(const OCSP_CERTID *a, const OCSP_CERTID *b)
  * whether it is SSL.
  */
 
-int OCSP_parse_url(const char *url, char **phost, char **pport, char **ppath,
+int __cdecl OCSP_parse_url(const char *url, char **phost, char **pport, char **ppath,
                    int *pssl)
 {
     char *p, *buf;
diff --git a/crypto/ocsp/ocsp_prn.c b/crypto/ocsp/ocsp_prn.c
index 5605812ef7..abba225944 100644
--- a/crypto/ocsp/ocsp_prn.c
+++ b/crypto/ocsp/ocsp_prn.c
@@ -46,7 +46,7 @@ static const char *do_table2string(long s, const OCSP_TBLSTR *ts, size_t len)
 
 #define table2string(s, tbl) do_table2string(s, tbl, OSSL_NELEM(tbl))
 
-const char *OCSP_response_status_str(long s)
+const char * __cdecl OCSP_response_status_str(long s)
 {
     static const OCSP_TBLSTR rstat_tbl[] = {
         {OCSP_RESPONSE_STATUS_SUCCESSFUL, "successful"},
@@ -59,7 +59,7 @@ const char *OCSP_response_status_str(long s)
     return table2string(s, rstat_tbl);
 }
 
-const char *OCSP_cert_status_str(long s)
+const char * __cdecl OCSP_cert_status_str(long s)
 {
     static const OCSP_TBLSTR cstat_tbl[] = {
         {V_OCSP_CERTSTATUS_GOOD, "good"},
@@ -69,7 +69,7 @@ const char *OCSP_cert_status_str(long s)
     return table2string(s, cstat_tbl);
 }
 
-const char *OCSP_crl_reason_str(long s)
+const char * __cdecl OCSP_crl_reason_str(long s)
 {
     static const OCSP_TBLSTR reason_tbl[] = {
         {OCSP_REVOKED_STATUS_UNSPECIFIED, "unspecified"},
@@ -84,7 +84,7 @@ const char *OCSP_crl_reason_str(long s)
     return table2string(s, reason_tbl);
 }
 
-int OCSP_REQUEST_print(BIO *bp, OCSP_REQUEST *o, unsigned long flags)
+int __cdecl OCSP_REQUEST_print(BIO *bp, OCSP_REQUEST *o, unsigned long flags)
 {
     int i;
     long l;
@@ -129,7 +129,7 @@ int OCSP_REQUEST_print(BIO *bp, OCSP_REQUEST *o, unsigned long flags)
     return 0;
 }
 
-int OCSP_RESPONSE_print(BIO *bp, OCSP_RESPONSE *o, unsigned long flags)
+int __cdecl OCSP_RESPONSE_print(BIO *bp, OCSP_RESPONSE *o, unsigned long flags)
 {
     int i, ret = 0;
     long l;
diff --git a/crypto/ocsp/ocsp_srv.c b/crypto/ocsp/ocsp_srv.c
index 6bd6f7b6d8..0cf4e6b2f6 100644
--- a/crypto/ocsp/ocsp_srv.c
+++ b/crypto/ocsp/ocsp_srv.c
@@ -21,22 +21,22 @@
  * relevant information from the request.
  */
 
-int OCSP_request_onereq_count(OCSP_REQUEST *req)
+int __cdecl OCSP_request_onereq_count(OCSP_REQUEST *req)
 {
     return sk_OCSP_ONEREQ_num(req->tbsRequest.requestList);
 }
 
-OCSP_ONEREQ *OCSP_request_onereq_get0(OCSP_REQUEST *req, int i)
+OCSP_ONEREQ * __cdecl OCSP_request_onereq_get0(OCSP_REQUEST *req, int i)
 {
     return sk_OCSP_ONEREQ_value(req->tbsRequest.requestList, i);
 }
 
-OCSP_CERTID *OCSP_onereq_get0_id(OCSP_ONEREQ *one)
+OCSP_CERTID * __cdecl OCSP_onereq_get0_id(OCSP_ONEREQ *one)
 {
     return one->reqCert;
 }
 
-int OCSP_id_get0_info(ASN1_OCTET_STRING **piNameHash, ASN1_OBJECT **pmd,
+int __cdecl OCSP_id_get0_info(ASN1_OCTET_STRING **piNameHash, ASN1_OBJECT **pmd,
                       ASN1_OCTET_STRING **pikeyHash,
                       ASN1_INTEGER **pserial, OCSP_CERTID *cid)
 {
@@ -53,7 +53,7 @@ int OCSP_id_get0_info(ASN1_OCTET_STRING **piNameHash, ASN1_OBJECT **pmd,
     return 1;
 }
 
-int OCSP_request_is_signed(OCSP_REQUEST *req)
+int __cdecl OCSP_request_is_signed(OCSP_REQUEST *req)
 {
     if (req->optionalSignature)
         return 1;
@@ -61,7 +61,7 @@ int OCSP_request_is_signed(OCSP_REQUEST *req)
 }
 
 /* Create an OCSP response and encode an optional basic response */
-OCSP_RESPONSE *OCSP_response_create(int status, OCSP_BASICRESP *bs)
+OCSP_RESPONSE * __cdecl OCSP_response_create(int status, OCSP_BASICRESP *bs)
 {
     OCSP_RESPONSE *rsp = NULL;
 
@@ -83,7 +83,7 @@ OCSP_RESPONSE *OCSP_response_create(int status, OCSP_BASICRESP *bs)
     return NULL;
 }
 
-OCSP_SINGLERESP *OCSP_basic_add1_status(OCSP_BASICRESP *rsp,
+OCSP_SINGLERESP * __cdecl OCSP_basic_add1_status(OCSP_BASICRESP *rsp,
                                         OCSP_CERTID *cid,
                                         int status, int reason,
                                         ASN1_TIME *revtime,
@@ -156,7 +156,7 @@ OCSP_SINGLERESP *OCSP_basic_add1_status(OCSP_BASICRESP *rsp,
 
 /* Add a certificate to an OCSP request */
 
-int OCSP_basic_add1_cert(OCSP_BASICRESP *resp, X509 *cert)
+int __cdecl OCSP_basic_add1_cert(OCSP_BASICRESP *resp, X509 *cert)
 {
     if (resp->certs == NULL
         && (resp->certs = sk_X509_new_null()) == NULL)
@@ -174,7 +174,7 @@ int OCSP_basic_add1_cert(OCSP_BASICRESP *resp, X509 *cert)
  * include one or more optional certificates in the response.
  */
 
-int OCSP_basic_sign_ctx(OCSP_BASICRESP *brsp,
+int __cdecl OCSP_basic_sign_ctx(OCSP_BASICRESP *brsp,
                     X509 *signer, EVP_MD_CTX *ctx,
                     STACK_OF(X509) *certs, unsigned long flags)
 {
@@ -229,7 +229,7 @@ int OCSP_basic_sign_ctx(OCSP_BASICRESP *brsp,
     return 0;
 }
 
-int OCSP_basic_sign(OCSP_BASICRESP *brsp,
+int __cdecl OCSP_basic_sign(OCSP_BASICRESP *brsp,
                     X509 *signer, EVP_PKEY *key, const EVP_MD *dgst,
                     STACK_OF(X509) *certs, unsigned long flags)
 {
@@ -249,7 +249,7 @@ int OCSP_basic_sign(OCSP_BASICRESP *brsp,
     return i;
 }
 
-int OCSP_RESPID_set_by_name(OCSP_RESPID *respid, X509 *cert)
+int __cdecl OCSP_RESPID_set_by_name(OCSP_RESPID *respid, X509 *cert)
 {
     if (!X509_NAME_set(&respid->value.byName, X509_get_subject_name(cert)))
         return 0;
@@ -259,7 +259,7 @@ int OCSP_RESPID_set_by_name(OCSP_RESPID *respid, X509 *cert)
     return 1;
 }
 
-int OCSP_RESPID_set_by_key(OCSP_RESPID *respid, X509 *cert)
+int __cdecl OCSP_RESPID_set_by_key(OCSP_RESPID *respid, X509 *cert)
 {
     ASN1_OCTET_STRING *byKey = NULL;
     unsigned char md[SHA_DIGEST_LENGTH];
@@ -283,7 +283,7 @@ int OCSP_RESPID_set_by_key(OCSP_RESPID *respid, X509 *cert)
     return 1;
 }
 
-int OCSP_RESPID_match(OCSP_RESPID *respid, X509 *cert)
+int __cdecl OCSP_RESPID_match(OCSP_RESPID *respid, X509 *cert)
 {
     if (respid->type == V_OCSP_RESPID_KEY) {
         unsigned char md[SHA_DIGEST_LENGTH];
diff --git a/crypto/ocsp/ocsp_vfy.c b/crypto/ocsp/ocsp_vfy.c
index 9a8d343866..e6933c19ef 100644
--- a/crypto/ocsp/ocsp_vfy.c
+++ b/crypto/ocsp/ocsp_vfy.c
@@ -27,7 +27,7 @@ static int ocsp_req_find_signer(X509 **psigner, OCSP_REQUEST *req,
 
 /* Verify a basic response message */
 
-int OCSP_basic_verify(OCSP_BASICRESP *bs, STACK_OF(X509) *certs,
+int __cdecl OCSP_basic_verify(OCSP_BASICRESP *bs, STACK_OF(X509) *certs,
                       X509_STORE *st, unsigned long flags)
 {
     X509 *signer, *x;
@@ -138,7 +138,7 @@ int OCSP_basic_verify(OCSP_BASICRESP *bs, STACK_OF(X509) *certs,
     goto end;
 }
 
-int OCSP_resp_get0_signer(OCSP_BASICRESP *bs, X509 **signer,
+int __cdecl OCSP_resp_get0_signer(OCSP_BASICRESP *bs, X509 **signer,
                           STACK_OF(X509) *extra_certs)
 {
     int ret;
@@ -336,7 +336,7 @@ static int ocsp_check_delegated(X509 *x)
  * trust value.
  */
 
-int OCSP_request_verify(OCSP_REQUEST *req, STACK_OF(X509) *certs,
+int __cdecl OCSP_request_verify(OCSP_REQUEST *req, STACK_OF(X509) *certs,
                         X509_STORE *store, unsigned long flags)
 {
     X509 *signer;
diff --git a/crypto/pem/pem_err.c b/crypto/pem/pem_err.c
index f642030aa5..ee032ca46b 100644
--- a/crypto/pem/pem_err.c
+++ b/crypto/pem/pem_err.c
@@ -114,7 +114,7 @@ static const ERR_STRING_DATA PEM_str_reasons[] = {
 
 #endif
 
-int ERR_load_PEM_strings(void)
+int __cdecl ERR_load_PEM_strings(void)
 {
 #ifndef OPENSSL_NO_ERR
     if (ERR_func_error_string(PEM_str_functs[0].error) == NULL) {
diff --git a/crypto/pem/pem_info.c b/crypto/pem/pem_info.c
index f90cb44650..745c4235af 100644
--- a/crypto/pem/pem_info.c
+++ b/crypto/pem/pem_info.c
@@ -18,7 +18,7 @@
 #include <openssl/dsa.h>
 
 #ifndef OPENSSL_NO_STDIO
-STACK_OF(X509_INFO) *PEM_X509_INFO_read(FILE *fp, STACK_OF(X509_INFO) *sk,
+STACK_OF(X509_INFO) * __cdecl PEM_X509_INFO_read(FILE *fp, STACK_OF(X509_INFO) *sk,
                                         pem_password_cb *cb, void *u)
 {
     BIO *b;
@@ -35,7 +35,7 @@ STACK_OF(X509_INFO) *PEM_X509_INFO_read(FILE *fp, STACK_OF(X509_INFO) *sk,
 }
 #endif
 
-STACK_OF(X509_INFO) *PEM_X509_INFO_read_bio(BIO *bp, STACK_OF(X509_INFO) *sk,
+STACK_OF(X509_INFO) * __cdecl PEM_X509_INFO_read_bio(BIO *bp, STACK_OF(X509_INFO) *sk,
                                             pem_password_cb *cb, void *u)
 {
     X509_INFO *xi = NULL;
@@ -244,7 +244,7 @@ STACK_OF(X509_INFO) *PEM_X509_INFO_read_bio(BIO *bp, STACK_OF(X509_INFO) *sk,
 }
 
 /* A TJH addition */
-int PEM_X509_INFO_write_bio(BIO *bp, X509_INFO *xi, EVP_CIPHER *enc,
+int __cdecl PEM_X509_INFO_write_bio(BIO *bp, X509_INFO *xi, EVP_CIPHER *enc,
                             unsigned char *kstr, int klen,
                             pem_password_cb *cb, void *u)
 {
diff --git a/crypto/pem/pem_lib.c b/crypto/pem/pem_lib.c
index 4bb86463fa..8f6c55a7dd 100644
--- a/crypto/pem/pem_lib.c
+++ b/crypto/pem/pem_lib.c
@@ -28,7 +28,7 @@ static int load_iv(char **fromp, unsigned char *to, int num);
 static int check_pem(const char *nm, const char *name);
 int pem_check_suffix(const char *pem_str, const char *suffix);
 
-int PEM_def_callback(char *buf, int num, int rwflag, void *userdata)
+int __cdecl PEM_def_callback(char *buf, int num, int rwflag, void *userdata)
 {
     int i, min_len;
     const char *prompt;
@@ -63,7 +63,7 @@ int PEM_def_callback(char *buf, int num, int rwflag, void *userdata)
     return strlen(buf);
 }
 
-void PEM_proc_type(char *buf, int type)
+void __cdecl PEM_proc_type(char *buf, int type)
 {
     const char *str;
     char *p = buf + strlen(buf);
@@ -80,7 +80,7 @@ void PEM_proc_type(char *buf, int type)
     BIO_snprintf(p, PEM_BUFSIZE - (size_t)(p - buf), "Proc-Type: 4,%s\n", str);
 }
 
-void PEM_dek_info(char *buf, const char *type, int len, char *str)
+void __cdecl PEM_dek_info(char *buf, const char *type, int len, char *str)
 {
     long i;
     char *p = buf + strlen(buf);
@@ -103,7 +103,7 @@ void PEM_dek_info(char *buf, const char *type, int len, char *str)
 }
 
 #ifndef OPENSSL_NO_STDIO
-void *PEM_ASN1_read(d2i_of_void *d2i, const char *name, FILE *fp, void **x,
+void * __cdecl PEM_ASN1_read(d2i_of_void *d2i, const char *name, FILE *fp, void **x,
                     pem_password_cb *cb, void *u)
 {
     BIO *b;
@@ -272,14 +272,14 @@ static int pem_bytes_read_bio_flags(unsigned char **pdata, long *plen,
     return ret;
 }
 
-int PEM_bytes_read_bio(unsigned char **pdata, long *plen, char **pnm,
+int __cdecl PEM_bytes_read_bio(unsigned char **pdata, long *plen, char **pnm,
                        const char *name, BIO *bp, pem_password_cb *cb,
                        void *u) {
     return pem_bytes_read_bio_flags(pdata, plen, pnm, name, bp, cb, u,
                                     PEM_FLAG_EAY_COMPATIBLE);
 }
 
-int PEM_bytes_read_bio_secmem(unsigned char **pdata, long *plen, char **pnm,
+int __cdecl PEM_bytes_read_bio_secmem(unsigned char **pdata, long *plen, char **pnm,
                               const char *name, BIO *bp, pem_password_cb *cb,
                               void *u) {
     return pem_bytes_read_bio_flags(pdata, plen, pnm, name, bp, cb, u,
@@ -287,7 +287,7 @@ int PEM_bytes_read_bio_secmem(unsigned char **pdata, long *plen, char **pnm,
 }
 
 #ifndef OPENSSL_NO_STDIO
-int PEM_ASN1_write(i2d_of_void *i2d, const char *name, FILE *fp,
+int __cdecl PEM_ASN1_write(i2d_of_void *i2d, const char *name, FILE *fp,
                    void *x, const EVP_CIPHER *enc, unsigned char *kstr,
                    int klen, pem_password_cb *callback, void *u)
 {
@@ -305,7 +305,7 @@ int PEM_ASN1_write(i2d_of_void *i2d, const char *name, FILE *fp,
 }
 #endif
 
-int PEM_ASN1_write_bio(i2d_of_void *i2d, const char *name, BIO *bp,
+int __cdecl PEM_ASN1_write_bio(i2d_of_void *i2d, const char *name, BIO *bp,
                        void *x, const EVP_CIPHER *enc, unsigned char *kstr,
                        int klen, pem_password_cb *callback, void *u)
 {
@@ -405,7 +405,7 @@ int PEM_ASN1_write_bio(i2d_of_void *i2d, const char *name, BIO *bp,
     return ret;
 }
 
-int PEM_do_header(EVP_CIPHER_INFO *cipher, unsigned char *data, long *plen,
+int __cdecl PEM_do_header(EVP_CIPHER_INFO *cipher, unsigned char *data, long *plen,
                   pem_password_cb *callback, void *u)
 {
     int ok;
@@ -478,7 +478,7 @@ int PEM_do_header(EVP_CIPHER_INFO *cipher, unsigned char *data, long *plen,
  * presumably we also parse rfc822-style headers for S/MIME, so a common
  * abstraction might well be more generally useful.
  */
-int PEM_get_EVP_CIPHER_INFO(char *header, EVP_CIPHER_INFO *cipher)
+int __cdecl PEM_get_EVP_CIPHER_INFO(char *header, EVP_CIPHER_INFO *cipher)
 {
     static const char ProcType[] = "Proc-Type:";
     static const char ENCRYPTED[] = "ENCRYPTED";
@@ -582,7 +582,7 @@ static int load_iv(char **fromp, unsigned char *to, int num)
 }
 
 #ifndef OPENSSL_NO_STDIO
-int PEM_write(FILE *fp, const char *name, const char *header,
+int __cdecl PEM_write(FILE *fp, const char *name, const char *header,
               const unsigned char *data, long len)
 {
     BIO *b;
@@ -599,7 +599,7 @@ int PEM_write(FILE *fp, const char *name, const char *header,
 }
 #endif
 
-int PEM_write_bio(BIO *bp, const char *name, const char *header,
+int __cdecl PEM_write_bio(BIO *bp, const char *name, const char *header,
                   const unsigned char *data, long len)
 {
     int nlen, n, i, j, outl;
@@ -662,7 +662,7 @@ int PEM_write_bio(BIO *bp, const char *name, const char *header,
 }
 
 #ifndef OPENSSL_NO_STDIO
-int PEM_read(FILE *fp, char **name, char **header, unsigned char **data,
+int __cdecl PEM_read(FILE *fp, char **name, char **header, unsigned char **data,
              long *len)
 {
     BIO *b;
@@ -882,7 +882,7 @@ err:
  * By nature of the PEM format, all content must be printable ASCII (except
  * for line endings).  Other characters are malformed input and will be rejected.
  */
-int PEM_read_bio_ex(BIO *bp, char **name_out, char **header,
+int __cdecl PEM_read_bio_ex(BIO *bp, char **name_out, char **header,
                     unsigned char **data, long *len_out, unsigned int flags)
 {
     EVP_ENCODE_CTX *ctx = EVP_ENCODE_CTX_new();
@@ -959,7 +959,7 @@ end:
     return ret;
 }
 
-int PEM_read_bio(BIO *bp, char **name, char **header, unsigned char **data,
+int __cdecl PEM_read_bio(BIO *bp, char **name, char **header, unsigned char **data,
                  long *len)
 {
     return PEM_read_bio_ex(bp, name, header, data, len, PEM_FLAG_EAY_COMPATIBLE);
diff --git a/crypto/pem/pem_oth.c b/crypto/pem/pem_oth.c
index 566205331f..959c5ca5b3 100644
--- a/crypto/pem/pem_oth.c
+++ b/crypto/pem/pem_oth.c
@@ -17,7 +17,7 @@
 
 /* Handle 'other' PEMs: not private keys */
 
-void *PEM_ASN1_read_bio(d2i_of_void *d2i, const char *name, BIO *bp, void **x,
+void * __cdecl PEM_ASN1_read_bio(d2i_of_void *d2i, const char *name, BIO *bp, void **x,
                         pem_password_cb *cb, void *u)
 {
     const unsigned char *p = NULL;
diff --git a/crypto/pem/pem_pk8.c b/crypto/pem/pem_pk8.c
index ab6c4c6bde..00f09dd4e6 100644
--- a/crypto/pem/pem_pk8.c
+++ b/crypto/pem/pem_pk8.c
@@ -32,28 +32,28 @@ static int do_pk8pkey_fp(FILE *bp, EVP_PKEY *x, int isder,
  * uses PKCS#5 v1.5 PBE algorithms whereas the others use PKCS#5 v2.0.
  */
 
-int PEM_write_bio_PKCS8PrivateKey_nid(BIO *bp, EVP_PKEY *x, int nid,
+int __cdecl PEM_write_bio_PKCS8PrivateKey_nid(BIO *bp, EVP_PKEY *x, int nid,
                                       char *kstr, int klen,
                                       pem_password_cb *cb, void *u)
 {
     return do_pk8pkey(bp, x, 0, nid, NULL, kstr, klen, cb, u);
 }
 
-int PEM_write_bio_PKCS8PrivateKey(BIO *bp, EVP_PKEY *x, const EVP_CIPHER *enc,
+int __cdecl PEM_write_bio_PKCS8PrivateKey(BIO *bp, EVP_PKEY *x, const EVP_CIPHER *enc,
                                   char *kstr, int klen,
                                   pem_password_cb *cb, void *u)
 {
     return do_pk8pkey(bp, x, 0, -1, enc, kstr, klen, cb, u);
 }
 
-int i2d_PKCS8PrivateKey_bio(BIO *bp, EVP_PKEY *x, const EVP_CIPHER *enc,
+int __cdecl i2d_PKCS8PrivateKey_bio(BIO *bp, EVP_PKEY *x, const EVP_CIPHER *enc,
                             char *kstr, int klen,
                             pem_password_cb *cb, void *u)
 {
     return do_pk8pkey(bp, x, 1, -1, enc, kstr, klen, cb, u);
 }
 
-int i2d_PKCS8PrivateKey_nid_bio(BIO *bp, EVP_PKEY *x, int nid,
+int __cdecl i2d_PKCS8PrivateKey_nid_bio(BIO *bp, EVP_PKEY *x, int nid,
                                 char *kstr, int klen,
                                 pem_password_cb *cb, void *u)
 {
@@ -109,7 +109,7 @@ static int do_pk8pkey(BIO *bp, EVP_PKEY *x, int isder, int nid,
     }
 }
 
-EVP_PKEY *d2i_PKCS8PrivateKey_bio(BIO *bp, EVP_PKEY **x, pem_password_cb *cb,
+EVP_PKEY * __cdecl d2i_PKCS8PrivateKey_bio(BIO *bp, EVP_PKEY **x, pem_password_cb *cb,
                                   void *u)
 {
     PKCS8_PRIV_KEY_INFO *p8inf = NULL;
@@ -147,27 +147,27 @@ EVP_PKEY *d2i_PKCS8PrivateKey_bio(BIO *bp, EVP_PKEY **x, pem_password_cb *cb,
 
 #ifndef OPENSSL_NO_STDIO
 
-int i2d_PKCS8PrivateKey_fp(FILE *fp, EVP_PKEY *x, const EVP_CIPHER *enc,
+int __cdecl i2d_PKCS8PrivateKey_fp(FILE *fp, EVP_PKEY *x, const EVP_CIPHER *enc,
                            char *kstr, int klen, pem_password_cb *cb, void *u)
 {
     return do_pk8pkey_fp(fp, x, 1, -1, enc, kstr, klen, cb, u);
 }
 
-int i2d_PKCS8PrivateKey_nid_fp(FILE *fp, EVP_PKEY *x, int nid,
+int __cdecl i2d_PKCS8PrivateKey_nid_fp(FILE *fp, EVP_PKEY *x, int nid,
                                char *kstr, int klen,
                                pem_password_cb *cb, void *u)
 {
     return do_pk8pkey_fp(fp, x, 1, nid, NULL, kstr, klen, cb, u);
 }
 
-int PEM_write_PKCS8PrivateKey_nid(FILE *fp, EVP_PKEY *x, int nid,
+int __cdecl PEM_write_PKCS8PrivateKey_nid(FILE *fp, EVP_PKEY *x, int nid,
                                   char *kstr, int klen,
                                   pem_password_cb *cb, void *u)
 {
     return do_pk8pkey_fp(fp, x, 0, nid, NULL, kstr, klen, cb, u);
 }
 
-int PEM_write_PKCS8PrivateKey(FILE *fp, EVP_PKEY *x, const EVP_CIPHER *enc,
+int __cdecl PEM_write_PKCS8PrivateKey(FILE *fp, EVP_PKEY *x, const EVP_CIPHER *enc,
                               char *kstr, int klen, pem_password_cb *cb,
                               void *u)
 {
@@ -190,7 +190,7 @@ static int do_pk8pkey_fp(FILE *fp, EVP_PKEY *x, int isder, int nid,
     return ret;
 }
 
-EVP_PKEY *d2i_PKCS8PrivateKey_fp(FILE *fp, EVP_PKEY **x, pem_password_cb *cb,
+EVP_PKEY * __cdecl d2i_PKCS8PrivateKey_fp(FILE *fp, EVP_PKEY **x, pem_password_cb *cb,
                                  void *u)
 {
     BIO *bp;
diff --git a/crypto/pem/pem_pkey.c b/crypto/pem/pem_pkey.c
index aa032d2b1c..f9ba80593b 100644
--- a/crypto/pem/pem_pkey.c
+++ b/crypto/pem/pem_pkey.c
@@ -102,7 +102,7 @@ int PEM_write_bio_PrivateKey(BIO *bp, EVP_PKEY *x, const EVP_CIPHER *enc,
     return PEM_write_bio_PrivateKey_traditional(bp, x, enc, kstr, klen, cb, u);
 }
 
-int PEM_write_bio_PrivateKey_traditional(BIO *bp, EVP_PKEY *x,
+int __cdecl PEM_write_bio_PrivateKey_traditional(BIO *bp, EVP_PKEY *x,
                                          const EVP_CIPHER *enc,
                                          unsigned char *kstr, int klen,
                                          pem_password_cb *cb, void *u)
@@ -113,7 +113,7 @@ int PEM_write_bio_PrivateKey_traditional(BIO *bp, EVP_PKEY *x,
                               pem_str, bp, x, enc, kstr, klen, cb, u);
 }
 
-EVP_PKEY *PEM_read_bio_Parameters(BIO *bp, EVP_PKEY **x)
+EVP_PKEY * __cdecl PEM_read_bio_Parameters(BIO *bp, EVP_PKEY **x)
 {
     char *nm = NULL;
     const unsigned char *p = NULL;
@@ -151,7 +151,7 @@ EVP_PKEY *PEM_read_bio_Parameters(BIO *bp, EVP_PKEY **x)
     return ret;
 }
 
-int PEM_write_bio_Parameters(BIO *bp, EVP_PKEY *x)
+int __cdecl PEM_write_bio_Parameters(BIO *bp, EVP_PKEY *x)
 {
     char pem_str[80];
     if (!x->ameth || !x->ameth->param_encode)
diff --git a/crypto/pem/pem_sign.c b/crypto/pem/pem_sign.c
index 7e7b32ebf7..eafba5d865 100644
--- a/crypto/pem/pem_sign.c
+++ b/crypto/pem/pem_sign.c
@@ -14,17 +14,17 @@
 #include <openssl/x509.h>
 #include <openssl/pem.h>
 
-int PEM_SignInit(EVP_MD_CTX *ctx, EVP_MD *type)
+int __cdecl PEM_SignInit(EVP_MD_CTX *ctx, EVP_MD *type)
 {
     return EVP_DigestInit_ex(ctx, type, NULL);
 }
 
-int PEM_SignUpdate(EVP_MD_CTX *ctx, unsigned char *data, unsigned int count)
+int __cdecl PEM_SignUpdate(EVP_MD_CTX *ctx, unsigned char *data, unsigned int count)
 {
     return EVP_DigestUpdate(ctx, data, count);
 }
 
-int PEM_SignFinal(EVP_MD_CTX *ctx, unsigned char *sigret,
+int __cdecl PEM_SignFinal(EVP_MD_CTX *ctx, unsigned char *sigret,
                   unsigned int *siglen, EVP_PKEY *pkey)
 {
     unsigned char *m;
diff --git a/crypto/pem/pvkfmt.c b/crypto/pem/pvkfmt.c
index 2bbee4a306..c793cff5a5 100644
--- a/crypto/pem/pvkfmt.c
+++ b/crypto/pem/pvkfmt.c
@@ -382,22 +382,22 @@ static EVP_PKEY *b2i_rsa(const unsigned char **in,
     return NULL;
 }
 
-EVP_PKEY *b2i_PrivateKey(const unsigned char **in, long length)
+EVP_PKEY * __cdecl b2i_PrivateKey(const unsigned char **in, long length)
 {
     return do_b2i(in, length, 0);
 }
 
-EVP_PKEY *b2i_PublicKey(const unsigned char **in, long length)
+EVP_PKEY * __cdecl b2i_PublicKey(const unsigned char **in, long length)
 {
     return do_b2i(in, length, 1);
 }
 
-EVP_PKEY *b2i_PrivateKey_bio(BIO *in)
+EVP_PKEY * __cdecl b2i_PrivateKey_bio(BIO *in)
 {
     return do_b2i_bio(in, 0);
 }
 
-EVP_PKEY *b2i_PublicKey_bio(BIO *in)
+EVP_PKEY * __cdecl b2i_PublicKey_bio(BIO *in)
 {
     return do_b2i_bio(in, 1);
 }
@@ -599,12 +599,12 @@ static void write_dsa(unsigned char **out, DSA *dsa, int ispub)
     return;
 }
 
-int i2b_PrivateKey_bio(BIO *out, EVP_PKEY *pk)
+int __cdecl i2b_PrivateKey_bio(BIO *out, EVP_PKEY *pk)
 {
     return do_i2b_bio(out, pk, 0);
 }
 
-int i2b_PublicKey_bio(BIO *out, EVP_PKEY *pk)
+int __cdecl i2b_PublicKey_bio(BIO *out, EVP_PKEY *pk)
 {
     return do_i2b_bio(out, pk, 1);
 }
@@ -746,7 +746,7 @@ static EVP_PKEY *do_PVK_body(const unsigned char **in,
     return ret;
 }
 
-EVP_PKEY *b2i_PVK_bio(BIO *in, pem_password_cb *cb, void *u)
+EVP_PKEY * __cdecl b2i_PVK_bio(BIO *in, pem_password_cb *cb, void *u)
 {
     unsigned char pvk_hdr[24], *buf = NULL;
     const unsigned char *p;
@@ -864,7 +864,7 @@ static int i2b_PVK(unsigned char **out, EVP_PKEY *pk, int enclevel,
     return -1;
 }
 
-int i2b_PVK_bio(BIO *out, EVP_PKEY *pk, int enclevel,
+int __cdecl i2b_PVK_bio(BIO *out, EVP_PKEY *pk, int enclevel,
                 pem_password_cb *cb, void *u)
 {
     unsigned char *tmp = NULL;
diff --git a/crypto/pkcs12/p12_add.c b/crypto/pkcs12/p12_add.c
index 193ed8097d..f18c196e3e 100644
--- a/crypto/pkcs12/p12_add.c
+++ b/crypto/pkcs12/p12_add.c
@@ -14,7 +14,7 @@
 
 /* Pack an object into an OCTET STRING and turn into a safebag */
 
-PKCS12_SAFEBAG *PKCS12_item_pack_safebag(void *obj, const ASN1_ITEM *it,
+PKCS12_SAFEBAG * __cdecl PKCS12_item_pack_safebag(void *obj, const ASN1_ITEM *it,
                                          int nid1, int nid2)
 {
     PKCS12_BAGS *bag;
@@ -43,7 +43,7 @@ PKCS12_SAFEBAG *PKCS12_item_pack_safebag(void *obj, const ASN1_ITEM *it,
 }
 
 /* Turn a stack of SAFEBAGS into a PKCS#7 data Contentinfo */
-PKCS7 *PKCS12_pack_p7data(STACK_OF(PKCS12_SAFEBAG) *sk)
+PKCS7 * __cdecl PKCS12_pack_p7data(STACK_OF(PKCS12_SAFEBAG) *sk)
 {
     PKCS7 *p7;
 
@@ -69,7 +69,7 @@ PKCS7 *PKCS12_pack_p7data(STACK_OF(PKCS12_SAFEBAG) *sk)
 }
 
 /* Unpack SAFEBAGS from PKCS#7 data ContentInfo */
-STACK_OF(PKCS12_SAFEBAG) *PKCS12_unpack_p7data(PKCS7 *p7)
+STACK_OF(PKCS12_SAFEBAG) * __cdecl PKCS12_unpack_p7data(PKCS7 *p7)
 {
     if (!PKCS7_type_is_data(p7)) {
         PKCS12err(PKCS12_F_PKCS12_UNPACK_P7DATA,
@@ -81,7 +81,7 @@ STACK_OF(PKCS12_SAFEBAG) *PKCS12_unpack_p7data(PKCS7 *p7)
 
 /* Turn a stack of SAFEBAGS into a PKCS#7 encrypted data ContentInfo */
 
-PKCS7 *PKCS12_pack_p7encdata(int pbe_nid, const char *pass, int passlen,
+PKCS7 * __cdecl PKCS12_pack_p7encdata(int pbe_nid, const char *pass, int passlen,
                              unsigned char *salt, int saltlen, int iter,
                              STACK_OF(PKCS12_SAFEBAG) *bags)
 {
@@ -127,7 +127,7 @@ PKCS7 *PKCS12_pack_p7encdata(int pbe_nid, const char *pass, int passlen,
     return NULL;
 }
 
-STACK_OF(PKCS12_SAFEBAG) *PKCS12_unpack_p7encdata(PKCS7 *p7, const char *pass,
+STACK_OF(PKCS12_SAFEBAG) * __cdecl PKCS12_unpack_p7encdata(PKCS7 *p7, const char *pass,
                                                   int passlen)
 {
     if (!PKCS7_type_is_encrypted(p7))
@@ -138,13 +138,13 @@ STACK_OF(PKCS12_SAFEBAG) *PKCS12_unpack_p7encdata(PKCS7 *p7, const char *pass,
                                    p7->d.encrypted->enc_data->enc_data, 1);
 }
 
-PKCS8_PRIV_KEY_INFO *PKCS12_decrypt_skey(const PKCS12_SAFEBAG *bag,
+PKCS8_PRIV_KEY_INFO * __cdecl PKCS12_decrypt_skey(const PKCS12_SAFEBAG *bag,
                                          const char *pass, int passlen)
 {
     return PKCS8_decrypt(bag->value.shkeybag, pass, passlen);
 }
 
-int PKCS12_pack_authsafes(PKCS12 *p12, STACK_OF(PKCS7) *safes)
+int __cdecl PKCS12_pack_authsafes(PKCS12 *p12, STACK_OF(PKCS7) *safes)
 {
     if (ASN1_item_pack(safes, ASN1_ITEM_rptr(PKCS12_AUTHSAFES),
                        &p12->authsafes->d.data))
@@ -152,7 +152,7 @@ int PKCS12_pack_authsafes(PKCS12 *p12, STACK_OF(PKCS7) *safes)
     return 0;
 }
 
-STACK_OF(PKCS7) *PKCS12_unpack_authsafes(const PKCS12 *p12)
+STACK_OF(PKCS7) * __cdecl PKCS12_unpack_authsafes(const PKCS12 *p12)
 {
     if (!PKCS7_type_is_data(p12->authsafes)) {
         PKCS12err(PKCS12_F_PKCS12_UNPACK_AUTHSAFES,
diff --git a/crypto/pkcs12/p12_attr.c b/crypto/pkcs12/p12_attr.c
index c324f50514..81fe2259fd 100644
--- a/crypto/pkcs12/p12_attr.c
+++ b/crypto/pkcs12/p12_attr.c
@@ -14,7 +14,7 @@
 
 /* Add a local keyid to a safebag */
 
-int PKCS12_add_localkeyid(PKCS12_SAFEBAG *bag, unsigned char *name,
+int __cdecl PKCS12_add_localkeyid(PKCS12_SAFEBAG *bag, unsigned char *name,
                           int namelen)
 {
     if (X509at_add1_attr_by_NID(&bag->attrib, NID_localKeyID,
@@ -26,7 +26,7 @@ int PKCS12_add_localkeyid(PKCS12_SAFEBAG *bag, unsigned char *name,
 
 /* Add key usage to PKCS#8 structure */
 
-int PKCS8_add_keyusage(PKCS8_PRIV_KEY_INFO *p8, int usage)
+int __cdecl PKCS8_add_keyusage(PKCS8_PRIV_KEY_INFO *p8, int usage)
 {
     unsigned char us_val = (unsigned char)usage;
     return PKCS8_pkey_add1_attr_by_NID(p8, NID_key_usage,
@@ -35,7 +35,7 @@ int PKCS8_add_keyusage(PKCS8_PRIV_KEY_INFO *p8, int usage)
 
 /* Add a friendlyname to a safebag */
 
-int PKCS12_add_friendlyname_asc(PKCS12_SAFEBAG *bag, const char *name,
+int __cdecl PKCS12_add_friendlyname_asc(PKCS12_SAFEBAG *bag, const char *name,
                                 int namelen)
 {
     if (X509at_add1_attr_by_NID(&bag->attrib, NID_friendlyName,
@@ -45,7 +45,7 @@ int PKCS12_add_friendlyname_asc(PKCS12_SAFEBAG *bag, const char *name,
         return 0;
 }
 
-int PKCS12_add_friendlyname_utf8(PKCS12_SAFEBAG *bag, const char *name,
+int __cdecl PKCS12_add_friendlyname_utf8(PKCS12_SAFEBAG *bag, const char *name,
                                 int namelen)
 {
     if (X509at_add1_attr_by_NID(&bag->attrib, NID_friendlyName,
@@ -55,7 +55,7 @@ int PKCS12_add_friendlyname_utf8(PKCS12_SAFEBAG *bag, const char *name,
         return 0;
 }
 
-int PKCS12_add_friendlyname_uni(PKCS12_SAFEBAG *bag,
+int __cdecl PKCS12_add_friendlyname_uni(PKCS12_SAFEBAG *bag,
                                 const unsigned char *name, int namelen)
 {
     if (X509at_add1_attr_by_NID(&bag->attrib, NID_friendlyName,
@@ -65,7 +65,7 @@ int PKCS12_add_friendlyname_uni(PKCS12_SAFEBAG *bag,
         return 0;
 }
 
-int PKCS12_add_CSPName_asc(PKCS12_SAFEBAG *bag, const char *name, int namelen)
+int __cdecl PKCS12_add_CSPName_asc(PKCS12_SAFEBAG *bag, const char *name, int namelen)
 {
     if (X509at_add1_attr_by_NID(&bag->attrib, NID_ms_csp_name,
                                 MBSTRING_ASC, (unsigned char *)name, namelen))
@@ -74,7 +74,7 @@ int PKCS12_add_CSPName_asc(PKCS12_SAFEBAG *bag, const char *name, int namelen)
         return 0;
 }
 
-ASN1_TYPE *PKCS12_get_attr_gen(const STACK_OF(X509_ATTRIBUTE) *attrs,
+ASN1_TYPE * __cdecl PKCS12_get_attr_gen(const STACK_OF(X509_ATTRIBUTE) *attrs,
                                int attr_nid)
 {
     X509_ATTRIBUTE *attrib;
@@ -84,7 +84,7 @@ ASN1_TYPE *PKCS12_get_attr_gen(const STACK_OF(X509_ATTRIBUTE) *attrs,
     return X509_ATTRIBUTE_get0_type(attrib, 0);
 }
 
-char *PKCS12_get_friendlyname(PKCS12_SAFEBAG *bag)
+char * __cdecl PKCS12_get_friendlyname(PKCS12_SAFEBAG *bag)
 {
     const ASN1_TYPE *atype;
 
@@ -96,7 +96,7 @@ char *PKCS12_get_friendlyname(PKCS12_SAFEBAG *bag)
                             atype->value.bmpstring->length);
 }
 
-const STACK_OF(X509_ATTRIBUTE) *
+const STACK_OF(X509_ATTRIBUTE) * __cdecl 
 PKCS12_SAFEBAG_get0_attrs(const PKCS12_SAFEBAG *bag)
 {
     return bag->attrib;
diff --git a/crypto/pkcs12/p12_crpt.c b/crypto/pkcs12/p12_crpt.c
index feef9d1fc4..ad598a35ac 100644
--- a/crypto/pkcs12/p12_crpt.c
+++ b/crypto/pkcs12/p12_crpt.c
@@ -13,11 +13,11 @@
 
 /* PKCS#12 PBE algorithms now in static table */
 
-void PKCS12_PBE_add(void)
+void __cdecl PKCS12_PBE_add(void)
 {
 }
 
-int PKCS12_PBE_keyivgen(EVP_CIPHER_CTX *ctx, const char *pass, int passlen,
+int __cdecl PKCS12_PBE_keyivgen(EVP_CIPHER_CTX *ctx, const char *pass, int passlen,
                         ASN1_TYPE *param, const EVP_CIPHER *cipher,
                         const EVP_MD *md, int en_de)
 {
@@ -25,7 +25,7 @@ int PKCS12_PBE_keyivgen(EVP_CIPHER_CTX *ctx, const char *pass, int passlen,
     int saltlen, iter, ret;
     unsigned char *salt;
     unsigned char key[EVP_MAX_KEY_LENGTH], iv[EVP_MAX_IV_LENGTH];
-    int (*pkcs12_key_gen)(const char *pass, int passlen,
+    int (__cdecl *pkcs12_key_gen)(const char *pass, int passlen,
                           unsigned char *salt, int slen,
                           int id, int iter, int n,
                           unsigned char *out,
diff --git a/crypto/pkcs12/p12_crt.c b/crypto/pkcs12/p12_crt.c
index 10cf8dd589..9d980cdf33 100644
--- a/crypto/pkcs12/p12_crt.c
+++ b/crypto/pkcs12/p12_crt.c
@@ -28,7 +28,7 @@ static int copy_bag_attr(PKCS12_SAFEBAG *bag, EVP_PKEY *pkey, int nid)
     return 1;
 }
 
-PKCS12 *PKCS12_create(const char *pass, const char *name, EVP_PKEY *pkey, X509 *cert,
+PKCS12 * __cdecl PKCS12_create(const char *pass, const char *name, EVP_PKEY *pkey, X509 *cert,
                       STACK_OF(X509) *ca, int nid_key, int nid_cert, int iter,
                       int mac_iter, int keytype)
 {
@@ -131,7 +131,7 @@ PKCS12 *PKCS12_create(const char *pass, const char *name, EVP_PKEY *pkey, X509 *
 
 }
 
-PKCS12_SAFEBAG *PKCS12_add_cert(STACK_OF(PKCS12_SAFEBAG) **pbags, X509 *cert)
+PKCS12_SAFEBAG * __cdecl PKCS12_add_cert(STACK_OF(PKCS12_SAFEBAG) **pbags, X509 *cert)
 {
     PKCS12_SAFEBAG *bag = NULL;
     char *name;
@@ -168,7 +168,7 @@ PKCS12_SAFEBAG *PKCS12_add_cert(STACK_OF(PKCS12_SAFEBAG) **pbags, X509 *cert)
 
 }
 
-PKCS12_SAFEBAG *PKCS12_add_key(STACK_OF(PKCS12_SAFEBAG) **pbags,
+PKCS12_SAFEBAG * __cdecl PKCS12_add_key(STACK_OF(PKCS12_SAFEBAG) **pbags,
                                EVP_PKEY *key, int key_usage, int iter,
                                int nid_key, const char *pass)
 {
@@ -202,7 +202,7 @@ PKCS12_SAFEBAG *PKCS12_add_key(STACK_OF(PKCS12_SAFEBAG) **pbags,
 
 }
 
-int PKCS12_add_safe(STACK_OF(PKCS7) **psafes, STACK_OF(PKCS12_SAFEBAG) *bags,
+int __cdecl PKCS12_add_safe(STACK_OF(PKCS7) **psafes, STACK_OF(PKCS12_SAFEBAG) *bags,
                     int nid_safe, int iter, const char *pass)
 {
     PKCS7 *p7 = NULL;
@@ -271,7 +271,7 @@ static int pkcs12_add_bag(STACK_OF(PKCS12_SAFEBAG) **pbags,
 
 }
 
-PKCS12 *PKCS12_add_safes(STACK_OF(PKCS7) *safes, int nid_p7)
+PKCS12 * __cdecl PKCS12_add_safes(STACK_OF(PKCS7) *safes, int nid_p7)
 {
     PKCS12 *p12;
     if (nid_p7 <= 0)
diff --git a/crypto/pkcs12/p12_decr.c b/crypto/pkcs12/p12_decr.c
index 3c860584e8..e863a1398b 100644
--- a/crypto/pkcs12/p12_decr.c
+++ b/crypto/pkcs12/p12_decr.c
@@ -20,7 +20,7 @@
  * Encrypt/Decrypt a buffer based on password and algor, result in a
  * OPENSSL_malloc'ed buffer
  */
-unsigned char *PKCS12_pbe_crypt(const X509_ALGOR *algor,
+unsigned char * __cdecl PKCS12_pbe_crypt(const X509_ALGOR *algor,
                                 const char *pass, int passlen,
                                 const unsigned char *in, int inlen,
                                 unsigned char **data, int *datalen, int en_de)
@@ -79,7 +79,7 @@ unsigned char *PKCS12_pbe_crypt(const X509_ALGOR *algor,
  * after use.
  */
 
-void *PKCS12_item_decrypt_d2i(const X509_ALGOR *algor, const ASN1_ITEM *it,
+void * __cdecl PKCS12_item_decrypt_d2i(const X509_ALGOR *algor, const ASN1_ITEM *it,
                               const char *pass, int passlen,
                               const ASN1_OCTET_STRING *oct, int zbuf)
 {
@@ -121,7 +121,7 @@ void *PKCS12_item_decrypt_d2i(const X509_ALGOR *algor, const ASN1_ITEM *it,
  * encoding.
  */
 
-ASN1_OCTET_STRING *PKCS12_item_i2d_encrypt(X509_ALGOR *algor,
+ASN1_OCTET_STRING * __cdecl PKCS12_item_i2d_encrypt(X509_ALGOR *algor,
                                            const ASN1_ITEM *it,
                                            const char *pass, int passlen,
                                            void *obj, int zbuf)
diff --git a/crypto/pkcs12/p12_init.c b/crypto/pkcs12/p12_init.c
index 88db0f2dc4..1d81d0f25d 100644
--- a/crypto/pkcs12/p12_init.c
+++ b/crypto/pkcs12/p12_init.c
@@ -14,7 +14,7 @@
 
 /* Initialise a PKCS12 structure to take data */
 
-PKCS12 *PKCS12_init(int mode)
+PKCS12 * __cdecl PKCS12_init(int mode)
 {
     PKCS12 *pkcs12;
 
diff --git a/crypto/pkcs12/p12_key.c b/crypto/pkcs12/p12_key.c
index ab31a61295..d14957992e 100644
--- a/crypto/pkcs12/p12_key.c
+++ b/crypto/pkcs12/p12_key.c
@@ -27,7 +27,7 @@ void h__dump(unsigned char *p, int len);
 # define min(a,b) ((a) < (b) ? (a) : (b))
 #endif
 
-int PKCS12_key_gen_asc(const char *pass, int passlen, unsigned char *salt,
+int __cdecl PKCS12_key_gen_asc(const char *pass, int passlen, unsigned char *salt,
                        int saltlen, int id, int iter, int n,
                        unsigned char *out, const EVP_MD *md_type)
 {
@@ -50,7 +50,7 @@ int PKCS12_key_gen_asc(const char *pass, int passlen, unsigned char *salt,
     return ret;
 }
 
-int PKCS12_key_gen_utf8(const char *pass, int passlen, unsigned char *salt,
+int __cdecl PKCS12_key_gen_utf8(const char *pass, int passlen, unsigned char *salt,
                         int saltlen, int id, int iter, int n,
                         unsigned char *out, const EVP_MD *md_type)
 {
@@ -73,7 +73,7 @@ int PKCS12_key_gen_utf8(const char *pass, int passlen, unsigned char *salt,
     return ret;
 }
 
-int PKCS12_key_gen_uni(unsigned char *pass, int passlen, unsigned char *salt,
+int __cdecl PKCS12_key_gen_uni(unsigned char *pass, int passlen, unsigned char *salt,
                        int saltlen, int id, int iter, int n,
                        unsigned char *out, const EVP_MD *md_type)
 {
diff --git a/crypto/pkcs12/p12_kiss.c b/crypto/pkcs12/p12_kiss.c
index 7ab98385a7..5f7a53d4cd 100644
--- a/crypto/pkcs12/p12_kiss.c
+++ b/crypto/pkcs12/p12_kiss.c
@@ -29,7 +29,7 @@ static int parse_bag(PKCS12_SAFEBAG *bag, const char *pass, int passlen,
  * uninitialised.
  */
 
-int PKCS12_parse(PKCS12 *p12, const char *pass, EVP_PKEY **pkey, X509 **cert,
+int __cdecl PKCS12_parse(PKCS12 *p12, const char *pass, EVP_PKEY **pkey, X509 **cert,
                  STACK_OF(X509) **ca)
 {
     STACK_OF(X509) *ocerts = NULL;
diff --git a/crypto/pkcs12/p12_mutl.c b/crypto/pkcs12/p12_mutl.c
index 0cbbed364a..d613d16cec 100644
--- a/crypto/pkcs12/p12_mutl.c
+++ b/crypto/pkcs12/p12_mutl.c
@@ -15,12 +15,12 @@
 #include <openssl/pkcs12.h>
 #include "p12_lcl.h"
 
-int PKCS12_mac_present(const PKCS12 *p12)
+int __cdecl PKCS12_mac_present(const PKCS12 *p12)
 {
     return p12->mac ? 1 : 0;
 }
 
-void PKCS12_get0_mac(const ASN1_OCTET_STRING **pmac,
+void __cdecl PKCS12_get0_mac(const ASN1_OCTET_STRING **pmac,
                      const X509_ALGOR **pmacalg,
                      const ASN1_OCTET_STRING **psalt,
                      const ASN1_INTEGER **piter,
@@ -67,9 +67,9 @@ static int pkcs12_gen_gost_mac_key(const char *pass, int passlen,
 }
 
 /* Generate a MAC */
-static int pkcs12_gen_mac(PKCS12 *p12, const char *pass, int passlen,
+static int __cdecl pkcs12_gen_mac(PKCS12 *p12, const char *pass, int passlen,
                           unsigned char *mac, unsigned int *maclen,
-                          int (*pkcs12_key_gen)(const char *pass, int passlen,
+                          int (__cdecl *pkcs12_key_gen)(const char *pass, int passlen,
                                                 unsigned char *salt, int slen,
                                                 int id, int iter, int n,
                                                 unsigned char *out,
@@ -140,14 +140,14 @@ err:
     return ret;
 }
 
-int PKCS12_gen_mac(PKCS12 *p12, const char *pass, int passlen,
+int __cdecl PKCS12_gen_mac(PKCS12 *p12, const char *pass, int passlen,
                    unsigned char *mac, unsigned int *maclen)
 {
     return pkcs12_gen_mac(p12, pass, passlen, mac, maclen, NULL);
 }
 
 /* Verify the mac */
-int PKCS12_verify_mac(PKCS12 *p12, const char *pass, int passlen)
+int __cdecl PKCS12_verify_mac(PKCS12 *p12, const char *pass, int passlen)
 {
     unsigned char mac[EVP_MAX_MD_SIZE];
     unsigned int maclen;
@@ -172,7 +172,7 @@ int PKCS12_verify_mac(PKCS12 *p12, const char *pass, int passlen)
 
 /* Set a mac */
 
-int PKCS12_set_mac(PKCS12 *p12, const char *pass, int passlen,
+int __cdecl PKCS12_set_mac(PKCS12 *p12, const char *pass, int passlen,
                    unsigned char *salt, int saltlen, int iter,
                    const EVP_MD *md_type)
 {
@@ -203,7 +203,7 @@ int PKCS12_set_mac(PKCS12 *p12, const char *pass, int passlen,
 }
 
 /* Set up a mac structure */
-int PKCS12_setup_mac(PKCS12 *p12, int iter, unsigned char *salt, int saltlen,
+int __cdecl PKCS12_setup_mac(PKCS12 *p12, int iter, unsigned char *salt, int saltlen,
                      const EVP_MD *md_type)
 {
     X509_ALGOR *macalg;
diff --git a/crypto/pkcs12/p12_npas.c b/crypto/pkcs12/p12_npas.c
index 0ce75ed330..ba2c352e9a 100644
--- a/crypto/pkcs12/p12_npas.c
+++ b/crypto/pkcs12/p12_npas.c
@@ -29,7 +29,7 @@ static int alg_get(const X509_ALGOR *alg, int *pnid, int *piter,
  * Change the password on a PKCS#12 structure.
  */
 
-int PKCS12_newpass(PKCS12 *p12, const char *oldpass, const char *newpass)
+int __cdecl PKCS12_newpass(PKCS12 *p12, const char *oldpass, const char *newpass)
 {
     /* Check for NULL PKCS12 structure */
 
diff --git a/crypto/pkcs12/p12_p8d.c b/crypto/pkcs12/p12_p8d.c
index d926a77df8..f12e863deb 100644
--- a/crypto/pkcs12/p12_p8d.c
+++ b/crypto/pkcs12/p12_p8d.c
@@ -11,7 +11,7 @@
 #include "internal/cryptlib.h"
 #include <openssl/pkcs12.h>
 
-PKCS8_PRIV_KEY_INFO *PKCS8_decrypt(const X509_SIG *p8, const char *pass,
+PKCS8_PRIV_KEY_INFO * __cdecl PKCS8_decrypt(const X509_SIG *p8, const char *pass,
                                    int passlen)
 {
     const X509_ALGOR *dalg;
diff --git a/crypto/pkcs12/p12_p8e.c b/crypto/pkcs12/p12_p8e.c
index 86a07e1335..d47756c2c0 100644
--- a/crypto/pkcs12/p12_p8e.c
+++ b/crypto/pkcs12/p12_p8e.c
@@ -12,7 +12,7 @@
 #include <openssl/pkcs12.h>
 #include "internal/x509_int.h"
 
-X509_SIG *PKCS8_encrypt(int pbe_nid, const EVP_CIPHER *cipher,
+X509_SIG * __cdecl PKCS8_encrypt(int pbe_nid, const EVP_CIPHER *cipher,
                         const char *pass, int passlen,
                         unsigned char *salt, int saltlen, int iter,
                         PKCS8_PRIV_KEY_INFO *p8inf)
@@ -41,7 +41,7 @@ X509_SIG *PKCS8_encrypt(int pbe_nid, const EVP_CIPHER *cipher,
     return p8;
 }
 
-X509_SIG *PKCS8_set0_pbe(const char *pass, int passlen,
+X509_SIG * __cdecl PKCS8_set0_pbe(const char *pass, int passlen,
                          PKCS8_PRIV_KEY_INFO *p8inf, X509_ALGOR *pbe)
 {
     X509_SIG *p8;
diff --git a/crypto/pkcs12/p12_sbag.c b/crypto/pkcs12/p12_sbag.c
index a09c5b9313..846846f51e 100644
--- a/crypto/pkcs12/p12_sbag.c
+++ b/crypto/pkcs12/p12_sbag.c
@@ -19,32 +19,32 @@ ASN1_TYPE *PKCS12_get_attr(const PKCS12_SAFEBAG *bag, int attr_nid)
 }
 #endif
 
-const ASN1_TYPE *PKCS12_SAFEBAG_get0_attr(const PKCS12_SAFEBAG *bag,
+const ASN1_TYPE * __cdecl PKCS12_SAFEBAG_get0_attr(const PKCS12_SAFEBAG *bag,
                                           int attr_nid)
 {
     return PKCS12_get_attr_gen(bag->attrib, attr_nid);
 }
 
-ASN1_TYPE *PKCS8_get_attr(PKCS8_PRIV_KEY_INFO *p8, int attr_nid)
+ASN1_TYPE * __cdecl PKCS8_get_attr(PKCS8_PRIV_KEY_INFO *p8, int attr_nid)
 {
     return PKCS12_get_attr_gen(PKCS8_pkey_get0_attrs(p8), attr_nid);
 }
 
-const PKCS8_PRIV_KEY_INFO *PKCS12_SAFEBAG_get0_p8inf(const PKCS12_SAFEBAG *bag)
+const PKCS8_PRIV_KEY_INFO * __cdecl PKCS12_SAFEBAG_get0_p8inf(const PKCS12_SAFEBAG *bag)
 {
     if (PKCS12_SAFEBAG_get_nid(bag) != NID_keyBag)
         return NULL;
     return bag->value.keybag;
 }
 
-const X509_SIG *PKCS12_SAFEBAG_get0_pkcs8(const PKCS12_SAFEBAG *bag)
+const X509_SIG * __cdecl PKCS12_SAFEBAG_get0_pkcs8(const PKCS12_SAFEBAG *bag)
 {
     if (OBJ_obj2nid(bag->type) != NID_pkcs8ShroudedKeyBag)
         return NULL;
     return bag->value.shkeybag;
 }
 
-const STACK_OF(PKCS12_SAFEBAG) *
+const STACK_OF(PKCS12_SAFEBAG) * __cdecl 
 PKCS12_SAFEBAG_get0_safes(const PKCS12_SAFEBAG *bag)
 {
     if (OBJ_obj2nid(bag->type) != NID_safeContentsBag)
@@ -52,17 +52,17 @@ PKCS12_SAFEBAG_get0_safes(const PKCS12_SAFEBAG *bag)
     return bag->value.safes;
 }
 
-const ASN1_OBJECT *PKCS12_SAFEBAG_get0_type(const PKCS12_SAFEBAG *bag)
+const ASN1_OBJECT * __cdecl PKCS12_SAFEBAG_get0_type(const PKCS12_SAFEBAG *bag)
 {
     return bag->type;
 }
 
-int PKCS12_SAFEBAG_get_nid(const PKCS12_SAFEBAG *bag)
+int __cdecl PKCS12_SAFEBAG_get_nid(const PKCS12_SAFEBAG *bag)
 {
     return OBJ_obj2nid(bag->type);
 }
 
-int PKCS12_SAFEBAG_get_bag_nid(const PKCS12_SAFEBAG *bag)
+int __cdecl PKCS12_SAFEBAG_get_bag_nid(const PKCS12_SAFEBAG *bag)
 {
     int btype = PKCS12_SAFEBAG_get_nid(bag);
 
@@ -71,7 +71,7 @@ int PKCS12_SAFEBAG_get_bag_nid(const PKCS12_SAFEBAG *bag)
     return OBJ_obj2nid(bag->value.bag->type);
 }
 
-X509 *PKCS12_SAFEBAG_get1_cert(const PKCS12_SAFEBAG *bag)
+X509 * __cdecl PKCS12_SAFEBAG_get1_cert(const PKCS12_SAFEBAG *bag)
 {
     if (PKCS12_SAFEBAG_get_nid(bag) != NID_certBag)
         return NULL;
@@ -81,7 +81,7 @@ X509 *PKCS12_SAFEBAG_get1_cert(const PKCS12_SAFEBAG *bag)
                             ASN1_ITEM_rptr(X509));
 }
 
-X509_CRL *PKCS12_SAFEBAG_get1_crl(const PKCS12_SAFEBAG *bag)
+X509_CRL * __cdecl PKCS12_SAFEBAG_get1_crl(const PKCS12_SAFEBAG *bag)
 {
     if (PKCS12_SAFEBAG_get_nid(bag) != NID_crlBag)
         return NULL;
@@ -91,13 +91,13 @@ X509_CRL *PKCS12_SAFEBAG_get1_crl(const PKCS12_SAFEBAG *bag)
                             ASN1_ITEM_rptr(X509_CRL));
 }
 
-PKCS12_SAFEBAG *PKCS12_SAFEBAG_create_cert(X509 *x509)
+PKCS12_SAFEBAG * __cdecl PKCS12_SAFEBAG_create_cert(X509 *x509)
 {
     return PKCS12_item_pack_safebag(x509, ASN1_ITEM_rptr(X509),
                                     NID_x509Certificate, NID_certBag);
 }
 
-PKCS12_SAFEBAG *PKCS12_SAFEBAG_create_crl(X509_CRL *crl)
+PKCS12_SAFEBAG * __cdecl PKCS12_SAFEBAG_create_crl(X509_CRL *crl)
 {
     return PKCS12_item_pack_safebag(crl, ASN1_ITEM_rptr(X509_CRL),
                                     NID_x509Crl, NID_crlBag);
@@ -105,7 +105,7 @@ PKCS12_SAFEBAG *PKCS12_SAFEBAG_create_crl(X509_CRL *crl)
 
 /* Turn PKCS8 object into a keybag */
 
-PKCS12_SAFEBAG *PKCS12_SAFEBAG_create0_p8inf(PKCS8_PRIV_KEY_INFO *p8)
+PKCS12_SAFEBAG * __cdecl PKCS12_SAFEBAG_create0_p8inf(PKCS8_PRIV_KEY_INFO *p8)
 {
     PKCS12_SAFEBAG *bag = PKCS12_SAFEBAG_new();
 
@@ -120,7 +120,7 @@ PKCS12_SAFEBAG *PKCS12_SAFEBAG_create0_p8inf(PKCS8_PRIV_KEY_INFO *p8)
 
 /* Turn PKCS8 object into a shrouded keybag */
 
-PKCS12_SAFEBAG *PKCS12_SAFEBAG_create0_pkcs8(X509_SIG *p8)
+PKCS12_SAFEBAG *__cdecl PKCS12_SAFEBAG_create0_pkcs8(X509_SIG *p8)
 {
     PKCS12_SAFEBAG *bag = PKCS12_SAFEBAG_new();
 
@@ -134,7 +134,7 @@ PKCS12_SAFEBAG *PKCS12_SAFEBAG_create0_pkcs8(X509_SIG *p8)
     return bag;
 }
 
-PKCS12_SAFEBAG *PKCS12_SAFEBAG_create_pkcs8_encrypt(int pbe_nid,
+PKCS12_SAFEBAG * __cdecl PKCS12_SAFEBAG_create_pkcs8_encrypt(int pbe_nid,
                                                     const char *pass,
                                                     int passlen,
                                                     unsigned char *salt,
diff --git a/crypto/pkcs12/p12_utl.c b/crypto/pkcs12/p12_utl.c
index 43b9e3a594..de61a43344 100644
--- a/crypto/pkcs12/p12_utl.c
+++ b/crypto/pkcs12/p12_utl.c
@@ -13,7 +13,7 @@
 
 /* Cheap and nasty Unicode stuff */
 
-unsigned char *OPENSSL_asc2uni(const char *asc, int asclen,
+unsigned char * __cdecl OPENSSL_asc2uni(const char *asc, int asclen,
                                unsigned char **uni, int *unilen)
 {
     int ulen, i;
@@ -40,7 +40,7 @@ unsigned char *OPENSSL_asc2uni(const char *asc, int asclen,
     return unitmp;
 }
 
-char *OPENSSL_uni2asc(const unsigned char *uni, int unilen)
+char * __cdecl OPENSSL_uni2asc(const unsigned char *uni, int unilen)
 {
     int asclen, i;
     char *asctmp;
@@ -71,7 +71,7 @@ char *OPENSSL_uni2asc(const unsigned char *uni, int unilen)
  * expressed not in number of UTF-16 characters, but in number of
  * bytes the string occupies, and treat it, the length, accordingly.
  */
-unsigned char *OPENSSL_utf82uni(const char *asc, int asclen,
+unsigned char * __cdecl OPENSSL_utf82uni(const char *asc, int asclen,
                                 unsigned char **uni, int *unilen)
 {
     int ulen, i, j;
@@ -173,7 +173,7 @@ static int bmp_to_utf8(char *str, const unsigned char *utf16, int len)
     return UTF8_putc((unsigned char *)str, len > 4 ? 4 : len, utf32chr);
 }
 
-char *OPENSSL_uni2utf8(const unsigned char *uni, int unilen)
+char * __cdecl OPENSSL_uni2utf8(const unsigned char *uni, int unilen)
 {
     int asclen, i, j;
     char *asctmp;
@@ -219,25 +219,25 @@ char *OPENSSL_uni2utf8(const unsigned char *uni, int unilen)
     return asctmp;
 }
 
-int i2d_PKCS12_bio(BIO *bp, PKCS12 *p12)
+int __cdecl i2d_PKCS12_bio(BIO *bp, PKCS12 *p12)
 {
     return ASN1_item_i2d_bio(ASN1_ITEM_rptr(PKCS12), bp, p12);
 }
 
 #ifndef OPENSSL_NO_STDIO
-int i2d_PKCS12_fp(FILE *fp, PKCS12 *p12)
+int __cdecl i2d_PKCS12_fp(FILE *fp, PKCS12 *p12)
 {
     return ASN1_item_i2d_fp(ASN1_ITEM_rptr(PKCS12), fp, p12);
 }
 #endif
 
-PKCS12 *d2i_PKCS12_bio(BIO *bp, PKCS12 **p12)
+PKCS12 * __cdecl d2i_PKCS12_bio(BIO *bp, PKCS12 **p12)
 {
     return ASN1_item_d2i_bio(ASN1_ITEM_rptr(PKCS12), bp, p12);
 }
 
 #ifndef OPENSSL_NO_STDIO
-PKCS12 *d2i_PKCS12_fp(FILE *fp, PKCS12 **p12)
+PKCS12 * __cdecl d2i_PKCS12_fp(FILE *fp, PKCS12 **p12)
 {
     return ASN1_item_d2i_fp(ASN1_ITEM_rptr(PKCS12), fp, p12);
 }
diff --git a/crypto/pkcs12/pk12err.c b/crypto/pkcs12/pk12err.c
index 38ce5197ee..1721f6a907 100644
--- a/crypto/pkcs12/pk12err.c
+++ b/crypto/pkcs12/pk12err.c
@@ -105,7 +105,7 @@ static const ERR_STRING_DATA PKCS12_str_reasons[] = {
 
 #endif
 
-int ERR_load_PKCS12_strings(void)
+int __cdecl ERR_load_PKCS12_strings(void)
 {
 #ifndef OPENSSL_NO_ERR
     if (ERR_func_error_string(PKCS12_str_functs[0].error) == NULL) {
diff --git a/crypto/pkcs7/bio_pk7.c b/crypto/pkcs7/bio_pk7.c
index 29feaa3544..3a8aa5af98 100644
--- a/crypto/pkcs7/bio_pk7.c
+++ b/crypto/pkcs7/bio_pk7.c
@@ -18,7 +18,7 @@
 
 /* Streaming encode support for PKCS#7 */
 
-BIO *BIO_new_PKCS7(BIO *out, PKCS7 *p7)
+BIO * __cdecl BIO_new_PKCS7(BIO *out, PKCS7 *p7)
 {
     return BIO_new_NDEF(out, (ASN1_VALUE *)p7, ASN1_ITEM_rptr(PKCS7));
 }
diff --git a/crypto/pkcs7/pk7_attr.c b/crypto/pkcs7/pk7_attr.c
index e90bf03c52..9f46d043d7 100644
--- a/crypto/pkcs7/pk7_attr.c
+++ b/crypto/pkcs7/pk7_attr.c
@@ -17,7 +17,7 @@
 #include <openssl/x509.h>
 #include <openssl/err.h>
 
-int PKCS7_add_attrib_smimecap(PKCS7_SIGNER_INFO *si,
+int __cdecl PKCS7_add_attrib_smimecap(PKCS7_SIGNER_INFO *si,
                               STACK_OF(X509_ALGOR) *cap)
 {
     ASN1_STRING *seq;
@@ -32,7 +32,7 @@ int PKCS7_add_attrib_smimecap(PKCS7_SIGNER_INFO *si,
                                       V_ASN1_SEQUENCE, seq);
 }
 
-STACK_OF(X509_ALGOR) *PKCS7_get_smimecap(PKCS7_SIGNER_INFO *si)
+STACK_OF(X509_ALGOR) * __cdecl PKCS7_get_smimecap(PKCS7_SIGNER_INFO *si)
 {
     ASN1_TYPE *cap;
     const unsigned char *p;
@@ -47,7 +47,7 @@ STACK_OF(X509_ALGOR) *PKCS7_get_smimecap(PKCS7_SIGNER_INFO *si)
 }
 
 /* Basic smime-capabilities OID and optional integer arg */
-int PKCS7_simple_smimecap(STACK_OF(X509_ALGOR) *sk, int nid, int arg)
+int __cdecl PKCS7_simple_smimecap(STACK_OF(X509_ALGOR) *sk, int nid, int arg)
 {
     ASN1_INTEGER *nbit = NULL;
     X509_ALGOR *alg;
@@ -83,7 +83,7 @@ err:
     return 0;
 }
 
-int PKCS7_add_attrib_content_type(PKCS7_SIGNER_INFO *si, ASN1_OBJECT *coid)
+int __cdecl PKCS7_add_attrib_content_type(PKCS7_SIGNER_INFO *si, ASN1_OBJECT *coid)
 {
     if (PKCS7_get_signed_attribute(si, NID_pkcs9_contentType))
         return 0;
@@ -93,7 +93,7 @@ int PKCS7_add_attrib_content_type(PKCS7_SIGNER_INFO *si, ASN1_OBJECT *coid)
                                       V_ASN1_OBJECT, coid);
 }
 
-int PKCS7_add0_attrib_signing_time(PKCS7_SIGNER_INFO *si, ASN1_TIME *t)
+int __cdecl PKCS7_add0_attrib_signing_time(PKCS7_SIGNER_INFO *si, ASN1_TIME *t)
 {
     if (t == NULL && (t = X509_gmtime_adj(NULL, 0)) == NULL) {
         PKCS7err(PKCS7_F_PKCS7_ADD0_ATTRIB_SIGNING_TIME,
@@ -104,7 +104,7 @@ int PKCS7_add0_attrib_signing_time(PKCS7_SIGNER_INFO *si, ASN1_TIME *t)
                                       V_ASN1_UTCTIME, t);
 }
 
-int PKCS7_add1_attrib_digest(PKCS7_SIGNER_INFO *si,
+int __cdecl PKCS7_add1_attrib_digest(PKCS7_SIGNER_INFO *si,
                              const unsigned char *md, int mdlen)
 {
     ASN1_OCTET_STRING *os;
diff --git a/crypto/pkcs7/pk7_doit.c b/crypto/pkcs7/pk7_doit.c
index f63fbc50ea..9244160718 100644
--- a/crypto/pkcs7/pk7_doit.c
+++ b/crypto/pkcs7/pk7_doit.c
@@ -193,7 +193,7 @@ static int pkcs7_decrypt_rinfo(unsigned char **pek, int *peklen,
     return ret;
 }
 
-BIO *PKCS7_dataInit(PKCS7 *p7, BIO *bio)
+BIO * __cdecl PKCS7_dataInit(PKCS7 *p7, BIO *bio)
 {
     int i;
     BIO *out = NULL, *btmp = NULL;
@@ -356,7 +356,7 @@ static int pkcs7_cmp_ri(PKCS7_RECIP_INFO *ri, X509 *pcert)
 }
 
 /* int */
-BIO *PKCS7_dataDecode(PKCS7 *p7, EVP_PKEY *pkey, BIO *in_bio, X509 *pcert)
+BIO * __cdecl PKCS7_dataDecode(PKCS7 *p7, EVP_PKEY *pkey, BIO *in_bio, X509 *pcert)
 {
     int i, j;
     BIO *out = NULL, *btmp = NULL, *etmp = NULL, *bio = NULL;
@@ -642,7 +642,7 @@ static int do_pkcs7_signed_attrib(PKCS7_SIGNER_INFO *si, EVP_MD_CTX *mctx)
     return 1;
 }
 
-int PKCS7_dataFinal(PKCS7 *p7, BIO *bio)
+int __cdecl PKCS7_dataFinal(PKCS7 *p7, BIO *bio)
 {
     int ret = 0;
     int i, j;
@@ -816,7 +816,7 @@ int PKCS7_dataFinal(PKCS7 *p7, BIO *bio)
     return ret;
 }
 
-int PKCS7_SIGNER_INFO_sign(PKCS7_SIGNER_INFO *si)
+int __cdecl PKCS7_SIGNER_INFO_sign(PKCS7_SIGNER_INFO *si)
 {
     EVP_MD_CTX *mctx;
     EVP_PKEY_CTX *pctx = NULL;
@@ -879,7 +879,7 @@ int PKCS7_SIGNER_INFO_sign(PKCS7_SIGNER_INFO *si)
 
 }
 
-int PKCS7_dataVerify(X509_STORE *cert_store, X509_STORE_CTX *ctx, BIO *bio,
+int __cdecl PKCS7_dataVerify(X509_STORE *cert_store, X509_STORE_CTX *ctx, BIO *bio,
                      PKCS7 *p7, PKCS7_SIGNER_INFO *si)
 {
     PKCS7_ISSUER_AND_SERIAL *ias;
@@ -936,7 +936,7 @@ int PKCS7_dataVerify(X509_STORE *cert_store, X509_STORE_CTX *ctx, BIO *bio,
     return ret;
 }
 
-int PKCS7_signatureVerify(BIO *bio, PKCS7 *p7, PKCS7_SIGNER_INFO *si,
+int __cdecl PKCS7_signatureVerify(BIO *bio, PKCS7 *p7, PKCS7_SIGNER_INFO *si,
                           X509 *x509)
 {
     ASN1_OCTET_STRING *os;
@@ -1048,7 +1048,7 @@ int PKCS7_signatureVerify(BIO *bio, PKCS7 *p7, PKCS7_SIGNER_INFO *si,
     return ret;
 }
 
-PKCS7_ISSUER_AND_SERIAL *PKCS7_get_issuer_and_serial(PKCS7 *p7, int idx)
+PKCS7_ISSUER_AND_SERIAL * __cdecl PKCS7_get_issuer_and_serial(PKCS7 *p7, int idx)
 {
     STACK_OF(PKCS7_RECIP_INFO) *rsk;
     PKCS7_RECIP_INFO *ri;
@@ -1068,12 +1068,12 @@ PKCS7_ISSUER_AND_SERIAL *PKCS7_get_issuer_and_serial(PKCS7 *p7, int idx)
     return ri->issuer_and_serial;
 }
 
-ASN1_TYPE *PKCS7_get_signed_attribute(PKCS7_SIGNER_INFO *si, int nid)
+ASN1_TYPE * __cdecl PKCS7_get_signed_attribute(PKCS7_SIGNER_INFO *si, int nid)
 {
     return get_attribute(si->auth_attr, nid);
 }
 
-ASN1_TYPE *PKCS7_get_attribute(PKCS7_SIGNER_INFO *si, int nid)
+ASN1_TYPE * __cdecl PKCS7_get_attribute(PKCS7_SIGNER_INFO *si, int nid)
 {
     return get_attribute(si->unauth_attr, nid);
 }
@@ -1087,7 +1087,7 @@ static ASN1_TYPE *get_attribute(STACK_OF(X509_ATTRIBUTE) *sk, int nid)
     return X509_ATTRIBUTE_get0_type(xa, 0);
 }
 
-ASN1_OCTET_STRING *PKCS7_digest_from_attributes(STACK_OF(X509_ATTRIBUTE) *sk)
+ASN1_OCTET_STRING * __cdecl PKCS7_digest_from_attributes(STACK_OF(X509_ATTRIBUTE) *sk)
 {
     ASN1_TYPE *astype;
     if ((astype = get_attribute(sk, NID_pkcs9_messageDigest)) == NULL)
@@ -1095,7 +1095,7 @@ ASN1_OCTET_STRING *PKCS7_digest_from_attributes(STACK_OF(X509_ATTRIBUTE) *sk)
     return astype->value.octet_string;
 }
 
-int PKCS7_set_signed_attributes(PKCS7_SIGNER_INFO *p7si,
+int __cdecl PKCS7_set_signed_attributes(PKCS7_SIGNER_INFO *p7si,
                                 STACK_OF(X509_ATTRIBUTE) *sk)
 {
     int i;
@@ -1114,7 +1114,7 @@ int PKCS7_set_signed_attributes(PKCS7_SIGNER_INFO *p7si,
     return 1;
 }
 
-int PKCS7_set_attributes(PKCS7_SIGNER_INFO *p7si,
+int __cdecl PKCS7_set_attributes(PKCS7_SIGNER_INFO *p7si,
                          STACK_OF(X509_ATTRIBUTE) *sk)
 {
     int i;
@@ -1133,13 +1133,13 @@ int PKCS7_set_attributes(PKCS7_SIGNER_INFO *p7si,
     return 1;
 }
 
-int PKCS7_add_signed_attribute(PKCS7_SIGNER_INFO *p7si, int nid, int atrtype,
+int __cdecl PKCS7_add_signed_attribute(PKCS7_SIGNER_INFO *p7si, int nid, int atrtype,
                                void *value)
 {
     return add_attribute(&(p7si->auth_attr), nid, atrtype, value);
 }
 
-int PKCS7_add_attribute(PKCS7_SIGNER_INFO *p7si, int nid, int atrtype,
+int __cdecl PKCS7_add_attribute(PKCS7_SIGNER_INFO *p7si, int nid, int atrtype,
                         void *value)
 {
     return add_attribute(&(p7si->unauth_attr), nid, atrtype, value);
diff --git a/crypto/pkcs7/pk7_lib.c b/crypto/pkcs7/pk7_lib.c
index 16b76431d1..58786a3326 100644
--- a/crypto/pkcs7/pk7_lib.c
+++ b/crypto/pkcs7/pk7_lib.c
@@ -14,7 +14,7 @@
 #include "internal/asn1_int.h"
 #include "internal/evp_int.h"
 
-long PKCS7_ctrl(PKCS7 *p7, int cmd, long larg, char *parg)
+long __cdecl PKCS7_ctrl(PKCS7 *p7, int cmd, long larg, char *parg)
 {
     int nid;
     long ret;
@@ -60,7 +60,7 @@ long PKCS7_ctrl(PKCS7 *p7, int cmd, long larg, char *parg)
     return ret;
 }
 
-int PKCS7_content_new(PKCS7 *p7, int type)
+int __cdecl PKCS7_content_new(PKCS7 *p7, int type)
 {
     PKCS7 *ret = NULL;
 
@@ -77,7 +77,7 @@ int PKCS7_content_new(PKCS7 *p7, int type)
     return 0;
 }
 
-int PKCS7_set_content(PKCS7 *p7, PKCS7 *p7_data)
+int __cdecl PKCS7_set_content(PKCS7 *p7, PKCS7 *p7_data)
 {
     int i;
 
@@ -104,7 +104,7 @@ int PKCS7_set_content(PKCS7 *p7, PKCS7 *p7_data)
     return 0;
 }
 
-int PKCS7_set_type(PKCS7 *p7, int type)
+int __cdecl PKCS7_set_type(PKCS7 *p7, int type)
 {
     ASN1_OBJECT *obj;
 
@@ -175,14 +175,14 @@ int PKCS7_set_type(PKCS7 *p7, int type)
     return 0;
 }
 
-int PKCS7_set0_type_other(PKCS7 *p7, int type, ASN1_TYPE *other)
+int __cdecl PKCS7_set0_type_other(PKCS7 *p7, int type, ASN1_TYPE *other)
 {
     p7->type = OBJ_nid2obj(type);
     p7->d.other = other;
     return 1;
 }
 
-int PKCS7_add_signer(PKCS7 *p7, PKCS7_SIGNER_INFO *psi)
+int __cdecl PKCS7_add_signer(PKCS7 *p7, PKCS7_SIGNER_INFO *psi)
 {
     int i, j, nid;
     X509_ALGOR *alg;
@@ -235,7 +235,7 @@ int PKCS7_add_signer(PKCS7 *p7, PKCS7_SIGNER_INFO *psi)
     return 1;
 }
 
-int PKCS7_add_certificate(PKCS7 *p7, X509 *x509)
+int __cdecl PKCS7_add_certificate(PKCS7 *p7, X509 *x509)
 {
     int i;
     STACK_OF(X509) **sk;
@@ -267,7 +267,7 @@ int PKCS7_add_certificate(PKCS7 *p7, X509 *x509)
     return 1;
 }
 
-int PKCS7_add_crl(PKCS7 *p7, X509_CRL *crl)
+int __cdecl PKCS7_add_crl(PKCS7 *p7, X509_CRL *crl)
 {
     int i;
     STACK_OF(X509_CRL) **sk;
@@ -300,7 +300,7 @@ int PKCS7_add_crl(PKCS7 *p7, X509_CRL *crl)
     return 1;
 }
 
-int PKCS7_SIGNER_INFO_set(PKCS7_SIGNER_INFO *p7i, X509 *x509, EVP_PKEY *pkey,
+int __cdecl PKCS7_SIGNER_INFO_set(PKCS7_SIGNER_INFO *p7i, X509 *x509, EVP_PKEY *pkey,
                           const EVP_MD *dgst)
 {
     int ret;
@@ -346,7 +346,7 @@ int PKCS7_SIGNER_INFO_set(PKCS7_SIGNER_INFO *p7i, X509 *x509, EVP_PKEY *pkey,
     return 0;
 }
 
-PKCS7_SIGNER_INFO *PKCS7_add_signature(PKCS7 *p7, X509 *x509, EVP_PKEY *pkey,
+PKCS7_SIGNER_INFO * __cdecl PKCS7_add_signature(PKCS7 *p7, X509 *x509, EVP_PKEY *pkey,
                                        const EVP_MD *dgst)
 {
     PKCS7_SIGNER_INFO *si = NULL;
@@ -374,7 +374,7 @@ PKCS7_SIGNER_INFO *PKCS7_add_signature(PKCS7 *p7, X509 *x509, EVP_PKEY *pkey,
     return NULL;
 }
 
-int PKCS7_set_digest(PKCS7 *p7, const EVP_MD *md)
+int __cdecl PKCS7_set_digest(PKCS7 *p7, const EVP_MD *md)
 {
     if (PKCS7_type_is_digest(p7)) {
         if ((p7->d.digest->md->parameter = ASN1_TYPE_new()) == NULL) {
@@ -390,7 +390,7 @@ int PKCS7_set_digest(PKCS7 *p7, const EVP_MD *md)
     return 1;
 }
 
-STACK_OF(PKCS7_SIGNER_INFO) *PKCS7_get_signer_info(PKCS7 *p7)
+STACK_OF(PKCS7_SIGNER_INFO) * __cdecl PKCS7_get_signer_info(PKCS7 *p7)
 {
     if (p7 == NULL || p7->d.ptr == NULL)
         return NULL;
@@ -402,7 +402,7 @@ STACK_OF(PKCS7_SIGNER_INFO) *PKCS7_get_signer_info(PKCS7 *p7)
         return NULL;
 }
 
-void PKCS7_SIGNER_INFO_get0_algs(PKCS7_SIGNER_INFO *si, EVP_PKEY **pk,
+void __cdecl PKCS7_SIGNER_INFO_get0_algs(PKCS7_SIGNER_INFO *si, EVP_PKEY **pk,
                                  X509_ALGOR **pdig, X509_ALGOR **psig)
 {
     if (pk)
@@ -413,13 +413,13 @@ void PKCS7_SIGNER_INFO_get0_algs(PKCS7_SIGNER_INFO *si, EVP_PKEY **pk,
         *psig = si->digest_enc_alg;
 }
 
-void PKCS7_RECIP_INFO_get0_alg(PKCS7_RECIP_INFO *ri, X509_ALGOR **penc)
+void __cdecl PKCS7_RECIP_INFO_get0_alg(PKCS7_RECIP_INFO *ri, X509_ALGOR **penc)
 {
     if (penc)
         *penc = ri->key_enc_algor;
 }
 
-PKCS7_RECIP_INFO *PKCS7_add_recipient(PKCS7 *p7, X509 *x509)
+PKCS7_RECIP_INFO * __cdecl PKCS7_add_recipient(PKCS7 *p7, X509 *x509)
 {
     PKCS7_RECIP_INFO *ri;
 
@@ -435,7 +435,7 @@ PKCS7_RECIP_INFO *PKCS7_add_recipient(PKCS7 *p7, X509 *x509)
     return NULL;
 }
 
-int PKCS7_add_recipient_info(PKCS7 *p7, PKCS7_RECIP_INFO *ri)
+int __cdecl PKCS7_add_recipient_info(PKCS7 *p7, PKCS7_RECIP_INFO *ri)
 {
     int i;
     STACK_OF(PKCS7_RECIP_INFO) *sk;
@@ -459,7 +459,7 @@ int PKCS7_add_recipient_info(PKCS7 *p7, PKCS7_RECIP_INFO *ri)
     return 1;
 }
 
-int PKCS7_RECIP_INFO_set(PKCS7_RECIP_INFO *p7i, X509 *x509)
+int __cdecl PKCS7_RECIP_INFO_set(PKCS7_RECIP_INFO *p7i, X509 *x509)
 {
     int ret;
     EVP_PKEY *pkey = NULL;
@@ -503,7 +503,7 @@ int PKCS7_RECIP_INFO_set(PKCS7_RECIP_INFO *p7i, X509 *x509)
     return 0;
 }
 
-X509 *PKCS7_cert_from_signer_info(PKCS7 *p7, PKCS7_SIGNER_INFO *si)
+X509 * __cdecl PKCS7_cert_from_signer_info(PKCS7 *p7, PKCS7_SIGNER_INFO *si)
 {
     if (PKCS7_type_is_signed(p7))
         return (X509_find_by_issuer_and_serial(p7->d.sign->cert,
@@ -514,7 +514,7 @@ X509 *PKCS7_cert_from_signer_info(PKCS7 *p7, PKCS7_SIGNER_INFO *si)
         return NULL;
 }
 
-int PKCS7_set_cipher(PKCS7 *p7, const EVP_CIPHER *cipher)
+int __cdecl PKCS7_set_cipher(PKCS7 *p7, const EVP_CIPHER *cipher)
 {
     int i;
     PKCS7_ENC_CONTENT *ec;
@@ -544,7 +544,7 @@ int PKCS7_set_cipher(PKCS7 *p7, const EVP_CIPHER *cipher)
     return 1;
 }
 
-int PKCS7_stream(unsigned char ***boundary, PKCS7 *p7)
+int __cdecl PKCS7_stream(unsigned char ***boundary, PKCS7 *p7)
 {
     ASN1_OCTET_STRING *os = NULL;
 
diff --git a/crypto/pkcs7/pk7_mime.c b/crypto/pkcs7/pk7_mime.c
index 19e6868148..7d05add7d1 100644
--- a/crypto/pkcs7/pk7_mime.c
+++ b/crypto/pkcs7/pk7_mime.c
@@ -14,19 +14,19 @@
 
 /* PKCS#7 wrappers round generalised stream and MIME routines */
 
-int i2d_PKCS7_bio_stream(BIO *out, PKCS7 *p7, BIO *in, int flags)
+int __cdecl i2d_PKCS7_bio_stream(BIO *out, PKCS7 *p7, BIO *in, int flags)
 {
     return i2d_ASN1_bio_stream(out, (ASN1_VALUE *)p7, in, flags,
                                ASN1_ITEM_rptr(PKCS7));
 }
 
-int PEM_write_bio_PKCS7_stream(BIO *out, PKCS7 *p7, BIO *in, int flags)
+int __cdecl PEM_write_bio_PKCS7_stream(BIO *out, PKCS7 *p7, BIO *in, int flags)
 {
     return PEM_write_bio_ASN1_stream(out, (ASN1_VALUE *)p7, in, flags,
                                      "PKCS7", ASN1_ITEM_rptr(PKCS7));
 }
 
-int SMIME_write_PKCS7(BIO *bio, PKCS7 *p7, BIO *data, int flags)
+int __cdecl SMIME_write_PKCS7(BIO *bio, PKCS7 *p7, BIO *data, int flags)
 {
     STACK_OF(X509_ALGOR) *mdalgs;
     int ctype_nid = OBJ_obj2nid(p7->type);
@@ -42,7 +42,7 @@ int SMIME_write_PKCS7(BIO *bio, PKCS7 *p7, BIO *data, int flags)
                             ASN1_ITEM_rptr(PKCS7));
 }
 
-PKCS7 *SMIME_read_PKCS7(BIO *bio, BIO **bcont)
+PKCS7 * __cdecl SMIME_read_PKCS7(BIO *bio, BIO **bcont)
 {
     return (PKCS7 *)SMIME_read_ASN1(bio, bcont, ASN1_ITEM_rptr(PKCS7));
 }
diff --git a/crypto/pkcs7/pk7_smime.c b/crypto/pkcs7/pk7_smime.c
index 44187230ef..cf0bf00d58 100644
--- a/crypto/pkcs7/pk7_smime.c
+++ b/crypto/pkcs7/pk7_smime.c
@@ -19,7 +19,7 @@
 
 static int pkcs7_copy_existing_digest(PKCS7 *p7, PKCS7_SIGNER_INFO *si);
 
-PKCS7 *PKCS7_sign(X509 *signcert, EVP_PKEY *pkey, STACK_OF(X509) *certs,
+PKCS7 * __cdecl PKCS7_sign(X509 *signcert, EVP_PKEY *pkey, STACK_OF(X509) *certs,
                   BIO *data, int flags)
 {
     PKCS7 *p7;
@@ -62,7 +62,7 @@ PKCS7 *PKCS7_sign(X509 *signcert, EVP_PKEY *pkey, STACK_OF(X509) *certs,
     return NULL;
 }
 
-int PKCS7_final(PKCS7 *p7, BIO *data, int flags)
+int __cdecl PKCS7_final(PKCS7 *p7, BIO *data, int flags)
 {
     BIO *p7bio;
     int ret = 0;
@@ -106,7 +106,7 @@ static int add_digest_smcap(STACK_OF(X509_ALGOR) *sk, int nid, int arg)
     return 1;
 }
 
-PKCS7_SIGNER_INFO *PKCS7_sign_add_signer(PKCS7 *p7, X509 *signcert,
+PKCS7_SIGNER_INFO * __cdecl PKCS7_sign_add_signer(PKCS7 *p7, X509 *signcert,
                                          EVP_PKEY *pkey, const EVP_MD *md,
                                          int flags)
 {
@@ -201,7 +201,7 @@ static int pkcs7_copy_existing_digest(PKCS7 *p7, PKCS7_SIGNER_INFO *si)
     return 0;
 }
 
-int PKCS7_verify(PKCS7 *p7, STACK_OF(X509) *certs, X509_STORE *store,
+int __cdecl PKCS7_verify(PKCS7 *p7, STACK_OF(X509) *certs, X509_STORE *store,
                  BIO *indata, BIO *out, int flags)
 {
     STACK_OF(X509) *signers;
@@ -369,7 +369,7 @@ int PKCS7_verify(PKCS7 *p7, STACK_OF(X509) *certs, X509_STORE *store,
     return ret;
 }
 
-STACK_OF(X509) *PKCS7_get0_signers(PKCS7 *p7, STACK_OF(X509) *certs,
+STACK_OF(X509) * __cdecl PKCS7_get0_signers(PKCS7 *p7, STACK_OF(X509) *certs,
                                    int flags)
 {
     STACK_OF(X509) *signers;
@@ -433,7 +433,7 @@ STACK_OF(X509) *PKCS7_get0_signers(PKCS7 *p7, STACK_OF(X509) *certs,
 
 /* Build a complete PKCS#7 enveloped data */
 
-PKCS7 *PKCS7_encrypt(STACK_OF(X509) *certs, BIO *in, const EVP_CIPHER *cipher,
+PKCS7 * __cdecl PKCS7_encrypt(STACK_OF(X509) *certs, BIO *in, const EVP_CIPHER *cipher,
                      int flags)
 {
     PKCS7 *p7;
@@ -474,7 +474,7 @@ PKCS7 *PKCS7_encrypt(STACK_OF(X509) *certs, BIO *in, const EVP_CIPHER *cipher,
 
 }
 
-int PKCS7_decrypt(PKCS7 *p7, EVP_PKEY *pkey, X509 *cert, BIO *data, int flags)
+int __cdecl PKCS7_decrypt(PKCS7 *p7, EVP_PKEY *pkey, X509 *cert, BIO *data, int flags)
 {
     BIO *tmpmem;
     int ret = 0, i;
diff --git a/crypto/pkcs7/pkcs7err.c b/crypto/pkcs7/pkcs7err.c
index 07490c1a58..ee81c47365 100644
--- a/crypto/pkcs7/pkcs7err.c
+++ b/crypto/pkcs7/pkcs7err.c
@@ -144,7 +144,7 @@ static const ERR_STRING_DATA PKCS7_str_reasons[] = {
 
 #endif
 
-int ERR_load_PKCS7_strings(void)
+int __cdecl ERR_load_PKCS7_strings(void)
 {
 #ifndef OPENSSL_NO_ERR
     if (ERR_func_error_string(PKCS7_str_functs[0].error) == NULL) {
diff --git a/crypto/ripemd/rmd_dgst.c b/crypto/ripemd/rmd_dgst.c
index a1670c7fbd..f8b6a834f5 100644
--- a/crypto/ripemd/rmd_dgst.c
+++ b/crypto/ripemd/rmd_dgst.c
@@ -18,7 +18,7 @@ void ripemd160_block_x86(RIPEMD160_CTX *c, unsigned long *p, size_t num);
 void ripemd160_block(RIPEMD160_CTX *c, unsigned long *p, size_t num);
 #endif
 
-int RIPEMD160_Init(RIPEMD160_CTX *c)
+int __cdecl RIPEMD160_Init(RIPEMD160_CTX *c)
 {
     memset(c, 0, sizeof(*c));
     c->A = RIPEMD160_A;
diff --git a/crypto/rsa/rsa_lib.c b/crypto/rsa/rsa_lib.c
index e737a28898..1ba92cd08b 100644
--- a/crypto/rsa/rsa_lib.c
+++ b/crypto/rsa/rsa_lib.c
@@ -17,7 +17,7 @@
 #include "internal/evp_int.h"
 #include "rsa_locl.h"
 
-RSA *RSA_new(void)
+RSA * __cdecl RSA_new(void)
 {
     return RSA_new_method(NULL);
 }
diff --git a/crypto/rsa/rsa_locl.h b/crypto/rsa/rsa_locl.h
index 2b94462a94..6cedbac835 100644
--- a/crypto/rsa/rsa_locl.h
+++ b/crypto/rsa/rsa_locl.h
@@ -67,23 +67,23 @@ struct rsa_st {
 
 struct rsa_meth_st {
     char *name;
-    int (*rsa_pub_enc) (int flen, const unsigned char *from,
+    int (__cdecl *rsa_pub_enc) (int flen, const unsigned char *from,
                         unsigned char *to, RSA *rsa, int padding);
-    int (*rsa_pub_dec) (int flen, const unsigned char *from,
+    int (__cdecl *rsa_pub_dec) (int flen, const unsigned char *from,
                         unsigned char *to, RSA *rsa, int padding);
-    int (*rsa_priv_enc) (int flen, const unsigned char *from,
+    int (__cdecl *rsa_priv_enc) (int flen, const unsigned char *from,
                          unsigned char *to, RSA *rsa, int padding);
-    int (*rsa_priv_dec) (int flen, const unsigned char *from,
+    int (__cdecl *rsa_priv_dec) (int flen, const unsigned char *from,
                          unsigned char *to, RSA *rsa, int padding);
     /* Can be null */
-    int (*rsa_mod_exp) (BIGNUM *r0, const BIGNUM *I, RSA *rsa, BN_CTX *ctx);
+    int (__cdecl *rsa_mod_exp) (BIGNUM *r0, const BIGNUM *I, RSA *rsa, BN_CTX *ctx);
     /* Can be null */
-    int (*bn_mod_exp) (BIGNUM *r, const BIGNUM *a, const BIGNUM *p,
+    int (__cdecl *bn_mod_exp) (BIGNUM *r, const BIGNUM *a, const BIGNUM *p,
                        const BIGNUM *m, BN_CTX *ctx, BN_MONT_CTX *m_ctx);
     /* called at new */
-    int (*init) (RSA *rsa);
+    int (__cdecl *init) (RSA *rsa);
     /* called at free */
-    int (*finish) (RSA *rsa);
+    int (__cdecl *finish) (RSA *rsa);
     /* RSA_METHOD_FLAG_* things */
     int flags;
     /* may be needed! */
@@ -94,11 +94,11 @@ struct rsa_meth_st {
      * this to work the RSA_public_decrypt() and RSA_private_encrypt() should
      * *NOT* be used RSA_sign(), RSA_verify() should be used instead.
      */
-    int (*rsa_sign) (int type,
+    int (__cdecl *rsa_sign) (int type,
                      const unsigned char *m, unsigned int m_length,
                      unsigned char *sigret, unsigned int *siglen,
                      const RSA *rsa);
-    int (*rsa_verify) (int dtype, const unsigned char *m,
+    int (__cdecl *rsa_verify) (int dtype, const unsigned char *m,
                        unsigned int m_length, const unsigned char *sigbuf,
                        unsigned int siglen, const RSA *rsa);
     /*
@@ -107,8 +107,8 @@ struct rsa_meth_st {
      * rewired, but one day it would be nice to assume there are no such
      * things as "builtin software" implementations.
      */
-    int (*rsa_keygen) (RSA *rsa, int bits, BIGNUM *e, BN_GENCB *cb);
-    int (*rsa_multi_prime_keygen) (RSA *rsa, int bits, int primes,
+    int (__cdecl *rsa_keygen) (RSA *rsa, int bits, BIGNUM *e, BN_GENCB *cb);
+    int (__cdecl *rsa_multi_prime_keygen) (RSA *rsa, int bits, int primes,
                                    BIGNUM *e, BN_GENCB *cb);
 };
 
@@ -125,8 +125,8 @@ RSA_PSS_PARAMS *rsa_pss_params_create(const EVP_MD *sigmd,
 int rsa_pss_get_param(const RSA_PSS_PARAMS *pss, const EVP_MD **pmd,
                       const EVP_MD **pmgf1md, int *psaltlen);
 /* internal function to clear and free multi-prime parameters */
-void rsa_multip_info_free_ex(RSA_PRIME_INFO *pinfo);
-void rsa_multip_info_free(RSA_PRIME_INFO *pinfo);
+void __cdecl rsa_multip_info_free_ex(RSA_PRIME_INFO *pinfo);
+void __cdecl rsa_multip_info_free(RSA_PRIME_INFO *pinfo);
 RSA_PRIME_INFO *rsa_multip_info_new(void);
 int rsa_multip_calc_product(RSA *rsa);
 int rsa_multip_cap(int bits);
diff --git a/crypto/rsa/rsa_meth.c b/crypto/rsa/rsa_meth.c
index def19f375f..d8687a289e 100644
--- a/crypto/rsa/rsa_meth.c
+++ b/crypto/rsa/rsa_meth.c
@@ -97,15 +97,15 @@ int RSA_meth_set0_app_data(RSA_METHOD *meth, void *app_data)
     return 1;
 }
 
-int (*RSA_meth_get_pub_enc(const RSA_METHOD *meth))
+int (__cdecl *RSA_meth_get_pub_enc(const RSA_METHOD *meth))
     (int flen, const unsigned char *from,
      unsigned char *to, RSA *rsa, int padding)
 {
     return meth->rsa_pub_enc;
 }
 
-int RSA_meth_set_pub_enc(RSA_METHOD *meth,
-                         int (*pub_enc) (int flen, const unsigned char *from,
+int __cdecl RSA_meth_set_pub_enc(RSA_METHOD *meth,
+                         int (__cdecl *pub_enc) (int flen, const unsigned char *from,
                                          unsigned char *to, RSA *rsa,
                                          int padding))
 {
@@ -113,15 +113,15 @@ int RSA_meth_set_pub_enc(RSA_METHOD *meth,
     return 1;
 }
 
-int (*RSA_meth_get_pub_dec(const RSA_METHOD *meth))
+int (__cdecl *RSA_meth_get_pub_dec(const RSA_METHOD *meth))
     (int flen, const unsigned char *from,
      unsigned char *to, RSA *rsa, int padding)
 {
     return meth->rsa_pub_dec;
 }
 
-int RSA_meth_set_pub_dec(RSA_METHOD *meth,
-                         int (*pub_dec) (int flen, const unsigned char *from,
+int __cdecl RSA_meth_set_pub_dec(RSA_METHOD *meth,
+                         int (__cdecl *pub_dec) (int flen, const unsigned char *from,
                                          unsigned char *to, RSA *rsa,
                                          int padding))
 {
@@ -129,15 +129,15 @@ int RSA_meth_set_pub_dec(RSA_METHOD *meth,
     return 1;
 }
 
-int (*RSA_meth_get_priv_enc(const RSA_METHOD *meth))
+int (__cdecl *RSA_meth_get_priv_enc(const RSA_METHOD *meth))
     (int flen, const unsigned char *from,
      unsigned char *to, RSA *rsa, int padding)
 {
     return meth->rsa_priv_enc;
 }
 
-int RSA_meth_set_priv_enc(RSA_METHOD *meth,
-                          int (*priv_enc) (int flen, const unsigned char *from,
+int __cdecl RSA_meth_set_priv_enc(RSA_METHOD *meth,
+                          int (__cdecl *priv_enc) (int flen, const unsigned char *from,
                                            unsigned char *to, RSA *rsa,
                                            int padding))
 {
@@ -145,15 +145,15 @@ int RSA_meth_set_priv_enc(RSA_METHOD *meth,
     return 1;
 }
 
-int (*RSA_meth_get_priv_dec(const RSA_METHOD *meth))
+int (__cdecl *RSA_meth_get_priv_dec(const RSA_METHOD *meth))
     (int flen, const unsigned char *from,
      unsigned char *to, RSA *rsa, int padding)
 {
     return meth->rsa_priv_dec;
 }
 
-int RSA_meth_set_priv_dec(RSA_METHOD *meth,
-                          int (*priv_dec) (int flen, const unsigned char *from,
+int __cdecl RSA_meth_set_priv_dec(RSA_METHOD *meth,
+                          int (__cdecl *priv_dec) (int flen, const unsigned char *from,
                                            unsigned char *to, RSA *rsa,
                                            int padding))
 {
@@ -162,14 +162,14 @@ int RSA_meth_set_priv_dec(RSA_METHOD *meth,
 }
 
     /* Can be null */
-int (*RSA_meth_get_mod_exp(const RSA_METHOD *meth))
+int (__cdecl *RSA_meth_get_mod_exp(const RSA_METHOD *meth))
     (BIGNUM *r0, const BIGNUM *i, RSA *rsa, BN_CTX *ctx)
 {
     return meth->rsa_mod_exp;
 }
 
-int RSA_meth_set_mod_exp(RSA_METHOD *meth,
-                         int (*mod_exp) (BIGNUM *r0, const BIGNUM *i, RSA *rsa,
+int __cdecl RSA_meth_set_mod_exp(RSA_METHOD *meth,
+                         int (__cdecl *mod_exp) (BIGNUM *r0, const BIGNUM *i, RSA *rsa,
                                          BN_CTX *ctx))
 {
     meth->rsa_mod_exp = mod_exp;
@@ -177,15 +177,15 @@ int RSA_meth_set_mod_exp(RSA_METHOD *meth,
 }
 
     /* Can be null */
-int (*RSA_meth_get_bn_mod_exp(const RSA_METHOD *meth))
+int (__cdecl *RSA_meth_get_bn_mod_exp(const RSA_METHOD *meth))
     (BIGNUM *r, const BIGNUM *a, const BIGNUM *p,
      const BIGNUM *m, BN_CTX *ctx, BN_MONT_CTX *m_ctx)
 {
     return meth->bn_mod_exp;
 }
 
-int RSA_meth_set_bn_mod_exp(RSA_METHOD *meth,
-                            int (*bn_mod_exp) (BIGNUM *r,
+int __cdecl RSA_meth_set_bn_mod_exp(RSA_METHOD *meth,
+                            int (__cdecl *bn_mod_exp) (BIGNUM *r,
                                                const BIGNUM *a,
                                                const BIGNUM *p,
                                                const BIGNUM *m,
@@ -197,30 +197,30 @@ int RSA_meth_set_bn_mod_exp(RSA_METHOD *meth,
 }
 
     /* called at new */
-int (*RSA_meth_get_init(const RSA_METHOD *meth)) (RSA *rsa)
+int (__cdecl *RSA_meth_get_init(const RSA_METHOD *meth)) (RSA *rsa)
 {
     return meth->init;
 }
 
-int RSA_meth_set_init(RSA_METHOD *meth, int (*init) (RSA *rsa))
+int __cdecl RSA_meth_set_init(RSA_METHOD *meth, int (__cdecl *init) (RSA *rsa))
 {
     meth->init = init;
     return 1;
 }
 
     /* called at free */
-int (*RSA_meth_get_finish(const RSA_METHOD *meth)) (RSA *rsa)
+int (__cdecl *RSA_meth_get_finish(const RSA_METHOD *meth)) (RSA *rsa)
 {
     return meth->finish;
 }
 
-int RSA_meth_set_finish(RSA_METHOD *meth, int (*finish) (RSA *rsa))
+int __cdecl RSA_meth_set_finish(RSA_METHOD *meth, int (__cdecl *finish) (RSA *rsa))
 {
     meth->finish = finish;
     return 1;
 }
 
-int (*RSA_meth_get_sign(const RSA_METHOD *meth))
+int (__cdecl *RSA_meth_get_sign(const RSA_METHOD *meth))
     (int type,
      const unsigned char *m, unsigned int m_length,
      unsigned char *sigret, unsigned int *siglen,
@@ -229,8 +229,8 @@ int (*RSA_meth_get_sign(const RSA_METHOD *meth))
     return meth->rsa_sign;
 }
 
-int RSA_meth_set_sign(RSA_METHOD *meth,
-                      int (*sign) (int type, const unsigned char *m,
+int __cdecl RSA_meth_set_sign(RSA_METHOD *meth,
+                      int (__cdecl *sign) (int type, const unsigned char *m,
                                    unsigned int m_length,
                                    unsigned char *sigret, unsigned int *siglen,
                                    const RSA *rsa))
@@ -239,7 +239,7 @@ int RSA_meth_set_sign(RSA_METHOD *meth,
     return 1;
 }
 
-int (*RSA_meth_get_verify(const RSA_METHOD *meth))
+int (__cdecl *RSA_meth_get_verify(const RSA_METHOD *meth))
     (int dtype, const unsigned char *m,
      unsigned int m_length, const unsigned char *sigbuf,
      unsigned int siglen, const RSA *rsa)
@@ -247,8 +247,8 @@ int (*RSA_meth_get_verify(const RSA_METHOD *meth))
     return meth->rsa_verify;
 }
 
-int RSA_meth_set_verify(RSA_METHOD *meth,
-                        int (*verify) (int dtype, const unsigned char *m,
+int __cdecl RSA_meth_set_verify(RSA_METHOD *meth,
+                        int (__cdecl *verify) (int dtype, const unsigned char *m,
                                        unsigned int m_length,
                                        const unsigned char *sigbuf,
                                        unsigned int siglen, const RSA *rsa))
@@ -257,28 +257,28 @@ int RSA_meth_set_verify(RSA_METHOD *meth,
     return 1;
 }
 
-int (*RSA_meth_get_keygen(const RSA_METHOD *meth))
+int (__cdecl *RSA_meth_get_keygen(const RSA_METHOD *meth))
     (RSA *rsa, int bits, BIGNUM *e, BN_GENCB *cb)
 {
     return meth->rsa_keygen;
 }
 
-int RSA_meth_set_keygen(RSA_METHOD *meth,
-                        int (*keygen) (RSA *rsa, int bits, BIGNUM *e,
+int __cdecl RSA_meth_set_keygen(RSA_METHOD *meth,
+                        int (__cdecl *keygen) (RSA *rsa, int bits, BIGNUM *e,
                                        BN_GENCB *cb))
 {
     meth->rsa_keygen = keygen;
     return 1;
 }
 
-int (*RSA_meth_get_multi_prime_keygen(const RSA_METHOD *meth))
+int (__cdecl *RSA_meth_get_multi_prime_keygen(const RSA_METHOD *meth))
     (RSA *rsa, int bits, int primes, BIGNUM *e, BN_GENCB *cb)
 {
     return meth->rsa_multi_prime_keygen;
 }
 
-int RSA_meth_set_multi_prime_keygen(RSA_METHOD *meth,
-                                    int (*keygen) (RSA *rsa, int bits,
+int __cdecl RSA_meth_set_multi_prime_keygen(RSA_METHOD *meth,
+                                    int (__cdecl *keygen) (RSA *rsa, int bits,
                                                    int primes, BIGNUM *e,
                                                    BN_GENCB *cb))
 {
diff --git a/crypto/rsa/rsa_mp.c b/crypto/rsa/rsa_mp.c
index e7e810823b..b8c7a7396c 100644
--- a/crypto/rsa/rsa_mp.c
+++ b/crypto/rsa/rsa_mp.c
@@ -12,14 +12,14 @@
 #include <openssl/err.h>
 #include "rsa_locl.h"
 
-void rsa_multip_info_free_ex(RSA_PRIME_INFO *pinfo)
+void __cdecl rsa_multip_info_free_ex(RSA_PRIME_INFO *pinfo)
 {
     /* free pp and pinfo only */
     BN_clear_free(pinfo->pp);
     OPENSSL_free(pinfo);
 }
 
-void rsa_multip_info_free(RSA_PRIME_INFO *pinfo)
+void __cdecl rsa_multip_info_free(RSA_PRIME_INFO *pinfo)
 {
     /* free a RSA_PRIME_INFO structure */
     BN_clear_free(pinfo->r);
diff --git a/crypto/rsa/rsa_ossl.c b/crypto/rsa/rsa_ossl.c
index c8c3b7886a..9e022c1381 100644
--- a/crypto/rsa/rsa_ossl.c
+++ b/crypto/rsa/rsa_ossl.c
@@ -12,18 +12,18 @@
 #include "rsa_locl.h"
 #include "internal/constant_time_locl.h"
 
-static int rsa_ossl_public_encrypt(int flen, const unsigned char *from,
+static int __cdecl rsa_ossl_public_encrypt(int flen, const unsigned char *from,
                                   unsigned char *to, RSA *rsa, int padding);
-static int rsa_ossl_private_encrypt(int flen, const unsigned char *from,
+static int __cdecl rsa_ossl_private_encrypt(int flen, const unsigned char *from,
                                    unsigned char *to, RSA *rsa, int padding);
-static int rsa_ossl_public_decrypt(int flen, const unsigned char *from,
+static int __cdecl rsa_ossl_public_decrypt(int flen, const unsigned char *from,
                                   unsigned char *to, RSA *rsa, int padding);
-static int rsa_ossl_private_decrypt(int flen, const unsigned char *from,
+static int __cdecl rsa_ossl_private_decrypt(int flen, const unsigned char *from,
                                    unsigned char *to, RSA *rsa, int padding);
-static int rsa_ossl_mod_exp(BIGNUM *r0, const BIGNUM *i, RSA *rsa,
+static int __cdecl rsa_ossl_mod_exp(BIGNUM *r0, const BIGNUM *i, RSA *rsa,
                            BN_CTX *ctx);
-static int rsa_ossl_init(RSA *rsa);
-static int rsa_ossl_finish(RSA *rsa);
+static int __cdecl rsa_ossl_init(RSA *rsa);
+static int __cdecl rsa_ossl_finish(RSA *rsa);
 static RSA_METHOD rsa_pkcs1_ossl_meth = {
     "OpenSSL PKCS#1 RSA",
     rsa_ossl_public_encrypt,
@@ -65,7 +65,7 @@ const RSA_METHOD *RSA_null_method(void)
     return NULL;
 }
 
-static int rsa_ossl_public_encrypt(int flen, const unsigned char *from,
+static int __cdecl rsa_ossl_public_encrypt(int flen, const unsigned char *from,
                                   unsigned char *to, RSA *rsa, int padding)
 {
     BIGNUM *f, *ret;
@@ -230,7 +230,7 @@ static int rsa_blinding_invert(BN_BLINDING *b, BIGNUM *f, BIGNUM *unblind,
 }
 
 /* signing */
-static int rsa_ossl_private_encrypt(int flen, const unsigned char *from,
+static int __cdecl rsa_ossl_private_encrypt(int flen, const unsigned char *from,
                                    unsigned char *to, RSA *rsa, int padding)
 {
     BIGNUM *f, *ret, *res;
@@ -364,7 +364,7 @@ static int rsa_ossl_private_encrypt(int flen, const unsigned char *from,
     return r;
 }
 
-static int rsa_ossl_private_decrypt(int flen, const unsigned char *from,
+static int __cdecl rsa_ossl_private_decrypt(int flen, const unsigned char *from,
                                    unsigned char *to, RSA *rsa, int padding)
 {
     BIGNUM *f, *ret;
@@ -499,7 +499,7 @@ static int rsa_ossl_private_decrypt(int flen, const unsigned char *from,
 }
 
 /* signature verification */
-static int rsa_ossl_public_decrypt(int flen, const unsigned char *from,
+static int __cdecl rsa_ossl_public_decrypt(int flen, const unsigned char *from,
                                   unsigned char *to, RSA *rsa, int padding)
 {
     BIGNUM *f, *ret;
@@ -594,7 +594,7 @@ static int rsa_ossl_public_decrypt(int flen, const unsigned char *from,
     return r;
 }
 
-static int rsa_ossl_mod_exp(BIGNUM *r0, const BIGNUM *I, RSA *rsa, BN_CTX *ctx)
+static int __cdecl rsa_ossl_mod_exp(BIGNUM *r0, const BIGNUM *I, RSA *rsa, BN_CTX *ctx)
 {
     BIGNUM *r1, *m1, *vrfy, *r2, *m[RSA_MAX_PRIME_NUM - 2];
     int ret = 0, i, ex_primes = 0, smooth = 0;
@@ -954,13 +954,13 @@ static int rsa_ossl_mod_exp(BIGNUM *r0, const BIGNUM *I, RSA *rsa, BN_CTX *ctx)
     return ret;
 }
 
-static int rsa_ossl_init(RSA *rsa)
+static int __cdecl rsa_ossl_init(RSA *rsa)
 {
     rsa->flags |= RSA_FLAG_CACHE_PUBLIC | RSA_FLAG_CACHE_PRIVATE;
     return 1;
 }
 
-static int rsa_ossl_finish(RSA *rsa)
+static int __cdecl rsa_ossl_finish(RSA *rsa)
 {
     int i;
     RSA_PRIME_INFO *pinfo;
diff --git a/crypto/sha/keccak1600.c b/crypto/sha/keccak1600.c
index 55a44023d5..9e3e805b1b 100644
--- a/crypto/sha/keccak1600.c
+++ b/crypto/sha/keccak1600.c
@@ -1146,7 +1146,7 @@ void SHA3_sponge(const unsigned char *inp, size_t len,
 
 # include <stdio.h>
 
-int main()
+int __cdecl main()
 {
     /*
      * This is 5-bit SHAKE128 test from http://csrc.nist.gov/groups/ST/toolkit/examples.html#aHashing
diff --git a/crypto/sha/sha1_one.c b/crypto/sha/sha1_one.c
index e5b38211d2..5807649c8f 100644
--- a/crypto/sha/sha1_one.c
+++ b/crypto/sha/sha1_one.c
@@ -12,7 +12,7 @@
 #include <openssl/crypto.h>
 #include <openssl/sha.h>
 
-unsigned char *SHA1(const unsigned char *d, size_t n, unsigned char *md)
+unsigned char * __cdecl SHA1(const unsigned char *d, size_t n, unsigned char *md)
 {
     SHA_CTX c;
     static unsigned char m[SHA_DIGEST_LENGTH];
diff --git a/crypto/sha/sha256.c b/crypto/sha/sha256.c
index bf78f075ee..cde44fb98d 100644
--- a/crypto/sha/sha256.c
+++ b/crypto/sha/sha256.c
@@ -31,7 +31,7 @@ int SHA224_Init(SHA256_CTX *c)
     return 1;
 }
 
-int SHA256_Init(SHA256_CTX *c)
+int __cdecl SHA256_Init(SHA256_CTX *c)
 {
     memset(c, 0, sizeof(*c));
     c->h[0] = 0x6a09e667UL;
@@ -60,7 +60,7 @@ unsigned char *SHA224(const unsigned char *d, size_t n, unsigned char *md)
     return md;
 }
 
-unsigned char *SHA256(const unsigned char *d, size_t n, unsigned char *md)
+unsigned char * __cdecl SHA256(const unsigned char *d, size_t n, unsigned char *md)
 {
     SHA256_CTX c;
     static unsigned char m[SHA256_DIGEST_LENGTH];
diff --git a/crypto/sha/sha_locl.h b/crypto/sha/sha_locl.h
index 4e5a090382..20df4dc95f 100644
--- a/crypto/sha/sha_locl.h
+++ b/crypto/sha/sha_locl.h
@@ -50,7 +50,7 @@ void sha1_block_data_order(SHA_CTX *c, const void *p, size_t num);
 #define INIT_DATA_h3 0x10325476UL
 #define INIT_DATA_h4 0xc3d2e1f0UL
 
-int HASH_INIT(SHA_CTX *c)
+int __cdecl HASH_INIT(SHA_CTX *c)
 {
     memset(c, 0, sizeof(*c));
     c->h0 = INIT_DATA_h0;
diff --git a/crypto/sm3/m_sm3.c b/crypto/sm3/m_sm3.c
index 85538dc8af..2c6f3d0f49 100644
--- a/crypto/sm3/m_sm3.c
+++ b/crypto/sm3/m_sm3.c
@@ -44,7 +44,7 @@ static const EVP_MD sm3_md = {
     sizeof(EVP_MD *) + sizeof(SM3_CTX),
 };
 
-const EVP_MD *EVP_sm3(void)
+const EVP_MD * __cdecl EVP_sm3(void)
 {
     return &sm3_md;
 }
diff --git a/crypto/sm3/sm3.c b/crypto/sm3/sm3.c
index 1588dd115a..da11aeaa23 100644
--- a/crypto/sm3/sm3.c
+++ b/crypto/sm3/sm3.c
@@ -12,7 +12,7 @@
 #include <openssl/e_os2.h>
 #include "sm3_locl.h"
 
-int sm3_init(SM3_CTX *c)
+int __cdecl sm3_init(SM3_CTX *c)
 {
     memset(c, 0, sizeof(*c));
     c->A = SM3_A;
diff --git a/crypto/sm3/sm3_locl.h b/crypto/sm3/sm3_locl.h
index efa6db57c6..ec24600d91 100644
--- a/crypto/sm3/sm3_locl.h
+++ b/crypto/sm3/sm3_locl.h
@@ -34,7 +34,7 @@
       } while (0)
 #define HASH_BLOCK_DATA_ORDER   sm3_block_data_order
 
-void sm3_transform(SM3_CTX *c, const unsigned char *data);
+void __cdecl sm3_transform(SM3_CTX *c, const unsigned char *data);
 
 #include "internal/md32_common.h"
 
diff --git a/crypto/srp/srp_vfy.c b/crypto/srp/srp_vfy.c
index eb279dd418..68e177db22 100644
--- a/crypto/srp/srp_vfy.c
+++ b/crypto/srp/srp_vfy.c
@@ -173,7 +173,7 @@ static int t_tob64(char *dst, const unsigned char *src, int size)
     return 1;
 }
 
-void SRP_user_pwd_free(SRP_user_pwd *user_pwd)
+void __cdecl SRP_user_pwd_free(SRP_user_pwd *user_pwd)
 {
     if (user_pwd == NULL)
         return;
diff --git a/crypto/stack/stack.c b/crypto/stack/stack.c
index 975515db59..80248f71b0 100644
--- a/crypto/stack/stack.c
+++ b/crypto/stack/stack.c
@@ -357,7 +357,7 @@ void OPENSSL_sk_zero(OPENSSL_STACK *st)
     st->num = 0;
 }
 
-void OPENSSL_sk_pop_free(OPENSSL_STACK *st, OPENSSL_sk_freefunc func)
+void __cdecl OPENSSL_sk_pop_free(OPENSSL_STACK *st, OPENSSL_sk_freefunc func)
 {
     int i;
 
@@ -377,12 +377,12 @@ void OPENSSL_sk_free(OPENSSL_STACK *st)
     OPENSSL_free(st);
 }
 
-int OPENSSL_sk_num(const OPENSSL_STACK *st)
+int __cdecl OPENSSL_sk_num(const OPENSSL_STACK *st)
 {
     return st == NULL ? -1 : st->num;
 }
 
-void *OPENSSL_sk_value(const OPENSSL_STACK *st, int i)
+void * __cdecl OPENSSL_sk_value(const OPENSSL_STACK *st, int i)
 {
     if (st == NULL || i < 0 || i >= st->num)
         return NULL;
diff --git a/crypto/store/store_lib.c b/crypto/store/store_lib.c
index 7de2e31f55..dcd8211221 100644
--- a/crypto/store/store_lib.c
+++ b/crypto/store/store_lib.c
@@ -439,7 +439,7 @@ X509_CRL *OSSL_STORE_INFO_get1_CRL(const OSSL_STORE_INFO *info)
 /*
  * Free the OSSL_STORE_INFO
  */
-void OSSL_STORE_INFO_free(OSSL_STORE_INFO *info)
+void __cdecl OSSL_STORE_INFO_free(OSSL_STORE_INFO *info)
 {
     if (info != NULL) {
         switch (info->type) {
diff --git a/crypto/store/store_register.c b/crypto/store/store_register.c
index e68cb3c568..e141dc8bd6 100644
--- a/crypto/store/store_register.c
+++ b/crypto/store/store_register.c
@@ -134,7 +134,7 @@ static unsigned long store_loader_hash(const OSSL_STORE_LOADER *v)
     return OPENSSL_LH_strhash(v->scheme);
 }
 
-static int store_loader_cmp(const OSSL_STORE_LOADER *a,
+static int __cdecl store_loader_cmp(const OSSL_STORE_LOADER *a,
                             const OSSL_STORE_LOADER *b)
 {
     assert(a->scheme != NULL && b->scheme != NULL);
diff --git a/crypto/threads_none.c b/crypto/threads_none.c
index aabf0e0dc0..744fad452c 100644
--- a/crypto/threads_none.c
+++ b/crypto/threads_none.c
@@ -17,7 +17,7 @@
 #  include <unistd.h>
 # endif
 
-CRYPTO_RWLOCK *CRYPTO_THREAD_lock_new(void)
+CRYPTO_RWLOCK * __cdecl CRYPTO_THREAD_lock_new(void)
 {
     CRYPTO_RWLOCK *lock;
 
@@ -31,28 +31,28 @@ CRYPTO_RWLOCK *CRYPTO_THREAD_lock_new(void)
     return lock;
 }
 
-int CRYPTO_THREAD_read_lock(CRYPTO_RWLOCK *lock)
+int __cdecl CRYPTO_THREAD_read_lock(CRYPTO_RWLOCK *lock)
 {
     if (!ossl_assert(*(unsigned int *)lock == 1))
         return 0;
     return 1;
 }
 
-int CRYPTO_THREAD_write_lock(CRYPTO_RWLOCK *lock)
+int __cdecl CRYPTO_THREAD_write_lock(CRYPTO_RWLOCK *lock)
 {
     if (!ossl_assert(*(unsigned int *)lock == 1))
         return 0;
     return 1;
 }
 
-int CRYPTO_THREAD_unlock(CRYPTO_RWLOCK *lock)
+int __cdecl CRYPTO_THREAD_unlock(CRYPTO_RWLOCK *lock)
 {
     if (!ossl_assert(*(unsigned int *)lock == 1))
         return 0;
     return 1;
 }
 
-void CRYPTO_THREAD_lock_free(CRYPTO_RWLOCK *lock) {
+void __cdecl CRYPTO_THREAD_lock_free(CRYPTO_RWLOCK *lock) {
     if (lock == NULL)
         return;
 
@@ -62,7 +62,7 @@ void CRYPTO_THREAD_lock_free(CRYPTO_RWLOCK *lock) {
     return;
 }
 
-int CRYPTO_THREAD_run_once(CRYPTO_ONCE *once, void (*init)(void))
+int __cdecl CRYPTO_THREAD_run_once(CRYPTO_ONCE *once, void (*init)(void))
 {
     if (*once != 0)
         return 1;
@@ -77,7 +77,7 @@ int CRYPTO_THREAD_run_once(CRYPTO_ONCE *once, void (*init)(void))
 
 static void *thread_local_storage[OPENSSL_CRYPTO_THREAD_LOCAL_KEY_MAX];
 
-int CRYPTO_THREAD_init_local(CRYPTO_THREAD_LOCAL *key, void (*cleanup)(void *))
+int __cdecl CRYPTO_THREAD_init_local(CRYPTO_THREAD_LOCAL *key, void (*cleanup)(void *))
 {
     static unsigned int thread_local_key = 0;
 
@@ -91,7 +91,7 @@ int CRYPTO_THREAD_init_local(CRYPTO_THREAD_LOCAL *key, void (*cleanup)(void *))
     return 1;
 }
 
-void *CRYPTO_THREAD_get_local(CRYPTO_THREAD_LOCAL *key)
+void * __cdecl CRYPTO_THREAD_get_local(CRYPTO_THREAD_LOCAL *key)
 {
     if (*key >= OPENSSL_CRYPTO_THREAD_LOCAL_KEY_MAX)
         return NULL;
@@ -99,7 +99,7 @@ void *CRYPTO_THREAD_get_local(CRYPTO_THREAD_LOCAL *key)
     return thread_local_storage[*key];
 }
 
-int CRYPTO_THREAD_set_local(CRYPTO_THREAD_LOCAL *key, void *val)
+int __cdecl CRYPTO_THREAD_set_local(CRYPTO_THREAD_LOCAL *key, void *val)
 {
     if (*key >= OPENSSL_CRYPTO_THREAD_LOCAL_KEY_MAX)
         return 0;
@@ -109,23 +109,23 @@ int CRYPTO_THREAD_set_local(CRYPTO_THREAD_LOCAL *key, void *val)
     return 1;
 }
 
-int CRYPTO_THREAD_cleanup_local(CRYPTO_THREAD_LOCAL *key)
+int __cdecl CRYPTO_THREAD_cleanup_local(CRYPTO_THREAD_LOCAL *key)
 {
     *key = OPENSSL_CRYPTO_THREAD_LOCAL_KEY_MAX + 1;
     return 1;
 }
 
-CRYPTO_THREAD_ID CRYPTO_THREAD_get_current_id(void)
+CRYPTO_THREAD_ID __cdecl CRYPTO_THREAD_get_current_id(void)
 {
     return 0;
 }
 
-int CRYPTO_THREAD_compare_id(CRYPTO_THREAD_ID a, CRYPTO_THREAD_ID b)
+int __cdecl CRYPTO_THREAD_compare_id(CRYPTO_THREAD_ID a, CRYPTO_THREAD_ID b)
 {
     return (a == b);
 }
 
-int CRYPTO_atomic_add(int *val, int amount, int *ret, CRYPTO_RWLOCK *lock)
+int __cdecl CRYPTO_atomic_add(int *val, int amount, int *ret, CRYPTO_RWLOCK *lock)
 {
     *val += amount;
     *ret  = *val;
diff --git a/crypto/threads_pthread.c b/crypto/threads_pthread.c
index 1774a2b2ac..1ee53716d3 100644
--- a/crypto/threads_pthread.c
+++ b/crypto/threads_pthread.c
@@ -21,7 +21,7 @@
 #  define USE_RWLOCK
 # endif
 
-CRYPTO_RWLOCK *CRYPTO_THREAD_lock_new(void)
+CRYPTO_RWLOCK * __cdecl CRYPTO_THREAD_lock_new(void)
 {
 # ifdef USE_RWLOCK
     CRYPTO_RWLOCK *lock;
@@ -59,7 +59,7 @@ CRYPTO_RWLOCK *CRYPTO_THREAD_lock_new(void)
     return lock;
 }
 
-int CRYPTO_THREAD_read_lock(CRYPTO_RWLOCK *lock)
+int __cdecl CRYPTO_THREAD_read_lock(CRYPTO_RWLOCK *lock)
 {
 # ifdef USE_RWLOCK
     if (pthread_rwlock_rdlock(lock) != 0)
@@ -72,7 +72,7 @@ int CRYPTO_THREAD_read_lock(CRYPTO_RWLOCK *lock)
     return 1;
 }
 
-int CRYPTO_THREAD_write_lock(CRYPTO_RWLOCK *lock)
+int __cdecl CRYPTO_THREAD_write_lock(CRYPTO_RWLOCK *lock)
 {
 # ifdef USE_RWLOCK
     if (pthread_rwlock_wrlock(lock) != 0)
@@ -85,7 +85,7 @@ int CRYPTO_THREAD_write_lock(CRYPTO_RWLOCK *lock)
     return 1;
 }
 
-int CRYPTO_THREAD_unlock(CRYPTO_RWLOCK *lock)
+int __cdecl CRYPTO_THREAD_unlock(CRYPTO_RWLOCK *lock)
 {
 # ifdef USE_RWLOCK
     if (pthread_rwlock_unlock(lock) != 0)
@@ -98,7 +98,7 @@ int CRYPTO_THREAD_unlock(CRYPTO_RWLOCK *lock)
     return 1;
 }
 
-void CRYPTO_THREAD_lock_free(CRYPTO_RWLOCK *lock)
+void __cdecl CRYPTO_THREAD_lock_free(CRYPTO_RWLOCK *lock)
 {
     if (lock == NULL)
         return;
@@ -113,7 +113,7 @@ void CRYPTO_THREAD_lock_free(CRYPTO_RWLOCK *lock)
     return;
 }
 
-int CRYPTO_THREAD_run_once(CRYPTO_ONCE *once, void (*init)(void))
+int __cdecl CRYPTO_THREAD_run_once(CRYPTO_ONCE *once, void (*init)(void))
 {
     if (pthread_once(once, init) != 0)
         return 0;
@@ -160,7 +160,7 @@ int CRYPTO_THREAD_compare_id(CRYPTO_THREAD_ID a, CRYPTO_THREAD_ID b)
     return pthread_equal(a, b);
 }
 
-int CRYPTO_atomic_add(int *val, int amount, int *ret, CRYPTO_RWLOCK *lock)
+int __cdecl CRYPTO_atomic_add(int *val, int amount, int *ret, CRYPTO_RWLOCK *lock)
 {
 # if defined(__GNUC__) && defined(__ATOMIC_ACQ_REL)
     if (__atomic_is_lock_free(sizeof(*val), val)) {
diff --git a/crypto/threads_win.c b/crypto/threads_win.c
index 44a360fcab..499d9d2a9f 100644
--- a/crypto/threads_win.c
+++ b/crypto/threads_win.c
@@ -15,7 +15,7 @@
 
 #if defined(OPENSSL_THREADS) && !defined(CRYPTO_TDEBUG) && defined(OPENSSL_SYS_WINDOWS)
 
-CRYPTO_RWLOCK *CRYPTO_THREAD_lock_new(void)
+CRYPTO_RWLOCK * __cdecl CRYPTO_THREAD_lock_new(void)
 {
     CRYPTO_RWLOCK *lock;
 
@@ -37,25 +37,25 @@ CRYPTO_RWLOCK *CRYPTO_THREAD_lock_new(void)
     return lock;
 }
 
-int CRYPTO_THREAD_read_lock(CRYPTO_RWLOCK *lock)
+int __cdecl CRYPTO_THREAD_read_lock(CRYPTO_RWLOCK *lock)
 {
     EnterCriticalSection(lock);
     return 1;
 }
 
-int CRYPTO_THREAD_write_lock(CRYPTO_RWLOCK *lock)
+int __cdecl CRYPTO_THREAD_write_lock(CRYPTO_RWLOCK *lock)
 {
     EnterCriticalSection(lock);
     return 1;
 }
 
-int CRYPTO_THREAD_unlock(CRYPTO_RWLOCK *lock)
+int __cdecl CRYPTO_THREAD_unlock(CRYPTO_RWLOCK *lock)
 {
     LeaveCriticalSection(lock);
     return 1;
 }
 
-void CRYPTO_THREAD_lock_free(CRYPTO_RWLOCK *lock)
+void __cdecl CRYPTO_THREAD_lock_free(CRYPTO_RWLOCK *lock)
 {
     if (lock == NULL)
         return;
@@ -74,7 +74,7 @@ void CRYPTO_THREAD_lock_free(CRYPTO_RWLOCK *lock)
  * We don't use InitOnceExecuteOnce because that isn't available in WinXP which
  * we still have to support.
  */
-int CRYPTO_THREAD_run_once(CRYPTO_ONCE *once, void (*init)(void))
+int __cdecl CRYPTO_THREAD_run_once(CRYPTO_ONCE *once, void (*init)(void))
 {
     LONG volatile *lock = (LONG *)once;
     LONG result;
@@ -94,7 +94,7 @@ int CRYPTO_THREAD_run_once(CRYPTO_ONCE *once, void (*init)(void))
     return (*lock == ONCE_DONE);
 }
 
-int CRYPTO_THREAD_init_local(CRYPTO_THREAD_LOCAL *key, void (*cleanup)(void *))
+int __cdecl CRYPTO_THREAD_init_local(CRYPTO_THREAD_LOCAL *key, void (*cleanup)(void *))
 {
     *key = TlsAlloc();
     if (*key == TLS_OUT_OF_INDEXES)
@@ -103,7 +103,7 @@ int CRYPTO_THREAD_init_local(CRYPTO_THREAD_LOCAL *key, void (*cleanup)(void *))
     return 1;
 }
 
-void *CRYPTO_THREAD_get_local(CRYPTO_THREAD_LOCAL *key)
+void * __cdecl CRYPTO_THREAD_get_local(CRYPTO_THREAD_LOCAL *key)
 {
     DWORD last_error;
     void *ret;
@@ -127,7 +127,7 @@ void *CRYPTO_THREAD_get_local(CRYPTO_THREAD_LOCAL *key)
     return ret;
 }
 
-int CRYPTO_THREAD_set_local(CRYPTO_THREAD_LOCAL *key, void *val)
+int __cdecl CRYPTO_THREAD_set_local(CRYPTO_THREAD_LOCAL *key, void *val)
 {
     if (TlsSetValue(*key, val) == 0)
         return 0;
@@ -135,7 +135,7 @@ int CRYPTO_THREAD_set_local(CRYPTO_THREAD_LOCAL *key, void *val)
     return 1;
 }
 
-int CRYPTO_THREAD_cleanup_local(CRYPTO_THREAD_LOCAL *key)
+int __cdecl CRYPTO_THREAD_cleanup_local(CRYPTO_THREAD_LOCAL *key)
 {
     if (TlsFree(*key) == 0)
         return 0;
@@ -143,17 +143,17 @@ int CRYPTO_THREAD_cleanup_local(CRYPTO_THREAD_LOCAL *key)
     return 1;
 }
 
-CRYPTO_THREAD_ID CRYPTO_THREAD_get_current_id(void)
+CRYPTO_THREAD_ID __cdecl CRYPTO_THREAD_get_current_id(void)
 {
     return GetCurrentThreadId();
 }
 
-int CRYPTO_THREAD_compare_id(CRYPTO_THREAD_ID a, CRYPTO_THREAD_ID b)
+int __cdecl CRYPTO_THREAD_compare_id(CRYPTO_THREAD_ID a, CRYPTO_THREAD_ID b)
 {
     return (a == b);
 }
 
-int CRYPTO_atomic_add(int *val, int amount, int *ret, CRYPTO_RWLOCK *lock)
+int __cdecl CRYPTO_atomic_add(int *val, int amount, int *ret, CRYPTO_RWLOCK *lock)
 {
     *ret = InterlockedExchangeAdd(val, amount) + amount;
     return 1;
diff --git a/crypto/ts/ts_asn1.c b/crypto/ts/ts_asn1.c
index 8707207082..ff5b77c36c 100644
--- a/crypto/ts/ts_asn1.c
+++ b/crypto/ts/ts_asn1.c
@@ -19,24 +19,24 @@ ASN1_SEQUENCE(TS_MSG_IMPRINT) = {
 
 IMPLEMENT_ASN1_FUNCTIONS_const(TS_MSG_IMPRINT)
 IMPLEMENT_ASN1_DUP_FUNCTION(TS_MSG_IMPRINT)
-TS_MSG_IMPRINT *d2i_TS_MSG_IMPRINT_bio(BIO *bp, TS_MSG_IMPRINT **a)
+TS_MSG_IMPRINT * __cdecl d2i_TS_MSG_IMPRINT_bio(BIO *bp, TS_MSG_IMPRINT **a)
 {
     return ASN1_d2i_bio_of(TS_MSG_IMPRINT, TS_MSG_IMPRINT_new,
                            d2i_TS_MSG_IMPRINT, bp, a);
 }
 
-int i2d_TS_MSG_IMPRINT_bio(BIO *bp, TS_MSG_IMPRINT *a)
+int __cdecl i2d_TS_MSG_IMPRINT_bio(BIO *bp, TS_MSG_IMPRINT *a)
 {
     return ASN1_i2d_bio_of_const(TS_MSG_IMPRINT, i2d_TS_MSG_IMPRINT, bp, a);
 }
 #ifndef OPENSSL_NO_STDIO
-TS_MSG_IMPRINT *d2i_TS_MSG_IMPRINT_fp(FILE *fp, TS_MSG_IMPRINT **a)
+TS_MSG_IMPRINT * __cdecl d2i_TS_MSG_IMPRINT_fp(FILE *fp, TS_MSG_IMPRINT **a)
 {
     return ASN1_d2i_fp_of(TS_MSG_IMPRINT, TS_MSG_IMPRINT_new,
                           d2i_TS_MSG_IMPRINT, fp, a);
 }
 
-int i2d_TS_MSG_IMPRINT_fp(FILE *fp, TS_MSG_IMPRINT *a)
+int __cdecl i2d_TS_MSG_IMPRINT_fp(FILE *fp, TS_MSG_IMPRINT *a)
 {
     return ASN1_i2d_fp_of_const(TS_MSG_IMPRINT, i2d_TS_MSG_IMPRINT, fp, a);
 }
@@ -53,22 +53,22 @@ ASN1_SEQUENCE(TS_REQ) = {
 
 IMPLEMENT_ASN1_FUNCTIONS_const(TS_REQ)
 IMPLEMENT_ASN1_DUP_FUNCTION(TS_REQ)
-TS_REQ *d2i_TS_REQ_bio(BIO *bp, TS_REQ **a)
+TS_REQ * __cdecl d2i_TS_REQ_bio(BIO *bp, TS_REQ **a)
 {
     return ASN1_d2i_bio_of(TS_REQ, TS_REQ_new, d2i_TS_REQ, bp, a);
 }
 
-int i2d_TS_REQ_bio(BIO *bp, TS_REQ *a)
+int __cdecl i2d_TS_REQ_bio(BIO *bp, TS_REQ *a)
 {
     return ASN1_i2d_bio_of_const(TS_REQ, i2d_TS_REQ, bp, a);
 }
 #ifndef OPENSSL_NO_STDIO
-TS_REQ *d2i_TS_REQ_fp(FILE *fp, TS_REQ **a)
+TS_REQ * __cdecl d2i_TS_REQ_fp(FILE *fp, TS_REQ **a)
 {
     return ASN1_d2i_fp_of(TS_REQ, TS_REQ_new, d2i_TS_REQ, fp, a);
 }
 
-int i2d_TS_REQ_fp(FILE *fp, TS_REQ *a)
+int __cdecl i2d_TS_REQ_fp(FILE *fp, TS_REQ *a)
 {
     return ASN1_i2d_fp_of_const(TS_REQ, i2d_TS_REQ, fp, a);
 }
@@ -98,24 +98,24 @@ ASN1_SEQUENCE(TS_TST_INFO) = {
 
 IMPLEMENT_ASN1_FUNCTIONS_const(TS_TST_INFO)
 IMPLEMENT_ASN1_DUP_FUNCTION(TS_TST_INFO)
-TS_TST_INFO *d2i_TS_TST_INFO_bio(BIO *bp, TS_TST_INFO **a)
+TS_TST_INFO * __cdecl d2i_TS_TST_INFO_bio(BIO *bp, TS_TST_INFO **a)
 {
     return ASN1_d2i_bio_of(TS_TST_INFO, TS_TST_INFO_new, d2i_TS_TST_INFO, bp,
                            a);
 }
 
-int i2d_TS_TST_INFO_bio(BIO *bp, TS_TST_INFO *a)
+int __cdecl i2d_TS_TST_INFO_bio(BIO *bp, TS_TST_INFO *a)
 {
     return ASN1_i2d_bio_of_const(TS_TST_INFO, i2d_TS_TST_INFO, bp, a);
 }
 #ifndef OPENSSL_NO_STDIO
-TS_TST_INFO *d2i_TS_TST_INFO_fp(FILE *fp, TS_TST_INFO **a)
+TS_TST_INFO * __cdecl d2i_TS_TST_INFO_fp(FILE *fp, TS_TST_INFO **a)
 {
     return ASN1_d2i_fp_of(TS_TST_INFO, TS_TST_INFO_new, d2i_TS_TST_INFO, fp,
                           a);
 }
 
-int i2d_TS_TST_INFO_fp(FILE *fp, TS_TST_INFO *a)
+int __cdecl i2d_TS_TST_INFO_fp(FILE *fp, TS_TST_INFO *a)
 {
     return ASN1_i2d_fp_of_const(TS_TST_INFO, i2d_TS_TST_INFO, fp, a);
 }
@@ -180,22 +180,22 @@ IMPLEMENT_ASN1_FUNCTIONS_const(TS_RESP)
 
 IMPLEMENT_ASN1_DUP_FUNCTION(TS_RESP)
 
-TS_RESP *d2i_TS_RESP_bio(BIO *bp, TS_RESP **a)
+TS_RESP * __cdecl d2i_TS_RESP_bio(BIO *bp, TS_RESP **a)
 {
     return ASN1_d2i_bio_of(TS_RESP, TS_RESP_new, d2i_TS_RESP, bp, a);
 }
 
-int i2d_TS_RESP_bio(BIO *bp, TS_RESP *a)
+int __cdecl i2d_TS_RESP_bio(BIO *bp, TS_RESP *a)
 {
     return ASN1_i2d_bio_of_const(TS_RESP, i2d_TS_RESP, bp, a);
 }
 #ifndef OPENSSL_NO_STDIO
-TS_RESP *d2i_TS_RESP_fp(FILE *fp, TS_RESP **a)
+TS_RESP * __cdecl d2i_TS_RESP_fp(FILE *fp, TS_RESP **a)
 {
     return ASN1_d2i_fp_of(TS_RESP, TS_RESP_new, d2i_TS_RESP, fp, a);
 }
 
-int i2d_TS_RESP_fp(FILE *fp, TS_RESP *a)
+int __cdecl i2d_TS_RESP_fp(FILE *fp, TS_RESP *a)
 {
     return ASN1_i2d_fp_of_const(TS_RESP, i2d_TS_RESP, fp, a);
 }
@@ -243,7 +243,7 @@ IMPLEMENT_ASN1_FUNCTIONS_const(ESS_SIGNING_CERT_V2)
 IMPLEMENT_ASN1_DUP_FUNCTION(ESS_SIGNING_CERT_V2)
 
 /* Getting encapsulated TS_TST_INFO object from PKCS7. */
-TS_TST_INFO *PKCS7_to_TS_TST_INFO(PKCS7 *token)
+TS_TST_INFO * __cdecl PKCS7_to_TS_TST_INFO(PKCS7 *token)
 {
     PKCS7_SIGNED *pkcs7_signed;
     PKCS7 *enveloped;
diff --git a/crypto/ts/ts_conf.c b/crypto/ts/ts_conf.c
index 625089a59b..d315780109 100644
--- a/crypto/ts/ts_conf.c
+++ b/crypto/ts/ts_conf.c
@@ -41,7 +41,7 @@
 
 /* Function definitions for certificate and key loading. */
 
-X509 *TS_CONF_load_cert(const char *file)
+X509 * __cdecl TS_CONF_load_cert(const char *file)
 {
     BIO *cert = NULL;
     X509 *x = NULL;
@@ -56,7 +56,7 @@ X509 *TS_CONF_load_cert(const char *file)
     return x;
 }
 
-STACK_OF(X509) *TS_CONF_load_certs(const char *file)
+STACK_OF(X509) * __cdecl TS_CONF_load_certs(const char *file)
 {
     BIO *certs = NULL;
     STACK_OF(X509) *othercerts = NULL;
@@ -84,7 +84,7 @@ STACK_OF(X509) *TS_CONF_load_certs(const char *file)
     return othercerts;
 }
 
-EVP_PKEY *TS_CONF_load_key(const char *file, const char *pass)
+EVP_PKEY * __cdecl TS_CONF_load_key(const char *file, const char *pass)
 {
     BIO *key = NULL;
     EVP_PKEY *pkey = NULL;
@@ -113,7 +113,7 @@ static void ts_CONF_invalid(const char *name, const char *tag)
     ERR_add_error_data(3, name, "::", tag);
 }
 
-const char *TS_CONF_get_tsa_section(CONF *conf, const char *section)
+const char * __cdecl TS_CONF_get_tsa_section(CONF *conf, const char *section)
 {
     if (!section) {
         section = NCONF_get_string(conf, BASE_SECTION, ENV_DEFAULT_TSA);
@@ -123,7 +123,7 @@ const char *TS_CONF_get_tsa_section(CONF *conf, const char *section)
     return section;
 }
 
-int TS_CONF_set_serial(CONF *conf, const char *section, TS_serial_cb cb,
+int __cdecl TS_CONF_set_serial(CONF *conf, const char *section, TS_serial_cb cb,
                        TS_RESP_CTX *ctx)
 {
     int ret = 0;
@@ -141,7 +141,7 @@ int TS_CONF_set_serial(CONF *conf, const char *section, TS_serial_cb cb,
 
 #ifndef OPENSSL_NO_ENGINE
 
-int TS_CONF_set_crypto_device(CONF *conf, const char *section,
+int __cdecl TS_CONF_set_crypto_device(CONF *conf, const char *section,
                               const char *device)
 {
     int ret = 0;
@@ -158,7 +158,7 @@ int TS_CONF_set_crypto_device(CONF *conf, const char *section,
     return ret;
 }
 
-int TS_CONF_set_default_engine(const char *name)
+int __cdecl TS_CONF_set_default_engine(const char *name)
 {
     ENGINE *e = NULL;
     int ret = 0;
@@ -185,7 +185,7 @@ int TS_CONF_set_default_engine(const char *name)
 
 #endif
 
-int TS_CONF_set_signer_cert(CONF *conf, const char *section,
+int __cdecl TS_CONF_set_signer_cert(CONF *conf, const char *section,
                             const char *cert, TS_RESP_CTX *ctx)
 {
     int ret = 0;
@@ -209,7 +209,7 @@ int TS_CONF_set_signer_cert(CONF *conf, const char *section,
     return ret;
 }
 
-int TS_CONF_set_certs(CONF *conf, const char *section, const char *certs,
+int __cdecl TS_CONF_set_certs(CONF *conf, const char *section, const char *certs,
                       TS_RESP_CTX *ctx)
 {
     int ret = 0;
@@ -231,7 +231,7 @@ int TS_CONF_set_certs(CONF *conf, const char *section, const char *certs,
     return ret;
 }
 
-int TS_CONF_set_signer_key(CONF *conf, const char *section,
+int __cdecl TS_CONF_set_signer_key(CONF *conf, const char *section,
                            const char *key, const char *pass,
                            TS_RESP_CTX *ctx)
 {
@@ -254,7 +254,7 @@ int TS_CONF_set_signer_key(CONF *conf, const char *section,
     return ret;
 }
 
-int TS_CONF_set_signer_digest(CONF *conf, const char *section,
+int __cdecl TS_CONF_set_signer_digest(CONF *conf, const char *section,
                               const char *md, TS_RESP_CTX *ctx)
 {
     int ret = 0;
@@ -278,7 +278,7 @@ int TS_CONF_set_signer_digest(CONF *conf, const char *section,
     return ret;
 }
 
-int TS_CONF_set_def_policy(CONF *conf, const char *section,
+int __cdecl TS_CONF_set_def_policy(CONF *conf, const char *section,
                            const char *policy, TS_RESP_CTX *ctx)
 {
     int ret = 0;
@@ -302,7 +302,7 @@ int TS_CONF_set_def_policy(CONF *conf, const char *section,
     return ret;
 }
 
-int TS_CONF_set_policies(CONF *conf, const char *section, TS_RESP_CTX *ctx)
+int __cdecl TS_CONF_set_policies(CONF *conf, const char *section, TS_RESP_CTX *ctx)
 {
     int ret = 0;
     int i;
@@ -334,7 +334,7 @@ int TS_CONF_set_policies(CONF *conf, const char *section, TS_RESP_CTX *ctx)
     return ret;
 }
 
-int TS_CONF_set_digests(CONF *conf, const char *section, TS_RESP_CTX *ctx)
+int __cdecl TS_CONF_set_digests(CONF *conf, const char *section, TS_RESP_CTX *ctx)
 {
     int ret = 0;
     int i;
@@ -372,7 +372,7 @@ int TS_CONF_set_digests(CONF *conf, const char *section, TS_RESP_CTX *ctx)
     return ret;
 }
 
-int TS_CONF_set_accuracy(CONF *conf, const char *section, TS_RESP_CTX *ctx)
+int __cdecl TS_CONF_set_accuracy(CONF *conf, const char *section, TS_RESP_CTX *ctx)
 {
     int ret = 0;
     int i;
@@ -409,7 +409,7 @@ int TS_CONF_set_accuracy(CONF *conf, const char *section, TS_RESP_CTX *ctx)
     return ret;
 }
 
-int TS_CONF_set_clock_precision_digits(CONF *conf, const char *section,
+int __cdecl TS_CONF_set_clock_precision_digits(CONF *conf, const char *section,
                                        TS_RESP_CTX *ctx)
 {
     int ret = 0;
@@ -451,24 +451,24 @@ static int ts_CONF_add_flag(CONF *conf, const char *section,
     return 1;
 }
 
-int TS_CONF_set_ordering(CONF *conf, const char *section, TS_RESP_CTX *ctx)
+int __cdecl TS_CONF_set_ordering(CONF *conf, const char *section, TS_RESP_CTX *ctx)
 {
     return ts_CONF_add_flag(conf, section, ENV_ORDERING, TS_ORDERING, ctx);
 }
 
-int TS_CONF_set_tsa_name(CONF *conf, const char *section, TS_RESP_CTX *ctx)
+int __cdecl TS_CONF_set_tsa_name(CONF *conf, const char *section, TS_RESP_CTX *ctx)
 {
     return ts_CONF_add_flag(conf, section, ENV_TSA_NAME, TS_TSA_NAME, ctx);
 }
 
-int TS_CONF_set_ess_cert_id_chain(CONF *conf, const char *section,
+int __cdecl TS_CONF_set_ess_cert_id_chain(CONF *conf, const char *section,
                                   TS_RESP_CTX *ctx)
 {
     return ts_CONF_add_flag(conf, section, ENV_ESS_CERT_ID_CHAIN,
                             TS_ESS_CERT_ID_CHAIN, ctx);
 }
 
-int TS_CONF_set_ess_cert_id_digest(CONF *conf, const char *section,
+int __cdecl TS_CONF_set_ess_cert_id_digest(CONF *conf, const char *section,
                                    TS_RESP_CTX *ctx)
 {
     int ret = 0;
diff --git a/crypto/ts/ts_lib.c b/crypto/ts/ts_lib.c
index ce2e12c593..e01b8284a8 100644
--- a/crypto/ts/ts_lib.c
+++ b/crypto/ts/ts_lib.c
@@ -16,7 +16,7 @@
 #include <openssl/ts.h>
 #include "ts_lcl.h"
 
-int TS_ASN1_INTEGER_print_bio(BIO *bio, const ASN1_INTEGER *num)
+int __cdecl TS_ASN1_INTEGER_print_bio(BIO *bio, const ASN1_INTEGER *num)
 {
     BIGNUM *num_bn;
     int result = 0;
@@ -35,7 +35,7 @@ int TS_ASN1_INTEGER_print_bio(BIO *bio, const ASN1_INTEGER *num)
     return result;
 }
 
-int TS_OBJ_print_bio(BIO *bio, const ASN1_OBJECT *obj)
+int __cdecl TS_OBJ_print_bio(BIO *bio, const ASN1_OBJECT *obj)
 {
     char obj_txt[128];
 
@@ -45,7 +45,7 @@ int TS_OBJ_print_bio(BIO *bio, const ASN1_OBJECT *obj)
     return 1;
 }
 
-int TS_ext_print_bio(BIO *bio, const STACK_OF(X509_EXTENSION) *extensions)
+int __cdecl TS_ext_print_bio(BIO *bio, const STACK_OF(X509_EXTENSION) *extensions)
 {
     int i, critical, n;
     X509_EXTENSION *ex;
@@ -70,14 +70,14 @@ int TS_ext_print_bio(BIO *bio, const STACK_OF(X509_EXTENSION) *extensions)
     return 1;
 }
 
-int TS_X509_ALGOR_print_bio(BIO *bio, const X509_ALGOR *alg)
+int __cdecl TS_X509_ALGOR_print_bio(BIO *bio, const X509_ALGOR *alg)
 {
     int i = OBJ_obj2nid(alg->algorithm);
     return BIO_printf(bio, "Hash Algorithm: %s\n",
                       (i == NID_undef) ? "UNKNOWN" : OBJ_nid2ln(i));
 }
 
-int TS_MSG_IMPRINT_print_bio(BIO *bio, TS_MSG_IMPRINT *a)
+int __cdecl TS_MSG_IMPRINT_print_bio(BIO *bio, TS_MSG_IMPRINT *a)
 {
     ASN1_OCTET_STRING *msg;
 
diff --git a/crypto/ts/ts_req_print.c b/crypto/ts/ts_req_print.c
index 0dedf47d92..69b9f51302 100644
--- a/crypto/ts/ts_req_print.c
+++ b/crypto/ts/ts_req_print.c
@@ -15,7 +15,7 @@
 #include <openssl/ts.h>
 #include "ts_lcl.h"
 
-int TS_REQ_print_bio(BIO *bio, TS_REQ *a)
+int __cdecl TS_REQ_print_bio(BIO *bio, TS_REQ *a)
 {
     int v;
     ASN1_OBJECT *policy_id;
diff --git a/crypto/ts/ts_req_utils.c b/crypto/ts/ts_req_utils.c
index 2073d3395d..2c480cf495 100644
--- a/crypto/ts/ts_req_utils.c
+++ b/crypto/ts/ts_req_utils.c
@@ -14,17 +14,17 @@
 #include <openssl/ts.h>
 #include "ts_lcl.h"
 
-int TS_REQ_set_version(TS_REQ *a, long version)
+int __cdecl TS_REQ_set_version(TS_REQ *a, long version)
 {
     return ASN1_INTEGER_set(a->version, version);
 }
 
-long TS_REQ_get_version(const TS_REQ *a)
+long __cdecl TS_REQ_get_version(const TS_REQ *a)
 {
     return ASN1_INTEGER_get(a->version);
 }
 
-int TS_REQ_set_msg_imprint(TS_REQ *a, TS_MSG_IMPRINT *msg_imprint)
+int __cdecl TS_REQ_set_msg_imprint(TS_REQ *a, TS_MSG_IMPRINT *msg_imprint)
 {
     TS_MSG_IMPRINT *new_msg_imprint;
 
@@ -40,12 +40,12 @@ int TS_REQ_set_msg_imprint(TS_REQ *a, TS_MSG_IMPRINT *msg_imprint)
     return 1;
 }
 
-TS_MSG_IMPRINT *TS_REQ_get_msg_imprint(TS_REQ *a)
+TS_MSG_IMPRINT * __cdecl TS_REQ_get_msg_imprint(TS_REQ *a)
 {
     return a->msg_imprint;
 }
 
-int TS_MSG_IMPRINT_set_algo(TS_MSG_IMPRINT *a, X509_ALGOR *alg)
+int __cdecl TS_MSG_IMPRINT_set_algo(TS_MSG_IMPRINT *a, X509_ALGOR *alg)
 {
     X509_ALGOR *new_alg;
 
@@ -61,22 +61,22 @@ int TS_MSG_IMPRINT_set_algo(TS_MSG_IMPRINT *a, X509_ALGOR *alg)
     return 1;
 }
 
-X509_ALGOR *TS_MSG_IMPRINT_get_algo(TS_MSG_IMPRINT *a)
+X509_ALGOR * __cdecl TS_MSG_IMPRINT_get_algo(TS_MSG_IMPRINT *a)
 {
     return a->hash_algo;
 }
 
-int TS_MSG_IMPRINT_set_msg(TS_MSG_IMPRINT *a, unsigned char *d, int len)
+int __cdecl TS_MSG_IMPRINT_set_msg(TS_MSG_IMPRINT *a, unsigned char *d, int len)
 {
     return ASN1_OCTET_STRING_set(a->hashed_msg, d, len);
 }
 
-ASN1_OCTET_STRING *TS_MSG_IMPRINT_get_msg(TS_MSG_IMPRINT *a)
+ASN1_OCTET_STRING * __cdecl TS_MSG_IMPRINT_get_msg(TS_MSG_IMPRINT *a)
 {
     return a->hashed_msg;
 }
 
-int TS_REQ_set_policy_id(TS_REQ *a, const ASN1_OBJECT *policy)
+int __cdecl TS_REQ_set_policy_id(TS_REQ *a, const ASN1_OBJECT *policy)
 {
     ASN1_OBJECT *new_policy;
 
@@ -92,12 +92,12 @@ int TS_REQ_set_policy_id(TS_REQ *a, const ASN1_OBJECT *policy)
     return 1;
 }
 
-ASN1_OBJECT *TS_REQ_get_policy_id(TS_REQ *a)
+ASN1_OBJECT * __cdecl TS_REQ_get_policy_id(TS_REQ *a)
 {
     return a->policy_id;
 }
 
-int TS_REQ_set_nonce(TS_REQ *a, const ASN1_INTEGER *nonce)
+int __cdecl TS_REQ_set_nonce(TS_REQ *a, const ASN1_INTEGER *nonce)
 {
     ASN1_INTEGER *new_nonce;
 
@@ -113,28 +113,28 @@ int TS_REQ_set_nonce(TS_REQ *a, const ASN1_INTEGER *nonce)
     return 1;
 }
 
-const ASN1_INTEGER *TS_REQ_get_nonce(const TS_REQ *a)
+const ASN1_INTEGER * __cdecl TS_REQ_get_nonce(const TS_REQ *a)
 {
     return a->nonce;
 }
 
-int TS_REQ_set_cert_req(TS_REQ *a, int cert_req)
+int __cdecl TS_REQ_set_cert_req(TS_REQ *a, int cert_req)
 {
     a->cert_req = cert_req ? 0xFF : 0x00;
     return 1;
 }
 
-int TS_REQ_get_cert_req(const TS_REQ *a)
+int __cdecl TS_REQ_get_cert_req(const TS_REQ *a)
 {
     return a->cert_req ? 1 : 0;
 }
 
-STACK_OF(X509_EXTENSION) *TS_REQ_get_exts(TS_REQ *a)
+STACK_OF(X509_EXTENSION) * __cdecl TS_REQ_get_exts(TS_REQ *a)
 {
     return a->extensions;
 }
 
-void TS_REQ_ext_free(TS_REQ *a)
+void __cdecl TS_REQ_ext_free(TS_REQ *a)
 {
     if (!a)
         return;
@@ -142,42 +142,42 @@ void TS_REQ_ext_free(TS_REQ *a)
     a->extensions = NULL;
 }
 
-int TS_REQ_get_ext_count(TS_REQ *a)
+int __cdecl TS_REQ_get_ext_count(TS_REQ *a)
 {
     return X509v3_get_ext_count(a->extensions);
 }
 
-int TS_REQ_get_ext_by_NID(TS_REQ *a, int nid, int lastpos)
+int __cdecl TS_REQ_get_ext_by_NID(TS_REQ *a, int nid, int lastpos)
 {
     return X509v3_get_ext_by_NID(a->extensions, nid, lastpos);
 }
 
-int TS_REQ_get_ext_by_OBJ(TS_REQ *a, const ASN1_OBJECT *obj, int lastpos)
+int __cdecl TS_REQ_get_ext_by_OBJ(TS_REQ *a, const ASN1_OBJECT *obj, int lastpos)
 {
     return X509v3_get_ext_by_OBJ(a->extensions, obj, lastpos);
 }
 
-int TS_REQ_get_ext_by_critical(TS_REQ *a, int crit, int lastpos)
+int __cdecl TS_REQ_get_ext_by_critical(TS_REQ *a, int crit, int lastpos)
 {
     return X509v3_get_ext_by_critical(a->extensions, crit, lastpos);
 }
 
-X509_EXTENSION *TS_REQ_get_ext(TS_REQ *a, int loc)
+X509_EXTENSION * __cdecl TS_REQ_get_ext(TS_REQ *a, int loc)
 {
     return X509v3_get_ext(a->extensions, loc);
 }
 
-X509_EXTENSION *TS_REQ_delete_ext(TS_REQ *a, int loc)
+X509_EXTENSION * __cdecl TS_REQ_delete_ext(TS_REQ *a, int loc)
 {
     return X509v3_delete_ext(a->extensions, loc);
 }
 
-int TS_REQ_add_ext(TS_REQ *a, X509_EXTENSION *ex, int loc)
+int __cdecl TS_REQ_add_ext(TS_REQ *a, X509_EXTENSION *ex, int loc)
 {
     return X509v3_add_ext(&a->extensions, ex, loc) != NULL;
 }
 
-void *TS_REQ_get_ext_d2i(TS_REQ *a, int nid, int *crit, int *idx)
+void * __cdecl TS_REQ_get_ext_d2i(TS_REQ *a, int nid, int *crit, int *idx)
 {
     return X509V3_get_d2i(a->extensions, nid, crit, idx);
 }
diff --git a/crypto/ts/ts_rsp_print.c b/crypto/ts/ts_rsp_print.c
index 6eb0ec8d75..9d0e9b2fc4 100644
--- a/crypto/ts/ts_rsp_print.c
+++ b/crypto/ts/ts_rsp_print.c
@@ -25,7 +25,7 @@ static int ts_status_map_print(BIO *bio, const struct status_map_st *a,
 static int ts_ACCURACY_print_bio(BIO *bio, const TS_ACCURACY *accuracy);
 
 
-int TS_RESP_print_bio(BIO *bio, TS_RESP *a)
+int __cdecl TS_RESP_print_bio(BIO *bio, TS_RESP *a)
 {
     BIO_printf(bio, "Status info:\n");
     TS_STATUS_INFO_print_bio(bio, a->status_info);
@@ -39,7 +39,7 @@ int TS_RESP_print_bio(BIO *bio, TS_RESP *a)
     return 1;
 }
 
-int TS_STATUS_INFO_print_bio(BIO *bio, TS_STATUS_INFO *a)
+int __cdecl TS_STATUS_INFO_print_bio(BIO *bio, TS_STATUS_INFO *a)
 {
     static const char *status_map[] = {
         "Granted.",
@@ -115,7 +115,7 @@ static int ts_status_map_print(BIO *bio, const struct status_map_st *a,
     return lines;
 }
 
-int TS_TST_INFO_print_bio(BIO *bio, TS_TST_INFO *a)
+int __cdecl TS_TST_INFO_print_bio(BIO *bio, TS_TST_INFO *a)
 {
     int v;
 
diff --git a/crypto/ts/ts_rsp_sign.c b/crypto/ts/ts_rsp_sign.c
index 1b2b84ef6b..4e5131031f 100644
--- a/crypto/ts/ts_rsp_sign.c
+++ b/crypto/ts/ts_rsp_sign.c
@@ -117,7 +117,7 @@ static int def_extension_cb(struct TS_resp_ctx *ctx, X509_EXTENSION *ext,
 
 /* TS_RESP_CTX management functions. */
 
-TS_RESP_CTX *TS_RESP_CTX_new(void)
+TS_RESP_CTX * __cdecl TS_RESP_CTX_new(void)
 {
     TS_RESP_CTX *ctx;
 
@@ -135,7 +135,7 @@ TS_RESP_CTX *TS_RESP_CTX_new(void)
     return ctx;
 }
 
-void TS_RESP_CTX_free(TS_RESP_CTX *ctx)
+void __cdecl TS_RESP_CTX_free(TS_RESP_CTX *ctx)
 {
     if (!ctx)
         return;
@@ -152,7 +152,7 @@ void TS_RESP_CTX_free(TS_RESP_CTX *ctx)
     OPENSSL_free(ctx);
 }
 
-int TS_RESP_CTX_set_signer_cert(TS_RESP_CTX *ctx, X509 *signer)
+int __cdecl TS_RESP_CTX_set_signer_cert(TS_RESP_CTX *ctx, X509 *signer)
 {
     if (X509_check_purpose(signer, X509_PURPOSE_TIMESTAMP_SIGN, 0) != 1) {
         TSerr(TS_F_TS_RESP_CTX_SET_SIGNER_CERT,
@@ -165,7 +165,7 @@ int TS_RESP_CTX_set_signer_cert(TS_RESP_CTX *ctx, X509 *signer)
     return 1;
 }
 
-int TS_RESP_CTX_set_signer_key(TS_RESP_CTX *ctx, EVP_PKEY *key)
+int __cdecl TS_RESP_CTX_set_signer_key(TS_RESP_CTX *ctx, EVP_PKEY *key)
 {
     EVP_PKEY_free(ctx->signer_key);
     ctx->signer_key = key;
@@ -174,13 +174,13 @@ int TS_RESP_CTX_set_signer_key(TS_RESP_CTX *ctx, EVP_PKEY *key)
     return 1;
 }
 
-int TS_RESP_CTX_set_signer_digest(TS_RESP_CTX *ctx, const EVP_MD *md)
+int __cdecl TS_RESP_CTX_set_signer_digest(TS_RESP_CTX *ctx, const EVP_MD *md)
 {
     ctx->signer_md = md;
     return 1;
 }
 
-int TS_RESP_CTX_set_def_policy(TS_RESP_CTX *ctx, const ASN1_OBJECT *def_policy)
+int __cdecl TS_RESP_CTX_set_def_policy(TS_RESP_CTX *ctx, const ASN1_OBJECT *def_policy)
 {
     ASN1_OBJECT_free(ctx->default_policy);
     if ((ctx->default_policy = OBJ_dup(def_policy)) == NULL)
@@ -191,7 +191,7 @@ int TS_RESP_CTX_set_def_policy(TS_RESP_CTX *ctx, const ASN1_OBJECT *def_policy)
     return 0;
 }
 
-int TS_RESP_CTX_set_certs(TS_RESP_CTX *ctx, STACK_OF(X509) *certs)
+int __cdecl TS_RESP_CTX_set_certs(TS_RESP_CTX *ctx, STACK_OF(X509) *certs)
 {
 
     sk_X509_pop_free(ctx->certs, X509_free);
@@ -206,7 +206,7 @@ int TS_RESP_CTX_set_certs(TS_RESP_CTX *ctx, STACK_OF(X509) *certs)
     return 1;
 }
 
-int TS_RESP_CTX_add_policy(TS_RESP_CTX *ctx, const ASN1_OBJECT *policy)
+int __cdecl TS_RESP_CTX_add_policy(TS_RESP_CTX *ctx, const ASN1_OBJECT *policy)
 {
     ASN1_OBJECT *copy = NULL;
 
@@ -225,7 +225,7 @@ int TS_RESP_CTX_add_policy(TS_RESP_CTX *ctx, const ASN1_OBJECT *policy)
     return 0;
 }
 
-int TS_RESP_CTX_add_md(TS_RESP_CTX *ctx, const EVP_MD *md)
+int __cdecl TS_RESP_CTX_add_md(TS_RESP_CTX *ctx, const EVP_MD *md)
 {
     if (ctx->mds == NULL
         && (ctx->mds = sk_EVP_MD_new_null()) == NULL)
@@ -247,7 +247,7 @@ int TS_RESP_CTX_add_md(TS_RESP_CTX *ctx, const EVP_MD *md)
         ASN1_INTEGER_free(ctx->micros);         \
         ctx->micros = NULL;
 
-int TS_RESP_CTX_set_accuracy(TS_RESP_CTX *ctx,
+int __cdecl TS_RESP_CTX_set_accuracy(TS_RESP_CTX *ctx,
                              int secs, int millis, int micros)
 {
 
@@ -272,31 +272,31 @@ int TS_RESP_CTX_set_accuracy(TS_RESP_CTX *ctx,
     return 0;
 }
 
-void TS_RESP_CTX_add_flags(TS_RESP_CTX *ctx, int flags)
+void __cdecl TS_RESP_CTX_add_flags(TS_RESP_CTX *ctx, int flags)
 {
     ctx->flags |= flags;
 }
 
-void TS_RESP_CTX_set_serial_cb(TS_RESP_CTX *ctx, TS_serial_cb cb, void *data)
+void __cdecl TS_RESP_CTX_set_serial_cb(TS_RESP_CTX *ctx, TS_serial_cb cb, void *data)
 {
     ctx->serial_cb = cb;
     ctx->serial_cb_data = data;
 }
 
-void TS_RESP_CTX_set_time_cb(TS_RESP_CTX *ctx, TS_time_cb cb, void *data)
+void __cdecl TS_RESP_CTX_set_time_cb(TS_RESP_CTX *ctx, TS_time_cb cb, void *data)
 {
     ctx->time_cb = cb;
     ctx->time_cb_data = data;
 }
 
-void TS_RESP_CTX_set_extension_cb(TS_RESP_CTX *ctx,
+void __cdecl TS_RESP_CTX_set_extension_cb(TS_RESP_CTX *ctx,
                                   TS_extension_cb cb, void *data)
 {
     ctx->extension_cb = cb;
     ctx->extension_cb_data = data;
 }
 
-int TS_RESP_CTX_set_status_info(TS_RESP_CTX *ctx,
+int __cdecl TS_RESP_CTX_set_status_info(TS_RESP_CTX *ctx,
                                 int status, const char *text)
 {
     TS_STATUS_INFO *si = NULL;
@@ -329,7 +329,7 @@ int TS_RESP_CTX_set_status_info(TS_RESP_CTX *ctx,
     return ret;
 }
 
-int TS_RESP_CTX_set_status_info_cond(TS_RESP_CTX *ctx,
+int __cdecl TS_RESP_CTX_set_status_info_cond(TS_RESP_CTX *ctx,
                                      int status, const char *text)
 {
     int ret = 1;
@@ -341,7 +341,7 @@ int TS_RESP_CTX_set_status_info_cond(TS_RESP_CTX *ctx,
     return ret;
 }
 
-int TS_RESP_CTX_add_failure_info(TS_RESP_CTX *ctx, int failure)
+int __cdecl TS_RESP_CTX_add_failure_info(TS_RESP_CTX *ctx, int failure)
 {
     TS_STATUS_INFO *si = ctx->response->status_info;
     if (si->failure_info == NULL
@@ -355,17 +355,17 @@ int TS_RESP_CTX_add_failure_info(TS_RESP_CTX *ctx, int failure)
     return 0;
 }
 
-TS_REQ *TS_RESP_CTX_get_request(TS_RESP_CTX *ctx)
+TS_REQ * __cdecl TS_RESP_CTX_get_request(TS_RESP_CTX *ctx)
 {
     return ctx->request;
 }
 
-TS_TST_INFO *TS_RESP_CTX_get_tst_info(TS_RESP_CTX *ctx)
+TS_TST_INFO * __cdecl TS_RESP_CTX_get_tst_info(TS_RESP_CTX *ctx)
 {
     return ctx->tst_info;
 }
 
-int TS_RESP_CTX_set_clock_precision_digits(TS_RESP_CTX *ctx,
+int __cdecl TS_RESP_CTX_set_clock_precision_digits(TS_RESP_CTX *ctx,
                                            unsigned precision)
 {
     if (precision > TS_MAX_CLOCK_PRECISION_DIGITS)
@@ -375,7 +375,7 @@ int TS_RESP_CTX_set_clock_precision_digits(TS_RESP_CTX *ctx,
 }
 
 /* Main entry method of the response generation. */
-TS_RESP *TS_RESP_create_response(TS_RESP_CTX *ctx, BIO *req_bio)
+TS_RESP * __cdecl TS_RESP_create_response(TS_RESP_CTX *ctx, BIO *req_bio)
 {
     ASN1_OBJECT *policy;
     TS_RESP *response;
@@ -1050,7 +1050,7 @@ static ASN1_GENERALIZEDTIME *TS_RESP_set_genTime_with_precision(
     return NULL;
 }
 
-int TS_RESP_CTX_set_ess_cert_id_digest(TS_RESP_CTX *ctx, const EVP_MD *md)
+int __cdecl TS_RESP_CTX_set_ess_cert_id_digest(TS_RESP_CTX *ctx, const EVP_MD *md)
 {
     ctx->ess_cert_id_digest = md;
     return 1;
diff --git a/crypto/ts/ts_rsp_utils.c b/crypto/ts/ts_rsp_utils.c
index 3ecee39a22..d3d3bcd01a 100644
--- a/crypto/ts/ts_rsp_utils.c
+++ b/crypto/ts/ts_rsp_utils.c
@@ -14,7 +14,7 @@
 #include <openssl/pkcs7.h>
 #include "ts_lcl.h"
 
-int TS_RESP_set_status_info(TS_RESP *a, TS_STATUS_INFO *status_info)
+int __cdecl TS_RESP_set_status_info(TS_RESP *a, TS_STATUS_INFO *status_info)
 {
     TS_STATUS_INFO *new_status_info;
 
@@ -31,13 +31,13 @@ int TS_RESP_set_status_info(TS_RESP *a, TS_STATUS_INFO *status_info)
     return 1;
 }
 
-TS_STATUS_INFO *TS_RESP_get_status_info(TS_RESP *a)
+TS_STATUS_INFO * __cdecl TS_RESP_get_status_info(TS_RESP *a)
 {
     return a->status_info;
 }
 
 /* Caller loses ownership of PKCS7 and TS_TST_INFO objects. */
-void TS_RESP_set_tst_info(TS_RESP *a, PKCS7 *p7, TS_TST_INFO *tst_info)
+void __cdecl TS_RESP_set_tst_info(TS_RESP *a, PKCS7 *p7, TS_TST_INFO *tst_info)
 {
     PKCS7_free(a->token);
     a->token = p7;
@@ -45,27 +45,27 @@ void TS_RESP_set_tst_info(TS_RESP *a, PKCS7 *p7, TS_TST_INFO *tst_info)
     a->tst_info = tst_info;
 }
 
-PKCS7 *TS_RESP_get_token(TS_RESP *a)
+PKCS7 * __cdecl TS_RESP_get_token(TS_RESP *a)
 {
     return a->token;
 }
 
-TS_TST_INFO *TS_RESP_get_tst_info(TS_RESP *a)
+TS_TST_INFO * __cdecl TS_RESP_get_tst_info(TS_RESP *a)
 {
     return a->tst_info;
 }
 
-int TS_TST_INFO_set_version(TS_TST_INFO *a, long version)
+int __cdecl TS_TST_INFO_set_version(TS_TST_INFO *a, long version)
 {
     return ASN1_INTEGER_set(a->version, version);
 }
 
-long TS_TST_INFO_get_version(const TS_TST_INFO *a)
+long __cdecl TS_TST_INFO_get_version(const TS_TST_INFO *a)
 {
     return ASN1_INTEGER_get(a->version);
 }
 
-int TS_TST_INFO_set_policy_id(TS_TST_INFO *a, ASN1_OBJECT *policy)
+int __cdecl TS_TST_INFO_set_policy_id(TS_TST_INFO *a, ASN1_OBJECT *policy)
 {
     ASN1_OBJECT *new_policy;
 
@@ -81,12 +81,12 @@ int TS_TST_INFO_set_policy_id(TS_TST_INFO *a, ASN1_OBJECT *policy)
     return 1;
 }
 
-ASN1_OBJECT *TS_TST_INFO_get_policy_id(TS_TST_INFO *a)
+ASN1_OBJECT * __cdecl TS_TST_INFO_get_policy_id(TS_TST_INFO *a)
 {
     return a->policy_id;
 }
 
-int TS_TST_INFO_set_msg_imprint(TS_TST_INFO *a, TS_MSG_IMPRINT *msg_imprint)
+int __cdecl TS_TST_INFO_set_msg_imprint(TS_TST_INFO *a, TS_MSG_IMPRINT *msg_imprint)
 {
     TS_MSG_IMPRINT *new_msg_imprint;
 
@@ -102,12 +102,12 @@ int TS_TST_INFO_set_msg_imprint(TS_TST_INFO *a, TS_MSG_IMPRINT *msg_imprint)
     return 1;
 }
 
-TS_MSG_IMPRINT *TS_TST_INFO_get_msg_imprint(TS_TST_INFO *a)
+TS_MSG_IMPRINT * __cdecl TS_TST_INFO_get_msg_imprint(TS_TST_INFO *a)
 {
     return a->msg_imprint;
 }
 
-int TS_TST_INFO_set_serial(TS_TST_INFO *a, const ASN1_INTEGER *serial)
+int __cdecl TS_TST_INFO_set_serial(TS_TST_INFO *a, const ASN1_INTEGER *serial)
 {
     ASN1_INTEGER *new_serial;
 
@@ -123,12 +123,12 @@ int TS_TST_INFO_set_serial(TS_TST_INFO *a, const ASN1_INTEGER *serial)
     return 1;
 }
 
-const ASN1_INTEGER *TS_TST_INFO_get_serial(const TS_TST_INFO *a)
+const ASN1_INTEGER * __cdecl TS_TST_INFO_get_serial(const TS_TST_INFO *a)
 {
     return a->serial;
 }
 
-int TS_TST_INFO_set_time(TS_TST_INFO *a, const ASN1_GENERALIZEDTIME *gtime)
+int __cdecl TS_TST_INFO_set_time(TS_TST_INFO *a, const ASN1_GENERALIZEDTIME *gtime)
 {
     ASN1_GENERALIZEDTIME *new_time;
 
@@ -144,12 +144,12 @@ int TS_TST_INFO_set_time(TS_TST_INFO *a, const ASN1_GENERALIZEDTIME *gtime)
     return 1;
 }
 
-const ASN1_GENERALIZEDTIME *TS_TST_INFO_get_time(const TS_TST_INFO *a)
+const ASN1_GENERALIZEDTIME * __cdecl TS_TST_INFO_get_time(const TS_TST_INFO *a)
 {
     return a->time;
 }
 
-int TS_TST_INFO_set_accuracy(TS_TST_INFO *a, TS_ACCURACY *accuracy)
+int __cdecl TS_TST_INFO_set_accuracy(TS_TST_INFO *a, TS_ACCURACY *accuracy)
 {
     TS_ACCURACY *new_accuracy;
 
@@ -165,12 +165,12 @@ int TS_TST_INFO_set_accuracy(TS_TST_INFO *a, TS_ACCURACY *accuracy)
     return 1;
 }
 
-TS_ACCURACY *TS_TST_INFO_get_accuracy(TS_TST_INFO *a)
+TS_ACCURACY * __cdecl TS_TST_INFO_get_accuracy(TS_TST_INFO *a)
 {
     return a->accuracy;
 }
 
-int TS_ACCURACY_set_seconds(TS_ACCURACY *a, const ASN1_INTEGER *seconds)
+int __cdecl TS_ACCURACY_set_seconds(TS_ACCURACY *a, const ASN1_INTEGER *seconds)
 {
     ASN1_INTEGER *new_seconds;
 
@@ -186,12 +186,12 @@ int TS_ACCURACY_set_seconds(TS_ACCURACY *a, const ASN1_INTEGER *seconds)
     return 1;
 }
 
-const ASN1_INTEGER *TS_ACCURACY_get_seconds(const TS_ACCURACY *a)
+const ASN1_INTEGER * __cdecl TS_ACCURACY_get_seconds(const TS_ACCURACY *a)
 {
     return a->seconds;
 }
 
-int TS_ACCURACY_set_millis(TS_ACCURACY *a, const ASN1_INTEGER *millis)
+int __cdecl TS_ACCURACY_set_millis(TS_ACCURACY *a, const ASN1_INTEGER *millis)
 {
     ASN1_INTEGER *new_millis = NULL;
 
@@ -209,12 +209,12 @@ int TS_ACCURACY_set_millis(TS_ACCURACY *a, const ASN1_INTEGER *millis)
     return 1;
 }
 
-const ASN1_INTEGER *TS_ACCURACY_get_millis(const TS_ACCURACY *a)
+const ASN1_INTEGER * __cdecl TS_ACCURACY_get_millis(const TS_ACCURACY *a)
 {
     return a->millis;
 }
 
-int TS_ACCURACY_set_micros(TS_ACCURACY *a, const ASN1_INTEGER *micros)
+int __cdecl TS_ACCURACY_set_micros(TS_ACCURACY *a, const ASN1_INTEGER *micros)
 {
     ASN1_INTEGER *new_micros = NULL;
 
@@ -232,23 +232,23 @@ int TS_ACCURACY_set_micros(TS_ACCURACY *a, const ASN1_INTEGER *micros)
     return 1;
 }
 
-const ASN1_INTEGER *TS_ACCURACY_get_micros(const TS_ACCURACY *a)
+const ASN1_INTEGER * __cdecl TS_ACCURACY_get_micros(const TS_ACCURACY *a)
 {
     return a->micros;
 }
 
-int TS_TST_INFO_set_ordering(TS_TST_INFO *a, int ordering)
+int __cdecl TS_TST_INFO_set_ordering(TS_TST_INFO *a, int ordering)
 {
     a->ordering = ordering ? 0xFF : 0x00;
     return 1;
 }
 
-int TS_TST_INFO_get_ordering(const TS_TST_INFO *a)
+int __cdecl TS_TST_INFO_get_ordering(const TS_TST_INFO *a)
 {
     return a->ordering ? 1 : 0;
 }
 
-int TS_TST_INFO_set_nonce(TS_TST_INFO *a, const ASN1_INTEGER *nonce)
+int __cdecl TS_TST_INFO_set_nonce(TS_TST_INFO *a, const ASN1_INTEGER *nonce)
 {
     ASN1_INTEGER *new_nonce;
 
@@ -264,12 +264,12 @@ int TS_TST_INFO_set_nonce(TS_TST_INFO *a, const ASN1_INTEGER *nonce)
     return 1;
 }
 
-const ASN1_INTEGER *TS_TST_INFO_get_nonce(const TS_TST_INFO *a)
+const ASN1_INTEGER * __cdecl TS_TST_INFO_get_nonce(const TS_TST_INFO *a)
 {
     return a->nonce;
 }
 
-int TS_TST_INFO_set_tsa(TS_TST_INFO *a, GENERAL_NAME *tsa)
+int __cdecl TS_TST_INFO_set_tsa(TS_TST_INFO *a, GENERAL_NAME *tsa)
 {
     GENERAL_NAME *new_tsa;
 
@@ -285,17 +285,17 @@ int TS_TST_INFO_set_tsa(TS_TST_INFO *a, GENERAL_NAME *tsa)
     return 1;
 }
 
-GENERAL_NAME *TS_TST_INFO_get_tsa(TS_TST_INFO *a)
+GENERAL_NAME * __cdecl TS_TST_INFO_get_tsa(TS_TST_INFO *a)
 {
     return a->tsa;
 }
 
-STACK_OF(X509_EXTENSION) *TS_TST_INFO_get_exts(TS_TST_INFO *a)
+STACK_OF(X509_EXTENSION) * __cdecl TS_TST_INFO_get_exts(TS_TST_INFO *a)
 {
     return a->extensions;
 }
 
-void TS_TST_INFO_ext_free(TS_TST_INFO *a)
+void __cdecl TS_TST_INFO_ext_free(TS_TST_INFO *a)
 {
     if (!a)
         return;
@@ -303,63 +303,63 @@ void TS_TST_INFO_ext_free(TS_TST_INFO *a)
     a->extensions = NULL;
 }
 
-int TS_TST_INFO_get_ext_count(TS_TST_INFO *a)
+int __cdecl TS_TST_INFO_get_ext_count(TS_TST_INFO *a)
 {
     return X509v3_get_ext_count(a->extensions);
 }
 
-int TS_TST_INFO_get_ext_by_NID(TS_TST_INFO *a, int nid, int lastpos)
+int __cdecl TS_TST_INFO_get_ext_by_NID(TS_TST_INFO *a, int nid, int lastpos)
 {
     return X509v3_get_ext_by_NID(a->extensions, nid, lastpos);
 }
 
-int TS_TST_INFO_get_ext_by_OBJ(TS_TST_INFO *a, const ASN1_OBJECT *obj, int lastpos)
+int __cdecl TS_TST_INFO_get_ext_by_OBJ(TS_TST_INFO *a, const ASN1_OBJECT *obj, int lastpos)
 {
     return X509v3_get_ext_by_OBJ(a->extensions, obj, lastpos);
 }
 
-int TS_TST_INFO_get_ext_by_critical(TS_TST_INFO *a, int crit, int lastpos)
+int __cdecl TS_TST_INFO_get_ext_by_critical(TS_TST_INFO *a, int crit, int lastpos)
 {
     return X509v3_get_ext_by_critical(a->extensions, crit, lastpos);
 }
 
-X509_EXTENSION *TS_TST_INFO_get_ext(TS_TST_INFO *a, int loc)
+X509_EXTENSION * __cdecl TS_TST_INFO_get_ext(TS_TST_INFO *a, int loc)
 {
     return X509v3_get_ext(a->extensions, loc);
 }
 
-X509_EXTENSION *TS_TST_INFO_delete_ext(TS_TST_INFO *a, int loc)
+X509_EXTENSION * __cdecl TS_TST_INFO_delete_ext(TS_TST_INFO *a, int loc)
 {
     return X509v3_delete_ext(a->extensions, loc);
 }
 
-int TS_TST_INFO_add_ext(TS_TST_INFO *a, X509_EXTENSION *ex, int loc)
+int __cdecl TS_TST_INFO_add_ext(TS_TST_INFO *a, X509_EXTENSION *ex, int loc)
 {
     return X509v3_add_ext(&a->extensions, ex, loc) != NULL;
 }
 
-void *TS_TST_INFO_get_ext_d2i(TS_TST_INFO *a, int nid, int *crit, int *idx)
+void * __cdecl TS_TST_INFO_get_ext_d2i(TS_TST_INFO *a, int nid, int *crit, int *idx)
 {
     return X509V3_get_d2i(a->extensions, nid, crit, idx);
 }
 
-int TS_STATUS_INFO_set_status(TS_STATUS_INFO *a, int i)
+int __cdecl TS_STATUS_INFO_set_status(TS_STATUS_INFO *a, int i)
 {
     return ASN1_INTEGER_set(a->status, i);
 }
 
-const ASN1_INTEGER *TS_STATUS_INFO_get0_status(const TS_STATUS_INFO *a)
+const ASN1_INTEGER * __cdecl TS_STATUS_INFO_get0_status(const TS_STATUS_INFO *a)
 {
     return a->status;
 }
 
 const STACK_OF(ASN1_UTF8STRING) *
-TS_STATUS_INFO_get0_text(const TS_STATUS_INFO *a)
+__cdecl TS_STATUS_INFO_get0_text(const TS_STATUS_INFO *a)
 {
     return a->text;
 }
 
-const ASN1_BIT_STRING *TS_STATUS_INFO_get0_failure_info(const TS_STATUS_INFO *a)
+const ASN1_BIT_STRING * __cdecl TS_STATUS_INFO_get0_failure_info(const TS_STATUS_INFO *a)
 {
     return a->failure_info;
 }
diff --git a/crypto/ts/ts_rsp_verify.c b/crypto/ts/ts_rsp_verify.c
index 9deda81b07..1e1382d953 100644
--- a/crypto/ts/ts_rsp_verify.c
+++ b/crypto/ts/ts_rsp_verify.c
@@ -87,7 +87,7 @@ static struct {
  *      - Verify the signature value.
  *      - Returns the signer certificate in 'signer', if 'signer' is not NULL.
  */
-int TS_RESP_verify_signature(PKCS7 *token, STACK_OF(X509) *certs,
+int __cdecl TS_RESP_verify_signature(PKCS7 *token, STACK_OF(X509) *certs,
                              X509_STORE *store, X509 **signer_out)
 {
     STACK_OF(PKCS7_SIGNER_INFO) *sinfos = NULL;
@@ -365,7 +365,7 @@ static int ts_issuer_serial_cmp(ESS_ISSUER_SERIAL *is, X509 *cert)
  *      - Gives an error message if the TS_TST_INFO is not present.
  *      - Calls _TS_RESP_verify_token to verify the token content.
  */
-int TS_RESP_verify_response(TS_VERIFY_CTX *ctx, TS_RESP *response)
+int __cdecl TS_RESP_verify_response(TS_VERIFY_CTX *ctx, TS_RESP *response)
 {
     PKCS7 *token = response->token;
     TS_TST_INFO *tst_info = response->tst_info;
@@ -385,7 +385,7 @@ int TS_RESP_verify_response(TS_VERIFY_CTX *ctx, TS_RESP *response)
  * Tries to extract a TS_TST_INFO structure from the PKCS7 token and
  * calls the internal int_TS_RESP_verify_token function for verifying it.
  */
-int TS_RESP_verify_token(TS_VERIFY_CTX *ctx, PKCS7 *token)
+int __cdecl TS_RESP_verify_token(TS_VERIFY_CTX *ctx, PKCS7 *token)
 {
     TS_TST_INFO *tst_info = PKCS7_to_TS_TST_INFO(token);
     int ret = 0;
diff --git a/crypto/ts/ts_verify_ctx.c b/crypto/ts/ts_verify_ctx.c
index d4792ee04f..19a4a6b2a0 100644
--- a/crypto/ts/ts_verify_ctx.c
+++ b/crypto/ts/ts_verify_ctx.c
@@ -12,7 +12,7 @@
 #include <openssl/ts.h>
 #include "ts_lcl.h"
 
-TS_VERIFY_CTX *TS_VERIFY_CTX_new(void)
+TS_VERIFY_CTX * __cdecl TS_VERIFY_CTX_new(void)
 {
     TS_VERIFY_CTX *ctx = OPENSSL_zalloc(sizeof(*ctx));
 
@@ -21,13 +21,13 @@ TS_VERIFY_CTX *TS_VERIFY_CTX_new(void)
     return ctx;
 }
 
-void TS_VERIFY_CTX_init(TS_VERIFY_CTX *ctx)
+void __cdecl TS_VERIFY_CTX_init(TS_VERIFY_CTX *ctx)
 {
     OPENSSL_assert(ctx != NULL);
     memset(ctx, 0, sizeof(*ctx));
 }
 
-void TS_VERIFY_CTX_free(TS_VERIFY_CTX *ctx)
+void __cdecl TS_VERIFY_CTX_free(TS_VERIFY_CTX *ctx)
 {
     if (!ctx)
         return;
@@ -36,38 +36,38 @@ void TS_VERIFY_CTX_free(TS_VERIFY_CTX *ctx)
     OPENSSL_free(ctx);
 }
 
-int TS_VERIFY_CTX_add_flags(TS_VERIFY_CTX *ctx, int f)
+int __cdecl TS_VERIFY_CTX_add_flags(TS_VERIFY_CTX *ctx, int f)
 {
     ctx->flags |= f;
     return ctx->flags;
 }
 
-int TS_VERIFY_CTX_set_flags(TS_VERIFY_CTX *ctx, int f)
+int __cdecl TS_VERIFY_CTX_set_flags(TS_VERIFY_CTX *ctx, int f)
 {
     ctx->flags = f;
     return ctx->flags;
 }
 
-BIO *TS_VERIFY_CTX_set_data(TS_VERIFY_CTX *ctx, BIO *b)
+BIO * __cdecl TS_VERIFY_CTX_set_data(TS_VERIFY_CTX *ctx, BIO *b)
 {
     ctx->data = b;
     return ctx->data;
 }
 
-X509_STORE *TS_VERIFY_CTX_set_store(TS_VERIFY_CTX *ctx, X509_STORE *s)
+X509_STORE * __cdecl TS_VERIFY_CTX_set_store(TS_VERIFY_CTX *ctx, X509_STORE *s)
 {
     ctx->store = s;
     return ctx->store;
 }
 
-STACK_OF(X509) *TS_VERIFY_CTS_set_certs(TS_VERIFY_CTX *ctx,
+STACK_OF(X509) * __cdecl TS_VERIFY_CTS_set_certs(TS_VERIFY_CTX *ctx,
                                         STACK_OF(X509) *certs)
 {
     ctx->certs = certs;
     return ctx->certs;
 }
 
-unsigned char *TS_VERIFY_CTX_set_imprint(TS_VERIFY_CTX *ctx,
+unsigned char * __cdecl TS_VERIFY_CTX_set_imprint(TS_VERIFY_CTX *ctx,
                                          unsigned char *hexstr, long len)
 {
     ctx->imprint = hexstr;
@@ -75,7 +75,7 @@ unsigned char *TS_VERIFY_CTX_set_imprint(TS_VERIFY_CTX *ctx,
     return ctx->imprint;
 }
 
-void TS_VERIFY_CTX_cleanup(TS_VERIFY_CTX *ctx)
+void __cdecl TS_VERIFY_CTX_cleanup(TS_VERIFY_CTX *ctx)
 {
     if (!ctx)
         return;
@@ -97,7 +97,7 @@ void TS_VERIFY_CTX_cleanup(TS_VERIFY_CTX *ctx)
     TS_VERIFY_CTX_init(ctx);
 }
 
-TS_VERIFY_CTX *TS_REQ_to_TS_VERIFY_CTX(TS_REQ *req, TS_VERIFY_CTX *ctx)
+TS_VERIFY_CTX * __cdecl TS_REQ_to_TS_VERIFY_CTX(TS_REQ *req, TS_VERIFY_CTX *ctx)
 {
     TS_VERIFY_CTX *ret = ctx;
     ASN1_OBJECT *policy;
diff --git a/crypto/ui/ui_lib.c b/crypto/ui/ui_lib.c
index f550972d3e..a30b5d2ebe 100644
--- a/crypto/ui/ui_lib.c
+++ b/crypto/ui/ui_lib.c
@@ -49,7 +49,7 @@ UI *UI_new_method(const UI_METHOD *method)
     return ret;
 }
 
-static void free_string(UI_STRING *uis)
+static void __cdecl free_string(UI_STRING *uis)
 {
     if (uis->flags & OUT_STRING_FREEABLE) {
         OPENSSL_free((char *)uis->out_string);
diff --git a/crypto/ui/ui_openssl.c b/crypto/ui/ui_openssl.c
index 0ec9f0daf3..467e6a640f 100644
--- a/crypto/ui/ui_openssl.c
+++ b/crypto/ui/ui_openssl.c
@@ -159,7 +159,7 @@ struct IOSB {
 # ifdef SIGACTION
 static struct sigaction savsig[NX509_SIG];
 # else
-static void (*savsig[NX509_SIG]) (int);
+static void (__cdecl *savsig[NX509_SIG]) (int);
 # endif
 
 # ifdef OPENSSL_SYS_VMS
@@ -183,9 +183,9 @@ static int is_a_tty;
 /* Declare static functions */
 # if !defined(OPENSSL_SYS_WINCE)
 static int read_till_nl(FILE *);
-static void recsig(int);
-static void pushsig(void);
-static void popsig(void);
+static void __cdecl recsig(int);
+static void __cdecl pushsig(void);
+static void __cdecl popsig(void);
 # endif
 # if defined(OPENSSL_SYS_MSDOS) && !defined(_WIN32)
 static int noecho_fgets(char *buf, int size, FILE *tty);
@@ -584,7 +584,7 @@ static int close_console(UI *ui)
 
 # if !defined(OPENSSL_SYS_WINCE)
 /* Internal functions to handle signals and act on them */
-static void pushsig(void)
+static void __cdecl pushsig(void)
 {
 #  ifndef OPENSSL_SYS_WIN32
     int i;
@@ -630,7 +630,7 @@ static void pushsig(void)
 #  endif
 }
 
-static void popsig(void)
+static void __cdecl popsig(void)
 {
 #  ifdef OPENSSL_SYS_WIN32
     signal(SIGABRT, savsig[SIGABRT]);
@@ -659,7 +659,7 @@ static void popsig(void)
 #  endif
 }
 
-static void recsig(int i)
+static void __cdecl recsig(int i)
 {
     intr_signal = i;
 }
diff --git a/crypto/uid.c b/crypto/uid.c
index 65b1171039..0bc9bc0d8c 100644
--- a/crypto/uid.c
+++ b/crypto/uid.c
@@ -12,7 +12,7 @@
 
 #if defined(OPENSSL_SYS_WIN32) || defined(OPENSSL_SYS_VXWORKS) || defined(OPENSSL_SYS_UEFI)
 
-int OPENSSL_issetugid(void)
+int __cdecl OPENSSL_issetugid(void)
 {
     return 0;
 }
@@ -21,7 +21,7 @@ int OPENSSL_issetugid(void)
 
 # include OPENSSL_UNISTD
 
-int OPENSSL_issetugid(void)
+int __cdecl OPENSSL_issetugid(void)
 {
     return issetugid();
 }
@@ -38,7 +38,7 @@ int OPENSSL_issetugid(void)
 #  endif
 # endif
 
-int OPENSSL_issetugid(void)
+int __cdecl OPENSSL_issetugid(void)
 {
 # ifdef OSSL_IMPLEMENT_GETAUXVAL
     return getauxval(AT_SECURE) != 0;
diff --git a/crypto/x509/by_dir.c b/crypto/x509/by_dir.c
index b691a83a0d..0070026868 100644
--- a/crypto/x509/by_dir.c
+++ b/crypto/x509/by_dir.c
@@ -118,12 +118,12 @@ static int new_dir(X509_LOOKUP *lu)
     return 0;
 }
 
-static void by_dir_hash_free(BY_DIR_HASH *hash)
+static void __cdecl by_dir_hash_free(BY_DIR_HASH *hash)
 {
     OPENSSL_free(hash);
 }
 
-static int by_dir_hash_cmp(const BY_DIR_HASH *const *a,
+static int __cdecl by_dir_hash_cmp(const BY_DIR_HASH *const *a,
                            const BY_DIR_HASH *const *b)
 {
     if ((*a)->hash > (*b)->hash)
@@ -133,7 +133,7 @@ static int by_dir_hash_cmp(const BY_DIR_HASH *const *a,
     return 0;
 }
 
-static void by_dir_entry_free(BY_DIR_ENTRY *ent)
+static void __cdecl by_dir_entry_free(BY_DIR_ENTRY *ent)
 {
     OPENSSL_free(ent->dir);
     sk_BY_DIR_HASH_pop_free(ent->hashes, by_dir_hash_free);
diff --git a/crypto/x509/x509_lu.c b/crypto/x509/x509_lu.c
index b7d2e66574..9c5b36cabc 100644
--- a/crypto/x509/x509_lu.c
+++ b/crypto/x509/x509_lu.c
@@ -135,7 +135,7 @@ X509_STORE *X509_LOOKUP_get_store(const X509_LOOKUP *ctx)
 }
 
 
-static int x509_object_cmp(const X509_OBJECT *const *a,
+static int __cdecl x509_object_cmp(const X509_OBJECT *const *a,
                            const X509_OBJECT *const *b)
 {
     int ret;
@@ -465,7 +465,7 @@ int X509_OBJECT_set1_X509_CRL(X509_OBJECT *a, X509_CRL *obj)
     return 1;
 }
 
-void X509_OBJECT_free(X509_OBJECT *a)
+void __cdecl X509_OBJECT_free(X509_OBJECT *a)
 {
     x509_object_free_internal(a);
     OPENSSL_free(a);
diff --git a/crypto/x509/x509_trs.c b/crypto/x509/x509_trs.c
index d749af4d59..7ca429180f 100644
--- a/crypto/x509/x509_trs.c
+++ b/crypto/x509/x509_trs.c
@@ -12,8 +12,8 @@
 #include <openssl/x509v3.h>
 #include "internal/x509_int.h"
 
-static int tr_cmp(const X509_TRUST *const *a, const X509_TRUST *const *b);
-static void trtable_free(X509_TRUST *p);
+static int __cdecl tr_cmp(const X509_TRUST *const *a, const X509_TRUST *const *b);
+static void __cdecl trtable_free(X509_TRUST *p);
 
 static int trust_1oidany(X509_TRUST *trust, X509 *x, int flags);
 static int trust_1oid(X509_TRUST *trust, X509 *x, int flags);
@@ -49,7 +49,7 @@ static X509_TRUST trstandard[] = {
 
 static STACK_OF(X509_TRUST) *trtable = NULL;
 
-static int tr_cmp(const X509_TRUST *const *a, const X509_TRUST *const *b)
+static int __cdecl tr_cmp(const X509_TRUST *const *a, const X509_TRUST *const *b)
 {
     return (*a)->trust - (*b)->trust;
 }
@@ -182,7 +182,7 @@ int X509_TRUST_add(int id, int flags, int (*ck) (X509_TRUST *, X509 *, int),
     return 0;
 }
 
-static void trtable_free(X509_TRUST *p)
+static void __cdecl trtable_free(X509_TRUST *p)
 {
     if (!p)
         return;
diff --git a/crypto/x509/x509_vpm.c b/crypto/x509/x509_vpm.c
index aea186295c..2a354ce00c 100644
--- a/crypto/x509/x509_vpm.c
+++ b/crypto/x509/x509_vpm.c
@@ -23,12 +23,12 @@
 #define SET_HOST 0
 #define ADD_HOST 1
 
-static char *str_copy(const char *s)
+static char * __cdecl str_copy(const char *s)
 {
     return OPENSSL_strdup(s);
 }
 
-static void str_free(char *s)
+static void __cdecl str_free(char *s)
 {
     OPENSSL_free(s);
 }
@@ -95,7 +95,7 @@ X509_VERIFY_PARAM *X509_VERIFY_PARAM_new(void)
     return param;
 }
 
-void X509_VERIFY_PARAM_free(X509_VERIFY_PARAM *param)
+void __cdecl X509_VERIFY_PARAM_free(X509_VERIFY_PARAM *param)
 {
     if (param == NULL)
         return;
@@ -531,7 +531,7 @@ static const X509_VERIFY_PARAM default_table[] = {
 
 static STACK_OF(X509_VERIFY_PARAM) *param_table = NULL;
 
-static int table_cmp(const X509_VERIFY_PARAM *a, const X509_VERIFY_PARAM *b)
+static int __cdecl table_cmp(const X509_VERIFY_PARAM *a, const X509_VERIFY_PARAM *b)
 {
     return strcmp(a->name, b->name);
 }
@@ -539,7 +539,7 @@ static int table_cmp(const X509_VERIFY_PARAM *a, const X509_VERIFY_PARAM *b)
 DECLARE_OBJ_BSEARCH_CMP_FN(X509_VERIFY_PARAM, X509_VERIFY_PARAM, table);
 IMPLEMENT_OBJ_BSEARCH_CMP_FN(X509_VERIFY_PARAM, X509_VERIFY_PARAM, table);
 
-static int param_cmp(const X509_VERIFY_PARAM *const *a,
+static int __cdecl param_cmp(const X509_VERIFY_PARAM *const *a,
                      const X509_VERIFY_PARAM *const *b)
 {
     return strcmp((*a)->name, (*b)->name);
diff --git a/crypto/x509/x_all.c b/crypto/x509/x_all.c
index 24e4114601..98b9c7000a 100644
--- a/crypto/x509/x_all.c
+++ b/crypto/x509/x_all.c
@@ -151,23 +151,23 @@ int i2d_X509_CRL_bio(BIO *bp, X509_CRL *crl)
 }
 
 #ifndef OPENSSL_NO_STDIO
-PKCS7 *d2i_PKCS7_fp(FILE *fp, PKCS7 **p7)
+PKCS7 * __cdecl d2i_PKCS7_fp(FILE *fp, PKCS7 **p7)
 {
     return ASN1_item_d2i_fp(ASN1_ITEM_rptr(PKCS7), fp, p7);
 }
 
-int i2d_PKCS7_fp(FILE *fp, PKCS7 *p7)
+int __cdecl i2d_PKCS7_fp(FILE *fp, PKCS7 *p7)
 {
     return ASN1_item_i2d_fp(ASN1_ITEM_rptr(PKCS7), fp, p7);
 }
 #endif
 
-PKCS7 *d2i_PKCS7_bio(BIO *bp, PKCS7 **p7)
+PKCS7 * __cdecl d2i_PKCS7_bio(BIO *bp, PKCS7 **p7)
 {
     return ASN1_item_d2i_bio(ASN1_ITEM_rptr(PKCS7), bp, p7);
 }
 
-int i2d_PKCS7_bio(BIO *bp, PKCS7 *p7)
+int __cdecl i2d_PKCS7_bio(BIO *bp, PKCS7 *p7)
 {
     return ASN1_item_i2d_bio(ASN1_ITEM_rptr(PKCS7), bp, p7);
 }
@@ -212,9 +212,9 @@ RSA *d2i_RSAPublicKey_fp(FILE *fp, RSA **rsa)
     return ASN1_item_d2i_fp(ASN1_ITEM_rptr(RSAPublicKey), fp, rsa);
 }
 
-RSA *d2i_RSA_PUBKEY_fp(FILE *fp, RSA **rsa)
+RSA * __cdecl d2i_RSA_PUBKEY_fp(FILE *fp, RSA **rsa)
 {
-    return ASN1_d2i_fp((void *(*)(void))
+    return ASN1_d2i_fp((void *(__cdecl *)(void))
                        RSA_new, (D2I_OF(void)) d2i_RSA_PUBKEY, fp,
                        (void **)rsa);
 }
@@ -245,7 +245,7 @@ RSA *d2i_RSAPublicKey_bio(BIO *bp, RSA **rsa)
     return ASN1_item_d2i_bio(ASN1_ITEM_rptr(RSAPublicKey), bp, rsa);
 }
 
-RSA *d2i_RSA_PUBKEY_bio(BIO *bp, RSA **rsa)
+RSA * __cdecl d2i_RSA_PUBKEY_bio(BIO *bp, RSA **rsa)
 {
     return ASN1_d2i_bio_of(RSA, RSA_new, d2i_RSA_PUBKEY, bp, rsa);
 }
@@ -263,7 +263,7 @@ int i2d_RSA_PUBKEY_bio(BIO *bp, RSA *rsa)
 
 #ifndef OPENSSL_NO_DSA
 # ifndef OPENSSL_NO_STDIO
-DSA *d2i_DSAPrivateKey_fp(FILE *fp, DSA **dsa)
+DSA * __cdecl d2i_DSAPrivateKey_fp(FILE *fp, DSA **dsa)
 {
     return ASN1_d2i_fp_of(DSA, DSA_new, d2i_DSAPrivateKey, fp, dsa);
 }
@@ -273,7 +273,7 @@ int i2d_DSAPrivateKey_fp(FILE *fp, DSA *dsa)
     return ASN1_i2d_fp_of_const(DSA, i2d_DSAPrivateKey, fp, dsa);
 }
 
-DSA *d2i_DSA_PUBKEY_fp(FILE *fp, DSA **dsa)
+DSA * __cdecl d2i_DSA_PUBKEY_fp(FILE *fp, DSA **dsa)
 {
     return ASN1_d2i_fp_of(DSA, DSA_new, d2i_DSA_PUBKEY, fp, dsa);
 }
@@ -284,7 +284,7 @@ int i2d_DSA_PUBKEY_fp(FILE *fp, DSA *dsa)
 }
 # endif
 
-DSA *d2i_DSAPrivateKey_bio(BIO *bp, DSA **dsa)
+DSA * __cdecl d2i_DSAPrivateKey_bio(BIO *bp, DSA **dsa)
 {
     return ASN1_d2i_bio_of(DSA, DSA_new, d2i_DSAPrivateKey, bp, dsa);
 }
@@ -294,7 +294,7 @@ int i2d_DSAPrivateKey_bio(BIO *bp, DSA *dsa)
     return ASN1_i2d_bio_of_const(DSA, i2d_DSAPrivateKey, bp, dsa);
 }
 
-DSA *d2i_DSA_PUBKEY_bio(BIO *bp, DSA **dsa)
+DSA * __cdecl d2i_DSA_PUBKEY_bio(BIO *bp, DSA **dsa)
 {
     return ASN1_d2i_bio_of(DSA, DSA_new, d2i_DSA_PUBKEY, bp, dsa);
 }
@@ -308,7 +308,7 @@ int i2d_DSA_PUBKEY_bio(BIO *bp, DSA *dsa)
 
 #ifndef OPENSSL_NO_EC
 # ifndef OPENSSL_NO_STDIO
-EC_KEY *d2i_EC_PUBKEY_fp(FILE *fp, EC_KEY **eckey)
+EC_KEY * __cdecl d2i_EC_PUBKEY_fp(FILE *fp, EC_KEY **eckey)
 {
     return ASN1_d2i_fp_of(EC_KEY, EC_KEY_new, d2i_EC_PUBKEY, fp, eckey);
 }
@@ -318,7 +318,7 @@ int i2d_EC_PUBKEY_fp(FILE *fp, EC_KEY *eckey)
     return ASN1_i2d_fp_of(EC_KEY, i2d_EC_PUBKEY, fp, eckey);
 }
 
-EC_KEY *d2i_ECPrivateKey_fp(FILE *fp, EC_KEY **eckey)
+EC_KEY * __cdecl d2i_ECPrivateKey_fp(FILE *fp, EC_KEY **eckey)
 {
     return ASN1_d2i_fp_of(EC_KEY, EC_KEY_new, d2i_ECPrivateKey, fp, eckey);
 }
@@ -328,7 +328,7 @@ int i2d_ECPrivateKey_fp(FILE *fp, EC_KEY *eckey)
     return ASN1_i2d_fp_of(EC_KEY, i2d_ECPrivateKey, fp, eckey);
 }
 # endif
-EC_KEY *d2i_EC_PUBKEY_bio(BIO *bp, EC_KEY **eckey)
+EC_KEY * __cdecl d2i_EC_PUBKEY_bio(BIO *bp, EC_KEY **eckey)
 {
     return ASN1_d2i_bio_of(EC_KEY, EC_KEY_new, d2i_EC_PUBKEY, bp, eckey);
 }
@@ -338,7 +338,7 @@ int i2d_EC_PUBKEY_bio(BIO *bp, EC_KEY *ecdsa)
     return ASN1_i2d_bio_of(EC_KEY, i2d_EC_PUBKEY, bp, ecdsa);
 }
 
-EC_KEY *d2i_ECPrivateKey_bio(BIO *bp, EC_KEY **eckey)
+EC_KEY * __cdecl d2i_ECPrivateKey_bio(BIO *bp, EC_KEY **eckey)
 {
     return ASN1_d2i_bio_of(EC_KEY, EC_KEY_new, d2i_ECPrivateKey, bp, eckey);
 }
@@ -401,7 +401,7 @@ int X509_NAME_digest(const X509_NAME *data, const EVP_MD *type,
             (ASN1_ITEM_rptr(X509_NAME), type, (char *)data, md, len));
 }
 
-int PKCS7_ISSUER_AND_SERIAL_digest(PKCS7_ISSUER_AND_SERIAL *data,
+int __cdecl PKCS7_ISSUER_AND_SERIAL_digest(PKCS7_ISSUER_AND_SERIAL *data,
                                    const EVP_MD *type, unsigned char *md,
                                    unsigned int *len)
 {
@@ -462,7 +462,7 @@ int i2d_PrivateKey_fp(FILE *fp, EVP_PKEY *pkey)
     return ASN1_i2d_fp_of(EVP_PKEY, i2d_PrivateKey, fp, pkey);
 }
 
-EVP_PKEY *d2i_PrivateKey_fp(FILE *fp, EVP_PKEY **a)
+EVP_PKEY * __cdecl d2i_PrivateKey_fp(FILE *fp, EVP_PKEY **a)
 {
     return ASN1_d2i_fp_of(EVP_PKEY, EVP_PKEY_new, d2i_AutoPrivateKey, fp, a);
 }
@@ -472,7 +472,7 @@ int i2d_PUBKEY_fp(FILE *fp, EVP_PKEY *pkey)
     return ASN1_i2d_fp_of(EVP_PKEY, i2d_PUBKEY, fp, pkey);
 }
 
-EVP_PKEY *d2i_PUBKEY_fp(FILE *fp, EVP_PKEY **a)
+EVP_PKEY * __cdecl d2i_PUBKEY_fp(FILE *fp, EVP_PKEY **a)
 {
     return ASN1_d2i_fp_of(EVP_PKEY, EVP_PKEY_new, d2i_PUBKEY, fp, a);
 }
@@ -509,7 +509,7 @@ int i2d_PrivateKey_bio(BIO *bp, EVP_PKEY *pkey)
     return ASN1_i2d_bio_of(EVP_PKEY, i2d_PrivateKey, bp, pkey);
 }
 
-EVP_PKEY *d2i_PrivateKey_bio(BIO *bp, EVP_PKEY **a)
+EVP_PKEY * __cdecl d2i_PrivateKey_bio(BIO *bp, EVP_PKEY **a)
 {
     return ASN1_d2i_bio_of(EVP_PKEY, EVP_PKEY_new, d2i_AutoPrivateKey, bp, a);
 }
@@ -519,7 +519,7 @@ int i2d_PUBKEY_bio(BIO *bp, EVP_PKEY *pkey)
     return ASN1_i2d_bio_of(EVP_PKEY, i2d_PUBKEY, bp, pkey);
 }
 
-EVP_PKEY *d2i_PUBKEY_bio(BIO *bp, EVP_PKEY **a)
+EVP_PKEY * __cdecl d2i_PUBKEY_bio(BIO *bp, EVP_PKEY **a)
 {
     return ASN1_d2i_bio_of(EVP_PKEY, EVP_PKEY_new, d2i_PUBKEY, bp, a);
 }
diff --git a/crypto/x509/x_crl.c b/crypto/x509/x_crl.c
index 12ab3cca42..c830de507c 100644
--- a/crypto/x509/x_crl.c
+++ b/crypto/x509/x_crl.c
@@ -15,7 +15,7 @@
 #include <openssl/x509v3.h>
 #include "x509_lcl.h"
 
-static int X509_REVOKED_cmp(const X509_REVOKED *const *a,
+static int __cdecl X509_REVOKED_cmp(const X509_REVOKED *const *a,
                             const X509_REVOKED *const *b);
 static void setup_idp(X509_CRL *crl, ISSUING_DIST_POINT *idp);
 
@@ -311,7 +311,7 @@ IMPLEMENT_ASN1_FUNCTIONS(X509_CRL)
 
 IMPLEMENT_ASN1_DUP_FUNCTION(X509_CRL)
 
-static int X509_REVOKED_cmp(const X509_REVOKED *const *a,
+static int __cdecl X509_REVOKED_cmp(const X509_REVOKED *const *a,
                             const X509_REVOKED *const *b)
 {
     return (ASN1_STRING_cmp((ASN1_STRING *)&(*a)->serialNumber,
diff --git a/crypto/x509/x_name.c b/crypto/x509/x_name.c
index a1e9bbdb66..e8c1ef76b3 100644
--- a/crypto/x509/x_name.c
+++ b/crypto/x509/x_name.c
@@ -125,12 +125,12 @@ static void x509_name_ex_free(ASN1_VALUE **pval, const ASN1_ITEM *it)
     *pval = NULL;
 }
 
-static void local_sk_X509_NAME_ENTRY_free(STACK_OF(X509_NAME_ENTRY) *ne)
+static void __cdecl local_sk_X509_NAME_ENTRY_free(STACK_OF(X509_NAME_ENTRY) *ne)
 {
     sk_X509_NAME_ENTRY_free(ne);
 }
 
-static void local_sk_X509_NAME_ENTRY_pop_free(STACK_OF(X509_NAME_ENTRY) *ne)
+static void __cdecl local_sk_X509_NAME_ENTRY_pop_free(STACK_OF(X509_NAME_ENTRY) *ne)
 {
     sk_X509_NAME_ENTRY_pop_free(ne, X509_NAME_ENTRY_free);
 }
diff --git a/crypto/x509/x_pubkey.c b/crypto/x509/x_pubkey.c
index 1c87b8268e..18da2106b0 100644
--- a/crypto/x509/x_pubkey.c
+++ b/crypto/x509/x_pubkey.c
@@ -179,7 +179,7 @@ EVP_PKEY *X509_PUBKEY_get(X509_PUBKEY *key)
  * decode as X509_PUBKEY
  */
 
-EVP_PKEY *d2i_PUBKEY(EVP_PKEY **a, const unsigned char **pp, long length)
+EVP_PKEY * __cdecl d2i_PUBKEY(EVP_PKEY **a, const unsigned char **pp, long length)
 {
     X509_PUBKEY *xpk;
     EVP_PKEY *pktmp;
@@ -200,7 +200,7 @@ EVP_PKEY *d2i_PUBKEY(EVP_PKEY **a, const unsigned char **pp, long length)
     return pktmp;
 }
 
-int i2d_PUBKEY(EVP_PKEY *a, unsigned char **pp)
+int __cdecl i2d_PUBKEY(EVP_PKEY *a, unsigned char **pp)
 {
     X509_PUBKEY *xpk = NULL;
     int ret;
@@ -217,7 +217,7 @@ int i2d_PUBKEY(EVP_PKEY *a, unsigned char **pp)
  * The following are equivalents but which return RSA and DSA keys
  */
 #ifndef OPENSSL_NO_RSA
-RSA *d2i_RSA_PUBKEY(RSA **a, const unsigned char **pp, long length)
+RSA * __cdecl d2i_RSA_PUBKEY(RSA **a, const unsigned char **pp, long length)
 {
     EVP_PKEY *pkey;
     RSA *key;
@@ -238,7 +238,7 @@ RSA *d2i_RSA_PUBKEY(RSA **a, const unsigned char **pp, long length)
     return key;
 }
 
-int i2d_RSA_PUBKEY(RSA *a, unsigned char **pp)
+int __cdecl i2d_RSA_PUBKEY(RSA *a, unsigned char **pp)
 {
     EVP_PKEY *pktmp;
     int ret;
@@ -257,7 +257,7 @@ int i2d_RSA_PUBKEY(RSA *a, unsigned char **pp)
 #endif
 
 #ifndef OPENSSL_NO_DSA
-DSA *d2i_DSA_PUBKEY(DSA **a, const unsigned char **pp, long length)
+DSA * __cdecl d2i_DSA_PUBKEY(DSA **a, const unsigned char **pp, long length)
 {
     EVP_PKEY *pkey;
     DSA *key;
@@ -278,7 +278,7 @@ DSA *d2i_DSA_PUBKEY(DSA **a, const unsigned char **pp, long length)
     return key;
 }
 
-int i2d_DSA_PUBKEY(DSA *a, unsigned char **pp)
+int __cdecl i2d_DSA_PUBKEY(DSA *a, unsigned char **pp)
 {
     EVP_PKEY *pktmp;
     int ret;
@@ -297,7 +297,7 @@ int i2d_DSA_PUBKEY(DSA *a, unsigned char **pp)
 #endif
 
 #ifndef OPENSSL_NO_EC
-EC_KEY *d2i_EC_PUBKEY(EC_KEY **a, const unsigned char **pp, long length)
+EC_KEY * __cdecl d2i_EC_PUBKEY(EC_KEY **a, const unsigned char **pp, long length)
 {
     EVP_PKEY *pkey;
     EC_KEY *key;
@@ -318,7 +318,7 @@ EC_KEY *d2i_EC_PUBKEY(EC_KEY **a, const unsigned char **pp, long length)
     return key;
 }
 
-int i2d_EC_PUBKEY(EC_KEY *a, unsigned char **pp)
+int __cdecl i2d_EC_PUBKEY(EC_KEY *a, unsigned char **pp)
 {
     EVP_PKEY *pktmp;
     int ret;
diff --git a/crypto/x509/x_x509.c b/crypto/x509/x_x509.c
index afe59c46c5..c0c0f2f44f 100644
--- a/crypto/x509/x_x509.c
+++ b/crypto/x509/x_x509.c
@@ -127,7 +127,7 @@ void *X509_get_ex_data(X509 *r, int idx)
  * reliable source such as local storage.
  */
 
-X509 *d2i_X509_AUX(X509 **a, const unsigned char **pp, long length)
+X509 * __cdecl d2i_X509_AUX(X509 **a, const unsigned char **pp, long length)
 {
     const unsigned char *q;
     X509 *ret;
@@ -197,7 +197,7 @@ static int i2d_x509_aux_internal(X509 *a, unsigned char **pp)
  * the allocation, nor can we allow i2d_X509_CERT_AUX() to increment the
  * allocated buffer.
  */
-int i2d_X509_AUX(X509 *a, unsigned char **pp)
+int __cdecl i2d_X509_AUX(X509 *a, unsigned char **pp)
 {
     int length;
     unsigned char *tmp;
diff --git a/crypto/x509v3/pcy_cache.c b/crypto/x509v3/pcy_cache.c
index 623870b1f6..42194005c7 100644
--- a/crypto/x509v3/pcy_cache.c
+++ b/crypto/x509v3/pcy_cache.c
@@ -14,7 +14,7 @@
 
 #include "pcy_int.h"
 
-static int policy_data_cmp(const X509_POLICY_DATA *const *a,
+static int __cdecl policy_data_cmp(const X509_POLICY_DATA *const *a,
                            const X509_POLICY_DATA *const *b);
 static int policy_cache_set_int(long *out, ASN1_INTEGER *value);
 
@@ -207,7 +207,7 @@ X509_POLICY_DATA *policy_cache_find_data(const X509_POLICY_CACHE *cache,
     return sk_X509_POLICY_DATA_value(cache->data, idx);
 }
 
-static int policy_data_cmp(const X509_POLICY_DATA *const *a,
+static int __cdecl policy_data_cmp(const X509_POLICY_DATA *const *a,
                            const X509_POLICY_DATA *const *b)
 {
     return OBJ_cmp((*a)->valid_policy, (*b)->valid_policy);
diff --git a/crypto/x509v3/pcy_data.c b/crypto/x509v3/pcy_data.c
index bd3bb0e40d..1ce8f6ce77 100644
--- a/crypto/x509v3/pcy_data.c
+++ b/crypto/x509v3/pcy_data.c
@@ -15,7 +15,7 @@
 
 /* Policy Node routines */
 
-void policy_data_free(X509_POLICY_DATA *data)
+void __cdecl policy_data_free(X509_POLICY_DATA *data)
 {
     if (data == NULL)
         return;
diff --git a/crypto/x509v3/pcy_int.h b/crypto/x509v3/pcy_int.h
index 5daf78de45..8f16cd61a3 100644
--- a/crypto/x509v3/pcy_int.h
+++ b/crypto/x509v3/pcy_int.h
@@ -137,7 +137,7 @@ struct X509_POLICY_TREE_st {
 
 X509_POLICY_DATA *policy_data_new(POLICYINFO *policy, const ASN1_OBJECT *id,
                                   int crit);
-void policy_data_free(X509_POLICY_DATA *data);
+void __cdecl policy_data_free(X509_POLICY_DATA *data);
 
 X509_POLICY_DATA *policy_cache_find_data(const X509_POLICY_CACHE *cache,
                                          const ASN1_OBJECT *id);
@@ -160,7 +160,7 @@ X509_POLICY_NODE *level_add_node(X509_POLICY_LEVEL *level,
                                  X509_POLICY_DATA *data,
                                  X509_POLICY_NODE *parent,
                                  X509_POLICY_TREE *tree);
-void policy_node_free(X509_POLICY_NODE *node);
+void __cdecl policy_node_free(X509_POLICY_NODE *node);
 int policy_node_match(const X509_POLICY_LEVEL *lvl,
                       const X509_POLICY_NODE *node, const ASN1_OBJECT *oid);
 
diff --git a/crypto/x509v3/pcy_node.c b/crypto/x509v3/pcy_node.c
index 1ffe98498b..f43bf9b52a 100644
--- a/crypto/x509v3/pcy_node.c
+++ b/crypto/x509v3/pcy_node.c
@@ -14,7 +14,7 @@
 
 #include "pcy_int.h"
 
-static int node_cmp(const X509_POLICY_NODE *const *a,
+static int __cdecl node_cmp(const X509_POLICY_NODE *const *a,
                     const X509_POLICY_NODE *const *b)
 {
     return OBJ_cmp((*a)->data->valid_policy, (*b)->data->valid_policy);
@@ -113,7 +113,7 @@ X509_POLICY_NODE *level_add_node(X509_POLICY_LEVEL *level,
     return NULL;
 }
 
-void policy_node_free(X509_POLICY_NODE *node)
+void __cdecl policy_node_free(X509_POLICY_NODE *node)
 {
     OPENSSL_free(node);
 }
diff --git a/crypto/x509v3/pcy_tree.c b/crypto/x509v3/pcy_tree.c
index 87f51d001b..676c2ccc79 100644
--- a/crypto/x509v3/pcy_tree.c
+++ b/crypto/x509v3/pcy_tree.c
@@ -598,7 +598,7 @@ static int tree_evaluate(X509_POLICY_TREE *tree)
     return X509_PCY_TREE_VALID;
 }
 
-static void exnode_free(X509_POLICY_NODE *node)
+static void __cdecl exnode_free(X509_POLICY_NODE *node)
 {
     if (node->data && (node->data->flags & POLICY_DATA_FLAG_EXTRA_NODE))
         OPENSSL_free(node);
diff --git a/crypto/x509v3/v3_addr.c b/crypto/x509v3/v3_addr.c
index bb58e04846..b6fceb2779 100644
--- a/crypto/x509v3/v3_addr.c
+++ b/crypto/x509v3/v3_addr.c
@@ -316,7 +316,7 @@ static int IPAddressOrRange_cmp(const IPAddressOrRange *a,
  * IPv4-specific closure over IPAddressOrRange_cmp, since sk_sort()
  * comparison routines are only allowed two arguments.
  */
-static int v4IPAddressOrRange_cmp(const IPAddressOrRange *const *a,
+static int __cdecl v4IPAddressOrRange_cmp(const IPAddressOrRange *const *a,
                                   const IPAddressOrRange *const *b)
 {
     return IPAddressOrRange_cmp(*a, *b, 4);
@@ -326,7 +326,7 @@ static int v4IPAddressOrRange_cmp(const IPAddressOrRange *const *a,
  * IPv6-specific closure over IPAddressOrRange_cmp, since sk_sort()
  * comparison routines are only allowed two arguments.
  */
-static int v6IPAddressOrRange_cmp(const IPAddressOrRange *const *a,
+static int __cdecl v6IPAddressOrRange_cmp(const IPAddressOrRange *const *a,
                                   const IPAddressOrRange *const *b)
 {
     return IPAddressOrRange_cmp(*a, *b, 16);
@@ -666,7 +666,7 @@ int X509v3_addr_get_range(IPAddressOrRange *aor,
  * null-SAFI rule to apply only within a single AFI, which is what I
  * would have expected and is what the following code implements.
  */
-static int IPAddressFamily_cmp(const IPAddressFamily *const *a_,
+static int __cdecl IPAddressFamily_cmp(const IPAddressFamily *const *a_,
                                const IPAddressFamily *const *b_)
 {
     const ASN1_OCTET_STRING *a = (*a_)->addressFamily;
diff --git a/crypto/x509v3/v3_asid.c b/crypto/x509v3/v3_asid.c
index 089f2ae29f..3bc9762a64 100644
--- a/crypto/x509v3/v3_asid.c
+++ b/crypto/x509v3/v3_asid.c
@@ -119,7 +119,7 @@ static int i2r_ASIdentifiers(const X509V3_EXT_METHOD *method,
 /*
  * Sort comparison function for a sequence of ASIdOrRange elements.
  */
-static int ASIdOrRange_cmp(const ASIdOrRange *const *a_,
+static int __cdecl ASIdOrRange_cmp(const ASIdOrRange *const *a_,
                            const ASIdOrRange *const *b_)
 {
     const ASIdOrRange *a = *a_, *b = *b_;
diff --git a/crypto/x509v3/v3_lib.c b/crypto/x509v3/v3_lib.c
index 97c1cbc20f..eadec5615d 100644
--- a/crypto/x509v3/v3_lib.c
+++ b/crypto/x509v3/v3_lib.c
@@ -18,9 +18,9 @@
 
 static STACK_OF(X509V3_EXT_METHOD) *ext_list = NULL;
 
-static int ext_cmp(const X509V3_EXT_METHOD *const *a,
+static int __cdecl ext_cmp(const X509V3_EXT_METHOD *const *a,
                    const X509V3_EXT_METHOD *const *b);
-static void ext_list_free(X509V3_EXT_METHOD *ext);
+static void __cdecl ext_list_free(X509V3_EXT_METHOD *ext);
 
 int X509V3_EXT_add(X509V3_EXT_METHOD *ext)
 {
@@ -36,7 +36,7 @@ int X509V3_EXT_add(X509V3_EXT_METHOD *ext)
     return 1;
 }
 
-static int ext_cmp(const X509V3_EXT_METHOD *const *a,
+static int __cdecl ext_cmp(const X509V3_EXT_METHOD *const *a,
                    const X509V3_EXT_METHOD *const *b)
 {
     return ((*a)->ext_nid - (*b)->ext_nid);
@@ -108,7 +108,7 @@ void X509V3_EXT_cleanup(void)
     ext_list = NULL;
 }
 
-static void ext_list_free(X509V3_EXT_METHOD *ext)
+static void __cdecl ext_list_free(X509V3_EXT_METHOD *ext)
 {
     if (ext->ext_flags & X509V3_EXT_DYNAMIC)
         OPENSSL_free(ext);
diff --git a/crypto/x509v3/v3_purp.c b/crypto/x509v3/v3_purp.c
index 2f06289d19..0f5b865f71 100644
--- a/crypto/x509v3/v3_purp.c
+++ b/crypto/x509v3/v3_purp.c
@@ -36,8 +36,8 @@ static int check_purpose_timestamp_sign(const X509_PURPOSE *xp, const X509 *x,
 static int no_check(const X509_PURPOSE *xp, const X509 *x, int ca);
 static int ocsp_helper(const X509_PURPOSE *xp, const X509 *x, int ca);
 
-static int xp_cmp(const X509_PURPOSE *const *a, const X509_PURPOSE *const *b);
-static void xptable_free(X509_PURPOSE *p);
+static int __cdecl xp_cmp(const X509_PURPOSE *const *a, const X509_PURPOSE *const *b);
+static void __cdecl xptable_free(X509_PURPOSE *p);
 
 static X509_PURPOSE xstandard[] = {
     {X509_PURPOSE_SSL_CLIENT, X509_TRUST_SSL_CLIENT, 0,
@@ -65,7 +65,7 @@ static X509_PURPOSE xstandard[] = {
 
 static STACK_OF(X509_PURPOSE) *xptable = NULL;
 
-static int xp_cmp(const X509_PURPOSE *const *a, const X509_PURPOSE *const *b)
+static int __cdecl xp_cmp(const X509_PURPOSE *const *a, const X509_PURPOSE *const *b)
 {
     return (*a)->purpose - (*b)->purpose;
 }
@@ -214,7 +214,7 @@ int X509_PURPOSE_add(int id, int trust, int flags,
     return 0;
 }
 
-static void xptable_free(X509_PURPOSE *p)
+static void __cdecl xptable_free(X509_PURPOSE *p)
 {
     if (!p)
         return;
@@ -253,7 +253,7 @@ int X509_PURPOSE_get_trust(const X509_PURPOSE *xp)
     return xp->trust;
 }
 
-static int nid_cmp(const int *a, const int *b)
+static int __cdecl nid_cmp(const int *a, const int *b)
 {
     return *a - *b;
 }
diff --git a/crypto/x509v3/v3_utl.c b/crypto/x509v3/v3_utl.c
index c9b40d2c76..d051a495d2 100644
--- a/crypto/x509v3/v3_utl.c
+++ b/crypto/x509v3/v3_utl.c
@@ -21,10 +21,10 @@
 #include "ext_dat.h"
 
 static char *strip_spaces(char *name);
-static int sk_strcmp(const char *const *a, const char *const *b);
+static int __cdecl sk_strcmp(const char *const *a, const char *const *b);
 static STACK_OF(OPENSSL_STRING) *get_email(X509_NAME *name,
                                            GENERAL_NAMES *gens);
-static void str_free(OPENSSL_STRING str);
+static void __cdecl str_free(OPENSSL_STRING str);
 static int append_ia5(STACK_OF(OPENSSL_STRING) **sk, const ASN1_IA5STRING *email);
 
 static int ipv4_from_asc(unsigned char *v4, const char *in);
@@ -75,7 +75,7 @@ int X509V3_add_value_uchar(const char *name, const unsigned char *value,
 
 /* Free function for STACK_OF(CONF_VALUE) */
 
-void X509V3_conf_free(CONF_VALUE *conf)
+void __cdecl X509V3_conf_free(CONF_VALUE *conf)
 {
     if (!conf)
         return;
@@ -410,7 +410,7 @@ int name_cmp(const char *name, const char *cmp)
     return 1;
 }
 
-static int sk_strcmp(const char *const *a, const char *const *b)
+static int __cdecl sk_strcmp(const char *const *a, const char *const *b)
 {
     return strcmp(*a, *b);
 }
@@ -491,7 +491,7 @@ static STACK_OF(OPENSSL_STRING) *get_email(X509_NAME *name,
     return ret;
 }
 
-static void str_free(OPENSSL_STRING str)
+static void __cdecl str_free(OPENSSL_STRING str)
 {
     OPENSSL_free(str);
 }
diff --git a/demos/bio/client-arg.c b/demos/bio/client-arg.c
index e8d5e46ab5..64da8b8d55 100644
--- a/demos/bio/client-arg.c
+++ b/demos/bio/client-arg.c
@@ -11,7 +11,7 @@
 #include <openssl/err.h>
 #include <openssl/ssl.h>
 
-int main(int argc, char **argv)
+int __cdecl main(int argc, char **argv)
 {
     BIO *sbio = NULL, *out = NULL;
     int len;
diff --git a/demos/bio/client-conf.c b/demos/bio/client-conf.c
index e819030eec..223f1ca7d8 100644
--- a/demos/bio/client-conf.c
+++ b/demos/bio/client-conf.c
@@ -12,7 +12,7 @@
 #include <openssl/ssl.h>
 #include <openssl/conf.h>
 
-int main(int argc, char **argv)
+int __cdecl main(int argc, char **argv)
 {
     BIO *sbio = NULL, *out = NULL;
     int i, len, rv;
diff --git a/demos/bio/saccept.c b/demos/bio/saccept.c
index de86ae6322..5bd262f50d 100644
--- a/demos/bio/saccept.c
+++ b/demos/bio/saccept.c
@@ -45,7 +45,7 @@ void sigsetup(void)
     sigaction(SIGINT, &sa, NULL);
 }
 
-int main(int argc, char *argv[])
+int __cdecl main(int argc, char *argv[])
 {
     char *port = NULL;
     BIO *in = NULL;
diff --git a/demos/bio/sconnect.c b/demos/bio/sconnect.c
index db71f29afe..3a377a9399 100644
--- a/demos/bio/sconnect.c
+++ b/demos/bio/sconnect.c
@@ -25,7 +25,7 @@
 #define HOSTPORT "localhost:4433"
 #define CAFILE "root.pem"
 
-int main(int argc, char *argv[])
+int __cdecl main(int argc, char *argv[])
 {
     const char *hostport = HOSTPORT;
     const char *CAfile = CAFILE;
diff --git a/demos/bio/server-arg.c b/demos/bio/server-arg.c
index d80d070f7a..9f079641b6 100644
--- a/demos/bio/server-arg.c
+++ b/demos/bio/server-arg.c
@@ -20,7 +20,7 @@
 #include <openssl/err.h>
 #include <openssl/ssl.h>
 
-int main(int argc, char *argv[])
+int __cdecl main(int argc, char *argv[])
 {
     char *port = "*:4433";
     BIO *ssl_bio, *tmp;
diff --git a/demos/bio/server-cmod.c b/demos/bio/server-cmod.c
index f1079ad329..caf3f18340 100644
--- a/demos/bio/server-cmod.c
+++ b/demos/bio/server-cmod.c
@@ -19,7 +19,7 @@
 #include <openssl/ssl.h>
 #include <openssl/conf.h>
 
-int main(int argc, char *argv[])
+int __cdecl main(int argc, char *argv[])
 {
     unsigned char buf[512];
     char *port = "*:4433";
diff --git a/demos/bio/server-conf.c b/demos/bio/server-conf.c
index 4d1655bfc9..f2a0773e52 100644
--- a/demos/bio/server-conf.c
+++ b/demos/bio/server-conf.c
@@ -21,7 +21,7 @@
 #include <openssl/ssl.h>
 #include <openssl/conf.h>
 
-int main(int argc, char *argv[])
+int __cdecl main(int argc, char *argv[])
 {
     char *port = "*:4433";
     BIO *in = NULL;
diff --git a/demos/cms/cms_comp.c b/demos/cms/cms_comp.c
index 0d548f93ca..d11002dd80 100644
--- a/demos/cms/cms_comp.c
+++ b/demos/cms/cms_comp.c
@@ -12,7 +12,7 @@
 #include <openssl/cms.h>
 #include <openssl/err.h>
 
-int main(int argc, char **argv)
+int __cdecl main(int argc, char **argv)
 {
     BIO *in = NULL, *out = NULL;
     CMS_ContentInfo *cms = NULL;
diff --git a/demos/cms/cms_ddec.c b/demos/cms/cms_ddec.c
index 8f2e9aecb2..04e8e519f0 100644
--- a/demos/cms/cms_ddec.c
+++ b/demos/cms/cms_ddec.c
@@ -15,7 +15,7 @@
 #include <openssl/cms.h>
 #include <openssl/err.h>
 
-int main(int argc, char **argv)
+int __cdecl main(int argc, char **argv)
 {
     BIO *in = NULL, *out = NULL, *tbio = NULL, *dcont = NULL;
     X509 *rcert = NULL;
diff --git a/demos/cms/cms_dec.c b/demos/cms/cms_dec.c
index 4f9428b4e7..09bd72a002 100644
--- a/demos/cms/cms_dec.c
+++ b/demos/cms/cms_dec.c
@@ -12,7 +12,7 @@
 #include <openssl/cms.h>
 #include <openssl/err.h>
 
-int main(int argc, char **argv)
+int __cdecl main(int argc, char **argv)
 {
     BIO *in = NULL, *out = NULL, *tbio = NULL;
     X509 *rcert = NULL;
diff --git a/demos/cms/cms_denc.c b/demos/cms/cms_denc.c
index adba69b96d..62a73c390a 100644
--- a/demos/cms/cms_denc.c
+++ b/demos/cms/cms_denc.c
@@ -15,7 +15,7 @@
 #include <openssl/cms.h>
 #include <openssl/err.h>
 
-int main(int argc, char **argv)
+int __cdecl main(int argc, char **argv)
 {
     BIO *in = NULL, *out = NULL, *tbio = NULL, *dout = NULL;
     X509 *rcert = NULL;
diff --git a/demos/cms/cms_enc.c b/demos/cms/cms_enc.c
index 4d17d720c6..d9205aa679 100644
--- a/demos/cms/cms_enc.c
+++ b/demos/cms/cms_enc.c
@@ -12,7 +12,7 @@
 #include <openssl/cms.h>
 #include <openssl/err.h>
 
-int main(int argc, char **argv)
+int __cdecl main(int argc, char **argv)
 {
     BIO *in = NULL, *out = NULL, *tbio = NULL;
     X509 *rcert = NULL;
diff --git a/demos/cms/cms_sign.c b/demos/cms/cms_sign.c
index 15bd5b8dd9..8e1a1e2d98 100644
--- a/demos/cms/cms_sign.c
+++ b/demos/cms/cms_sign.c
@@ -12,7 +12,7 @@
 #include <openssl/cms.h>
 #include <openssl/err.h>
 
-int main(int argc, char **argv)
+int __cdecl main(int argc, char **argv)
 {
     BIO *in = NULL, *out = NULL, *tbio = NULL;
     X509 *scert = NULL;
diff --git a/demos/cms/cms_sign2.c b/demos/cms/cms_sign2.c
index 14ebf27775..e288b4b2cf 100644
--- a/demos/cms/cms_sign2.c
+++ b/demos/cms/cms_sign2.c
@@ -12,7 +12,7 @@
 #include <openssl/cms.h>
 #include <openssl/err.h>
 
-int main(int argc, char **argv)
+int __cdecl main(int argc, char **argv)
 {
     BIO *in = NULL, *out = NULL, *tbio = NULL;
     X509 *scert = NULL, *scert2 = NULL;
diff --git a/demos/cms/cms_uncomp.c b/demos/cms/cms_uncomp.c
index 3e3b4c4c6e..4251a09a77 100644
--- a/demos/cms/cms_uncomp.c
+++ b/demos/cms/cms_uncomp.c
@@ -12,7 +12,7 @@
 #include <openssl/cms.h>
 #include <openssl/err.h>
 
-int main(int argc, char **argv)
+int __cdecl main(int argc, char **argv)
 {
     BIO *in = NULL, *out = NULL;
     CMS_ContentInfo *cms = NULL;
diff --git a/demos/cms/cms_ver.c b/demos/cms/cms_ver.c
index 43c10e2513..b6d62a108a 100644
--- a/demos/cms/cms_ver.c
+++ b/demos/cms/cms_ver.c
@@ -12,7 +12,7 @@
 #include <openssl/cms.h>
 #include <openssl/err.h>
 
-int main(int argc, char **argv)
+int __cdecl main(int argc, char **argv)
 {
     BIO *in = NULL, *out = NULL, *tbio = NULL, *cont = NULL;
     X509_STORE *st = NULL;
diff --git a/demos/evp/aesccm.c b/demos/evp/aesccm.c
index cc4d0b5ee9..e06181d761 100644
--- a/demos/evp/aesccm.c
+++ b/demos/evp/aesccm.c
@@ -118,7 +118,7 @@ void aes_ccm_decrypt(void)
     EVP_CIPHER_CTX_free(ctx);
 }
 
-int main(int argc, char **argv)
+int __cdecl main(int argc, char **argv)
 {
     aes_ccm_encrypt();
     aes_ccm_decrypt();
diff --git a/demos/evp/aesgcm.c b/demos/evp/aesgcm.c
index 3cef27f991..420384af91 100644
--- a/demos/evp/aesgcm.c
+++ b/demos/evp/aesgcm.c
@@ -114,7 +114,7 @@ void aes_gcm_decrypt(void)
     EVP_CIPHER_CTX_free(ctx);
 }
 
-int main(int argc, char **argv)
+int __cdecl main(int argc, char **argv)
 {
     aes_gcm_encrypt();
     aes_gcm_decrypt();
diff --git a/demos/pkcs12/pkread.c b/demos/pkcs12/pkread.c
index e5f78f1b35..495bb16402 100644
--- a/demos/pkcs12/pkread.c
+++ b/demos/pkcs12/pkread.c
@@ -45,7 +45,7 @@ static char *find_friendly_name(PKCS12 *p12)
     return name;
 }
 
-int main(int argc, char **argv)
+int __cdecl main(int argc, char **argv)
 {
     FILE *fp;
     EVP_PKEY *pkey = NULL;
diff --git a/demos/pkcs12/pkwrite.c b/demos/pkcs12/pkwrite.c
index e14cf8327d..6fa4b99735 100644
--- a/demos/pkcs12/pkwrite.c
+++ b/demos/pkcs12/pkwrite.c
@@ -15,7 +15,7 @@
 
 /* Simple PKCS#12 file creator */
 
-int main(int argc, char **argv)
+int __cdecl main(int argc, char **argv)
 {
     FILE *fp;
     EVP_PKEY *pkey;
diff --git a/demos/smime/smdec.c b/demos/smime/smdec.c
index c4d1b090d9..3238f5bed5 100644
--- a/demos/smime/smdec.c
+++ b/demos/smime/smdec.c
@@ -12,7 +12,7 @@
 #include <openssl/pkcs7.h>
 #include <openssl/err.h>
 
-int main(int argc, char **argv)
+int __cdecl main(int argc, char **argv)
 {
     BIO *in = NULL, *out = NULL, *tbio = NULL;
     X509 *rcert = NULL;
diff --git a/demos/smime/smenc.c b/demos/smime/smenc.c
index 5d36e9a497..ec8107f7f8 100644
--- a/demos/smime/smenc.c
+++ b/demos/smime/smenc.c
@@ -12,7 +12,7 @@
 #include <openssl/pkcs7.h>
 #include <openssl/err.h>
 
-int main(int argc, char **argv)
+int __cdecl main(int argc, char **argv)
 {
     BIO *in = NULL, *out = NULL, *tbio = NULL;
     X509 *rcert = NULL;
diff --git a/demos/smime/smsign.c b/demos/smime/smsign.c
index ba0adb3974..3ccccfe2bb 100644
--- a/demos/smime/smsign.c
+++ b/demos/smime/smsign.c
@@ -12,7 +12,7 @@
 #include <openssl/pkcs7.h>
 #include <openssl/err.h>
 
-int main(int argc, char **argv)
+int __cdecl main(int argc, char **argv)
 {
     BIO *in = NULL, *out = NULL, *tbio = NULL;
     X509 *scert = NULL;
diff --git a/demos/smime/smsign2.c b/demos/smime/smsign2.c
index 2b7f45b294..80f8e3b518 100644
--- a/demos/smime/smsign2.c
+++ b/demos/smime/smsign2.c
@@ -12,7 +12,7 @@
 #include <openssl/pkcs7.h>
 #include <openssl/err.h>
 
-int main(int argc, char **argv)
+int __cdecl main(int argc, char **argv)
 {
     BIO *in = NULL, *out = NULL, *tbio = NULL;
     X509 *scert = NULL, *scert2 = NULL;
diff --git a/demos/smime/smver.c b/demos/smime/smver.c
index 75411c40d0..01cd21813f 100644
--- a/demos/smime/smver.c
+++ b/demos/smime/smver.c
@@ -12,7 +12,7 @@
 #include <openssl/pkcs7.h>
 #include <openssl/err.h>
 
-int main(int argc, char **argv)
+int __cdecl main(int argc, char **argv)
 {
     BIO *in = NULL, *out = NULL, *tbio = NULL, *cont = NULL;
     X509_STORE *st = NULL;
diff --git a/doc/man3/ASYNC_start_job.pod b/doc/man3/ASYNC_start_job.pod
index b06db76708..7aa6cac37e 100644
--- a/doc/man3/ASYNC_start_job.pod
+++ b/doc/man3/ASYNC_start_job.pod
@@ -244,7 +244,7 @@ The following example demonstrates how to use most of the core async APIs:
      return 1;
  }
 
- int main(void)
+ int __cdecl main(void)
  {
      ASYNC_JOB *job = NULL;
      ASYNC_WAIT_CTX *ctx = NULL;
diff --git a/doc/man3/EVP_DigestInit.pod b/doc/man3/EVP_DigestInit.pod
index 3e3e342297..bf10d3bb6f 100644
--- a/doc/man3/EVP_DigestInit.pod
+++ b/doc/man3/EVP_DigestInit.pod
@@ -313,7 +313,7 @@ digest name passed on the command line.
  #include <string.h>
  #include <openssl/evp.h>
 
- int main(int argc, char *argv[])
+ int __cdecl main(int argc, char *argv[])
  {
      EVP_MD_CTX *mdctx;
      const EVP_MD *md;
diff --git a/doc/man3/PKCS12_newpass.pod b/doc/man3/PKCS12_newpass.pod
index 5fc041bfbd..d8df52c083 100644
--- a/doc/man3/PKCS12_newpass.pod
+++ b/doc/man3/PKCS12_newpass.pod
@@ -45,7 +45,7 @@ the result to a new file.
  #include <openssl/err.h>
  #include <openssl/pkcs12.h>
 
- int main(int argc, char **argv)
+ int __cdecl main(int argc, char **argv)
  {
      FILE *fp;
      PKCS12 *p12;
diff --git a/engines/e_capi.c b/engines/e_capi.c
index 37202b81f3..d2c1fd145d 100644
--- a/engines/e_capi.c
+++ b/engines/e_capi.c
@@ -122,17 +122,17 @@ CAPI_KEY *capi_find_key(CAPI_CTX *ctx, const char *id);
 
 static EVP_PKEY *capi_load_privkey(ENGINE *eng, const char *key_id,
                                    UI_METHOD *ui_method, void *callback_data);
-static int capi_rsa_sign(int dtype, const unsigned char *m,
+static int __cdecl capi_rsa_sign(int dtype, const unsigned char *m,
                          unsigned int m_len, unsigned char *sigret,
                          unsigned int *siglen, const RSA *rsa);
-static int capi_rsa_priv_enc(int flen, const unsigned char *from,
+static int __cdecl capi_rsa_priv_enc(int flen, const unsigned char *from,
                              unsigned char *to, RSA *rsa, int padding);
-static int capi_rsa_priv_dec(int flen, const unsigned char *from,
+static int __cdecl capi_rsa_priv_dec(int flen, const unsigned char *from,
                              unsigned char *to, RSA *rsa, int padding);
-static int capi_rsa_free(RSA *rsa);
+static int __cdecl capi_rsa_free(RSA *rsa);
 
 # ifndef OPENSSL_NO_DSA
-static DSA_SIG *capi_dsa_do_sign(const unsigned char *digest, int dlen,
+static DSA_SIG * __cdecl capi_dsa_do_sign(const unsigned char *digest, int dlen,
                                  DSA *dsa);
 static int capi_dsa_free(DSA *dsa);
 # endif
@@ -808,14 +808,14 @@ static EVP_PKEY *capi_load_privkey(ENGINE *eng, const char *key_id,
 
 /* CryptoAPI RSA operations */
 
-int capi_rsa_priv_enc(int flen, const unsigned char *from,
+int __cdecl capi_rsa_priv_enc(int flen, const unsigned char *from,
                       unsigned char *to, RSA *rsa, int padding)
 {
     CAPIerr(CAPI_F_CAPI_RSA_PRIV_ENC, CAPI_R_FUNCTION_NOT_SUPPORTED);
     return -1;
 }
 
-int capi_rsa_sign(int dtype, const unsigned char *m, unsigned int m_len,
+int __cdecl capi_rsa_sign(int dtype, const unsigned char *m, unsigned int m_len,
                   unsigned char *sigret, unsigned int *siglen, const RSA *rsa)
 {
     ALG_ID alg;
@@ -910,7 +910,7 @@ int capi_rsa_sign(int dtype, const unsigned char *m, unsigned int m_len,
     return ret;
 }
 
-int capi_rsa_priv_dec(int flen, const unsigned char *from,
+int __cdecl capi_rsa_priv_dec(int flen, const unsigned char *from,
                       unsigned char *to, RSA *rsa, int padding)
 {
     int i;
@@ -977,7 +977,7 @@ int capi_rsa_priv_dec(int flen, const unsigned char *from,
     return flen;
 }
 
-static int capi_rsa_free(RSA *rsa)
+static int __cdecl capi_rsa_free(RSA *rsa)
 {
     CAPI_KEY *capi_key;
     capi_key = RSA_get_ex_data(rsa, rsa_capi_idx);
@@ -989,7 +989,7 @@ static int capi_rsa_free(RSA *rsa)
 # ifndef OPENSSL_NO_DSA
 /* CryptoAPI DSA operations */
 
-static DSA_SIG *capi_dsa_do_sign(const unsigned char *digest, int dlen,
+static DSA_SIG * __cdecl capi_dsa_do_sign(const unsigned char *digest, int dlen,
                                  DSA *dsa)
 {
     HCRYPTHASH hash;
diff --git a/fuzz/driver.c b/fuzz/driver.c
index 54d67de202..b9010d6987 100644
--- a/fuzz/driver.c
+++ b/fuzz/driver.c
@@ -32,7 +32,7 @@ int LLVMFuzzerTestOneInput(const uint8_t *buf, size_t len)
 
 #define BUF_SIZE 65536
 
-int main(int argc, char** argv)
+int __cdecl main(int argc, char** argv)
 {
     FuzzerInitialize(&argc, &argv);
 
diff --git a/fuzz/test-corpus.c b/fuzz/test-corpus.c
index 86be5337e1..13e2cae10d 100644
--- a/fuzz/test-corpus.c
+++ b/fuzz/test-corpus.c
@@ -58,7 +58,7 @@ static void testfile(const char *pathname)
     fclose(f);
 }
 
-int main(int argc, char **argv) {
+int __cdecl main(int argc, char **argv) {
     int n;
 
     FuzzerInitialize(&argc, &argv);
diff --git a/include/internal/err.h b/include/internal/err.h
index d46b8bdb29..6bad3f0cf3 100644
--- a/include/internal/err.h
+++ b/include/internal/err.h
@@ -10,6 +10,6 @@
 #ifndef INTERNAL_ERR_H
 # define INTERNAL_ERR_H
 
-void err_free_strings_int(void);
+void __cdecl err_free_strings_int(void);
 
 #endif
diff --git a/include/openssl/aes.h b/include/openssl/aes.h
index 245c552abd..6f78f11053 100644
--- a/include/openssl/aes.h
+++ b/include/openssl/aes.h
@@ -38,49 +38,49 @@ struct aes_key_st {
 };
 typedef struct aes_key_st AES_KEY;
 
-const char *AES_options(void);
+const char * __cdecl AES_options(void);
 
-int AES_set_encrypt_key(const unsigned char *userKey, const int bits,
+int __cdecl AES_set_encrypt_key(const unsigned char *userKey, const int bits,
                         AES_KEY *key);
-int AES_set_decrypt_key(const unsigned char *userKey, const int bits,
+int __cdecl AES_set_decrypt_key(const unsigned char *userKey, const int bits,
                         AES_KEY *key);
 
-void AES_encrypt(const unsigned char *in, unsigned char *out,
+void __cdecl AES_encrypt(const unsigned char *in, unsigned char *out,
                  const AES_KEY *key);
-void AES_decrypt(const unsigned char *in, unsigned char *out,
+void __cdecl AES_decrypt(const unsigned char *in, unsigned char *out,
                  const AES_KEY *key);
 
-void AES_ecb_encrypt(const unsigned char *in, unsigned char *out,
+void __cdecl AES_ecb_encrypt(const unsigned char *in, unsigned char *out,
                      const AES_KEY *key, const int enc);
-void AES_cbc_encrypt(const unsigned char *in, unsigned char *out,
+void __cdecl AES_cbc_encrypt(const unsigned char *in, unsigned char *out,
                      size_t length, const AES_KEY *key,
                      unsigned char *ivec, const int enc);
-void AES_cfb128_encrypt(const unsigned char *in, unsigned char *out,
+void __cdecl AES_cfb128_encrypt(const unsigned char *in, unsigned char *out,
                         size_t length, const AES_KEY *key,
                         unsigned char *ivec, int *num, const int enc);
-void AES_cfb1_encrypt(const unsigned char *in, unsigned char *out,
+void __cdecl AES_cfb1_encrypt(const unsigned char *in, unsigned char *out,
                       size_t length, const AES_KEY *key,
                       unsigned char *ivec, int *num, const int enc);
-void AES_cfb8_encrypt(const unsigned char *in, unsigned char *out,
+void __cdecl AES_cfb8_encrypt(const unsigned char *in, unsigned char *out,
                       size_t length, const AES_KEY *key,
                       unsigned char *ivec, int *num, const int enc);
-void AES_ofb128_encrypt(const unsigned char *in, unsigned char *out,
+void __cdecl AES_ofb128_encrypt(const unsigned char *in, unsigned char *out,
                         size_t length, const AES_KEY *key,
                         unsigned char *ivec, int *num);
 /* NB: the IV is _two_ blocks long */
-void AES_ige_encrypt(const unsigned char *in, unsigned char *out,
+void __cdecl AES_ige_encrypt(const unsigned char *in, unsigned char *out,
                      size_t length, const AES_KEY *key,
                      unsigned char *ivec, const int enc);
 /* NB: the IV is _four_ blocks long */
-void AES_bi_ige_encrypt(const unsigned char *in, unsigned char *out,
+void __cdecl AES_bi_ige_encrypt(const unsigned char *in, unsigned char *out,
                         size_t length, const AES_KEY *key,
                         const AES_KEY *key2, const unsigned char *ivec,
                         const int enc);
 
-int AES_wrap_key(AES_KEY *key, const unsigned char *iv,
+int __cdecl AES_wrap_key(AES_KEY *key, const unsigned char *iv,
                  unsigned char *out,
                  const unsigned char *in, unsigned int inlen);
-int AES_unwrap_key(AES_KEY *key, const unsigned char *iv,
+int __cdecl AES_unwrap_key(AES_KEY *key, const unsigned char *iv,
                    unsigned char *out,
                    const unsigned char *in, unsigned int inlen);
 
diff --git a/include/openssl/asn1.h b/include/openssl/asn1.h
index 9522eec18f..30c2a14d7a 100644
--- a/include/openssl/asn1.h
+++ b/include/openssl/asn1.h
@@ -228,25 +228,25 @@ typedef struct ASN1_VALUE_st ASN1_VALUE;
         DECLARE_ASN1_ENCODE_FUNCTIONS(type, itname, name)
 
 # define DECLARE_ASN1_ENCODE_FUNCTIONS(type, itname, name) \
-        type *d2i_##name(type **a, const unsigned char **in, long len); \
-        int i2d_##name(type *a, unsigned char **out); \
+        type * __cdecl d2i_##name(type **a, const unsigned char **in, long len); \
+        int __cdecl i2d_##name(type *a, unsigned char **out); \
         DECLARE_ASN1_ITEM(itname)
 
 # define DECLARE_ASN1_ENCODE_FUNCTIONS_const(type, name) \
-        type *d2i_##name(type **a, const unsigned char **in, long len); \
-        int i2d_##name(const type *a, unsigned char **out); \
+        type * __cdecl d2i_##name(type **a, const unsigned char **in, long len); \
+        int __cdecl i2d_##name(const type *a, unsigned char **out); \
         DECLARE_ASN1_ITEM(name)
 
 # define DECLARE_ASN1_NDEF_FUNCTION(name) \
-        int i2d_##name##_NDEF(name *a, unsigned char **out);
+        int __cdecl i2d_##name##_NDEF(name *a, unsigned char **out);
 
 # define DECLARE_ASN1_FUNCTIONS_const(name) \
         DECLARE_ASN1_ALLOC_FUNCTIONS(name) \
         DECLARE_ASN1_ENCODE_FUNCTIONS_const(name, name)
 
 # define DECLARE_ASN1_ALLOC_FUNCTIONS_name(type, name) \
-        type *name##_new(void); \
-        void name##_free(type *a);
+        type * __cdecl name##_new(void); \
+        void __cdecl name##_free(type *a);
 
 # define DECLARE_ASN1_PRINT_FUNCTION(stname) \
         DECLARE_ASN1_PRINT_FUNCTION_fname(stname, stname)
@@ -255,23 +255,23 @@ typedef struct ASN1_VALUE_st ASN1_VALUE;
         int fname##_print_ctx(BIO *out, stname *x, int indent, \
                                          const ASN1_PCTX *pctx);
 
-# define D2I_OF(type) type *(*)(type **,const unsigned char **,long)
-# define I2D_OF(type) int (*)(type *,unsigned char **)
-# define I2D_OF_const(type) int (*)(const type *,unsigned char **)
+# define D2I_OF(type) type *(__cdecl *)(type **,const unsigned char **,long)
+# define I2D_OF(type) int (__cdecl *)(type *,unsigned char **)
+# define I2D_OF_const(type) int (__cdecl *)(const type *,unsigned char **)
 
 # define CHECKED_D2I_OF(type, d2i) \
     ((d2i_of_void*) (1 ? d2i : ((D2I_OF(type))0)))
 # define CHECKED_I2D_OF(type, i2d) \
     ((i2d_of_void*) (1 ? i2d : ((I2D_OF(type))0)))
 # define CHECKED_NEW_OF(type, xnew) \
-    ((void *(*)(void)) (1 ? xnew : ((type *(*)(void))0)))
+    ((void *(__cdecl *)(void)) (1 ? xnew : ((type *(__cdecl *)(void))0)))
 # define CHECKED_PTR_OF(type, p) \
     ((void*) (1 ? p : (type*)0))
 # define CHECKED_PPTR_OF(type, p) \
     ((void**) (1 ? p : (type**)0))
 
-# define TYPEDEF_D2I_OF(type) typedef type *d2i_of_##type(type **,const unsigned char **,long)
-# define TYPEDEF_I2D_OF(type) typedef int i2d_of_##type(type *,unsigned char **)
+# define TYPEDEF_D2I_OF(type) typedef type * __cdecl d2i_of_##type(type **,const unsigned char **,long)
+# define TYPEDEF_I2D_OF(type) typedef int __cdecl i2d_of_##type(type *,unsigned char **)
 # define TYPEDEF_D2I2D_OF(type) TYPEDEF_D2I_OF(type); TYPEDEF_I2D_OF(type)
 
 TYPEDEF_D2I2D_OF(void);
@@ -517,87 +517,87 @@ typedef struct BIT_STRING_BITNAME_st {
 
 DECLARE_ASN1_FUNCTIONS_fname(ASN1_TYPE, ASN1_ANY, ASN1_TYPE)
 
-int ASN1_TYPE_get(const ASN1_TYPE *a);
-void ASN1_TYPE_set(ASN1_TYPE *a, int type, void *value);
-int ASN1_TYPE_set1(ASN1_TYPE *a, int type, const void *value);
-int ASN1_TYPE_cmp(const ASN1_TYPE *a, const ASN1_TYPE *b);
+int __cdecl ASN1_TYPE_get(const ASN1_TYPE *a);
+void __cdecl ASN1_TYPE_set(ASN1_TYPE *a, int type, void *value);
+int __cdecl ASN1_TYPE_set1(ASN1_TYPE *a, int type, const void *value);
+int __cdecl ASN1_TYPE_cmp(const ASN1_TYPE *a, const ASN1_TYPE *b);
 
-ASN1_TYPE *ASN1_TYPE_pack_sequence(const ASN1_ITEM *it, void *s, ASN1_TYPE **t);
-void *ASN1_TYPE_unpack_sequence(const ASN1_ITEM *it, const ASN1_TYPE *t);
+ASN1_TYPE * __cdecl ASN1_TYPE_pack_sequence(const ASN1_ITEM *it, void *s, ASN1_TYPE **t);
+void * __cdecl ASN1_TYPE_unpack_sequence(const ASN1_ITEM *it, const ASN1_TYPE *t);
 
-ASN1_OBJECT *ASN1_OBJECT_new(void);
-void ASN1_OBJECT_free(ASN1_OBJECT *a);
-int i2d_ASN1_OBJECT(const ASN1_OBJECT *a, unsigned char **pp);
-ASN1_OBJECT *d2i_ASN1_OBJECT(ASN1_OBJECT **a, const unsigned char **pp,
+ASN1_OBJECT * __cdecl ASN1_OBJECT_new(void);
+void __cdecl ASN1_OBJECT_free(ASN1_OBJECT *a);
+int __cdecl i2d_ASN1_OBJECT(const ASN1_OBJECT *a, unsigned char **pp);
+ASN1_OBJECT * __cdecl d2i_ASN1_OBJECT(ASN1_OBJECT **a, const unsigned char **pp,
                              long length);
 
 DECLARE_ASN1_ITEM(ASN1_OBJECT)
 
 DEFINE_STACK_OF(ASN1_OBJECT)
 
-ASN1_STRING *ASN1_STRING_new(void);
-void ASN1_STRING_free(ASN1_STRING *a);
-void ASN1_STRING_clear_free(ASN1_STRING *a);
-int ASN1_STRING_copy(ASN1_STRING *dst, const ASN1_STRING *str);
-ASN1_STRING *ASN1_STRING_dup(const ASN1_STRING *a);
-ASN1_STRING *ASN1_STRING_type_new(int type);
-int ASN1_STRING_cmp(const ASN1_STRING *a, const ASN1_STRING *b);
+ASN1_STRING * __cdecl ASN1_STRING_new(void);
+void __cdecl ASN1_STRING_free(ASN1_STRING *a);
+void __cdecl ASN1_STRING_clear_free(ASN1_STRING *a);
+int __cdecl ASN1_STRING_copy(ASN1_STRING *dst, const ASN1_STRING *str);
+ASN1_STRING * __cdecl ASN1_STRING_dup(const ASN1_STRING *a);
+ASN1_STRING * __cdecl ASN1_STRING_type_new(int type);
+int __cdecl ASN1_STRING_cmp(const ASN1_STRING *a, const ASN1_STRING *b);
   /*
    * Since this is used to store all sorts of things, via macros, for now,
    * make its data void *
    */
-int ASN1_STRING_set(ASN1_STRING *str, const void *data, int len);
-void ASN1_STRING_set0(ASN1_STRING *str, void *data, int len);
-int ASN1_STRING_length(const ASN1_STRING *x);
-void ASN1_STRING_length_set(ASN1_STRING *x, int n);
-int ASN1_STRING_type(const ASN1_STRING *x);
+int __cdecl ASN1_STRING_set(ASN1_STRING *str, const void *data, int len);
+void __cdecl ASN1_STRING_set0(ASN1_STRING *str, void *data, int len);
+int __cdecl ASN1_STRING_length(const ASN1_STRING *x);
+void __cdecl ASN1_STRING_length_set(ASN1_STRING *x, int n);
+int __cdecl ASN1_STRING_type(const ASN1_STRING *x);
 DEPRECATEDIN_1_1_0(unsigned char *ASN1_STRING_data(ASN1_STRING *x))
-const unsigned char *ASN1_STRING_get0_data(const ASN1_STRING *x);
+const unsigned char * __cdecl ASN1_STRING_get0_data(const ASN1_STRING *x);
 
 DECLARE_ASN1_FUNCTIONS(ASN1_BIT_STRING)
-int ASN1_BIT_STRING_set(ASN1_BIT_STRING *a, unsigned char *d, int length);
-int ASN1_BIT_STRING_set_bit(ASN1_BIT_STRING *a, int n, int value);
-int ASN1_BIT_STRING_get_bit(const ASN1_BIT_STRING *a, int n);
-int ASN1_BIT_STRING_check(const ASN1_BIT_STRING *a,
+int __cdecl ASN1_BIT_STRING_set(ASN1_BIT_STRING *a, unsigned char *d, int length);
+int __cdecl ASN1_BIT_STRING_set_bit(ASN1_BIT_STRING *a, int n, int value);
+int __cdecl ASN1_BIT_STRING_get_bit(const ASN1_BIT_STRING *a, int n);
+int __cdecl ASN1_BIT_STRING_check(const ASN1_BIT_STRING *a,
                           const unsigned char *flags, int flags_len);
 
-int ASN1_BIT_STRING_name_print(BIO *out, ASN1_BIT_STRING *bs,
+int __cdecl ASN1_BIT_STRING_name_print(BIO *out, ASN1_BIT_STRING *bs,
                                BIT_STRING_BITNAME *tbl, int indent);
-int ASN1_BIT_STRING_num_asc(const char *name, BIT_STRING_BITNAME *tbl);
-int ASN1_BIT_STRING_set_asc(ASN1_BIT_STRING *bs, const char *name, int value,
+int __cdecl ASN1_BIT_STRING_num_asc(const char *name, BIT_STRING_BITNAME *tbl);
+int __cdecl ASN1_BIT_STRING_set_asc(ASN1_BIT_STRING *bs, const char *name, int value,
                             BIT_STRING_BITNAME *tbl);
 
 DECLARE_ASN1_FUNCTIONS(ASN1_INTEGER)
-ASN1_INTEGER *d2i_ASN1_UINTEGER(ASN1_INTEGER **a, const unsigned char **pp,
+ASN1_INTEGER * __cdecl d2i_ASN1_UINTEGER(ASN1_INTEGER **a, const unsigned char **pp,
                                 long length);
-ASN1_INTEGER *ASN1_INTEGER_dup(const ASN1_INTEGER *x);
-int ASN1_INTEGER_cmp(const ASN1_INTEGER *x, const ASN1_INTEGER *y);
+ASN1_INTEGER * __cdecl ASN1_INTEGER_dup(const ASN1_INTEGER *x);
+int __cdecl ASN1_INTEGER_cmp(const ASN1_INTEGER *x, const ASN1_INTEGER *y);
 
 DECLARE_ASN1_FUNCTIONS(ASN1_ENUMERATED)
 
-int ASN1_UTCTIME_check(const ASN1_UTCTIME *a);
-ASN1_UTCTIME *ASN1_UTCTIME_set(ASN1_UTCTIME *s, time_t t);
-ASN1_UTCTIME *ASN1_UTCTIME_adj(ASN1_UTCTIME *s, time_t t,
+int __cdecl ASN1_UTCTIME_check(const ASN1_UTCTIME *a);
+ASN1_UTCTIME * __cdecl ASN1_UTCTIME_set(ASN1_UTCTIME *s, time_t t);
+ASN1_UTCTIME * __cdecl ASN1_UTCTIME_adj(ASN1_UTCTIME *s, time_t t,
                                int offset_day, long offset_sec);
-int ASN1_UTCTIME_set_string(ASN1_UTCTIME *s, const char *str);
-int ASN1_UTCTIME_cmp_time_t(const ASN1_UTCTIME *s, time_t t);
+int __cdecl ASN1_UTCTIME_set_string(ASN1_UTCTIME *s, const char *str);
+int __cdecl ASN1_UTCTIME_cmp_time_t(const ASN1_UTCTIME *s, time_t t);
 
-int ASN1_GENERALIZEDTIME_check(const ASN1_GENERALIZEDTIME *a);
-ASN1_GENERALIZEDTIME *ASN1_GENERALIZEDTIME_set(ASN1_GENERALIZEDTIME *s,
+int __cdecl ASN1_GENERALIZEDTIME_check(const ASN1_GENERALIZEDTIME *a);
+ASN1_GENERALIZEDTIME * __cdecl ASN1_GENERALIZEDTIME_set(ASN1_GENERALIZEDTIME *s,
                                                time_t t);
-ASN1_GENERALIZEDTIME *ASN1_GENERALIZEDTIME_adj(ASN1_GENERALIZEDTIME *s,
+ASN1_GENERALIZEDTIME * __cdecl ASN1_GENERALIZEDTIME_adj(ASN1_GENERALIZEDTIME *s,
                                                time_t t, int offset_day,
                                                long offset_sec);
-int ASN1_GENERALIZEDTIME_set_string(ASN1_GENERALIZEDTIME *s, const char *str);
+int __cdecl ASN1_GENERALIZEDTIME_set_string(ASN1_GENERALIZEDTIME *s, const char *str);
 
-int ASN1_TIME_diff(int *pday, int *psec,
+int __cdecl ASN1_TIME_diff(int *pday, int *psec,
                    const ASN1_TIME *from, const ASN1_TIME *to);
 
 DECLARE_ASN1_FUNCTIONS(ASN1_OCTET_STRING)
-ASN1_OCTET_STRING *ASN1_OCTET_STRING_dup(const ASN1_OCTET_STRING *a);
-int ASN1_OCTET_STRING_cmp(const ASN1_OCTET_STRING *a,
+ASN1_OCTET_STRING * __cdecl ASN1_OCTET_STRING_dup(const ASN1_OCTET_STRING *a);
+int __cdecl ASN1_OCTET_STRING_cmp(const ASN1_OCTET_STRING *a,
                           const ASN1_OCTET_STRING *b);
-int ASN1_OCTET_STRING_set(ASN1_OCTET_STRING *str, const unsigned char *data,
+int __cdecl ASN1_OCTET_STRING_set(ASN1_OCTET_STRING *str, const unsigned char *data,
                           int len);
 
 DECLARE_ASN1_FUNCTIONS(ASN1_VISIBLESTRING)
@@ -606,8 +606,8 @@ DECLARE_ASN1_FUNCTIONS(ASN1_UTF8STRING)
 DECLARE_ASN1_FUNCTIONS(ASN1_NULL)
 DECLARE_ASN1_FUNCTIONS(ASN1_BMPSTRING)
 
-int UTF8_getc(const unsigned char *str, int len, unsigned long *val);
-int UTF8_putc(unsigned char *str, int len, unsigned long value);
+int __cdecl UTF8_getc(const unsigned char *str, int len, unsigned long *val);
+int __cdecl UTF8_putc(unsigned char *str, int len, unsigned long value);
 
 DECLARE_ASN1_FUNCTIONS_name(ASN1_STRING, ASN1_PRINTABLE)
 
@@ -623,69 +623,69 @@ DECLARE_ASN1_FUNCTIONS(ASN1_TIME)
 
 DECLARE_ASN1_ITEM(ASN1_OCTET_STRING_NDEF)
 
-ASN1_TIME *ASN1_TIME_set(ASN1_TIME *s, time_t t);
-ASN1_TIME *ASN1_TIME_adj(ASN1_TIME *s, time_t t,
+ASN1_TIME * __cdecl ASN1_TIME_set(ASN1_TIME *s, time_t t);
+ASN1_TIME * __cdecl ASN1_TIME_adj(ASN1_TIME *s, time_t t,
                          int offset_day, long offset_sec);
-int ASN1_TIME_check(const ASN1_TIME *t);
-ASN1_GENERALIZEDTIME *ASN1_TIME_to_generalizedtime(const ASN1_TIME *t,
+int __cdecl ASN1_TIME_check(const ASN1_TIME *t);
+ASN1_GENERALIZEDTIME * __cdecl ASN1_TIME_to_generalizedtime(const ASN1_TIME *t,
                                                    ASN1_GENERALIZEDTIME **out);
-int ASN1_TIME_set_string(ASN1_TIME *s, const char *str);
-int ASN1_TIME_set_string_X509(ASN1_TIME *s, const char *str);
-int ASN1_TIME_to_tm(const ASN1_TIME *s, struct tm *tm);
-int ASN1_TIME_normalize(ASN1_TIME *s);
-int ASN1_TIME_cmp_time_t(const ASN1_TIME *s, time_t t);
-int ASN1_TIME_compare(const ASN1_TIME *a, const ASN1_TIME *b);
-
-int i2a_ASN1_INTEGER(BIO *bp, const ASN1_INTEGER *a);
-int a2i_ASN1_INTEGER(BIO *bp, ASN1_INTEGER *bs, char *buf, int size);
-int i2a_ASN1_ENUMERATED(BIO *bp, const ASN1_ENUMERATED *a);
-int a2i_ASN1_ENUMERATED(BIO *bp, ASN1_ENUMERATED *bs, char *buf, int size);
-int i2a_ASN1_OBJECT(BIO *bp, const ASN1_OBJECT *a);
-int a2i_ASN1_STRING(BIO *bp, ASN1_STRING *bs, char *buf, int size);
-int i2a_ASN1_STRING(BIO *bp, const ASN1_STRING *a, int type);
-int i2t_ASN1_OBJECT(char *buf, int buf_len, const ASN1_OBJECT *a);
-
-int a2d_ASN1_OBJECT(unsigned char *out, int olen, const char *buf, int num);
-ASN1_OBJECT *ASN1_OBJECT_create(int nid, unsigned char *data, int len,
+int __cdecl ASN1_TIME_set_string(ASN1_TIME *s, const char *str);
+int __cdecl ASN1_TIME_set_string_X509(ASN1_TIME *s, const char *str);
+int __cdecl ASN1_TIME_to_tm(const ASN1_TIME *s, struct tm *tm);
+int __cdecl ASN1_TIME_normalize(ASN1_TIME *s);
+int __cdecl ASN1_TIME_cmp_time_t(const ASN1_TIME *s, time_t t);
+int __cdecl ASN1_TIME_compare(const ASN1_TIME *a, const ASN1_TIME *b);
+
+int __cdecl i2a_ASN1_INTEGER(BIO *bp, const ASN1_INTEGER *a);
+int __cdecl a2i_ASN1_INTEGER(BIO *bp, ASN1_INTEGER *bs, char *buf, int size);
+int __cdecl i2a_ASN1_ENUMERATED(BIO *bp, const ASN1_ENUMERATED *a);
+int __cdecl a2i_ASN1_ENUMERATED(BIO *bp, ASN1_ENUMERATED *bs, char *buf, int size);
+int __cdecl i2a_ASN1_OBJECT(BIO *bp, const ASN1_OBJECT *a);
+int __cdecl a2i_ASN1_STRING(BIO *bp, ASN1_STRING *bs, char *buf, int size);
+int __cdecl i2a_ASN1_STRING(BIO *bp, const ASN1_STRING *a, int type);
+int __cdecl i2t_ASN1_OBJECT(char *buf, int buf_len, const ASN1_OBJECT *a);
+
+int __cdecl a2d_ASN1_OBJECT(unsigned char *out, int olen, const char *buf, int num);
+ASN1_OBJECT * __cdecl ASN1_OBJECT_create(int nid, unsigned char *data, int len,
                                 const char *sn, const char *ln);
 
-int ASN1_INTEGER_get_int64(int64_t *pr, const ASN1_INTEGER *a);
-int ASN1_INTEGER_set_int64(ASN1_INTEGER *a, int64_t r);
-int ASN1_INTEGER_get_uint64(uint64_t *pr, const ASN1_INTEGER *a);
-int ASN1_INTEGER_set_uint64(ASN1_INTEGER *a, uint64_t r);
+int __cdecl ASN1_INTEGER_get_int64(int64_t *pr, const ASN1_INTEGER *a);
+int __cdecl ASN1_INTEGER_set_int64(ASN1_INTEGER *a, int64_t r);
+int __cdecl ASN1_INTEGER_get_uint64(uint64_t *pr, const ASN1_INTEGER *a);
+int __cdecl ASN1_INTEGER_set_uint64(ASN1_INTEGER *a, uint64_t r);
 
-int ASN1_INTEGER_set(ASN1_INTEGER *a, long v);
-long ASN1_INTEGER_get(const ASN1_INTEGER *a);
-ASN1_INTEGER *BN_to_ASN1_INTEGER(const BIGNUM *bn, ASN1_INTEGER *ai);
-BIGNUM *ASN1_INTEGER_to_BN(const ASN1_INTEGER *ai, BIGNUM *bn);
+int __cdecl ASN1_INTEGER_set(ASN1_INTEGER *a, long v);
+long __cdecl ASN1_INTEGER_get(const ASN1_INTEGER *a);
+ASN1_INTEGER * __cdecl BN_to_ASN1_INTEGER(const BIGNUM *bn, ASN1_INTEGER *ai);
+BIGNUM * __cdecl ASN1_INTEGER_to_BN(const ASN1_INTEGER *ai, BIGNUM *bn);
 
-int ASN1_ENUMERATED_get_int64(int64_t *pr, const ASN1_ENUMERATED *a);
-int ASN1_ENUMERATED_set_int64(ASN1_ENUMERATED *a, int64_t r);
+int __cdecl ASN1_ENUMERATED_get_int64(int64_t *pr, const ASN1_ENUMERATED *a);
+int __cdecl ASN1_ENUMERATED_set_int64(ASN1_ENUMERATED *a, int64_t r);
 
 
-int ASN1_ENUMERATED_set(ASN1_ENUMERATED *a, long v);
-long ASN1_ENUMERATED_get(const ASN1_ENUMERATED *a);
-ASN1_ENUMERATED *BN_to_ASN1_ENUMERATED(const BIGNUM *bn, ASN1_ENUMERATED *ai);
-BIGNUM *ASN1_ENUMERATED_to_BN(const ASN1_ENUMERATED *ai, BIGNUM *bn);
+int __cdecl ASN1_ENUMERATED_set(ASN1_ENUMERATED *a, long v);
+long __cdecl ASN1_ENUMERATED_get(const ASN1_ENUMERATED *a);
+ASN1_ENUMERATED * __cdecl BN_to_ASN1_ENUMERATED(const BIGNUM *bn, ASN1_ENUMERATED *ai);
+BIGNUM * __cdecl ASN1_ENUMERATED_to_BN(const ASN1_ENUMERATED *ai, BIGNUM *bn);
 
 /* General */
 /* given a string, return the correct type, max is the maximum length */
-int ASN1_PRINTABLE_type(const unsigned char *s, int max);
+int __cdecl ASN1_PRINTABLE_type(const unsigned char *s, int max);
 
-unsigned long ASN1_tag2bit(int tag);
+unsigned long __cdecl ASN1_tag2bit(int tag);
 
 /* SPECIALS */
-int ASN1_get_object(const unsigned char **pp, long *plength, int *ptag,
+int __cdecl ASN1_get_object(const unsigned char **pp, long *plength, int *ptag,
                     int *pclass, long omax);
-int ASN1_check_infinite_end(unsigned char **p, long len);
-int ASN1_const_check_infinite_end(const unsigned char **p, long len);
-void ASN1_put_object(unsigned char **pp, int constructed, int length,
+int __cdecl ASN1_check_infinite_end(unsigned char **p, long len);
+int __cdecl ASN1_const_check_infinite_end(const unsigned char **p, long len);
+void __cdecl ASN1_put_object(unsigned char **pp, int constructed, int length,
                      int tag, int xclass);
-int ASN1_put_eoc(unsigned char **pp);
-int ASN1_object_size(int constructed, int length, int tag);
+int __cdecl ASN1_put_eoc(unsigned char **pp);
+int __cdecl ASN1_object_size(int constructed, int length, int tag);
 
 /* Used to implement other functions */
-void *ASN1_dup(i2d_of_void *i2d, d2i_of_void *d2i, void *x);
+void * __cdecl ASN1_dup(i2d_of_void *i2d, d2i_of_void *d2i, void *x);
 
 # define ASN1_dup_of(type,i2d,d2i,x) \
     ((type*)ASN1_dup(CHECKED_I2D_OF(type, i2d), \
@@ -697,7 +697,7 @@ void *ASN1_dup(i2d_of_void *i2d, d2i_of_void *d2i, void *x);
                      CHECKED_D2I_OF(type, d2i), \
                      CHECKED_PTR_OF(const type, x)))
 
-void *ASN1_item_dup(const ASN1_ITEM *it, void *x);
+void * __cdecl ASN1_item_dup(const ASN1_ITEM *it, void *x);
 
 /* ASN1 alloc/free macros for when a type is only used internally */
 
@@ -706,16 +706,16 @@ void *ASN1_item_dup(const ASN1_ITEM *it, void *x);
                 ASN1_item_free(CHECKED_PTR_OF(type, x), ASN1_ITEM_rptr(type))
 
 # ifndef OPENSSL_NO_STDIO
-void *ASN1_d2i_fp(void *(*xnew) (void), d2i_of_void *d2i, FILE *in, void **x);
+void * __cdecl ASN1_d2i_fp(void *(__cdecl *xnew) (void), d2i_of_void *d2i, FILE *in, void **x);
 
 #  define ASN1_d2i_fp_of(type,xnew,d2i,in,x) \
-    ((type*)ASN1_d2i_fp(CHECKED_NEW_OF(type, xnew), \
+    ((type *)ASN1_d2i_fp(CHECKED_NEW_OF(type, xnew), \
                         CHECKED_D2I_OF(type, d2i), \
                         in, \
                         CHECKED_PPTR_OF(type, x)))
 
-void *ASN1_item_d2i_fp(const ASN1_ITEM *it, FILE *in, void *x);
-int ASN1_i2d_fp(i2d_of_void *i2d, FILE *out, void *x);
+void * __cdecl ASN1_item_d2i_fp(const ASN1_ITEM *it, FILE *in, void *x);
+int __cdecl ASN1_i2d_fp(i2d_of_void *i2d, FILE *out, void *x);
 
 #  define ASN1_i2d_fp_of(type,i2d,out,x) \
     (ASN1_i2d_fp(CHECKED_I2D_OF(type, i2d), \
@@ -727,22 +727,22 @@ int ASN1_i2d_fp(i2d_of_void *i2d, FILE *out, void *x);
                  out, \
                  CHECKED_PTR_OF(const type, x)))
 
-int ASN1_item_i2d_fp(const ASN1_ITEM *it, FILE *out, void *x);
-int ASN1_STRING_print_ex_fp(FILE *fp, const ASN1_STRING *str, unsigned long flags);
+int __cdecl ASN1_item_i2d_fp(const ASN1_ITEM *it, FILE *out, void *x);
+int __cdecl ASN1_STRING_print_ex_fp(FILE *fp, const ASN1_STRING *str, unsigned long flags);
 # endif
 
-int ASN1_STRING_to_UTF8(unsigned char **out, const ASN1_STRING *in);
+int __cdecl ASN1_STRING_to_UTF8(unsigned char **out, const ASN1_STRING *in);
 
-void *ASN1_d2i_bio(void *(*xnew) (void), d2i_of_void *d2i, BIO *in, void **x);
+void * __cdecl ASN1_d2i_bio(void * (__cdecl *xnew) (void), d2i_of_void *d2i, BIO *in, void **x);
 
 #  define ASN1_d2i_bio_of(type,xnew,d2i,in,x) \
-    ((type*)ASN1_d2i_bio( CHECKED_NEW_OF(type, xnew), \
+    ((type*) ASN1_d2i_bio( CHECKED_NEW_OF(type, xnew), \
                           CHECKED_D2I_OF(type, d2i), \
                           in, \
                           CHECKED_PPTR_OF(type, x)))
 
-void *ASN1_item_d2i_bio(const ASN1_ITEM *it, BIO *in, void *x);
-int ASN1_i2d_bio(i2d_of_void *i2d, BIO *out, unsigned char *x);
+void * __cdecl ASN1_item_d2i_bio(const ASN1_ITEM *it, BIO *in, void *x);
+int __cdecl ASN1_i2d_bio(i2d_of_void *i2d, BIO *out, unsigned char *x);
 
 #  define ASN1_i2d_bio_of(type,i2d,out,x) \
     (ASN1_i2d_bio(CHECKED_I2D_OF(type, i2d), \
@@ -754,69 +754,69 @@ int ASN1_i2d_bio(i2d_of_void *i2d, BIO *out, unsigned char *x);
                   out, \
                   CHECKED_PTR_OF(const type, x)))
 
-int ASN1_item_i2d_bio(const ASN1_ITEM *it, BIO *out, void *x);
-int ASN1_UTCTIME_print(BIO *fp, const ASN1_UTCTIME *a);
-int ASN1_GENERALIZEDTIME_print(BIO *fp, const ASN1_GENERALIZEDTIME *a);
-int ASN1_TIME_print(BIO *fp, const ASN1_TIME *a);
-int ASN1_STRING_print(BIO *bp, const ASN1_STRING *v);
-int ASN1_STRING_print_ex(BIO *out, const ASN1_STRING *str, unsigned long flags);
-int ASN1_buf_print(BIO *bp, const unsigned char *buf, size_t buflen, int off);
-int ASN1_bn_print(BIO *bp, const char *number, const BIGNUM *num,
+int __cdecl ASN1_item_i2d_bio(const ASN1_ITEM *it, BIO *out, void *x);
+int __cdecl ASN1_UTCTIME_print(BIO *fp, const ASN1_UTCTIME *a);
+int __cdecl ASN1_GENERALIZEDTIME_print(BIO *fp, const ASN1_GENERALIZEDTIME *a);
+int __cdecl ASN1_TIME_print(BIO *fp, const ASN1_TIME *a);
+int __cdecl ASN1_STRING_print(BIO *bp, const ASN1_STRING *v);
+int __cdecl ASN1_STRING_print_ex(BIO *out, const ASN1_STRING *str, unsigned long flags);
+int __cdecl ASN1_buf_print(BIO *bp, const unsigned char *buf, size_t buflen, int off);
+int __cdecl ASN1_bn_print(BIO *bp, const char *number, const BIGNUM *num,
                   unsigned char *buf, int off);
-int ASN1_parse(BIO *bp, const unsigned char *pp, long len, int indent);
-int ASN1_parse_dump(BIO *bp, const unsigned char *pp, long len, int indent,
+int __cdecl ASN1_parse(BIO *bp, const unsigned char *pp, long len, int indent);
+int __cdecl ASN1_parse_dump(BIO *bp, const unsigned char *pp, long len, int indent,
                     int dump);
-const char *ASN1_tag2str(int tag);
+const char * __cdecl ASN1_tag2str(int tag);
 
 /* Used to load and write Netscape format cert */
 
-int ASN1_UNIVERSALSTRING_to_string(ASN1_UNIVERSALSTRING *s);
+int __cdecl ASN1_UNIVERSALSTRING_to_string(ASN1_UNIVERSALSTRING *s);
 
-int ASN1_TYPE_set_octetstring(ASN1_TYPE *a, unsigned char *data, int len);
-int ASN1_TYPE_get_octetstring(const ASN1_TYPE *a, unsigned char *data, int max_len);
-int ASN1_TYPE_set_int_octetstring(ASN1_TYPE *a, long num,
+int __cdecl ASN1_TYPE_set_octetstring(ASN1_TYPE *a, unsigned char *data, int len);
+int __cdecl ASN1_TYPE_get_octetstring(const ASN1_TYPE *a, unsigned char *data, int max_len);
+int __cdecl ASN1_TYPE_set_int_octetstring(ASN1_TYPE *a, long num,
                                   unsigned char *data, int len);
-int ASN1_TYPE_get_int_octetstring(const ASN1_TYPE *a, long *num,
+int __cdecl ASN1_TYPE_get_int_octetstring(const ASN1_TYPE *a, long *num,
                                   unsigned char *data, int max_len);
 
-void *ASN1_item_unpack(const ASN1_STRING *oct, const ASN1_ITEM *it);
+void * __cdecl ASN1_item_unpack(const ASN1_STRING *oct, const ASN1_ITEM *it);
 
-ASN1_STRING *ASN1_item_pack(void *obj, const ASN1_ITEM *it,
+ASN1_STRING * __cdecl ASN1_item_pack(void *obj, const ASN1_ITEM *it,
                             ASN1_OCTET_STRING **oct);
 
-void ASN1_STRING_set_default_mask(unsigned long mask);
-int ASN1_STRING_set_default_mask_asc(const char *p);
-unsigned long ASN1_STRING_get_default_mask(void);
-int ASN1_mbstring_copy(ASN1_STRING **out, const unsigned char *in, int len,
+void __cdecl ASN1_STRING_set_default_mask(unsigned long mask);
+int __cdecl ASN1_STRING_set_default_mask_asc(const char *p);
+unsigned long __cdecl ASN1_STRING_get_default_mask(void);
+int __cdecl ASN1_mbstring_copy(ASN1_STRING **out, const unsigned char *in, int len,
                        int inform, unsigned long mask);
-int ASN1_mbstring_ncopy(ASN1_STRING **out, const unsigned char *in, int len,
+int __cdecl ASN1_mbstring_ncopy(ASN1_STRING **out, const unsigned char *in, int len,
                         int inform, unsigned long mask,
                         long minsize, long maxsize);
 
-ASN1_STRING *ASN1_STRING_set_by_NID(ASN1_STRING **out,
+ASN1_STRING * __cdecl ASN1_STRING_set_by_NID(ASN1_STRING **out,
                                     const unsigned char *in, int inlen,
                                     int inform, int nid);
-ASN1_STRING_TABLE *ASN1_STRING_TABLE_get(int nid);
-int ASN1_STRING_TABLE_add(int, long, long, unsigned long, unsigned long);
-void ASN1_STRING_TABLE_cleanup(void);
+ASN1_STRING_TABLE * __cdecl ASN1_STRING_TABLE_get(int nid);
+int __cdecl ASN1_STRING_TABLE_add(int, long, long, unsigned long, unsigned long);
+void __cdecl ASN1_STRING_TABLE_cleanup(void);
 
 /* ASN1 template functions */
 
 /* Old API compatible functions */
-ASN1_VALUE *ASN1_item_new(const ASN1_ITEM *it);
-void ASN1_item_free(ASN1_VALUE *val, const ASN1_ITEM *it);
-ASN1_VALUE *ASN1_item_d2i(ASN1_VALUE **val, const unsigned char **in,
+ASN1_VALUE * __cdecl ASN1_item_new(const ASN1_ITEM *it);
+void __cdecl ASN1_item_free(ASN1_VALUE *val, const ASN1_ITEM *it);
+ASN1_VALUE * __cdecl ASN1_item_d2i(ASN1_VALUE **val, const unsigned char **in,
                           long len, const ASN1_ITEM *it);
-int ASN1_item_i2d(ASN1_VALUE *val, unsigned char **out, const ASN1_ITEM *it);
-int ASN1_item_ndef_i2d(ASN1_VALUE *val, unsigned char **out,
+int __cdecl ASN1_item_i2d(ASN1_VALUE *val, unsigned char **out, const ASN1_ITEM *it);
+int __cdecl ASN1_item_ndef_i2d(ASN1_VALUE *val, unsigned char **out,
                        const ASN1_ITEM *it);
 
-void ASN1_add_oid_module(void);
-void ASN1_add_stable_module(void);
+void __cdecl ASN1_add_oid_module(void);
+void __cdecl ASN1_add_stable_module(void);
 
-ASN1_TYPE *ASN1_generate_nconf(const char *str, CONF *nconf);
-ASN1_TYPE *ASN1_generate_v3(const char *str, X509V3_CTX *cnf);
-int ASN1_str2mask(const char *str, unsigned long *pmask);
+ASN1_TYPE * __cdecl ASN1_generate_nconf(const char *str, CONF *nconf);
+ASN1_TYPE * __cdecl ASN1_generate_v3(const char *str, X509V3_CTX *cnf);
+int __cdecl ASN1_str2mask(const char *str, unsigned long *pmask);
 
 /* ASN1 Print flags */
 
@@ -839,46 +839,46 @@ int ASN1_str2mask(const char *str, unsigned long *pmask);
 /* Don't show structure name even at top level */
 # define ASN1_PCTX_FLAGS_NO_STRUCT_NAME          0x100
 
-int ASN1_item_print(BIO *out, ASN1_VALUE *ifld, int indent,
+int __cdecl ASN1_item_print(BIO *out, ASN1_VALUE *ifld, int indent,
                     const ASN1_ITEM *it, const ASN1_PCTX *pctx);
-ASN1_PCTX *ASN1_PCTX_new(void);
-void ASN1_PCTX_free(ASN1_PCTX *p);
-unsigned long ASN1_PCTX_get_flags(const ASN1_PCTX *p);
-void ASN1_PCTX_set_flags(ASN1_PCTX *p, unsigned long flags);
-unsigned long ASN1_PCTX_get_nm_flags(const ASN1_PCTX *p);
-void ASN1_PCTX_set_nm_flags(ASN1_PCTX *p, unsigned long flags);
-unsigned long ASN1_PCTX_get_cert_flags(const ASN1_PCTX *p);
-void ASN1_PCTX_set_cert_flags(ASN1_PCTX *p, unsigned long flags);
-unsigned long ASN1_PCTX_get_oid_flags(const ASN1_PCTX *p);
-void ASN1_PCTX_set_oid_flags(ASN1_PCTX *p, unsigned long flags);
-unsigned long ASN1_PCTX_get_str_flags(const ASN1_PCTX *p);
-void ASN1_PCTX_set_str_flags(ASN1_PCTX *p, unsigned long flags);
-
-ASN1_SCTX *ASN1_SCTX_new(int (*scan_cb) (ASN1_SCTX *ctx));
-void ASN1_SCTX_free(ASN1_SCTX *p);
-const ASN1_ITEM *ASN1_SCTX_get_item(ASN1_SCTX *p);
-const ASN1_TEMPLATE *ASN1_SCTX_get_template(ASN1_SCTX *p);
-unsigned long ASN1_SCTX_get_flags(ASN1_SCTX *p);
-void ASN1_SCTX_set_app_data(ASN1_SCTX *p, void *data);
-void *ASN1_SCTX_get_app_data(ASN1_SCTX *p);
-
-const BIO_METHOD *BIO_f_asn1(void);
-
-BIO *BIO_new_NDEF(BIO *out, ASN1_VALUE *val, const ASN1_ITEM *it);
-
-int i2d_ASN1_bio_stream(BIO *out, ASN1_VALUE *val, BIO *in, int flags,
+ASN1_PCTX * __cdecl ASN1_PCTX_new(void);
+void __cdecl ASN1_PCTX_free(ASN1_PCTX *p);
+unsigned long __cdecl ASN1_PCTX_get_flags(const ASN1_PCTX *p);
+void __cdecl ASN1_PCTX_set_flags(ASN1_PCTX *p, unsigned long flags);
+unsigned long __cdecl ASN1_PCTX_get_nm_flags(const ASN1_PCTX *p);
+void __cdecl ASN1_PCTX_set_nm_flags(ASN1_PCTX *p, unsigned long flags);
+unsigned long __cdecl ASN1_PCTX_get_cert_flags(const ASN1_PCTX *p);
+void __cdecl ASN1_PCTX_set_cert_flags(ASN1_PCTX *p, unsigned long flags);
+unsigned long __cdecl ASN1_PCTX_get_oid_flags(const ASN1_PCTX *p);
+void __cdecl ASN1_PCTX_set_oid_flags(ASN1_PCTX *p, unsigned long flags);
+unsigned long __cdecl ASN1_PCTX_get_str_flags(const ASN1_PCTX *p);
+void __cdecl ASN1_PCTX_set_str_flags(ASN1_PCTX *p, unsigned long flags);
+
+ASN1_SCTX * __cdecl ASN1_SCTX_new(int (*scan_cb) (ASN1_SCTX *ctx));
+void __cdecl ASN1_SCTX_free(ASN1_SCTX *p);
+const ASN1_ITEM * __cdecl ASN1_SCTX_get_item(ASN1_SCTX *p);
+const ASN1_TEMPLATE * __cdecl ASN1_SCTX_get_template(ASN1_SCTX *p);
+unsigned long __cdecl ASN1_SCTX_get_flags(ASN1_SCTX *p);
+void __cdecl ASN1_SCTX_set_app_data(ASN1_SCTX *p, void *data);
+void * __cdecl ASN1_SCTX_get_app_data(ASN1_SCTX *p);
+
+const BIO_METHOD * __cdecl BIO_f_asn1(void);
+
+BIO * __cdecl BIO_new_NDEF(BIO *out, ASN1_VALUE *val, const ASN1_ITEM *it);
+
+int __cdecl i2d_ASN1_bio_stream(BIO *out, ASN1_VALUE *val, BIO *in, int flags,
                         const ASN1_ITEM *it);
-int PEM_write_bio_ASN1_stream(BIO *out, ASN1_VALUE *val, BIO *in, int flags,
+int __cdecl PEM_write_bio_ASN1_stream(BIO *out, ASN1_VALUE *val, BIO *in, int flags,
                               const char *hdr, const ASN1_ITEM *it);
-int SMIME_write_ASN1(BIO *bio, ASN1_VALUE *val, BIO *data, int flags,
+int __cdecl SMIME_write_ASN1(BIO *bio, ASN1_VALUE *val, BIO *data, int flags,
                      int ctype_nid, int econt_nid,
                      STACK_OF(X509_ALGOR) *mdalgs, const ASN1_ITEM *it);
-ASN1_VALUE *SMIME_read_ASN1(BIO *bio, BIO **bcont, const ASN1_ITEM *it);
-int SMIME_crlf_copy(BIO *in, BIO *out, int flags);
-int SMIME_text(BIO *in, BIO *out);
+ASN1_VALUE * __cdecl SMIME_read_ASN1(BIO *bio, BIO **bcont, const ASN1_ITEM *it);
+int __cdecl SMIME_crlf_copy(BIO *in, BIO *out, int flags);
+int __cdecl SMIME_text(BIO *in, BIO *out);
 
-const ASN1_ITEM *ASN1_ITEM_lookup(const char *name);
-const ASN1_ITEM *ASN1_ITEM_get(size_t i);
+const ASN1_ITEM * __cdecl ASN1_ITEM_lookup(const char *name);
+const ASN1_ITEM * __cdecl ASN1_ITEM_get(size_t i);
 
 # ifdef  __cplusplus
 }
diff --git a/include/openssl/asn1err.h b/include/openssl/asn1err.h
index faed5a5518..10d838047e 100644
--- a/include/openssl/asn1err.h
+++ b/include/openssl/asn1err.h
@@ -18,7 +18,7 @@
 # ifdef  __cplusplus
 extern "C"
 # endif
-int ERR_load_ASN1_strings(void);
+int __cdecl ERR_load_ASN1_strings(void);
 
 /*
  * ASN1 function codes.
diff --git a/include/openssl/asn1t.h b/include/openssl/asn1t.h
index a450ba0d9d..4c086992ef 100644
--- a/include/openssl/asn1t.h
+++ b/include/openssl/asn1t.h
@@ -818,11 +818,11 @@ typedef struct ASN1_STREAM_ARG_st {
         }
 
 # define IMPLEMENT_ASN1_ALLOC_FUNCTIONS_fname(stname, itname, fname) \
-        stname *fname##_new(void) \
+        stname * __cdecl fname##_new(void) \
         { \
                 return (stname *)ASN1_item_new(ASN1_ITEM_rptr(itname)); \
         } \
-        void fname##_free(stname *a) \
+        void __cdecl fname##_free(stname *a) \
         { \
                 ASN1_item_free((ASN1_VALUE *)a, ASN1_ITEM_rptr(itname)); \
         }
@@ -832,17 +832,17 @@ typedef struct ASN1_STREAM_ARG_st {
         IMPLEMENT_ASN1_ALLOC_FUNCTIONS_fname(stname, itname, fname)
 
 # define IMPLEMENT_ASN1_ENCODE_FUNCTIONS_fname(stname, itname, fname) \
-        stname *d2i_##fname(stname **a, const unsigned char **in, long len) \
+        stname * __cdecl d2i_##fname(stname **a, const unsigned char **in, long len) \
         { \
                 return (stname *)ASN1_item_d2i((ASN1_VALUE **)a, in, len, ASN1_ITEM_rptr(itname));\
         } \
-        int i2d_##fname(stname *a, unsigned char **out) \
+        int __cdecl i2d_##fname(stname *a, unsigned char **out) \
         { \
                 return ASN1_item_i2d((ASN1_VALUE *)a, out, ASN1_ITEM_rptr(itname));\
         }
 
 # define IMPLEMENT_ASN1_NDEF_FUNCTION(stname) \
-        int i2d_##stname##_NDEF(stname *a, unsigned char **out) \
+        int __cdecl i2d_##stname##_NDEF(stname *a, unsigned char **out) \
         { \
                 return ASN1_item_ndef_i2d((ASN1_VALUE *)a, out, ASN1_ITEM_rptr(stname));\
         }
@@ -865,17 +865,17 @@ typedef struct ASN1_STREAM_ARG_st {
  * constification is done.
  */
 # define IMPLEMENT_ASN1_ENCODE_FUNCTIONS_const_fname(stname, itname, fname) \
-        stname *d2i_##fname(stname **a, const unsigned char **in, long len) \
+        stname * __cdecl d2i_##fname(stname **a, const unsigned char **in, long len) \
         { \
                 return (stname *)ASN1_item_d2i((ASN1_VALUE **)a, in, len, ASN1_ITEM_rptr(itname));\
         } \
-        int i2d_##fname(const stname *a, unsigned char **out) \
+        int __cdecl i2d_##fname(const stname *a, unsigned char **out) \
         { \
                 return ASN1_item_i2d((ASN1_VALUE *)a, out, ASN1_ITEM_rptr(itname));\
         }
 
 # define IMPLEMENT_ASN1_DUP_FUNCTION(stname) \
-        stname * stname##_dup(stname *x) \
+        stname * __cdecl stname##_dup(stname *x) \
         { \
         return ASN1_item_dup(ASN1_ITEM_rptr(stname), x); \
         }
@@ -929,14 +929,14 @@ DEFINE_STACK_OF(ASN1_VALUE)
 
 /* Functions used internally by the ASN1 code */
 
-int ASN1_item_ex_new(ASN1_VALUE **pval, const ASN1_ITEM *it);
-void ASN1_item_ex_free(ASN1_VALUE **pval, const ASN1_ITEM *it);
+int __cdecl ASN1_item_ex_new(ASN1_VALUE **pval, const ASN1_ITEM *it);
+void __cdecl ASN1_item_ex_free(ASN1_VALUE **pval, const ASN1_ITEM *it);
 
-int ASN1_item_ex_d2i(ASN1_VALUE **pval, const unsigned char **in, long len,
+int __cdecl ASN1_item_ex_d2i(ASN1_VALUE **pval, const unsigned char **in, long len,
                      const ASN1_ITEM *it, int tag, int aclass, char opt,
                      ASN1_TLC *ctx);
 
-int ASN1_item_ex_i2d(ASN1_VALUE **pval, unsigned char **out,
+int __cdecl ASN1_item_ex_i2d(ASN1_VALUE **pval, unsigned char **out,
                      const ASN1_ITEM *it, int tag, int aclass);
 
 #ifdef  __cplusplus
diff --git a/include/openssl/async.h b/include/openssl/async.h
index 7052b89052..5cb71527ce 100644
--- a/include/openssl/async.h
+++ b/include/openssl/async.h
@@ -37,37 +37,37 @@ typedef struct async_wait_ctx_st ASYNC_WAIT_CTX;
 #define ASYNC_PAUSE    2
 #define ASYNC_FINISH   3
 
-int ASYNC_init_thread(size_t max_size, size_t init_size);
-void ASYNC_cleanup_thread(void);
+int __cdecl ASYNC_init_thread(size_t max_size, size_t init_size);
+void __cdecl ASYNC_cleanup_thread(void);
 
 #ifdef OSSL_ASYNC_FD
-ASYNC_WAIT_CTX *ASYNC_WAIT_CTX_new(void);
-void ASYNC_WAIT_CTX_free(ASYNC_WAIT_CTX *ctx);
-int ASYNC_WAIT_CTX_set_wait_fd(ASYNC_WAIT_CTX *ctx, const void *key,
+ASYNC_WAIT_CTX * __cdecl ASYNC_WAIT_CTX_new(void);
+void __cdecl ASYNC_WAIT_CTX_free(ASYNC_WAIT_CTX *ctx);
+int __cdecl ASYNC_WAIT_CTX_set_wait_fd(ASYNC_WAIT_CTX *ctx, const void *key,
                                OSSL_ASYNC_FD fd,
                                void *custom_data,
                                void (*cleanup)(ASYNC_WAIT_CTX *, const void *,
                                                OSSL_ASYNC_FD, void *));
-int ASYNC_WAIT_CTX_get_fd(ASYNC_WAIT_CTX *ctx, const void *key,
+int __cdecl ASYNC_WAIT_CTX_get_fd(ASYNC_WAIT_CTX *ctx, const void *key,
                         OSSL_ASYNC_FD *fd, void **custom_data);
-int ASYNC_WAIT_CTX_get_all_fds(ASYNC_WAIT_CTX *ctx, OSSL_ASYNC_FD *fd,
+int __cdecl ASYNC_WAIT_CTX_get_all_fds(ASYNC_WAIT_CTX *ctx, OSSL_ASYNC_FD *fd,
                                size_t *numfds);
-int ASYNC_WAIT_CTX_get_changed_fds(ASYNC_WAIT_CTX *ctx, OSSL_ASYNC_FD *addfd,
+int __cdecl ASYNC_WAIT_CTX_get_changed_fds(ASYNC_WAIT_CTX *ctx, OSSL_ASYNC_FD *addfd,
                                    size_t *numaddfds, OSSL_ASYNC_FD *delfd,
                                    size_t *numdelfds);
-int ASYNC_WAIT_CTX_clear_fd(ASYNC_WAIT_CTX *ctx, const void *key);
+int __cdecl ASYNC_WAIT_CTX_clear_fd(ASYNC_WAIT_CTX *ctx, const void *key);
 #endif
 
-int ASYNC_is_capable(void);
+int __cdecl ASYNC_is_capable(void);
 
-int ASYNC_start_job(ASYNC_JOB **job, ASYNC_WAIT_CTX *ctx, int *ret,
+int __cdecl ASYNC_start_job(ASYNC_JOB **job, ASYNC_WAIT_CTX *ctx, int *ret,
                     int (*func)(void *), void *args, size_t size);
-int ASYNC_pause_job(void);
+int __cdecl ASYNC_pause_job(void);
 
-ASYNC_JOB *ASYNC_get_current_job(void);
-ASYNC_WAIT_CTX *ASYNC_get_wait_ctx(ASYNC_JOB *job);
-void ASYNC_block_pause(void);
-void ASYNC_unblock_pause(void);
+ASYNC_JOB * __cdecl ASYNC_get_current_job(void);
+ASYNC_WAIT_CTX * __cdecl ASYNC_get_wait_ctx(ASYNC_JOB *job);
+void __cdecl ASYNC_block_pause(void);
+void __cdecl ASYNC_unblock_pause(void);
 
 
 # ifdef  __cplusplus
diff --git a/include/openssl/asyncerr.h b/include/openssl/asyncerr.h
index 91afbbb2f5..d404cafb75 100644
--- a/include/openssl/asyncerr.h
+++ b/include/openssl/asyncerr.h
@@ -18,7 +18,7 @@
 # ifdef  __cplusplus
 extern "C"
 # endif
-int ERR_load_ASYNC_strings(void);
+int __cdecl ERR_load_ASYNC_strings(void);
 
 /*
  * ASYNC function codes.
diff --git a/include/openssl/bio.h b/include/openssl/bio.h
index e1fddfb796..4adb76d7e3 100644
--- a/include/openssl/bio.h
+++ b/include/openssl/bio.h
@@ -173,10 +173,10 @@ extern "C" {
 typedef union bio_addr_st BIO_ADDR;
 typedef struct bio_addrinfo_st BIO_ADDRINFO;
 
-int BIO_get_new_index(void);
-void BIO_set_flags(BIO *b, int flags);
-int BIO_test_flags(const BIO *b, int flags);
-void BIO_clear_flags(BIO *b, int flags);
+int __cdecl BIO_get_new_index(void);
+void __cdecl BIO_set_flags(BIO *b, int flags);
+int __cdecl BIO_test_flags(const BIO *b, int flags);
+void __cdecl BIO_clear_flags(BIO *b, int flags);
 
 # define BIO_get_flags(b) BIO_test_flags(b, ~(0x0))
 # define BIO_set_retry_special(b) \
@@ -232,24 +232,24 @@ void BIO_clear_flags(BIO *b, int flags);
 # define BIO_cb_pre(a)   (!((a)&BIO_CB_RETURN))
 # define BIO_cb_post(a)  ((a)&BIO_CB_RETURN)
 
-typedef long (*BIO_callback_fn)(BIO *b, int oper, const char *argp, int argi,
+typedef long (__cdecl *BIO_callback_fn)(BIO *b, int oper, const char *argp, int argi,
                                 long argl, long ret);
-typedef long (*BIO_callback_fn_ex)(BIO *b, int oper, const char *argp,
+typedef long (__cdecl *BIO_callback_fn_ex)(BIO *b, int oper, const char *argp,
                                    size_t len, int argi,
                                    long argl, int ret, size_t *processed);
-BIO_callback_fn BIO_get_callback(const BIO *b);
-void BIO_set_callback(BIO *b, BIO_callback_fn callback);
+BIO_callback_fn __cdecl BIO_get_callback(const BIO *b);
+void __cdecl BIO_set_callback(BIO *b, BIO_callback_fn callback);
 
-BIO_callback_fn_ex BIO_get_callback_ex(const BIO *b);
-void BIO_set_callback_ex(BIO *b, BIO_callback_fn_ex callback);
+BIO_callback_fn_ex __cdecl BIO_get_callback_ex(const BIO *b);
+void __cdecl BIO_set_callback_ex(BIO *b, BIO_callback_fn_ex callback);
 
-char *BIO_get_callback_arg(const BIO *b);
-void BIO_set_callback_arg(BIO *b, char *arg);
+char * __cdecl BIO_get_callback_arg(const BIO *b);
+void __cdecl BIO_set_callback_arg(BIO *b, char *arg);
 
 typedef struct bio_method_st BIO_METHOD;
 
-const char *BIO_method_name(const BIO *b);
-int BIO_method_type(const BIO *b);
+const char * __cdecl BIO_method_name(const BIO *b);
+int __cdecl BIO_method_type(const BIO *b);
 
 typedef int BIO_info_cb(BIO *, int, int);
 typedef BIO_info_cb bio_info_cb;  /* backward compatibility */
@@ -483,8 +483,8 @@ int BIO_read_filename(BIO *b, const char *name);
 # define BIO_pending(b)          (int)BIO_ctrl(b,BIO_CTRL_PENDING,0,NULL)
 # define BIO_wpending(b)         (int)BIO_ctrl(b,BIO_CTRL_WPENDING,0,NULL)
 /* ...pending macros have inappropriate return type */
-size_t BIO_ctrl_pending(BIO *b);
-size_t BIO_ctrl_wpending(BIO *b);
+size_t __cdecl BIO_ctrl_pending(BIO *b);
+size_t __cdecl BIO_ctrl_wpending(BIO *b);
 # define BIO_flush(b)            (int)BIO_ctrl(b,BIO_CTRL_FLUSH,0,NULL)
 # define BIO_get_info_callback(b,cbp) (int)BIO_ctrl(b,BIO_CTRL_GET_CALLBACK,0, \
                                                    cbp)
@@ -503,9 +503,9 @@ size_t BIO_ctrl_wpending(BIO *b);
 /* macros with inappropriate type -- but ...pending macros use int too: */
 # define BIO_get_write_guarantee(b) (int)BIO_ctrl(b,BIO_C_GET_WRITE_GUARANTEE,0,NULL)
 # define BIO_get_read_request(b)    (int)BIO_ctrl(b,BIO_C_GET_READ_REQUEST,0,NULL)
-size_t BIO_ctrl_get_write_guarantee(BIO *b);
-size_t BIO_ctrl_get_read_request(BIO *b);
-int BIO_ctrl_reset_read_request(BIO *b);
+size_t __cdecl BIO_ctrl_get_write_guarantee(BIO *b);
+size_t __cdecl BIO_ctrl_get_read_request(BIO *b);
+int __cdecl BIO_ctrl_reset_read_request(BIO *b);
 
 /* ctrl macros for dgram */
 # define BIO_ctrl_dgram_connect(b,peer)  \
@@ -525,162 +525,162 @@ int BIO_ctrl_reset_read_request(BIO *b);
 
 #define BIO_get_ex_new_index(l, p, newf, dupf, freef) \
     CRYPTO_get_ex_new_index(CRYPTO_EX_INDEX_BIO, l, p, newf, dupf, freef)
-int BIO_set_ex_data(BIO *bio, int idx, void *data);
-void *BIO_get_ex_data(BIO *bio, int idx);
-uint64_t BIO_number_read(BIO *bio);
-uint64_t BIO_number_written(BIO *bio);
+int __cdecl BIO_set_ex_data(BIO *bio, int idx, void *data);
+void * __cdecl BIO_get_ex_data(BIO *bio, int idx);
+uint64_t __cdecl BIO_number_read(BIO *bio);
+uint64_t __cdecl BIO_number_written(BIO *bio);
 
 /* For BIO_f_asn1() */
-int BIO_asn1_set_prefix(BIO *b, asn1_ps_func *prefix,
+int __cdecl BIO_asn1_set_prefix(BIO *b, asn1_ps_func *prefix,
                         asn1_ps_func *prefix_free);
-int BIO_asn1_get_prefix(BIO *b, asn1_ps_func **pprefix,
+int __cdecl BIO_asn1_get_prefix(BIO *b, asn1_ps_func **pprefix,
                         asn1_ps_func **pprefix_free);
-int BIO_asn1_set_suffix(BIO *b, asn1_ps_func *suffix,
+int __cdecl BIO_asn1_set_suffix(BIO *b, asn1_ps_func *suffix,
                         asn1_ps_func *suffix_free);
-int BIO_asn1_get_suffix(BIO *b, asn1_ps_func **psuffix,
+int __cdecl BIO_asn1_get_suffix(BIO *b, asn1_ps_func **psuffix,
                         asn1_ps_func **psuffix_free);
 
-const BIO_METHOD *BIO_s_file(void);
-BIO *BIO_new_file(const char *filename, const char *mode);
+const BIO_METHOD * __cdecl BIO_s_file(void);
+BIO * __cdecl BIO_new_file(const char *filename, const char *mode);
 # ifndef OPENSSL_NO_STDIO
-BIO *BIO_new_fp(FILE *stream, int close_flag);
+BIO * __cdecl BIO_new_fp(FILE *stream, int close_flag);
 # endif
-BIO *BIO_new(const BIO_METHOD *type);
-int BIO_free(BIO *a);
-void BIO_set_data(BIO *a, void *ptr);
-void *BIO_get_data(BIO *a);
-void BIO_set_init(BIO *a, int init);
-int BIO_get_init(BIO *a);
-void BIO_set_shutdown(BIO *a, int shut);
-int BIO_get_shutdown(BIO *a);
-void BIO_vfree(BIO *a);
-int BIO_up_ref(BIO *a);
-int BIO_read(BIO *b, void *data, int dlen);
-int BIO_read_ex(BIO *b, void *data, size_t dlen, size_t *readbytes);
-int BIO_gets(BIO *bp, char *buf, int size);
-int BIO_write(BIO *b, const void *data, int dlen);
-int BIO_write_ex(BIO *b, const void *data, size_t dlen, size_t *written);
-int BIO_puts(BIO *bp, const char *buf);
-int BIO_indent(BIO *b, int indent, int max);
-long BIO_ctrl(BIO *bp, int cmd, long larg, void *parg);
-long BIO_callback_ctrl(BIO *b, int cmd, BIO_info_cb *fp);
-void *BIO_ptr_ctrl(BIO *bp, int cmd, long larg);
-long BIO_int_ctrl(BIO *bp, int cmd, long larg, int iarg);
-BIO *BIO_push(BIO *b, BIO *append);
-BIO *BIO_pop(BIO *b);
-void BIO_free_all(BIO *a);
-BIO *BIO_find_type(BIO *b, int bio_type);
-BIO *BIO_next(BIO *b);
-void BIO_set_next(BIO *b, BIO *next);
-BIO *BIO_get_retry_BIO(BIO *bio, int *reason);
-int BIO_get_retry_reason(BIO *bio);
-void BIO_set_retry_reason(BIO *bio, int reason);
-BIO *BIO_dup_chain(BIO *in);
-
-int BIO_nread0(BIO *bio, char **buf);
-int BIO_nread(BIO *bio, char **buf, int num);
-int BIO_nwrite0(BIO *bio, char **buf);
-int BIO_nwrite(BIO *bio, char **buf, int num);
-
-long BIO_debug_callback(BIO *bio, int cmd, const char *argp, int argi,
+BIO * __cdecl BIO_new(const BIO_METHOD *type);
+int __cdecl BIO_free(BIO *a);
+void __cdecl BIO_set_data(BIO *a, void *ptr);
+void * __cdecl BIO_get_data(BIO *a);
+void __cdecl BIO_set_init(BIO *a, int init);
+int __cdecl BIO_get_init(BIO *a);
+void __cdecl BIO_set_shutdown(BIO *a, int shut);
+int __cdecl BIO_get_shutdown(BIO *a);
+void __cdecl BIO_vfree(BIO *a);
+int __cdecl BIO_up_ref(BIO *a);
+int __cdecl BIO_read(BIO *b, void *data, int dlen);
+int __cdecl BIO_read_ex(BIO *b, void *data, size_t dlen, size_t *readbytes);
+int __cdecl BIO_gets(BIO *bp, char *buf, int size);
+int __cdecl BIO_write(BIO *b, const void *data, int dlen);
+int __cdecl BIO_write_ex(BIO *b, const void *data, size_t dlen, size_t *written);
+int __cdecl BIO_puts(BIO *bp, const char *buf);
+int __cdecl BIO_indent(BIO *b, int indent, int max);
+long __cdecl BIO_ctrl(BIO *bp, int cmd, long larg, void *parg);
+long __cdecl BIO_callback_ctrl(BIO *b, int cmd, BIO_info_cb *fp);
+void * __cdecl BIO_ptr_ctrl(BIO *bp, int cmd, long larg);
+long __cdecl BIO_int_ctrl(BIO *bp, int cmd, long larg, int iarg);
+BIO * __cdecl BIO_push(BIO *b, BIO *append);
+BIO * __cdecl BIO_pop(BIO *b);
+void __cdecl BIO_free_all(BIO *a);
+BIO *__cdecl BIO_find_type(BIO *b, int bio_type);
+BIO * __cdecl BIO_next(BIO *b);
+void __cdecl BIO_set_next(BIO *b, BIO *next);
+BIO * __cdecl BIO_get_retry_BIO(BIO *bio, int *reason);
+int __cdecl BIO_get_retry_reason(BIO *bio);
+void __cdecl BIO_set_retry_reason(BIO *bio, int reason);
+BIO * __cdecl BIO_dup_chain(BIO *in);
+
+int __cdecl BIO_nread0(BIO *bio, char **buf);
+int __cdecl BIO_nread(BIO *bio, char **buf, int num);
+int __cdecl BIO_nwrite0(BIO *bio, char **buf);
+int __cdecl BIO_nwrite(BIO *bio, char **buf, int num);
+
+long __cdecl BIO_debug_callback(BIO *bio, int cmd, const char *argp, int argi,
                         long argl, long ret);
 
-const BIO_METHOD *BIO_s_mem(void);
-const BIO_METHOD *BIO_s_secmem(void);
-BIO *BIO_new_mem_buf(const void *buf, int len);
+const BIO_METHOD * __cdecl BIO_s_mem(void);
+const BIO_METHOD * __cdecl BIO_s_secmem(void);
+BIO * __cdecl BIO_new_mem_buf(const void *buf, int len);
 # ifndef OPENSSL_NO_SOCK
-const BIO_METHOD *BIO_s_socket(void);
-const BIO_METHOD *BIO_s_connect(void);
-const BIO_METHOD *BIO_s_accept(void);
+const BIO_METHOD * __cdecl BIO_s_socket(void);
+const BIO_METHOD * __cdecl BIO_s_connect(void);
+const BIO_METHOD * __cdecl BIO_s_accept(void);
 # endif
-const BIO_METHOD *BIO_s_fd(void);
-const BIO_METHOD *BIO_s_log(void);
-const BIO_METHOD *BIO_s_bio(void);
-const BIO_METHOD *BIO_s_null(void);
-const BIO_METHOD *BIO_f_null(void);
-const BIO_METHOD *BIO_f_buffer(void);
-const BIO_METHOD *BIO_f_linebuffer(void);
-const BIO_METHOD *BIO_f_nbio_test(void);
+const BIO_METHOD * __cdecl BIO_s_fd(void);
+const BIO_METHOD * __cdecl BIO_s_log(void);
+const BIO_METHOD * __cdecl BIO_s_bio(void);
+const BIO_METHOD * __cdecl BIO_s_null(void);
+const BIO_METHOD * __cdecl BIO_f_null(void);
+const BIO_METHOD * __cdecl BIO_f_buffer(void);
+const BIO_METHOD * __cdecl BIO_f_linebuffer(void);
+const BIO_METHOD * __cdecl BIO_f_nbio_test(void);
 # ifndef OPENSSL_NO_DGRAM
-const BIO_METHOD *BIO_s_datagram(void);
-int BIO_dgram_non_fatal_error(int error);
-BIO *BIO_new_dgram(int fd, int close_flag);
+const BIO_METHOD * __cdecl BIO_s_datagram(void);
+int __cdecl BIO_dgram_non_fatal_error(int error);
+BIO * __cdecl BIO_new_dgram(int fd, int close_flag);
 #  ifndef OPENSSL_NO_SCTP
-const BIO_METHOD *BIO_s_datagram_sctp(void);
-BIO *BIO_new_dgram_sctp(int fd, int close_flag);
-int BIO_dgram_is_sctp(BIO *bio);
-int BIO_dgram_sctp_notification_cb(BIO *b,
+const BIO_METHOD * __cdecl BIO_s_datagram_sctp(void);
+BIO * __cdecl BIO_new_dgram_sctp(int fd, int close_flag);
+int __cdecl BIO_dgram_is_sctp(BIO *bio);
+int __cdecl BIO_dgram_sctp_notification_cb(BIO *b,
                                    void (*handle_notifications) (BIO *bio,
                                                                  void *context,
                                                                  void *buf),
                                    void *context);
-int BIO_dgram_sctp_wait_for_dry(BIO *b);
-int BIO_dgram_sctp_msg_waiting(BIO *b);
+int __cdecl BIO_dgram_sctp_wait_for_dry(BIO *b);
+int __cdecl BIO_dgram_sctp_msg_waiting(BIO *b);
 #  endif
 # endif
 
 # ifndef OPENSSL_NO_SOCK
-int BIO_sock_should_retry(int i);
-int BIO_sock_non_fatal_error(int error);
+int __cdecl BIO_sock_should_retry(int i);
+int __cdecl BIO_sock_non_fatal_error(int error);
 # endif
 
-int BIO_fd_should_retry(int i);
-int BIO_fd_non_fatal_error(int error);
-int BIO_dump_cb(int (*cb) (const void *data, size_t len, void *u),
+int __cdecl BIO_fd_should_retry(int i);
+int __cdecl BIO_fd_non_fatal_error(int error);
+int __cdecl BIO_dump_cb(int (*cb) (const void *data, size_t len, void *u),
                 void *u, const char *s, int len);
-int BIO_dump_indent_cb(int (*cb) (const void *data, size_t len, void *u),
+int __cdecl BIO_dump_indent_cb(int (*cb) (const void *data, size_t len, void *u),
                        void *u, const char *s, int len, int indent);
-int BIO_dump(BIO *b, const char *bytes, int len);
-int BIO_dump_indent(BIO *b, const char *bytes, int len, int indent);
+int __cdecl BIO_dump(BIO *b, const char *bytes, int len);
+int __cdecl BIO_dump_indent(BIO *b, const char *bytes, int len, int indent);
 # ifndef OPENSSL_NO_STDIO
-int BIO_dump_fp(FILE *fp, const char *s, int len);
-int BIO_dump_indent_fp(FILE *fp, const char *s, int len, int indent);
+int __cdecl BIO_dump_fp(FILE *fp, const char *s, int len);
+int __cdecl BIO_dump_indent_fp(FILE *fp, const char *s, int len, int indent);
 # endif
-int BIO_hex_string(BIO *out, int indent, int width, unsigned char *data,
+int __cdecl BIO_hex_string(BIO *out, int indent, int width, unsigned char *data,
                    int datalen);
 
 # ifndef OPENSSL_NO_SOCK
-BIO_ADDR *BIO_ADDR_new(void);
-int BIO_ADDR_rawmake(BIO_ADDR *ap, int family,
+BIO_ADDR * __cdecl BIO_ADDR_new(void);
+int __cdecl BIO_ADDR_rawmake(BIO_ADDR *ap, int family,
                      const void *where, size_t wherelen, unsigned short port);
-void BIO_ADDR_free(BIO_ADDR *);
-void BIO_ADDR_clear(BIO_ADDR *ap);
-int BIO_ADDR_family(const BIO_ADDR *ap);
-int BIO_ADDR_rawaddress(const BIO_ADDR *ap, void *p, size_t *l);
-unsigned short BIO_ADDR_rawport(const BIO_ADDR *ap);
-char *BIO_ADDR_hostname_string(const BIO_ADDR *ap, int numeric);
-char *BIO_ADDR_service_string(const BIO_ADDR *ap, int numeric);
-char *BIO_ADDR_path_string(const BIO_ADDR *ap);
-
-const BIO_ADDRINFO *BIO_ADDRINFO_next(const BIO_ADDRINFO *bai);
-int BIO_ADDRINFO_family(const BIO_ADDRINFO *bai);
-int BIO_ADDRINFO_socktype(const BIO_ADDRINFO *bai);
-int BIO_ADDRINFO_protocol(const BIO_ADDRINFO *bai);
-const BIO_ADDR *BIO_ADDRINFO_address(const BIO_ADDRINFO *bai);
-void BIO_ADDRINFO_free(BIO_ADDRINFO *bai);
+void __cdecl BIO_ADDR_free(BIO_ADDR *);
+void __cdecl BIO_ADDR_clear(BIO_ADDR *ap);
+int __cdecl BIO_ADDR_family(const BIO_ADDR *ap);
+int __cdecl BIO_ADDR_rawaddress(const BIO_ADDR *ap, void *p, size_t *l);
+unsigned short __cdecl BIO_ADDR_rawport(const BIO_ADDR *ap);
+char * __cdecl BIO_ADDR_hostname_string(const BIO_ADDR *ap, int numeric);
+char * __cdecl BIO_ADDR_service_string(const BIO_ADDR *ap, int numeric);
+char * __cdecl BIO_ADDR_path_string(const BIO_ADDR *ap);
+
+const BIO_ADDRINFO * __cdecl BIO_ADDRINFO_next(const BIO_ADDRINFO *bai);
+int __cdecl BIO_ADDRINFO_family(const BIO_ADDRINFO *bai);
+int __cdecl BIO_ADDRINFO_socktype(const BIO_ADDRINFO *bai);
+int __cdecl BIO_ADDRINFO_protocol(const BIO_ADDRINFO *bai);
+const BIO_ADDR * __cdecl BIO_ADDRINFO_address(const BIO_ADDRINFO *bai);
+void __cdecl BIO_ADDRINFO_free(BIO_ADDRINFO *bai);
 
 enum BIO_hostserv_priorities {
     BIO_PARSE_PRIO_HOST, BIO_PARSE_PRIO_SERV
 };
-int BIO_parse_hostserv(const char *hostserv, char **host, char **service,
+int __cdecl BIO_parse_hostserv(const char *hostserv, char **host, char **service,
                        enum BIO_hostserv_priorities hostserv_prio);
 enum BIO_lookup_type {
     BIO_LOOKUP_CLIENT, BIO_LOOKUP_SERVER
 };
-int BIO_lookup(const char *host, const char *service,
+int __cdecl BIO_lookup(const char *host, const char *service,
                enum BIO_lookup_type lookup_type,
                int family, int socktype, BIO_ADDRINFO **res);
-int BIO_lookup_ex(const char *host, const char *service,
+int __cdecl BIO_lookup_ex(const char *host, const char *service,
                   int lookup_type, int family, int socktype, int protocol,
                   BIO_ADDRINFO **res);
-int BIO_sock_error(int sock);
-int BIO_socket_ioctl(int fd, long type, void *arg);
-int BIO_socket_nbio(int fd, int mode);
-int BIO_sock_init(void);
+int __cdecl BIO_sock_error(int sock);
+int __cdecl BIO_socket_ioctl(int fd, long type, void *arg);
+int __cdecl BIO_socket_nbio(int fd, int mode);
+int __cdecl BIO_sock_init(void);
 # if OPENSSL_API_COMPAT < 0x10100000L
 #  define BIO_sock_cleanup() while(0) continue
 # endif
-int BIO_set_tcp_ndelay(int sock, int turn_on);
+int __cdecl BIO_set_tcp_ndelay(int sock, int turn_on);
 
 DEPRECATEDIN_1_1_0(struct hostent *BIO_gethostbyname(const char *name))
 DEPRECATEDIN_1_1_0(int BIO_get_port(const char *str, unsigned short *port_ptr))
@@ -694,7 +694,7 @@ union BIO_sock_info_u {
 enum BIO_sock_info_type {
     BIO_SOCK_INFO_ADDRESS
 };
-int BIO_sock_info(int sock,
+int __cdecl BIO_sock_info(int sock,
                   enum BIO_sock_info_type type, union BIO_sock_info_u *info);
 
 #  define BIO_SOCK_REUSEADDR    0x01
@@ -703,21 +703,21 @@ int BIO_sock_info(int sock,
 #  define BIO_SOCK_NONBLOCK     0x08
 #  define BIO_SOCK_NODELAY      0x10
 
-int BIO_socket(int domain, int socktype, int protocol, int options);
-int BIO_connect(int sock, const BIO_ADDR *addr, int options);
-int BIO_bind(int sock, const BIO_ADDR *addr, int options);
-int BIO_listen(int sock, const BIO_ADDR *addr, int options);
-int BIO_accept_ex(int accept_sock, BIO_ADDR *addr, int options);
-int BIO_closesocket(int sock);
+int __cdecl BIO_socket(int domain, int socktype, int protocol, int options);
+int __cdecl BIO_connect(int sock, const BIO_ADDR *addr, int options);
+int __cdecl BIO_bind(int sock, const BIO_ADDR *addr, int options);
+int __cdecl BIO_listen(int sock, const BIO_ADDR *addr, int options);
+int __cdecl BIO_accept_ex(int accept_sock, BIO_ADDR *addr, int options);
+int __cdecl BIO_closesocket(int sock);
 
-BIO *BIO_new_socket(int sock, int close_flag);
-BIO *BIO_new_connect(const char *host_port);
-BIO *BIO_new_accept(const char *host_port);
+BIO * __cdecl BIO_new_socket(int sock, int close_flag);
+BIO * __cdecl BIO_new_connect(const char *host_port);
+BIO * __cdecl BIO_new_accept(const char *host_port);
 # endif /* OPENSSL_NO_SOCK*/
 
-BIO *BIO_new_fd(int fd, int close_flag);
+BIO * __cdecl BIO_new_fd(int fd, int close_flag);
 
-int BIO_new_bio_pair(BIO **bio1, size_t writebuf1,
+int __cdecl BIO_new_bio_pair(BIO **bio1, size_t writebuf1,
                      BIO **bio2, size_t writebuf2);
 /*
  * If successful, returns 1 and in *bio1, *bio2 two BIO pair endpoints.
@@ -725,7 +725,7 @@ int BIO_new_bio_pair(BIO **bio1, size_t writebuf1,
  * value.
  */
 
-void BIO_copy_next_retry(BIO *b);
+void __cdecl BIO_copy_next_retry(BIO *b);
 
 /*
  * long BIO_ghbn_ctrl(int cmd,int iarg,char *parg);
@@ -748,49 +748,49 @@ void BIO_copy_next_retry(BIO *b);
 #   endif
 #  endif
 # endif
-int BIO_printf(BIO *bio, const char *format, ...)
+int __cdecl BIO_printf(BIO *bio, const char *format, ...)
 ossl_bio__attr__((__format__(ossl_bio__printf__, 2, 3)));
-int BIO_vprintf(BIO *bio, const char *format, va_list args)
+int __cdecl BIO_vprintf(BIO *bio, const char *format, va_list args)
 ossl_bio__attr__((__format__(ossl_bio__printf__, 2, 0)));
-int BIO_snprintf(char *buf, size_t n, const char *format, ...)
+int __cdecl BIO_snprintf(char *buf, size_t n, const char *format, ...)
 ossl_bio__attr__((__format__(ossl_bio__printf__, 3, 4)));
-int BIO_vsnprintf(char *buf, size_t n, const char *format, va_list args)
+int __cdecl BIO_vsnprintf(char *buf, size_t n, const char *format, va_list args)
 ossl_bio__attr__((__format__(ossl_bio__printf__, 3, 0)));
 # undef ossl_bio__attr__
 # undef ossl_bio__printf__
 
 
-BIO_METHOD *BIO_meth_new(int type, const char *name);
-void BIO_meth_free(BIO_METHOD *biom);
-int (*BIO_meth_get_write(const BIO_METHOD *biom)) (BIO *, const char *, int);
-int (*BIO_meth_get_write_ex(const BIO_METHOD *biom)) (BIO *, const char *, size_t,
+BIO_METHOD *__cdecl BIO_meth_new(int type, const char *name);
+void __cdecl BIO_meth_free(BIO_METHOD *biom);
+int (* __cdecl BIO_meth_get_write(const BIO_METHOD *biom)) (BIO *, const char *, int);
+int (* __cdecl BIO_meth_get_write_ex(const BIO_METHOD *biom)) (BIO *, const char *, size_t,
                                                 size_t *);
-int BIO_meth_set_write(BIO_METHOD *biom,
+int __cdecl BIO_meth_set_write(BIO_METHOD *biom,
                        int (*write) (BIO *, const char *, int));
-int BIO_meth_set_write_ex(BIO_METHOD *biom,
+int __cdecl BIO_meth_set_write_ex(BIO_METHOD *biom,
                        int (*bwrite) (BIO *, const char *, size_t, size_t *));
-int (*BIO_meth_get_read(const BIO_METHOD *biom)) (BIO *, char *, int);
-int (*BIO_meth_get_read_ex(const BIO_METHOD *biom)) (BIO *, char *, size_t, size_t *);
-int BIO_meth_set_read(BIO_METHOD *biom,
+int (* __cdecl BIO_meth_get_read(const BIO_METHOD *biom)) (BIO *, char *, int);
+int (* __cdecl BIO_meth_get_read_ex(const BIO_METHOD *biom)) (BIO *, char *, size_t, size_t *);
+int __cdecl BIO_meth_set_read(BIO_METHOD *biom,
                       int (*read) (BIO *, char *, int));
-int BIO_meth_set_read_ex(BIO_METHOD *biom,
+int __cdecl BIO_meth_set_read_ex(BIO_METHOD *biom,
                          int (*bread) (BIO *, char *, size_t, size_t *));
-int (*BIO_meth_get_puts(const BIO_METHOD *biom)) (BIO *, const char *);
-int BIO_meth_set_puts(BIO_METHOD *biom,
+int (* __cdecl BIO_meth_get_puts(const BIO_METHOD *biom)) (BIO *, const char *);
+int __cdecl BIO_meth_set_puts(BIO_METHOD *biom,
                       int (*puts) (BIO *, const char *));
-int (*BIO_meth_get_gets(const BIO_METHOD *biom)) (BIO *, char *, int);
-int BIO_meth_set_gets(BIO_METHOD *biom,
+int (* __cdecl BIO_meth_get_gets(const BIO_METHOD *biom)) (BIO *, char *, int);
+int __cdecl BIO_meth_set_gets(BIO_METHOD *biom,
                       int (*gets) (BIO *, char *, int));
-long (*BIO_meth_get_ctrl(const BIO_METHOD *biom)) (BIO *, int, long, void *);
-int BIO_meth_set_ctrl(BIO_METHOD *biom,
+long (* __cdecl BIO_meth_get_ctrl(const BIO_METHOD *biom)) (BIO *, int, long, void *);
+int __cdecl BIO_meth_set_ctrl(BIO_METHOD *biom,
                       long (*ctrl) (BIO *, int, long, void *));
-int (*BIO_meth_get_create(const BIO_METHOD *bion)) (BIO *);
-int BIO_meth_set_create(BIO_METHOD *biom, int (*create) (BIO *));
-int (*BIO_meth_get_destroy(const BIO_METHOD *biom)) (BIO *);
-int BIO_meth_set_destroy(BIO_METHOD *biom, int (*destroy) (BIO *));
-long (*BIO_meth_get_callback_ctrl(const BIO_METHOD *biom))
+int (* __cdecl BIO_meth_get_create(const BIO_METHOD *bion)) (BIO *);
+int __cdecl BIO_meth_set_create(BIO_METHOD *biom, int (*create) (BIO *));
+int (* __cdecl BIO_meth_get_destroy(const BIO_METHOD *biom)) (BIO *);
+int __cdecl BIO_meth_set_destroy(BIO_METHOD *biom, int (*destroy) (BIO *));
+long (* __cdecl BIO_meth_get_callback_ctrl(const BIO_METHOD *biom))
                                  (BIO *, int, BIO_info_cb *);
-int BIO_meth_set_callback_ctrl(BIO_METHOD *biom,
+int __cdecl BIO_meth_set_callback_ctrl(BIO_METHOD *biom,
                                long (*callback_ctrl) (BIO *, int,
                                                       BIO_info_cb *));
 
diff --git a/include/openssl/bioerr.h b/include/openssl/bioerr.h
index 46e2c96ee3..4c738bbb02 100644
--- a/include/openssl/bioerr.h
+++ b/include/openssl/bioerr.h
@@ -18,7 +18,7 @@
 # ifdef  __cplusplus
 extern "C"
 # endif
-int ERR_load_BIO_strings(void);
+int __cdecl ERR_load_BIO_strings(void);
 
 /*
  * BIO function codes.
diff --git a/include/openssl/blowfish.h b/include/openssl/blowfish.h
index cd3e460e98..a749b13ade 100644
--- a/include/openssl/blowfish.h
+++ b/include/openssl/blowfish.h
@@ -36,22 +36,22 @@ typedef struct bf_key_st {
     BF_LONG S[4 * 256];
 } BF_KEY;
 
-void BF_set_key(BF_KEY *key, int len, const unsigned char *data);
+void __cdecl BF_set_key(BF_KEY *key, int len, const unsigned char *data);
 
-void BF_encrypt(BF_LONG *data, const BF_KEY *key);
-void BF_decrypt(BF_LONG *data, const BF_KEY *key);
+void __cdecl BF_encrypt(BF_LONG *data, const BF_KEY *key);
+void __cdecl BF_decrypt(BF_LONG *data, const BF_KEY *key);
 
-void BF_ecb_encrypt(const unsigned char *in, unsigned char *out,
+void __cdecl BF_ecb_encrypt(const unsigned char *in, unsigned char *out,
                     const BF_KEY *key, int enc);
-void BF_cbc_encrypt(const unsigned char *in, unsigned char *out, long length,
+void __cdecl BF_cbc_encrypt(const unsigned char *in, unsigned char *out, long length,
                     const BF_KEY *schedule, unsigned char *ivec, int enc);
-void BF_cfb64_encrypt(const unsigned char *in, unsigned char *out,
+void __cdecl BF_cfb64_encrypt(const unsigned char *in, unsigned char *out,
                       long length, const BF_KEY *schedule,
                       unsigned char *ivec, int *num, int enc);
-void BF_ofb64_encrypt(const unsigned char *in, unsigned char *out,
+void __cdecl BF_ofb64_encrypt(const unsigned char *in, unsigned char *out,
                       long length, const BF_KEY *schedule,
                       unsigned char *ivec, int *num);
-const char *BF_options(void);
+const char * __cdecl BF_options(void);
 
 # ifdef  __cplusplus
 }
diff --git a/include/openssl/bn.h b/include/openssl/bn.h
index 8af05d00e5..def342fd3a 100644
--- a/include/openssl/bn.h
+++ b/include/openssl/bn.h
@@ -67,8 +67,8 @@ extern "C" {
 #  define BN_FLG_FREE            0x8000 /* used for debugging */
 # endif
 
-void BN_set_flags(BIGNUM *b, int n);
-int BN_get_flags(const BIGNUM *b, int n);
+void __cdecl BN_set_flags(BIGNUM *b, int n);
+int __cdecl BN_get_flags(const BIGNUM *b, int n);
 
 /* Values for |top| in BN_rand() */
 #define BN_RAND_TOP_ANY    -1
@@ -85,23 +85,23 @@ int BN_get_flags(const BIGNUM *b, int n);
  * value |dest| should be a newly allocated BIGNUM obtained via BN_new() that
  * has not been otherwise initialised or used.
  */
-void BN_with_flags(BIGNUM *dest, const BIGNUM *b, int flags);
+void __cdecl BN_with_flags(BIGNUM *dest, const BIGNUM *b, int flags);
 
 /* Wrapper function to make using BN_GENCB easier */
-int BN_GENCB_call(BN_GENCB *cb, int a, int b);
+int __cdecl BN_GENCB_call(BN_GENCB *cb, int a, int b);
 
-BN_GENCB *BN_GENCB_new(void);
-void BN_GENCB_free(BN_GENCB *cb);
+BN_GENCB * __cdecl BN_GENCB_new(void);
+void __cdecl BN_GENCB_free(BN_GENCB *cb);
 
 /* Populate a BN_GENCB structure with an "old"-style callback */
-void BN_GENCB_set_old(BN_GENCB *gencb, void (*callback) (int, int, void *),
+void __cdecl BN_GENCB_set_old(BN_GENCB *gencb, void (*callback) (int, int, void *),
                       void *cb_arg);
 
 /* Populate a BN_GENCB structure with a "new"-style callback */
-void BN_GENCB_set(BN_GENCB *gencb, int (*callback) (int, int, BN_GENCB *),
+void __cdecl BN_GENCB_set(BN_GENCB *gencb, int (*callback) (int, int, BN_GENCB *),
                   void *cb_arg);
 
-void *BN_GENCB_get_arg(BN_GENCB *cb);
+void * __cdecl BN_GENCB_get_arg(BN_GENCB *cb);
 
 # define BN_prime_checks 0      /* default: select number of iterations based
                                  * on the size of the number */
@@ -180,15 +180,15 @@ void *BN_GENCB_get_arg(BN_GENCB *cb);
 
 # define BN_num_bytes(a) ((BN_num_bits(a)+7)/8)
 
-int BN_abs_is_word(const BIGNUM *a, const BN_ULONG w);
-int BN_is_zero(const BIGNUM *a);
-int BN_is_one(const BIGNUM *a);
-int BN_is_word(const BIGNUM *a, const BN_ULONG w);
-int BN_is_odd(const BIGNUM *a);
+int __cdecl BN_abs_is_word(const BIGNUM *a, const BN_ULONG w);
+int __cdecl BN_is_zero(const BIGNUM *a);
+int __cdecl BN_is_one(const BIGNUM *a);
+int __cdecl BN_is_word(const BIGNUM *a, const BN_ULONG w);
+int __cdecl BN_is_odd(const BIGNUM *a);
 
 # define BN_one(a)       (BN_set_word((a),1))
 
-void BN_zero_ex(BIGNUM *a);
+void __cdecl BN_zero_ex(BIGNUM *a);
 
 # if OPENSSL_API_COMPAT >= 0x00908000L
 #  define BN_zero(a)      BN_zero_ex(a)
@@ -196,131 +196,131 @@ void BN_zero_ex(BIGNUM *a);
 #  define BN_zero(a)      (BN_set_word((a),0))
 # endif
 
-const BIGNUM *BN_value_one(void);
-char *BN_options(void);
-BN_CTX *BN_CTX_new(void);
-BN_CTX *BN_CTX_secure_new(void);
-void BN_CTX_free(BN_CTX *c);
-void BN_CTX_start(BN_CTX *ctx);
-BIGNUM *BN_CTX_get(BN_CTX *ctx);
-void BN_CTX_end(BN_CTX *ctx);
-int BN_rand(BIGNUM *rnd, int bits, int top, int bottom);
-int BN_priv_rand(BIGNUM *rnd, int bits, int top, int bottom);
-int BN_rand_range(BIGNUM *rnd, const BIGNUM *range);
-int BN_priv_rand_range(BIGNUM *rnd, const BIGNUM *range);
-int BN_pseudo_rand(BIGNUM *rnd, int bits, int top, int bottom);
-int BN_pseudo_rand_range(BIGNUM *rnd, const BIGNUM *range);
-int BN_num_bits(const BIGNUM *a);
-int BN_num_bits_word(BN_ULONG l);
-int BN_security_bits(int L, int N);
-BIGNUM *BN_new(void);
-BIGNUM *BN_secure_new(void);
-void BN_clear_free(BIGNUM *a);
-BIGNUM *BN_copy(BIGNUM *a, const BIGNUM *b);
-void BN_swap(BIGNUM *a, BIGNUM *b);
-BIGNUM *BN_bin2bn(const unsigned char *s, int len, BIGNUM *ret);
-int BN_bn2bin(const BIGNUM *a, unsigned char *to);
-int BN_bn2binpad(const BIGNUM *a, unsigned char *to, int tolen);
-BIGNUM *BN_lebin2bn(const unsigned char *s, int len, BIGNUM *ret);
-int BN_bn2lebinpad(const BIGNUM *a, unsigned char *to, int tolen);
-BIGNUM *BN_mpi2bn(const unsigned char *s, int len, BIGNUM *ret);
-int BN_bn2mpi(const BIGNUM *a, unsigned char *to);
-int BN_sub(BIGNUM *r, const BIGNUM *a, const BIGNUM *b);
-int BN_usub(BIGNUM *r, const BIGNUM *a, const BIGNUM *b);
-int BN_uadd(BIGNUM *r, const BIGNUM *a, const BIGNUM *b);
-int BN_add(BIGNUM *r, const BIGNUM *a, const BIGNUM *b);
-int BN_mul(BIGNUM *r, const BIGNUM *a, const BIGNUM *b, BN_CTX *ctx);
-int BN_sqr(BIGNUM *r, const BIGNUM *a, BN_CTX *ctx);
+const BIGNUM * __cdecl BN_value_one(void);
+char * __cdecl BN_options(void);
+BN_CTX * __cdecl BN_CTX_new(void);
+BN_CTX * __cdecl BN_CTX_secure_new(void);
+void __cdecl BN_CTX_free(BN_CTX *c);
+void __cdecl BN_CTX_start(BN_CTX *ctx);
+BIGNUM * __cdecl BN_CTX_get(BN_CTX *ctx);
+void __cdecl BN_CTX_end(BN_CTX *ctx);
+int __cdecl BN_rand(BIGNUM *rnd, int bits, int top, int bottom);
+int __cdecl BN_priv_rand(BIGNUM *rnd, int bits, int top, int bottom);
+int __cdecl BN_rand_range(BIGNUM *rnd, const BIGNUM *range);
+int __cdecl BN_priv_rand_range(BIGNUM *rnd, const BIGNUM *range);
+int __cdecl BN_pseudo_rand(BIGNUM *rnd, int bits, int top, int bottom);
+int __cdecl BN_pseudo_rand_range(BIGNUM *rnd, const BIGNUM *range);
+int __cdecl BN_num_bits(const BIGNUM *a);
+int __cdecl BN_num_bits_word(BN_ULONG l);
+int __cdecl BN_security_bits(int L, int N);
+BIGNUM * __cdecl BN_new(void);
+BIGNUM * __cdecl BN_secure_new(void);
+void __cdecl BN_clear_free(BIGNUM *a);
+BIGNUM * __cdecl BN_copy(BIGNUM *a, const BIGNUM *b);
+void __cdecl BN_swap(BIGNUM *a, BIGNUM *b);
+BIGNUM * __cdecl BN_bin2bn(const unsigned char *s, int len, BIGNUM *ret);
+int __cdecl BN_bn2bin(const BIGNUM *a, unsigned char *to);
+int __cdecl BN_bn2binpad(const BIGNUM *a, unsigned char *to, int tolen);
+BIGNUM * __cdecl BN_lebin2bn(const unsigned char *s, int len, BIGNUM *ret);
+int __cdecl BN_bn2lebinpad(const BIGNUM *a, unsigned char *to, int tolen);
+BIGNUM * __cdecl BN_mpi2bn(const unsigned char *s, int len, BIGNUM *ret);
+int __cdecl BN_bn2mpi(const BIGNUM *a, unsigned char *to);
+int __cdecl BN_sub(BIGNUM *r, const BIGNUM *a, const BIGNUM *b);
+int __cdecl BN_usub(BIGNUM *r, const BIGNUM *a, const BIGNUM *b);
+int __cdecl BN_uadd(BIGNUM *r, const BIGNUM *a, const BIGNUM *b);
+int __cdecl BN_add(BIGNUM *r, const BIGNUM *a, const BIGNUM *b);
+int __cdecl BN_mul(BIGNUM *r, const BIGNUM *a, const BIGNUM *b, BN_CTX *ctx);
+int __cdecl BN_sqr(BIGNUM *r, const BIGNUM *a, BN_CTX *ctx);
 /** BN_set_negative sets sign of a BIGNUM
  * \param  b  pointer to the BIGNUM object
  * \param  n  0 if the BIGNUM b should be positive and a value != 0 otherwise
  */
-void BN_set_negative(BIGNUM *b, int n);
+void __cdecl BN_set_negative(BIGNUM *b, int n);
 /** BN_is_negative returns 1 if the BIGNUM is negative
  * \param  b  pointer to the BIGNUM object
  * \return 1 if a < 0 and 0 otherwise
  */
-int BN_is_negative(const BIGNUM *b);
+int __cdecl BN_is_negative(const BIGNUM *b);
 
-int BN_div(BIGNUM *dv, BIGNUM *rem, const BIGNUM *m, const BIGNUM *d,
+int __cdecl BN_div(BIGNUM *dv, BIGNUM *rem, const BIGNUM *m, const BIGNUM *d,
            BN_CTX *ctx);
 # define BN_mod(rem,m,d,ctx) BN_div(NULL,(rem),(m),(d),(ctx))
-int BN_nnmod(BIGNUM *r, const BIGNUM *m, const BIGNUM *d, BN_CTX *ctx);
-int BN_mod_add(BIGNUM *r, const BIGNUM *a, const BIGNUM *b, const BIGNUM *m,
+int __cdecl BN_nnmod(BIGNUM *r, const BIGNUM *m, const BIGNUM *d, BN_CTX *ctx);
+int __cdecl BN_mod_add(BIGNUM *r, const BIGNUM *a, const BIGNUM *b, const BIGNUM *m,
                BN_CTX *ctx);
-int BN_mod_add_quick(BIGNUM *r, const BIGNUM *a, const BIGNUM *b,
+int __cdecl BN_mod_add_quick(BIGNUM *r, const BIGNUM *a, const BIGNUM *b,
                      const BIGNUM *m);
-int BN_mod_sub(BIGNUM *r, const BIGNUM *a, const BIGNUM *b, const BIGNUM *m,
+int __cdecl BN_mod_sub(BIGNUM *r, const BIGNUM *a, const BIGNUM *b, const BIGNUM *m,
                BN_CTX *ctx);
-int BN_mod_sub_quick(BIGNUM *r, const BIGNUM *a, const BIGNUM *b,
+int __cdecl BN_mod_sub_quick(BIGNUM *r, const BIGNUM *a, const BIGNUM *b,
                      const BIGNUM *m);
-int BN_mod_mul(BIGNUM *r, const BIGNUM *a, const BIGNUM *b, const BIGNUM *m,
+int __cdecl BN_mod_mul(BIGNUM *r, const BIGNUM *a, const BIGNUM *b, const BIGNUM *m,
                BN_CTX *ctx);
-int BN_mod_sqr(BIGNUM *r, const BIGNUM *a, const BIGNUM *m, BN_CTX *ctx);
-int BN_mod_lshift1(BIGNUM *r, const BIGNUM *a, const BIGNUM *m, BN_CTX *ctx);
-int BN_mod_lshift1_quick(BIGNUM *r, const BIGNUM *a, const BIGNUM *m);
-int BN_mod_lshift(BIGNUM *r, const BIGNUM *a, int n, const BIGNUM *m,
+int __cdecl BN_mod_sqr(BIGNUM *r, const BIGNUM *a, const BIGNUM *m, BN_CTX *ctx);
+int __cdecl BN_mod_lshift1(BIGNUM *r, const BIGNUM *a, const BIGNUM *m, BN_CTX *ctx);
+int __cdecl BN_mod_lshift1_quick(BIGNUM *r, const BIGNUM *a, const BIGNUM *m);
+int __cdecl BN_mod_lshift(BIGNUM *r, const BIGNUM *a, int n, const BIGNUM *m,
                   BN_CTX *ctx);
-int BN_mod_lshift_quick(BIGNUM *r, const BIGNUM *a, int n, const BIGNUM *m);
-
-BN_ULONG BN_mod_word(const BIGNUM *a, BN_ULONG w);
-BN_ULONG BN_div_word(BIGNUM *a, BN_ULONG w);
-int BN_mul_word(BIGNUM *a, BN_ULONG w);
-int BN_add_word(BIGNUM *a, BN_ULONG w);
-int BN_sub_word(BIGNUM *a, BN_ULONG w);
-int BN_set_word(BIGNUM *a, BN_ULONG w);
-BN_ULONG BN_get_word(const BIGNUM *a);
-
-int BN_cmp(const BIGNUM *a, const BIGNUM *b);
-void BN_free(BIGNUM *a);
-int BN_is_bit_set(const BIGNUM *a, int n);
-int BN_lshift(BIGNUM *r, const BIGNUM *a, int n);
-int BN_lshift1(BIGNUM *r, const BIGNUM *a);
-int BN_exp(BIGNUM *r, const BIGNUM *a, const BIGNUM *p, BN_CTX *ctx);
-
-int BN_mod_exp(BIGNUM *r, const BIGNUM *a, const BIGNUM *p,
+int __cdecl BN_mod_lshift_quick(BIGNUM *r, const BIGNUM *a, int n, const BIGNUM *m);
+
+BN_ULONG __cdecl BN_mod_word(const BIGNUM *a, BN_ULONG w);
+BN_ULONG __cdecl BN_div_word(BIGNUM *a, BN_ULONG w);
+int __cdecl BN_mul_word(BIGNUM *a, BN_ULONG w);
+int __cdecl BN_add_word(BIGNUM *a, BN_ULONG w);
+int __cdecl BN_sub_word(BIGNUM *a, BN_ULONG w);
+int __cdecl BN_set_word(BIGNUM *a, BN_ULONG w);
+BN_ULONG __cdecl BN_get_word(const BIGNUM *a);
+
+int __cdecl BN_cmp(const BIGNUM *a, const BIGNUM *b);
+void __cdecl BN_free(BIGNUM *a);
+int __cdecl BN_is_bit_set(const BIGNUM *a, int n);
+int __cdecl BN_lshift(BIGNUM *r, const BIGNUM *a, int n);
+int __cdecl BN_lshift1(BIGNUM *r, const BIGNUM *a);
+int __cdecl BN_exp(BIGNUM *r, const BIGNUM *a, const BIGNUM *p, BN_CTX *ctx);
+
+int __cdecl BN_mod_exp(BIGNUM *r, const BIGNUM *a, const BIGNUM *p,
                const BIGNUM *m, BN_CTX *ctx);
-int BN_mod_exp_mont(BIGNUM *r, const BIGNUM *a, const BIGNUM *p,
+int __cdecl BN_mod_exp_mont(BIGNUM *r, const BIGNUM *a, const BIGNUM *p,
                     const BIGNUM *m, BN_CTX *ctx, BN_MONT_CTX *m_ctx);
-int BN_mod_exp_mont_consttime(BIGNUM *rr, const BIGNUM *a, const BIGNUM *p,
+int __cdecl BN_mod_exp_mont_consttime(BIGNUM *rr, const BIGNUM *a, const BIGNUM *p,
                               const BIGNUM *m, BN_CTX *ctx,
                               BN_MONT_CTX *in_mont);
-int BN_mod_exp_mont_word(BIGNUM *r, BN_ULONG a, const BIGNUM *p,
+int __cdecl BN_mod_exp_mont_word(BIGNUM *r, BN_ULONG a, const BIGNUM *p,
                          const BIGNUM *m, BN_CTX *ctx, BN_MONT_CTX *m_ctx);
-int BN_mod_exp2_mont(BIGNUM *r, const BIGNUM *a1, const BIGNUM *p1,
+int __cdecl BN_mod_exp2_mont(BIGNUM *r, const BIGNUM *a1, const BIGNUM *p1,
                      const BIGNUM *a2, const BIGNUM *p2, const BIGNUM *m,
                      BN_CTX *ctx, BN_MONT_CTX *m_ctx);
-int BN_mod_exp_simple(BIGNUM *r, const BIGNUM *a, const BIGNUM *p,
+int __cdecl BN_mod_exp_simple(BIGNUM *r, const BIGNUM *a, const BIGNUM *p,
                       const BIGNUM *m, BN_CTX *ctx);
 
-int BN_mask_bits(BIGNUM *a, int n);
+int __cdecl BN_mask_bits(BIGNUM *a, int n);
 # ifndef OPENSSL_NO_STDIO
-int BN_print_fp(FILE *fp, const BIGNUM *a);
+int __cdecl BN_print_fp(FILE *fp, const BIGNUM *a);
 # endif
-int BN_print(BIO *bio, const BIGNUM *a);
-int BN_reciprocal(BIGNUM *r, const BIGNUM *m, int len, BN_CTX *ctx);
-int BN_rshift(BIGNUM *r, const BIGNUM *a, int n);
-int BN_rshift1(BIGNUM *r, const BIGNUM *a);
-void BN_clear(BIGNUM *a);
-BIGNUM *BN_dup(const BIGNUM *a);
-int BN_ucmp(const BIGNUM *a, const BIGNUM *b);
-int BN_set_bit(BIGNUM *a, int n);
-int BN_clear_bit(BIGNUM *a, int n);
-char *BN_bn2hex(const BIGNUM *a);
-char *BN_bn2dec(const BIGNUM *a);
-int BN_hex2bn(BIGNUM **a, const char *str);
-int BN_dec2bn(BIGNUM **a, const char *str);
-int BN_asc2bn(BIGNUM **a, const char *str);
-int BN_gcd(BIGNUM *r, const BIGNUM *a, const BIGNUM *b, BN_CTX *ctx);
-int BN_kronecker(const BIGNUM *a, const BIGNUM *b, BN_CTX *ctx); /* returns
+int __cdecl BN_print(BIO *bio, const BIGNUM *a);
+int __cdecl BN_reciprocal(BIGNUM *r, const BIGNUM *m, int len, BN_CTX *ctx);
+int __cdecl BN_rshift(BIGNUM *r, const BIGNUM *a, int n);
+int __cdecl BN_rshift1(BIGNUM *r, const BIGNUM *a);
+void __cdecl BN_clear(BIGNUM *a);
+BIGNUM * __cdecl BN_dup(const BIGNUM *a);
+int __cdecl BN_ucmp(const BIGNUM *a, const BIGNUM *b);
+int __cdecl BN_set_bit(BIGNUM *a, int n);
+int __cdecl BN_clear_bit(BIGNUM *a, int n);
+char * __cdecl BN_bn2hex(const BIGNUM *a);
+char * __cdecl BN_bn2dec(const BIGNUM *a);
+int __cdecl BN_hex2bn(BIGNUM **a, const char *str);
+int __cdecl BN_dec2bn(BIGNUM **a, const char *str);
+int __cdecl BN_asc2bn(BIGNUM **a, const char *str);
+int __cdecl BN_gcd(BIGNUM *r, const BIGNUM *a, const BIGNUM *b, BN_CTX *ctx);
+int __cdecl BN_kronecker(const BIGNUM *a, const BIGNUM *b, BN_CTX *ctx); /* returns
                                                                   * -2 for
                                                                   * error */
-BIGNUM *BN_mod_inverse(BIGNUM *ret,
+BIGNUM * __cdecl BN_mod_inverse(BIGNUM *ret,
                        const BIGNUM *a, const BIGNUM *n, BN_CTX *ctx);
-BIGNUM *BN_mod_sqrt(BIGNUM *ret,
+BIGNUM * __cdecl BN_mod_sqrt(BIGNUM *ret,
                     const BIGNUM *a, const BIGNUM *n, BN_CTX *ctx);
 
-void BN_consttime_swap(BN_ULONG swap, BIGNUM *a, BIGNUM *b, int nwords);
+void __cdecl BN_consttime_swap(BN_ULONG swap, BIGNUM *a, BIGNUM *b, int nwords);
 
 /* Deprecated versions */
 DEPRECATEDIN_0_9_8(BIGNUM *BN_generate_prime(BIGNUM *ret, int bits, int safe,
@@ -340,58 +340,58 @@ DEPRECATEDIN_0_9_8(int
                                         int do_trial_division))
 
 /* Newer versions */
-int BN_generate_prime_ex(BIGNUM *ret, int bits, int safe, const BIGNUM *add,
+int __cdecl BN_generate_prime_ex(BIGNUM *ret, int bits, int safe, const BIGNUM *add,
                          const BIGNUM *rem, BN_GENCB *cb);
-int BN_is_prime_ex(const BIGNUM *p, int nchecks, BN_CTX *ctx, BN_GENCB *cb);
-int BN_is_prime_fasttest_ex(const BIGNUM *p, int nchecks, BN_CTX *ctx,
+int __cdecl BN_is_prime_ex(const BIGNUM *p, int nchecks, BN_CTX *ctx, BN_GENCB *cb);
+int __cdecl BN_is_prime_fasttest_ex(const BIGNUM *p, int nchecks, BN_CTX *ctx,
                             int do_trial_division, BN_GENCB *cb);
 
-int BN_X931_generate_Xpq(BIGNUM *Xp, BIGNUM *Xq, int nbits, BN_CTX *ctx);
+int __cdecl BN_X931_generate_Xpq(BIGNUM *Xp, BIGNUM *Xq, int nbits, BN_CTX *ctx);
 
-int BN_X931_derive_prime_ex(BIGNUM *p, BIGNUM *p1, BIGNUM *p2,
+int __cdecl BN_X931_derive_prime_ex(BIGNUM *p, BIGNUM *p1, BIGNUM *p2,
                             const BIGNUM *Xp, const BIGNUM *Xp1,
                             const BIGNUM *Xp2, const BIGNUM *e, BN_CTX *ctx,
                             BN_GENCB *cb);
-int BN_X931_generate_prime_ex(BIGNUM *p, BIGNUM *p1, BIGNUM *p2, BIGNUM *Xp1,
+int __cdecl BN_X931_generate_prime_ex(BIGNUM *p, BIGNUM *p1, BIGNUM *p2, BIGNUM *Xp1,
                               BIGNUM *Xp2, const BIGNUM *Xp, const BIGNUM *e,
                               BN_CTX *ctx, BN_GENCB *cb);
 
-BN_MONT_CTX *BN_MONT_CTX_new(void);
-int BN_mod_mul_montgomery(BIGNUM *r, const BIGNUM *a, const BIGNUM *b,
+BN_MONT_CTX * __cdecl BN_MONT_CTX_new(void);
+int __cdecl BN_mod_mul_montgomery(BIGNUM *r, const BIGNUM *a, const BIGNUM *b,
                           BN_MONT_CTX *mont, BN_CTX *ctx);
-int BN_to_montgomery(BIGNUM *r, const BIGNUM *a, BN_MONT_CTX *mont,
+int __cdecl BN_to_montgomery(BIGNUM *r, const BIGNUM *a, BN_MONT_CTX *mont,
                      BN_CTX *ctx);
-int BN_from_montgomery(BIGNUM *r, const BIGNUM *a, BN_MONT_CTX *mont,
+int __cdecl BN_from_montgomery(BIGNUM *r, const BIGNUM *a, BN_MONT_CTX *mont,
                        BN_CTX *ctx);
-void BN_MONT_CTX_free(BN_MONT_CTX *mont);
-int BN_MONT_CTX_set(BN_MONT_CTX *mont, const BIGNUM *mod, BN_CTX *ctx);
-BN_MONT_CTX *BN_MONT_CTX_copy(BN_MONT_CTX *to, BN_MONT_CTX *from);
-BN_MONT_CTX *BN_MONT_CTX_set_locked(BN_MONT_CTX **pmont, CRYPTO_RWLOCK *lock,
+void __cdecl BN_MONT_CTX_free(BN_MONT_CTX *mont);
+int __cdecl BN_MONT_CTX_set(BN_MONT_CTX *mont, const BIGNUM *mod, BN_CTX *ctx);
+BN_MONT_CTX * __cdecl BN_MONT_CTX_copy(BN_MONT_CTX *to, BN_MONT_CTX *from);
+BN_MONT_CTX * __cdecl BN_MONT_CTX_set_locked(BN_MONT_CTX **pmont, CRYPTO_RWLOCK *lock,
                                     const BIGNUM *mod, BN_CTX *ctx);
 
 /* BN_BLINDING flags */
 # define BN_BLINDING_NO_UPDATE   0x00000001
 # define BN_BLINDING_NO_RECREATE 0x00000002
 
-BN_BLINDING *BN_BLINDING_new(const BIGNUM *A, const BIGNUM *Ai, BIGNUM *mod);
-void BN_BLINDING_free(BN_BLINDING *b);
-int BN_BLINDING_update(BN_BLINDING *b, BN_CTX *ctx);
-int BN_BLINDING_convert(BIGNUM *n, BN_BLINDING *b, BN_CTX *ctx);
-int BN_BLINDING_invert(BIGNUM *n, BN_BLINDING *b, BN_CTX *ctx);
-int BN_BLINDING_convert_ex(BIGNUM *n, BIGNUM *r, BN_BLINDING *b, BN_CTX *);
-int BN_BLINDING_invert_ex(BIGNUM *n, const BIGNUM *r, BN_BLINDING *b,
+BN_BLINDING * __cdecl BN_BLINDING_new(const BIGNUM *A, const BIGNUM *Ai, BIGNUM *mod);
+void __cdecl BN_BLINDING_free(BN_BLINDING *b);
+int __cdecl BN_BLINDING_update(BN_BLINDING *b, BN_CTX *ctx);
+int __cdecl BN_BLINDING_convert(BIGNUM *n, BN_BLINDING *b, BN_CTX *ctx);
+int __cdecl BN_BLINDING_invert(BIGNUM *n, BN_BLINDING *b, BN_CTX *ctx);
+int __cdecl BN_BLINDING_convert_ex(BIGNUM *n, BIGNUM *r, BN_BLINDING *b, BN_CTX *);
+int __cdecl BN_BLINDING_invert_ex(BIGNUM *n, const BIGNUM *r, BN_BLINDING *b,
                           BN_CTX *);
 
-int BN_BLINDING_is_current_thread(BN_BLINDING *b);
-void BN_BLINDING_set_current_thread(BN_BLINDING *b);
-int BN_BLINDING_lock(BN_BLINDING *b);
-int BN_BLINDING_unlock(BN_BLINDING *b);
+int __cdecl BN_BLINDING_is_current_thread(BN_BLINDING *b);
+void __cdecl BN_BLINDING_set_current_thread(BN_BLINDING *b);
+int __cdecl BN_BLINDING_lock(BN_BLINDING *b);
+int __cdecl BN_BLINDING_unlock(BN_BLINDING *b);
 
-unsigned long BN_BLINDING_get_flags(const BN_BLINDING *);
-void BN_BLINDING_set_flags(BN_BLINDING *, unsigned long);
-BN_BLINDING *BN_BLINDING_create_param(BN_BLINDING *b,
+unsigned long __cdecl BN_BLINDING_get_flags(const BN_BLINDING *);
+void __cdecl BN_BLINDING_set_flags(BN_BLINDING *, unsigned long);
+BN_BLINDING * __cdecl BN_BLINDING_create_param(BN_BLINDING *b,
                                       const BIGNUM *e, BIGNUM *m, BN_CTX *ctx,
-                                      int (*bn_mod_exp) (BIGNUM *r,
+                                      int (__cdecl *bn_mod_exp) (BIGNUM *r,
                                                          const BIGNUM *a,
                                                          const BIGNUM *p,
                                                          const BIGNUM *m,
@@ -403,14 +403,14 @@ DEPRECATEDIN_0_9_8(void BN_set_params(int mul, int high, int low, int mont))
 DEPRECATEDIN_0_9_8(int BN_get_params(int which)) /* 0, mul, 1 high, 2 low, 3
                                                   * mont */
 
-BN_RECP_CTX *BN_RECP_CTX_new(void);
-void BN_RECP_CTX_free(BN_RECP_CTX *recp);
-int BN_RECP_CTX_set(BN_RECP_CTX *recp, const BIGNUM *rdiv, BN_CTX *ctx);
-int BN_mod_mul_reciprocal(BIGNUM *r, const BIGNUM *x, const BIGNUM *y,
+BN_RECP_CTX * __cdecl BN_RECP_CTX_new(void);
+void __cdecl BN_RECP_CTX_free(BN_RECP_CTX *recp);
+int __cdecl BN_RECP_CTX_set(BN_RECP_CTX *recp, const BIGNUM *rdiv, BN_CTX *ctx);
+int __cdecl BN_mod_mul_reciprocal(BIGNUM *r, const BIGNUM *x, const BIGNUM *y,
                           BN_RECP_CTX *recp, BN_CTX *ctx);
-int BN_mod_exp_recp(BIGNUM *r, const BIGNUM *a, const BIGNUM *p,
+int __cdecl BN_mod_exp_recp(BIGNUM *r, const BIGNUM *a, const BIGNUM *p,
                     const BIGNUM *m, BN_CTX *ctx);
-int BN_div_recp(BIGNUM *dv, BIGNUM *rem, const BIGNUM *m,
+int __cdecl BN_div_recp(BIGNUM *dv, BIGNUM *rem, const BIGNUM *m,
                 BN_RECP_CTX *recp, BN_CTX *ctx);
 
 # ifndef OPENSSL_NO_EC2M
@@ -425,30 +425,30 @@ int BN_div_recp(BIGNUM *dv, BIGNUM *rem, const BIGNUM *m,
 /*
  * r = a + b
  */
-int BN_GF2m_add(BIGNUM *r, const BIGNUM *a, const BIGNUM *b);
+int __cdecl BN_GF2m_add(BIGNUM *r, const BIGNUM *a, const BIGNUM *b);
 #  define BN_GF2m_sub(r, a, b) BN_GF2m_add(r, a, b)
 /*
  * r=a mod p
  */
-int BN_GF2m_mod(BIGNUM *r, const BIGNUM *a, const BIGNUM *p);
+int __cdecl BN_GF2m_mod(BIGNUM *r, const BIGNUM *a, const BIGNUM *p);
 /* r = (a * b) mod p */
-int BN_GF2m_mod_mul(BIGNUM *r, const BIGNUM *a, const BIGNUM *b,
+int __cdecl BN_GF2m_mod_mul(BIGNUM *r, const BIGNUM *a, const BIGNUM *b,
                     const BIGNUM *p, BN_CTX *ctx);
 /* r = (a * a) mod p */
-int BN_GF2m_mod_sqr(BIGNUM *r, const BIGNUM *a, const BIGNUM *p, BN_CTX *ctx);
+int __cdecl BN_GF2m_mod_sqr(BIGNUM *r, const BIGNUM *a, const BIGNUM *p, BN_CTX *ctx);
 /* r = (1 / b) mod p */
-int BN_GF2m_mod_inv(BIGNUM *r, const BIGNUM *b, const BIGNUM *p, BN_CTX *ctx);
+int __cdecl BN_GF2m_mod_inv(BIGNUM *r, const BIGNUM *b, const BIGNUM *p, BN_CTX *ctx);
 /* r = (a / b) mod p */
-int BN_GF2m_mod_div(BIGNUM *r, const BIGNUM *a, const BIGNUM *b,
+int __cdecl BN_GF2m_mod_div(BIGNUM *r, const BIGNUM *a, const BIGNUM *b,
                     const BIGNUM *p, BN_CTX *ctx);
 /* r = (a ^ b) mod p */
-int BN_GF2m_mod_exp(BIGNUM *r, const BIGNUM *a, const BIGNUM *b,
+int __cdecl BN_GF2m_mod_exp(BIGNUM *r, const BIGNUM *a, const BIGNUM *b,
                     const BIGNUM *p, BN_CTX *ctx);
 /* r = sqrt(a) mod p */
-int BN_GF2m_mod_sqrt(BIGNUM *r, const BIGNUM *a, const BIGNUM *p,
+int __cdecl BN_GF2m_mod_sqrt(BIGNUM *r, const BIGNUM *a, const BIGNUM *p,
                      BN_CTX *ctx);
 /* r^2 + r = a mod p */
-int BN_GF2m_mod_solve_quad(BIGNUM *r, const BIGNUM *a, const BIGNUM *p,
+int __cdecl BN_GF2m_mod_solve_quad(BIGNUM *r, const BIGNUM *a, const BIGNUM *p,
                            BN_CTX *ctx);
 #  define BN_GF2m_cmp(a, b) BN_ucmp((a), (b))
 /*-
@@ -458,66 +458,66 @@ int BN_GF2m_mod_solve_quad(BIGNUM *r, const BIGNUM *a, const BIGNUM *p,
  * where m = p[0] > p[1] > ... > p[k] = 0.
  */
 /* r = a mod p */
-int BN_GF2m_mod_arr(BIGNUM *r, const BIGNUM *a, const int p[]);
+int __cdecl BN_GF2m_mod_arr(BIGNUM *r, const BIGNUM *a, const int p[]);
 /* r = (a * b) mod p */
-int BN_GF2m_mod_mul_arr(BIGNUM *r, const BIGNUM *a, const BIGNUM *b,
+int __cdecl BN_GF2m_mod_mul_arr(BIGNUM *r, const BIGNUM *a, const BIGNUM *b,
                         const int p[], BN_CTX *ctx);
 /* r = (a * a) mod p */
-int BN_GF2m_mod_sqr_arr(BIGNUM *r, const BIGNUM *a, const int p[],
+int __cdecl BN_GF2m_mod_sqr_arr(BIGNUM *r, const BIGNUM *a, const int p[],
                         BN_CTX *ctx);
 /* r = (1 / b) mod p */
-int BN_GF2m_mod_inv_arr(BIGNUM *r, const BIGNUM *b, const int p[],
+int __cdecl BN_GF2m_mod_inv_arr(BIGNUM *r, const BIGNUM *b, const int p[],
                         BN_CTX *ctx);
 /* r = (a / b) mod p */
-int BN_GF2m_mod_div_arr(BIGNUM *r, const BIGNUM *a, const BIGNUM *b,
+int __cdecl BN_GF2m_mod_div_arr(BIGNUM *r, const BIGNUM *a, const BIGNUM *b,
                         const int p[], BN_CTX *ctx);
 /* r = (a ^ b) mod p */
-int BN_GF2m_mod_exp_arr(BIGNUM *r, const BIGNUM *a, const BIGNUM *b,
+int __cdecl BN_GF2m_mod_exp_arr(BIGNUM *r, const BIGNUM *a, const BIGNUM *b,
                         const int p[], BN_CTX *ctx);
 /* r = sqrt(a) mod p */
-int BN_GF2m_mod_sqrt_arr(BIGNUM *r, const BIGNUM *a,
+int __cdecl BN_GF2m_mod_sqrt_arr(BIGNUM *r, const BIGNUM *a,
                          const int p[], BN_CTX *ctx);
 /* r^2 + r = a mod p */
-int BN_GF2m_mod_solve_quad_arr(BIGNUM *r, const BIGNUM *a,
+int __cdecl BN_GF2m_mod_solve_quad_arr(BIGNUM *r, const BIGNUM *a,
                                const int p[], BN_CTX *ctx);
-int BN_GF2m_poly2arr(const BIGNUM *a, int p[], int max);
-int BN_GF2m_arr2poly(const int p[], BIGNUM *a);
+int __cdecl BN_GF2m_poly2arr(const BIGNUM *a, int p[], int max);
+int __cdecl BN_GF2m_arr2poly(const int p[], BIGNUM *a);
 
 # endif
 
 /*
  * faster mod functions for the 'NIST primes' 0 <= a < p^2
  */
-int BN_nist_mod_192(BIGNUM *r, const BIGNUM *a, const BIGNUM *p, BN_CTX *ctx);
-int BN_nist_mod_224(BIGNUM *r, const BIGNUM *a, const BIGNUM *p, BN_CTX *ctx);
-int BN_nist_mod_256(BIGNUM *r, const BIGNUM *a, const BIGNUM *p, BN_CTX *ctx);
-int BN_nist_mod_384(BIGNUM *r, const BIGNUM *a, const BIGNUM *p, BN_CTX *ctx);
-int BN_nist_mod_521(BIGNUM *r, const BIGNUM *a, const BIGNUM *p, BN_CTX *ctx);
-
-const BIGNUM *BN_get0_nist_prime_192(void);
-const BIGNUM *BN_get0_nist_prime_224(void);
-const BIGNUM *BN_get0_nist_prime_256(void);
-const BIGNUM *BN_get0_nist_prime_384(void);
-const BIGNUM *BN_get0_nist_prime_521(void);
-
-int (*BN_nist_mod_func(const BIGNUM *p)) (BIGNUM *r, const BIGNUM *a,
+int __cdecl BN_nist_mod_192(BIGNUM *r, const BIGNUM *a, const BIGNUM *p, BN_CTX *ctx);
+int __cdecl BN_nist_mod_224(BIGNUM *r, const BIGNUM *a, const BIGNUM *p, BN_CTX *ctx);
+int __cdecl BN_nist_mod_256(BIGNUM *r, const BIGNUM *a, const BIGNUM *p, BN_CTX *ctx);
+int __cdecl BN_nist_mod_384(BIGNUM *r, const BIGNUM *a, const BIGNUM *p, BN_CTX *ctx);
+int __cdecl BN_nist_mod_521(BIGNUM *r, const BIGNUM *a, const BIGNUM *p, BN_CTX *ctx);
+
+const BIGNUM * __cdecl BN_get0_nist_prime_192(void);
+const BIGNUM * __cdecl BN_get0_nist_prime_224(void);
+const BIGNUM * __cdecl BN_get0_nist_prime_256(void);
+const BIGNUM * __cdecl BN_get0_nist_prime_384(void);
+const BIGNUM * __cdecl BN_get0_nist_prime_521(void);
+
+int (__cdecl *BN_nist_mod_func(const BIGNUM *p)) (BIGNUM *r, const BIGNUM *a,
                                           const BIGNUM *field, BN_CTX *ctx);
 
-int BN_generate_dsa_nonce(BIGNUM *out, const BIGNUM *range,
+int __cdecl BN_generate_dsa_nonce(BIGNUM *out, const BIGNUM *range,
                           const BIGNUM *priv, const unsigned char *message,
                           size_t message_len, BN_CTX *ctx);
 
 /* Primes from RFC 2409 */
-BIGNUM *BN_get_rfc2409_prime_768(BIGNUM *bn);
-BIGNUM *BN_get_rfc2409_prime_1024(BIGNUM *bn);
+BIGNUM * __cdecl BN_get_rfc2409_prime_768(BIGNUM *bn);
+BIGNUM * __cdecl BN_get_rfc2409_prime_1024(BIGNUM *bn);
 
 /* Primes from RFC 3526 */
-BIGNUM *BN_get_rfc3526_prime_1536(BIGNUM *bn);
-BIGNUM *BN_get_rfc3526_prime_2048(BIGNUM *bn);
-BIGNUM *BN_get_rfc3526_prime_3072(BIGNUM *bn);
-BIGNUM *BN_get_rfc3526_prime_4096(BIGNUM *bn);
-BIGNUM *BN_get_rfc3526_prime_6144(BIGNUM *bn);
-BIGNUM *BN_get_rfc3526_prime_8192(BIGNUM *bn);
+BIGNUM * __cdecl BN_get_rfc3526_prime_1536(BIGNUM *bn);
+BIGNUM * __cdecl BN_get_rfc3526_prime_2048(BIGNUM *bn);
+BIGNUM * __cdecl BN_get_rfc3526_prime_3072(BIGNUM *bn);
+BIGNUM * __cdecl BN_get_rfc3526_prime_4096(BIGNUM *bn);
+BIGNUM * __cdecl BN_get_rfc3526_prime_6144(BIGNUM *bn);
+BIGNUM * __cdecl BN_get_rfc3526_prime_8192(BIGNUM *bn);
 
 # if OPENSSL_API_COMPAT < 0x10100000L
 #  define get_rfc2409_prime_768 BN_get_rfc2409_prime_768
@@ -530,7 +530,7 @@ BIGNUM *BN_get_rfc3526_prime_8192(BIGNUM *bn);
 #  define get_rfc3526_prime_8192 BN_get_rfc3526_prime_8192
 # endif
 
-int BN_bntest_rand(BIGNUM *rnd, int bits, int top, int bottom);
+int __cdecl BN_bntest_rand(BIGNUM *rnd, int bits, int top, int bottom);
 
 
 # ifdef  __cplusplus
diff --git a/include/openssl/bnerr.h b/include/openssl/bnerr.h
index 9f3c7cfaab..0cd520583b 100644
--- a/include/openssl/bnerr.h
+++ b/include/openssl/bnerr.h
@@ -18,7 +18,7 @@
 # ifdef  __cplusplus
 extern "C"
 # endif
-int ERR_load_BN_strings(void);
+int __cdecl ERR_load_BN_strings(void);
 
 /*
  * BN function codes.
diff --git a/include/openssl/buffer.h b/include/openssl/buffer.h
index d2765766b7..951f045fc3 100644
--- a/include/openssl/buffer.h
+++ b/include/openssl/buffer.h
@@ -44,12 +44,12 @@ struct buf_mem_st {
 
 # define BUF_MEM_FLAG_SECURE  0x01
 
-BUF_MEM *BUF_MEM_new(void);
-BUF_MEM *BUF_MEM_new_ex(unsigned long flags);
-void BUF_MEM_free(BUF_MEM *a);
-size_t BUF_MEM_grow(BUF_MEM *str, size_t len);
-size_t BUF_MEM_grow_clean(BUF_MEM *str, size_t len);
-void BUF_reverse(unsigned char *out, const unsigned char *in, size_t siz);
+BUF_MEM * __cdecl BUF_MEM_new(void);
+BUF_MEM * __cdecl BUF_MEM_new_ex(unsigned long flags);
+void __cdecl BUF_MEM_free(BUF_MEM *a);
+size_t __cdecl BUF_MEM_grow(BUF_MEM *str, size_t len);
+size_t __cdecl BUF_MEM_grow_clean(BUF_MEM *str, size_t len);
+void __cdecl BUF_reverse(unsigned char *out, const unsigned char *in, size_t siz);
 
 
 # ifdef  __cplusplus
diff --git a/include/openssl/buffererr.h b/include/openssl/buffererr.h
index 04f6ff7a83..0a3c910d10 100644
--- a/include/openssl/buffererr.h
+++ b/include/openssl/buffererr.h
@@ -18,7 +18,7 @@
 # ifdef  __cplusplus
 extern "C"
 # endif
-int ERR_load_BUF_strings(void);
+int __cdecl ERR_load_BUF_strings(void);
 
 /*
  * BUF function codes.
diff --git a/include/openssl/camellia.h b/include/openssl/camellia.h
index 151f3c1349..c4d15f7db7 100644
--- a/include/openssl/camellia.h
+++ b/include/openssl/camellia.h
@@ -44,32 +44,32 @@ struct camellia_key_st {
 };
 typedef struct camellia_key_st CAMELLIA_KEY;
 
-int Camellia_set_key(const unsigned char *userKey, const int bits,
+int __cdecl Camellia_set_key(const unsigned char *userKey, const int bits,
                      CAMELLIA_KEY *key);
 
-void Camellia_encrypt(const unsigned char *in, unsigned char *out,
+void __cdecl Camellia_encrypt(const unsigned char *in, unsigned char *out,
                       const CAMELLIA_KEY *key);
-void Camellia_decrypt(const unsigned char *in, unsigned char *out,
+void __cdecl Camellia_decrypt(const unsigned char *in, unsigned char *out,
                       const CAMELLIA_KEY *key);
 
-void Camellia_ecb_encrypt(const unsigned char *in, unsigned char *out,
+void __cdecl Camellia_ecb_encrypt(const unsigned char *in, unsigned char *out,
                           const CAMELLIA_KEY *key, const int enc);
-void Camellia_cbc_encrypt(const unsigned char *in, unsigned char *out,
+void __cdecl Camellia_cbc_encrypt(const unsigned char *in, unsigned char *out,
                           size_t length, const CAMELLIA_KEY *key,
                           unsigned char *ivec, const int enc);
-void Camellia_cfb128_encrypt(const unsigned char *in, unsigned char *out,
+void __cdecl Camellia_cfb128_encrypt(const unsigned char *in, unsigned char *out,
                              size_t length, const CAMELLIA_KEY *key,
                              unsigned char *ivec, int *num, const int enc);
-void Camellia_cfb1_encrypt(const unsigned char *in, unsigned char *out,
+void __cdecl Camellia_cfb1_encrypt(const unsigned char *in, unsigned char *out,
                            size_t length, const CAMELLIA_KEY *key,
                            unsigned char *ivec, int *num, const int enc);
-void Camellia_cfb8_encrypt(const unsigned char *in, unsigned char *out,
+void __cdecl Camellia_cfb8_encrypt(const unsigned char *in, unsigned char *out,
                            size_t length, const CAMELLIA_KEY *key,
                            unsigned char *ivec, int *num, const int enc);
-void Camellia_ofb128_encrypt(const unsigned char *in, unsigned char *out,
+void __cdecl Camellia_ofb128_encrypt(const unsigned char *in, unsigned char *out,
                              size_t length, const CAMELLIA_KEY *key,
                              unsigned char *ivec, int *num);
-void Camellia_ctr128_encrypt(const unsigned char *in, unsigned char *out,
+void __cdecl Camellia_ctr128_encrypt(const unsigned char *in, unsigned char *out,
                              size_t length, const CAMELLIA_KEY *key,
                              unsigned char ivec[CAMELLIA_BLOCK_SIZE],
                              unsigned char ecount_buf[CAMELLIA_BLOCK_SIZE],
diff --git a/include/openssl/cast.h b/include/openssl/cast.h
index 2cc89ae013..095dc41b85 100644
--- a/include/openssl/cast.h
+++ b/include/openssl/cast.h
@@ -30,18 +30,18 @@ typedef struct cast_key_st {
     int short_key;              /* Use reduced rounds for short key */
 } CAST_KEY;
 
-void CAST_set_key(CAST_KEY *key, int len, const unsigned char *data);
-void CAST_ecb_encrypt(const unsigned char *in, unsigned char *out,
+void __cdecl CAST_set_key(CAST_KEY *key, int len, const unsigned char *data);
+void __cdecl CAST_ecb_encrypt(const unsigned char *in, unsigned char *out,
                       const CAST_KEY *key, int enc);
-void CAST_encrypt(CAST_LONG *data, const CAST_KEY *key);
-void CAST_decrypt(CAST_LONG *data, const CAST_KEY *key);
-void CAST_cbc_encrypt(const unsigned char *in, unsigned char *out,
+void __cdecl CAST_encrypt(CAST_LONG *data, const CAST_KEY *key);
+void __cdecl CAST_decrypt(CAST_LONG *data, const CAST_KEY *key);
+void __cdecl CAST_cbc_encrypt(const unsigned char *in, unsigned char *out,
                       long length, const CAST_KEY *ks, unsigned char *iv,
                       int enc);
-void CAST_cfb64_encrypt(const unsigned char *in, unsigned char *out,
+void __cdecl CAST_cfb64_encrypt(const unsigned char *in, unsigned char *out,
                         long length, const CAST_KEY *schedule,
                         unsigned char *ivec, int *num, int enc);
-void CAST_ofb64_encrypt(const unsigned char *in, unsigned char *out,
+void __cdecl CAST_ofb64_encrypt(const unsigned char *in, unsigned char *out,
                         long length, const CAST_KEY *schedule,
                         unsigned char *ivec, int *num);
 
diff --git a/include/openssl/cmac.h b/include/openssl/cmac.h
index 3535a9abf7..0e390a4e5d 100644
--- a/include/openssl/cmac.h
+++ b/include/openssl/cmac.h
@@ -21,17 +21,17 @@ extern "C" {
 /* Opaque */
 typedef struct CMAC_CTX_st CMAC_CTX;
 
-CMAC_CTX *CMAC_CTX_new(void);
-void CMAC_CTX_cleanup(CMAC_CTX *ctx);
-void CMAC_CTX_free(CMAC_CTX *ctx);
-EVP_CIPHER_CTX *CMAC_CTX_get0_cipher_ctx(CMAC_CTX *ctx);
-int CMAC_CTX_copy(CMAC_CTX *out, const CMAC_CTX *in);
+CMAC_CTX * __cdecl CMAC_CTX_new(void);
+void __cdecl CMAC_CTX_cleanup(CMAC_CTX *ctx);
+void __cdecl CMAC_CTX_free(CMAC_CTX *ctx);
+EVP_CIPHER_CTX * __cdecl CMAC_CTX_get0_cipher_ctx(CMAC_CTX *ctx);
+int __cdecl CMAC_CTX_copy(CMAC_CTX *out, const CMAC_CTX *in);
 
-int CMAC_Init(CMAC_CTX *ctx, const void *key, size_t keylen,
+int __cdecl CMAC_Init(CMAC_CTX *ctx, const void *key, size_t keylen,
               const EVP_CIPHER *cipher, ENGINE *impl);
-int CMAC_Update(CMAC_CTX *ctx, const void *data, size_t dlen);
-int CMAC_Final(CMAC_CTX *ctx, unsigned char *out, size_t *poutlen);
-int CMAC_resume(CMAC_CTX *ctx);
+int __cdecl CMAC_Update(CMAC_CTX *ctx, const void *data, size_t dlen);
+int __cdecl CMAC_Final(CMAC_CTX *ctx, unsigned char *out, size_t *poutlen);
+int __cdecl CMAC_resume(CMAC_CTX *ctx);
 
 #ifdef  __cplusplus
 }
diff --git a/include/openssl/cms.h b/include/openssl/cms.h
index c7627968c7..53350de147 100644
--- a/include/openssl/cms.h
+++ b/include/openssl/cms.h
@@ -74,257 +74,257 @@ DECLARE_ASN1_PRINT_FUNCTION(CMS_ContentInfo)
 # define CMS_KEY_PARAM                   0x40000
 # define CMS_ASCIICRLF                   0x80000
 
-const ASN1_OBJECT *CMS_get0_type(const CMS_ContentInfo *cms);
+const ASN1_OBJECT * __cdecl CMS_get0_type(const CMS_ContentInfo *cms);
 
-BIO *CMS_dataInit(CMS_ContentInfo *cms, BIO *icont);
-int CMS_dataFinal(CMS_ContentInfo *cms, BIO *bio);
+BIO * __cdecl CMS_dataInit(CMS_ContentInfo *cms, BIO *icont);
+int __cdecl CMS_dataFinal(CMS_ContentInfo *cms, BIO *bio);
 
-ASN1_OCTET_STRING **CMS_get0_content(CMS_ContentInfo *cms);
-int CMS_is_detached(CMS_ContentInfo *cms);
-int CMS_set_detached(CMS_ContentInfo *cms, int detached);
+ASN1_OCTET_STRING ** __cdecl CMS_get0_content(CMS_ContentInfo *cms);
+int __cdecl CMS_is_detached(CMS_ContentInfo *cms);
+int __cdecl CMS_set_detached(CMS_ContentInfo *cms, int detached);
 
 # ifdef HEADER_PEM_H
 DECLARE_PEM_rw_const(CMS, CMS_ContentInfo)
 # endif
-int CMS_stream(unsigned char ***boundary, CMS_ContentInfo *cms);
-CMS_ContentInfo *d2i_CMS_bio(BIO *bp, CMS_ContentInfo **cms);
-int i2d_CMS_bio(BIO *bp, CMS_ContentInfo *cms);
+int __cdecl CMS_stream(unsigned char ***boundary, CMS_ContentInfo *cms);
+CMS_ContentInfo * __cdecl d2i_CMS_bio(BIO *bp, CMS_ContentInfo **cms);
+int __cdecl i2d_CMS_bio(BIO *bp, CMS_ContentInfo *cms);
 
-BIO *BIO_new_CMS(BIO *out, CMS_ContentInfo *cms);
-int i2d_CMS_bio_stream(BIO *out, CMS_ContentInfo *cms, BIO *in, int flags);
-int PEM_write_bio_CMS_stream(BIO *out, CMS_ContentInfo *cms, BIO *in,
+BIO * __cdecl BIO_new_CMS(BIO *out, CMS_ContentInfo *cms);
+int __cdecl i2d_CMS_bio_stream(BIO *out, CMS_ContentInfo *cms, BIO *in, int flags);
+int __cdecl PEM_write_bio_CMS_stream(BIO *out, CMS_ContentInfo *cms, BIO *in,
                              int flags);
-CMS_ContentInfo *SMIME_read_CMS(BIO *bio, BIO **bcont);
-int SMIME_write_CMS(BIO *bio, CMS_ContentInfo *cms, BIO *data, int flags);
+CMS_ContentInfo * __cdecl SMIME_read_CMS(BIO *bio, BIO **bcont);
+int __cdecl SMIME_write_CMS(BIO *bio, CMS_ContentInfo *cms, BIO *data, int flags);
 
-int CMS_final(CMS_ContentInfo *cms, BIO *data, BIO *dcont,
+int __cdecl CMS_final(CMS_ContentInfo *cms, BIO *data, BIO *dcont,
               unsigned int flags);
 
-CMS_ContentInfo *CMS_sign(X509 *signcert, EVP_PKEY *pkey,
+CMS_ContentInfo * __cdecl CMS_sign(X509 *signcert, EVP_PKEY *pkey,
                           STACK_OF(X509) *certs, BIO *data,
                           unsigned int flags);
 
-CMS_ContentInfo *CMS_sign_receipt(CMS_SignerInfo *si,
+CMS_ContentInfo * __cdecl CMS_sign_receipt(CMS_SignerInfo *si,
                                   X509 *signcert, EVP_PKEY *pkey,
                                   STACK_OF(X509) *certs, unsigned int flags);
 
-int CMS_data(CMS_ContentInfo *cms, BIO *out, unsigned int flags);
-CMS_ContentInfo *CMS_data_create(BIO *in, unsigned int flags);
+int __cdecl CMS_data(CMS_ContentInfo *cms, BIO *out, unsigned int flags);
+CMS_ContentInfo * __cdecl CMS_data_create(BIO *in, unsigned int flags);
 
-int CMS_digest_verify(CMS_ContentInfo *cms, BIO *dcont, BIO *out,
+int __cdecl CMS_digest_verify(CMS_ContentInfo *cms, BIO *dcont, BIO *out,
                       unsigned int flags);
-CMS_ContentInfo *CMS_digest_create(BIO *in, const EVP_MD *md,
+CMS_ContentInfo * __cdecl CMS_digest_create(BIO *in, const EVP_MD *md,
                                    unsigned int flags);
 
-int CMS_EncryptedData_decrypt(CMS_ContentInfo *cms,
+int __cdecl CMS_EncryptedData_decrypt(CMS_ContentInfo *cms,
                               const unsigned char *key, size_t keylen,
                               BIO *dcont, BIO *out, unsigned int flags);
 
-CMS_ContentInfo *CMS_EncryptedData_encrypt(BIO *in, const EVP_CIPHER *cipher,
+CMS_ContentInfo * __cdecl CMS_EncryptedData_encrypt(BIO *in, const EVP_CIPHER *cipher,
                                            const unsigned char *key,
                                            size_t keylen, unsigned int flags);
 
-int CMS_EncryptedData_set1_key(CMS_ContentInfo *cms, const EVP_CIPHER *ciph,
+int __cdecl CMS_EncryptedData_set1_key(CMS_ContentInfo *cms, const EVP_CIPHER *ciph,
                                const unsigned char *key, size_t keylen);
 
-int CMS_verify(CMS_ContentInfo *cms, STACK_OF(X509) *certs,
+int __cdecl CMS_verify(CMS_ContentInfo *cms, STACK_OF(X509) *certs,
                X509_STORE *store, BIO *dcont, BIO *out, unsigned int flags);
 
-int CMS_verify_receipt(CMS_ContentInfo *rcms, CMS_ContentInfo *ocms,
+int __cdecl CMS_verify_receipt(CMS_ContentInfo *rcms, CMS_ContentInfo *ocms,
                        STACK_OF(X509) *certs,
                        X509_STORE *store, unsigned int flags);
 
-STACK_OF(X509) *CMS_get0_signers(CMS_ContentInfo *cms);
+STACK_OF(X509) * __cdecl CMS_get0_signers(CMS_ContentInfo *cms);
 
-CMS_ContentInfo *CMS_encrypt(STACK_OF(X509) *certs, BIO *in,
+CMS_ContentInfo * __cdecl CMS_encrypt(STACK_OF(X509) *certs, BIO *in,
                              const EVP_CIPHER *cipher, unsigned int flags);
 
-int CMS_decrypt(CMS_ContentInfo *cms, EVP_PKEY *pkey, X509 *cert,
+int __cdecl CMS_decrypt(CMS_ContentInfo *cms, EVP_PKEY *pkey, X509 *cert,
                 BIO *dcont, BIO *out, unsigned int flags);
 
-int CMS_decrypt_set1_pkey(CMS_ContentInfo *cms, EVP_PKEY *pk, X509 *cert);
-int CMS_decrypt_set1_key(CMS_ContentInfo *cms,
+int __cdecl CMS_decrypt_set1_pkey(CMS_ContentInfo *cms, EVP_PKEY *pk, X509 *cert);
+int __cdecl CMS_decrypt_set1_key(CMS_ContentInfo *cms,
                          unsigned char *key, size_t keylen,
                          const unsigned char *id, size_t idlen);
-int CMS_decrypt_set1_password(CMS_ContentInfo *cms,
+int __cdecl CMS_decrypt_set1_password(CMS_ContentInfo *cms,
                               unsigned char *pass, ossl_ssize_t passlen);
 
-STACK_OF(CMS_RecipientInfo) *CMS_get0_RecipientInfos(CMS_ContentInfo *cms);
-int CMS_RecipientInfo_type(CMS_RecipientInfo *ri);
-EVP_PKEY_CTX *CMS_RecipientInfo_get0_pkey_ctx(CMS_RecipientInfo *ri);
-CMS_ContentInfo *CMS_EnvelopedData_create(const EVP_CIPHER *cipher);
-CMS_RecipientInfo *CMS_add1_recipient_cert(CMS_ContentInfo *cms,
+STACK_OF(CMS_RecipientInfo) * __cdecl CMS_get0_RecipientInfos(CMS_ContentInfo *cms);
+int __cdecl CMS_RecipientInfo_type(CMS_RecipientInfo *ri);
+EVP_PKEY_CTX * __cdecl CMS_RecipientInfo_get0_pkey_ctx(CMS_RecipientInfo *ri);
+CMS_ContentInfo * __cdecl CMS_EnvelopedData_create(const EVP_CIPHER *cipher);
+CMS_RecipientInfo * __cdecl CMS_add1_recipient_cert(CMS_ContentInfo *cms,
                                            X509 *recip, unsigned int flags);
-int CMS_RecipientInfo_set0_pkey(CMS_RecipientInfo *ri, EVP_PKEY *pkey);
-int CMS_RecipientInfo_ktri_cert_cmp(CMS_RecipientInfo *ri, X509 *cert);
-int CMS_RecipientInfo_ktri_get0_algs(CMS_RecipientInfo *ri,
+int __cdecl CMS_RecipientInfo_set0_pkey(CMS_RecipientInfo *ri, EVP_PKEY *pkey);
+int __cdecl CMS_RecipientInfo_ktri_cert_cmp(CMS_RecipientInfo *ri, X509 *cert);
+int __cdecl CMS_RecipientInfo_ktri_get0_algs(CMS_RecipientInfo *ri,
                                      EVP_PKEY **pk, X509 **recip,
                                      X509_ALGOR **palg);
-int CMS_RecipientInfo_ktri_get0_signer_id(CMS_RecipientInfo *ri,
+int __cdecl CMS_RecipientInfo_ktri_get0_signer_id(CMS_RecipientInfo *ri,
                                           ASN1_OCTET_STRING **keyid,
                                           X509_NAME **issuer,
                                           ASN1_INTEGER **sno);
 
-CMS_RecipientInfo *CMS_add0_recipient_key(CMS_ContentInfo *cms, int nid,
+CMS_RecipientInfo * __cdecl CMS_add0_recipient_key(CMS_ContentInfo *cms, int nid,
                                           unsigned char *key, size_t keylen,
                                           unsigned char *id, size_t idlen,
                                           ASN1_GENERALIZEDTIME *date,
                                           ASN1_OBJECT *otherTypeId,
                                           ASN1_TYPE *otherType);
 
-int CMS_RecipientInfo_kekri_get0_id(CMS_RecipientInfo *ri,
+int __cdecl CMS_RecipientInfo_kekri_get0_id(CMS_RecipientInfo *ri,
                                     X509_ALGOR **palg,
                                     ASN1_OCTET_STRING **pid,
                                     ASN1_GENERALIZEDTIME **pdate,
                                     ASN1_OBJECT **potherid,
                                     ASN1_TYPE **pothertype);
 
-int CMS_RecipientInfo_set0_key(CMS_RecipientInfo *ri,
+int __cdecl CMS_RecipientInfo_set0_key(CMS_RecipientInfo *ri,
                                unsigned char *key, size_t keylen);
 
-int CMS_RecipientInfo_kekri_id_cmp(CMS_RecipientInfo *ri,
+int __cdecl CMS_RecipientInfo_kekri_id_cmp(CMS_RecipientInfo *ri,
                                    const unsigned char *id, size_t idlen);
 
-int CMS_RecipientInfo_set0_password(CMS_RecipientInfo *ri,
+int __cdecl CMS_RecipientInfo_set0_password(CMS_RecipientInfo *ri,
                                     unsigned char *pass,
                                     ossl_ssize_t passlen);
 
-CMS_RecipientInfo *CMS_add0_recipient_password(CMS_ContentInfo *cms,
+CMS_RecipientInfo * __cdecl CMS_add0_recipient_password(CMS_ContentInfo *cms,
                                                int iter, int wrap_nid,
                                                int pbe_nid,
                                                unsigned char *pass,
                                                ossl_ssize_t passlen,
                                                const EVP_CIPHER *kekciph);
 
-int CMS_RecipientInfo_decrypt(CMS_ContentInfo *cms, CMS_RecipientInfo *ri);
-int CMS_RecipientInfo_encrypt(CMS_ContentInfo *cms, CMS_RecipientInfo *ri);
+int __cdecl CMS_RecipientInfo_decrypt(CMS_ContentInfo *cms, CMS_RecipientInfo *ri);
+int __cdecl CMS_RecipientInfo_encrypt(CMS_ContentInfo *cms, CMS_RecipientInfo *ri);
 
-int CMS_uncompress(CMS_ContentInfo *cms, BIO *dcont, BIO *out,
+int __cdecl CMS_uncompress(CMS_ContentInfo *cms, BIO *dcont, BIO *out,
                    unsigned int flags);
-CMS_ContentInfo *CMS_compress(BIO *in, int comp_nid, unsigned int flags);
+CMS_ContentInfo * __cdecl CMS_compress(BIO *in, int comp_nid, unsigned int flags);
 
-int CMS_set1_eContentType(CMS_ContentInfo *cms, const ASN1_OBJECT *oid);
-const ASN1_OBJECT *CMS_get0_eContentType(CMS_ContentInfo *cms);
+int __cdecl CMS_set1_eContentType(CMS_ContentInfo *cms, const ASN1_OBJECT *oid);
+const ASN1_OBJECT * __cdecl CMS_get0_eContentType(CMS_ContentInfo *cms);
 
-CMS_CertificateChoices *CMS_add0_CertificateChoices(CMS_ContentInfo *cms);
-int CMS_add0_cert(CMS_ContentInfo *cms, X509 *cert);
-int CMS_add1_cert(CMS_ContentInfo *cms, X509 *cert);
-STACK_OF(X509) *CMS_get1_certs(CMS_ContentInfo *cms);
+CMS_CertificateChoices * __cdecl CMS_add0_CertificateChoices(CMS_ContentInfo *cms);
+int __cdecl CMS_add0_cert(CMS_ContentInfo *cms, X509 *cert);
+int __cdecl CMS_add1_cert(CMS_ContentInfo *cms, X509 *cert);
+STACK_OF(X509) * __cdecl CMS_get1_certs(CMS_ContentInfo *cms);
 
-CMS_RevocationInfoChoice *CMS_add0_RevocationInfoChoice(CMS_ContentInfo *cms);
-int CMS_add0_crl(CMS_ContentInfo *cms, X509_CRL *crl);
-int CMS_add1_crl(CMS_ContentInfo *cms, X509_CRL *crl);
-STACK_OF(X509_CRL) *CMS_get1_crls(CMS_ContentInfo *cms);
+CMS_RevocationInfoChoice * __cdecl CMS_add0_RevocationInfoChoice(CMS_ContentInfo *cms);
+int __cdecl CMS_add0_crl(CMS_ContentInfo *cms, X509_CRL *crl);
+int __cdecl CMS_add1_crl(CMS_ContentInfo *cms, X509_CRL *crl);
+STACK_OF(X509_CRL) * __cdecl CMS_get1_crls(CMS_ContentInfo *cms);
 
-int CMS_SignedData_init(CMS_ContentInfo *cms);
-CMS_SignerInfo *CMS_add1_signer(CMS_ContentInfo *cms,
+int __cdecl CMS_SignedData_init(CMS_ContentInfo *cms);
+CMS_SignerInfo * __cdecl CMS_add1_signer(CMS_ContentInfo *cms,
                                 X509 *signer, EVP_PKEY *pk, const EVP_MD *md,
                                 unsigned int flags);
-EVP_PKEY_CTX *CMS_SignerInfo_get0_pkey_ctx(CMS_SignerInfo *si);
-EVP_MD_CTX *CMS_SignerInfo_get0_md_ctx(CMS_SignerInfo *si);
-STACK_OF(CMS_SignerInfo) *CMS_get0_SignerInfos(CMS_ContentInfo *cms);
+EVP_PKEY_CTX * __cdecl CMS_SignerInfo_get0_pkey_ctx(CMS_SignerInfo *si);
+EVP_MD_CTX * __cdecl CMS_SignerInfo_get0_md_ctx(CMS_SignerInfo *si);
+STACK_OF(CMS_SignerInfo) * __cdecl CMS_get0_SignerInfos(CMS_ContentInfo *cms);
 
-void CMS_SignerInfo_set1_signer_cert(CMS_SignerInfo *si, X509 *signer);
-int CMS_SignerInfo_get0_signer_id(CMS_SignerInfo *si,
+void __cdecl CMS_SignerInfo_set1_signer_cert(CMS_SignerInfo *si, X509 *signer);
+int __cdecl CMS_SignerInfo_get0_signer_id(CMS_SignerInfo *si,
                                   ASN1_OCTET_STRING **keyid,
                                   X509_NAME **issuer, ASN1_INTEGER **sno);
-int CMS_SignerInfo_cert_cmp(CMS_SignerInfo *si, X509 *cert);
-int CMS_set1_signers_certs(CMS_ContentInfo *cms, STACK_OF(X509) *certs,
+int __cdecl CMS_SignerInfo_cert_cmp(CMS_SignerInfo *si, X509 *cert);
+int __cdecl CMS_set1_signers_certs(CMS_ContentInfo *cms, STACK_OF(X509) *certs,
                            unsigned int flags);
-void CMS_SignerInfo_get0_algs(CMS_SignerInfo *si, EVP_PKEY **pk,
+void __cdecl CMS_SignerInfo_get0_algs(CMS_SignerInfo *si, EVP_PKEY **pk,
                               X509 **signer, X509_ALGOR **pdig,
                               X509_ALGOR **psig);
-ASN1_OCTET_STRING *CMS_SignerInfo_get0_signature(CMS_SignerInfo *si);
-int CMS_SignerInfo_sign(CMS_SignerInfo *si);
-int CMS_SignerInfo_verify(CMS_SignerInfo *si);
-int CMS_SignerInfo_verify_content(CMS_SignerInfo *si, BIO *chain);
+ASN1_OCTET_STRING * __cdecl CMS_SignerInfo_get0_signature(CMS_SignerInfo *si);
+int __cdecl CMS_SignerInfo_sign(CMS_SignerInfo *si);
+int __cdecl CMS_SignerInfo_verify(CMS_SignerInfo *si);
+int __cdecl CMS_SignerInfo_verify_content(CMS_SignerInfo *si, BIO *chain);
 
-int CMS_add_smimecap(CMS_SignerInfo *si, STACK_OF(X509_ALGOR) *algs);
-int CMS_add_simple_smimecap(STACK_OF(X509_ALGOR) **algs,
+int __cdecl CMS_add_smimecap(CMS_SignerInfo *si, STACK_OF(X509_ALGOR) *algs);
+int __cdecl CMS_add_simple_smimecap(STACK_OF(X509_ALGOR) **algs,
                             int algnid, int keysize);
-int CMS_add_standard_smimecap(STACK_OF(X509_ALGOR) **smcap);
+int __cdecl CMS_add_standard_smimecap(STACK_OF(X509_ALGOR) **smcap);
 
-int CMS_signed_get_attr_count(const CMS_SignerInfo *si);
-int CMS_signed_get_attr_by_NID(const CMS_SignerInfo *si, int nid,
+int __cdecl CMS_signed_get_attr_count(const CMS_SignerInfo *si);
+int __cdecl CMS_signed_get_attr_by_NID(const CMS_SignerInfo *si, int nid,
                                int lastpos);
-int CMS_signed_get_attr_by_OBJ(const CMS_SignerInfo *si, const ASN1_OBJECT *obj,
+int __cdecl CMS_signed_get_attr_by_OBJ(const CMS_SignerInfo *si, const ASN1_OBJECT *obj,
                                int lastpos);
-X509_ATTRIBUTE *CMS_signed_get_attr(const CMS_SignerInfo *si, int loc);
-X509_ATTRIBUTE *CMS_signed_delete_attr(CMS_SignerInfo *si, int loc);
-int CMS_signed_add1_attr(CMS_SignerInfo *si, X509_ATTRIBUTE *attr);
-int CMS_signed_add1_attr_by_OBJ(CMS_SignerInfo *si,
+X509_ATTRIBUTE * __cdecl CMS_signed_get_attr(const CMS_SignerInfo *si, int loc);
+X509_ATTRIBUTE * __cdecl CMS_signed_delete_attr(CMS_SignerInfo *si, int loc);
+int __cdecl CMS_signed_add1_attr(CMS_SignerInfo *si, X509_ATTRIBUTE *attr);
+int __cdecl CMS_signed_add1_attr_by_OBJ(CMS_SignerInfo *si,
                                 const ASN1_OBJECT *obj, int type,
                                 const void *bytes, int len);
-int CMS_signed_add1_attr_by_NID(CMS_SignerInfo *si,
+int __cdecl CMS_signed_add1_attr_by_NID(CMS_SignerInfo *si,
                                 int nid, int type,
                                 const void *bytes, int len);
-int CMS_signed_add1_attr_by_txt(CMS_SignerInfo *si,
+int __cdecl CMS_signed_add1_attr_by_txt(CMS_SignerInfo *si,
                                 const char *attrname, int type,
                                 const void *bytes, int len);
-void *CMS_signed_get0_data_by_OBJ(CMS_SignerInfo *si, const ASN1_OBJECT *oid,
+void * __cdecl CMS_signed_get0_data_by_OBJ(CMS_SignerInfo *si, const ASN1_OBJECT *oid,
                                   int lastpos, int type);
 
-int CMS_unsigned_get_attr_count(const CMS_SignerInfo *si);
-int CMS_unsigned_get_attr_by_NID(const CMS_SignerInfo *si, int nid,
+int __cdecl CMS_unsigned_get_attr_count(const CMS_SignerInfo *si);
+int __cdecl CMS_unsigned_get_attr_by_NID(const CMS_SignerInfo *si, int nid,
                                  int lastpos);
-int CMS_unsigned_get_attr_by_OBJ(const CMS_SignerInfo *si,
+int __cdecl CMS_unsigned_get_attr_by_OBJ(const CMS_SignerInfo *si,
                                  const ASN1_OBJECT *obj, int lastpos);
-X509_ATTRIBUTE *CMS_unsigned_get_attr(const CMS_SignerInfo *si, int loc);
-X509_ATTRIBUTE *CMS_unsigned_delete_attr(CMS_SignerInfo *si, int loc);
-int CMS_unsigned_add1_attr(CMS_SignerInfo *si, X509_ATTRIBUTE *attr);
-int CMS_unsigned_add1_attr_by_OBJ(CMS_SignerInfo *si,
+X509_ATTRIBUTE * __cdecl CMS_unsigned_get_attr(const CMS_SignerInfo *si, int loc);
+X509_ATTRIBUTE * __cdecl CMS_unsigned_delete_attr(CMS_SignerInfo *si, int loc);
+int __cdecl CMS_unsigned_add1_attr(CMS_SignerInfo *si, X509_ATTRIBUTE *attr);
+int __cdecl CMS_unsigned_add1_attr_by_OBJ(CMS_SignerInfo *si,
                                   const ASN1_OBJECT *obj, int type,
                                   const void *bytes, int len);
-int CMS_unsigned_add1_attr_by_NID(CMS_SignerInfo *si,
+int __cdecl CMS_unsigned_add1_attr_by_NID(CMS_SignerInfo *si,
                                   int nid, int type,
                                   const void *bytes, int len);
-int CMS_unsigned_add1_attr_by_txt(CMS_SignerInfo *si,
+int __cdecl CMS_unsigned_add1_attr_by_txt(CMS_SignerInfo *si,
                                   const char *attrname, int type,
                                   const void *bytes, int len);
-void *CMS_unsigned_get0_data_by_OBJ(CMS_SignerInfo *si, ASN1_OBJECT *oid,
+void * __cdecl CMS_unsigned_get0_data_by_OBJ(CMS_SignerInfo *si, ASN1_OBJECT *oid,
                                     int lastpos, int type);
 
-int CMS_get1_ReceiptRequest(CMS_SignerInfo *si, CMS_ReceiptRequest **prr);
-CMS_ReceiptRequest *CMS_ReceiptRequest_create0(unsigned char *id, int idlen,
+int __cdecl CMS_get1_ReceiptRequest(CMS_SignerInfo *si, CMS_ReceiptRequest **prr);
+CMS_ReceiptRequest * __cdecl CMS_ReceiptRequest_create0(unsigned char *id, int idlen,
                                                int allorfirst,
                                                STACK_OF(GENERAL_NAMES)
                                                *receiptList, STACK_OF(GENERAL_NAMES)
                                                *receiptsTo);
-int CMS_add1_ReceiptRequest(CMS_SignerInfo *si, CMS_ReceiptRequest *rr);
-void CMS_ReceiptRequest_get0_values(CMS_ReceiptRequest *rr,
+int __cdecl CMS_add1_ReceiptRequest(CMS_SignerInfo *si, CMS_ReceiptRequest *rr);
+void __cdecl CMS_ReceiptRequest_get0_values(CMS_ReceiptRequest *rr,
                                     ASN1_STRING **pcid,
                                     int *pallorfirst,
                                     STACK_OF(GENERAL_NAMES) **plist,
                                     STACK_OF(GENERAL_NAMES) **prto);
-int CMS_RecipientInfo_kari_get0_alg(CMS_RecipientInfo *ri,
+int __cdecl CMS_RecipientInfo_kari_get0_alg(CMS_RecipientInfo *ri,
                                     X509_ALGOR **palg,
                                     ASN1_OCTET_STRING **pukm);
 STACK_OF(CMS_RecipientEncryptedKey)
-*CMS_RecipientInfo_kari_get0_reks(CMS_RecipientInfo *ri);
+* __cdecl CMS_RecipientInfo_kari_get0_reks(CMS_RecipientInfo *ri);
 
-int CMS_RecipientInfo_kari_get0_orig_id(CMS_RecipientInfo *ri,
+int __cdecl CMS_RecipientInfo_kari_get0_orig_id(CMS_RecipientInfo *ri,
                                         X509_ALGOR **pubalg,
                                         ASN1_BIT_STRING **pubkey,
                                         ASN1_OCTET_STRING **keyid,
                                         X509_NAME **issuer,
                                         ASN1_INTEGER **sno);
 
-int CMS_RecipientInfo_kari_orig_id_cmp(CMS_RecipientInfo *ri, X509 *cert);
+int __cdecl CMS_RecipientInfo_kari_orig_id_cmp(CMS_RecipientInfo *ri, X509 *cert);
 
-int CMS_RecipientEncryptedKey_get0_id(CMS_RecipientEncryptedKey *rek,
+int __cdecl CMS_RecipientEncryptedKey_get0_id(CMS_RecipientEncryptedKey *rek,
                                       ASN1_OCTET_STRING **keyid,
                                       ASN1_GENERALIZEDTIME **tm,
                                       CMS_OtherKeyAttribute **other,
                                       X509_NAME **issuer, ASN1_INTEGER **sno);
-int CMS_RecipientEncryptedKey_cert_cmp(CMS_RecipientEncryptedKey *rek,
+int __cdecl CMS_RecipientEncryptedKey_cert_cmp(CMS_RecipientEncryptedKey *rek,
                                        X509 *cert);
-int CMS_RecipientInfo_kari_set0_pkey(CMS_RecipientInfo *ri, EVP_PKEY *pk);
-EVP_CIPHER_CTX *CMS_RecipientInfo_kari_get0_ctx(CMS_RecipientInfo *ri);
-int CMS_RecipientInfo_kari_decrypt(CMS_ContentInfo *cms,
+int __cdecl CMS_RecipientInfo_kari_set0_pkey(CMS_RecipientInfo *ri, EVP_PKEY *pk);
+EVP_CIPHER_CTX * __cdecl CMS_RecipientInfo_kari_get0_ctx(CMS_RecipientInfo *ri);
+int __cdecl CMS_RecipientInfo_kari_decrypt(CMS_ContentInfo *cms,
                                    CMS_RecipientInfo *ri,
                                    CMS_RecipientEncryptedKey *rek);
 
-int CMS_SharedInfo_encode(unsigned char **pder, X509_ALGOR *kekalg,
+int __cdecl CMS_SharedInfo_encode(unsigned char **pder, X509_ALGOR *kekalg,
                           ASN1_OCTET_STRING *ukm, int keylen);
 
 /* Backward compatibility for spelling errors. */
diff --git a/include/openssl/cmserr.h b/include/openssl/cmserr.h
index 7dbc13dc93..1e794ee703 100644
--- a/include/openssl/cmserr.h
+++ b/include/openssl/cmserr.h
@@ -22,7 +22,7 @@
 #  ifdef  __cplusplus
 extern "C"
 #  endif
-int ERR_load_CMS_strings(void);
+int __cdecl ERR_load_CMS_strings(void);
 
 /*
  * CMS function codes.
diff --git a/include/openssl/comp.h b/include/openssl/comp.h
index d814d3cf25..d2806578e1 100644
--- a/include/openssl/comp.h
+++ b/include/openssl/comp.h
@@ -21,19 +21,19 @@ extern "C" {
 
 
 
-COMP_CTX *COMP_CTX_new(COMP_METHOD *meth);
-const COMP_METHOD *COMP_CTX_get_method(const COMP_CTX *ctx);
-int COMP_CTX_get_type(const COMP_CTX* comp);
-int COMP_get_type(const COMP_METHOD *meth);
-const char *COMP_get_name(const COMP_METHOD *meth);
-void COMP_CTX_free(COMP_CTX *ctx);
-
-int COMP_compress_block(COMP_CTX *ctx, unsigned char *out, int olen,
+COMP_CTX * __cdecl COMP_CTX_new(COMP_METHOD *meth);
+const COMP_METHOD * __cdecl COMP_CTX_get_method(const COMP_CTX *ctx);
+int __cdecl COMP_CTX_get_type(const COMP_CTX* comp);
+int __cdecl COMP_get_type(const COMP_METHOD *meth);
+const char * __cdecl COMP_get_name(const COMP_METHOD *meth);
+void __cdecl COMP_CTX_free(COMP_CTX *ctx);
+
+int __cdecl COMP_compress_block(COMP_CTX *ctx, unsigned char *out, int olen,
                         unsigned char *in, int ilen);
-int COMP_expand_block(COMP_CTX *ctx, unsigned char *out, int olen,
+int __cdecl COMP_expand_block(COMP_CTX *ctx, unsigned char *out, int olen,
                       unsigned char *in, int ilen);
 
-COMP_METHOD *COMP_zlib(void);
+COMP_METHOD * __cdecl COMP_zlib(void);
 
 #if OPENSSL_API_COMPAT < 0x10100000L
 #define COMP_zlib_cleanup() while(0) continue
@@ -41,7 +41,7 @@ COMP_METHOD *COMP_zlib(void);
 
 # ifdef HEADER_BIO_H
 #  ifdef ZLIB
-const BIO_METHOD *BIO_f_zlib(void);
+const BIO_METHOD * __cdecl BIO_f_zlib(void);
 #  endif
 # endif
 
diff --git a/include/openssl/comperr.h b/include/openssl/comperr.h
index 90231e9aa3..134ee4cfce 100644
--- a/include/openssl/comperr.h
+++ b/include/openssl/comperr.h
@@ -22,7 +22,7 @@
 #  ifdef  __cplusplus
 extern "C"
 #  endif
-int ERR_load_COMP_strings(void);
+int __cdecl ERR_load_COMP_strings(void);
 
 /*
  * COMP function codes.
diff --git a/include/openssl/conf.h b/include/openssl/conf.h
index 7336cd2f1d..de9fe93f0f 100644
--- a/include/openssl/conf.h
+++ b/include/openssl/conf.h
@@ -66,27 +66,27 @@ typedef void conf_finish_func (CONF_IMODULE *md);
 # define CONF_MFLAGS_IGNORE_MISSING_FILE 0x10
 # define CONF_MFLAGS_DEFAULT_SECTION     0x20
 
-int CONF_set_default_method(CONF_METHOD *meth);
-void CONF_set_nconf(CONF *conf, LHASH_OF(CONF_VALUE) *hash);
-LHASH_OF(CONF_VALUE) *CONF_load(LHASH_OF(CONF_VALUE) *conf, const char *file,
+int __cdecl CONF_set_default_method(CONF_METHOD *meth);
+void __cdecl CONF_set_nconf(CONF *conf, LHASH_OF(CONF_VALUE) *hash);
+LHASH_OF(CONF_VALUE) * __cdecl CONF_load(LHASH_OF(CONF_VALUE) *conf, const char *file,
                                 long *eline);
 # ifndef OPENSSL_NO_STDIO
-LHASH_OF(CONF_VALUE) *CONF_load_fp(LHASH_OF(CONF_VALUE) *conf, FILE *fp,
+LHASH_OF(CONF_VALUE) * __cdecl CONF_load_fp(LHASH_OF(CONF_VALUE) *conf, FILE *fp,
                                    long *eline);
 # endif
-LHASH_OF(CONF_VALUE) *CONF_load_bio(LHASH_OF(CONF_VALUE) *conf, BIO *bp,
+LHASH_OF(CONF_VALUE) * __cdecl CONF_load_bio(LHASH_OF(CONF_VALUE) *conf, BIO *bp,
                                     long *eline);
-STACK_OF(CONF_VALUE) *CONF_get_section(LHASH_OF(CONF_VALUE) *conf,
+STACK_OF(CONF_VALUE) * __cdecl CONF_get_section(LHASH_OF(CONF_VALUE) *conf,
                                        const char *section);
-char *CONF_get_string(LHASH_OF(CONF_VALUE) *conf, const char *group,
+char * __cdecl CONF_get_string(LHASH_OF(CONF_VALUE) *conf, const char *group,
                       const char *name);
-long CONF_get_number(LHASH_OF(CONF_VALUE) *conf, const char *group,
+long __cdecl CONF_get_number(LHASH_OF(CONF_VALUE) *conf, const char *group,
                      const char *name);
-void CONF_free(LHASH_OF(CONF_VALUE) *conf);
+void __cdecl CONF_free(LHASH_OF(CONF_VALUE) *conf);
 #ifndef OPENSSL_NO_STDIO
-int CONF_dump_fp(LHASH_OF(CONF_VALUE) *conf, FILE *out);
+int __cdecl CONF_dump_fp(LHASH_OF(CONF_VALUE) *conf, FILE *out);
 #endif
-int CONF_dump_bio(LHASH_OF(CONF_VALUE) *conf, BIO *out);
+int __cdecl CONF_dump_bio(LHASH_OF(CONF_VALUE) *conf, BIO *out);
 
 DEPRECATEDIN_1_1_0(void OPENSSL_config(const char *config_name))
 
@@ -106,60 +106,60 @@ struct conf_st {
     LHASH_OF(CONF_VALUE) *data;
 };
 
-CONF *NCONF_new(CONF_METHOD *meth);
-CONF_METHOD *NCONF_default(void);
-CONF_METHOD *NCONF_WIN32(void);
-void NCONF_free(CONF *conf);
-void NCONF_free_data(CONF *conf);
+CONF * __cdecl NCONF_new(CONF_METHOD *meth);
+CONF_METHOD * __cdecl NCONF_default(void);
+CONF_METHOD * __cdecl NCONF_WIN32(void);
+void __cdecl NCONF_free(CONF *conf);
+void __cdecl NCONF_free_data(CONF *conf);
 
-int NCONF_load(CONF *conf, const char *file, long *eline);
+int __cdecl NCONF_load(CONF *conf, const char *file, long *eline);
 # ifndef OPENSSL_NO_STDIO
-int NCONF_load_fp(CONF *conf, FILE *fp, long *eline);
+int __cdecl NCONF_load_fp(CONF *conf, FILE *fp, long *eline);
 # endif
-int NCONF_load_bio(CONF *conf, BIO *bp, long *eline);
-STACK_OF(CONF_VALUE) *NCONF_get_section(const CONF *conf,
+int __cdecl NCONF_load_bio(CONF *conf, BIO *bp, long *eline);
+STACK_OF(CONF_VALUE) * __cdecl NCONF_get_section(const CONF *conf,
                                         const char *section);
-char *NCONF_get_string(const CONF *conf, const char *group, const char *name);
-int NCONF_get_number_e(const CONF *conf, const char *group, const char *name,
+char * __cdecl NCONF_get_string(const CONF *conf, const char *group, const char *name);
+int __cdecl NCONF_get_number_e(const CONF *conf, const char *group, const char *name,
                        long *result);
 #ifndef OPENSSL_NO_STDIO
-int NCONF_dump_fp(const CONF *conf, FILE *out);
+int __cdecl NCONF_dump_fp(const CONF *conf, FILE *out);
 #endif
-int NCONF_dump_bio(const CONF *conf, BIO *out);
+int __cdecl NCONF_dump_bio(const CONF *conf, BIO *out);
 
 #define NCONF_get_number(c,g,n,r) NCONF_get_number_e(c,g,n,r)
 
 /* Module functions */
 
-int CONF_modules_load(const CONF *cnf, const char *appname,
+int __cdecl CONF_modules_load(const CONF *cnf, const char *appname,
                       unsigned long flags);
-int CONF_modules_load_file(const char *filename, const char *appname,
+int __cdecl CONF_modules_load_file(const char *filename, const char *appname,
                            unsigned long flags);
-void CONF_modules_unload(int all);
-void CONF_modules_finish(void);
+void __cdecl CONF_modules_unload(int all);
+void __cdecl CONF_modules_finish(void);
 #if OPENSSL_API_COMPAT < 0x10100000L
 # define CONF_modules_free() while(0) continue
 #endif
-int CONF_module_add(const char *name, conf_init_func *ifunc,
+int __cdecl CONF_module_add(const char *name, conf_init_func *ifunc,
                     conf_finish_func *ffunc);
 
-const char *CONF_imodule_get_name(const CONF_IMODULE *md);
-const char *CONF_imodule_get_value(const CONF_IMODULE *md);
-void *CONF_imodule_get_usr_data(const CONF_IMODULE *md);
-void CONF_imodule_set_usr_data(CONF_IMODULE *md, void *usr_data);
-CONF_MODULE *CONF_imodule_get_module(const CONF_IMODULE *md);
-unsigned long CONF_imodule_get_flags(const CONF_IMODULE *md);
-void CONF_imodule_set_flags(CONF_IMODULE *md, unsigned long flags);
-void *CONF_module_get_usr_data(CONF_MODULE *pmod);
-void CONF_module_set_usr_data(CONF_MODULE *pmod, void *usr_data);
+const char * __cdecl CONF_imodule_get_name(const CONF_IMODULE *md);
+const char * __cdecl CONF_imodule_get_value(const CONF_IMODULE *md);
+void * __cdecl CONF_imodule_get_usr_data(const CONF_IMODULE *md);
+void __cdecl CONF_imodule_set_usr_data(CONF_IMODULE *md, void *usr_data);
+CONF_MODULE * __cdecl CONF_imodule_get_module(const CONF_IMODULE *md);
+unsigned long __cdecl CONF_imodule_get_flags(const CONF_IMODULE *md);
+void __cdecl CONF_imodule_set_flags(CONF_IMODULE *md, unsigned long flags);
+void * __cdecl CONF_module_get_usr_data(CONF_MODULE *pmod);
+void __cdecl CONF_module_set_usr_data(CONF_MODULE *pmod, void *usr_data);
 
-char *CONF_get1_default_config_file(void);
+char * __cdecl CONF_get1_default_config_file(void);
 
-int CONF_parse_list(const char *list, int sep, int nospc,
+int __cdecl CONF_parse_list(const char *list, int sep, int nospc,
                     int (*list_cb) (const char *elem, int len, void *usr),
                     void *arg);
 
-void OPENSSL_load_builtin_modules(void);
+void __cdecl OPENSSL_load_builtin_modules(void);
 
 
 # ifdef  __cplusplus
diff --git a/include/openssl/conf_api.h b/include/openssl/conf_api.h
index a0275ad79b..093a9d4825 100644
--- a/include/openssl/conf_api.h
+++ b/include/openssl/conf_api.h
@@ -18,21 +18,21 @@ extern "C" {
 #endif
 
 /* Up until OpenSSL 0.9.5a, this was new_section */
-CONF_VALUE *_CONF_new_section(CONF *conf, const char *section);
+CONF_VALUE * __cdecl _CONF_new_section(CONF *conf, const char *section);
 /* Up until OpenSSL 0.9.5a, this was get_section */
-CONF_VALUE *_CONF_get_section(const CONF *conf, const char *section);
+CONF_VALUE * __cdecl _CONF_get_section(const CONF *conf, const char *section);
 /* Up until OpenSSL 0.9.5a, this was CONF_get_section */
-STACK_OF(CONF_VALUE) *_CONF_get_section_values(const CONF *conf,
+STACK_OF(CONF_VALUE) * __cdecl _CONF_get_section_values(const CONF *conf,
                                                const char *section);
 
-int _CONF_add_string(CONF *conf, CONF_VALUE *section, CONF_VALUE *value);
-char *_CONF_get_string(const CONF *conf, const char *section,
+int __cdecl _CONF_add_string(CONF *conf, CONF_VALUE *section, CONF_VALUE *value);
+char * __cdecl _CONF_get_string(const CONF *conf, const char *section,
                        const char *name);
-long _CONF_get_number(const CONF *conf, const char *section,
+long __cdecl _CONF_get_number(const CONF *conf, const char *section,
                       const char *name);
 
-int _CONF_new_data(CONF *conf);
-void _CONF_free_data(CONF *conf);
+int __cdecl _CONF_new_data(CONF *conf);
+void __cdecl _CONF_free_data(CONF *conf);
 
 #ifdef  __cplusplus
 }
diff --git a/include/openssl/conferr.h b/include/openssl/conferr.h
index 32b9229185..4bd6d6a051 100644
--- a/include/openssl/conferr.h
+++ b/include/openssl/conferr.h
@@ -18,7 +18,7 @@
 # ifdef  __cplusplus
 extern "C"
 # endif
-int ERR_load_CONF_strings(void);
+int __cdecl ERR_load_CONF_strings(void);
 
 /*
  * CONF function codes.
diff --git a/include/openssl/crypto.h b/include/openssl/crypto.h
index 7d0b526236..ca4497e209 100644
--- a/include/openssl/crypto.h
+++ b/include/openssl/crypto.h
@@ -66,13 +66,13 @@ typedef struct {
 
 typedef void CRYPTO_RWLOCK;
 
-CRYPTO_RWLOCK *CRYPTO_THREAD_lock_new(void);
-int CRYPTO_THREAD_read_lock(CRYPTO_RWLOCK *lock);
-int CRYPTO_THREAD_write_lock(CRYPTO_RWLOCK *lock);
-int CRYPTO_THREAD_unlock(CRYPTO_RWLOCK *lock);
-void CRYPTO_THREAD_lock_free(CRYPTO_RWLOCK *lock);
+CRYPTO_RWLOCK * __cdecl CRYPTO_THREAD_lock_new(void);
+int __cdecl CRYPTO_THREAD_read_lock(CRYPTO_RWLOCK *lock);
+int __cdecl CRYPTO_THREAD_write_lock(CRYPTO_RWLOCK *lock);
+int __cdecl CRYPTO_THREAD_unlock(CRYPTO_RWLOCK *lock);
+void __cdecl CRYPTO_THREAD_lock_free(CRYPTO_RWLOCK *lock);
 
-int CRYPTO_atomic_add(int *val, int amount, int *ret, CRYPTO_RWLOCK *lock);
+int __cdecl CRYPTO_atomic_add(int *val, int amount, int *ret, CRYPTO_RWLOCK *lock);
 
 /*
  * The following can be used to detect memory leaks in the library. If
@@ -112,7 +112,7 @@ DEFINE_STACK_OF(void)
 /* No longer needed, so this is a no-op */
 #define OPENSSL_malloc_init() while(0) continue
 
-int CRYPTO_mem_ctrl(int mode);
+int __cdecl CRYPTO_mem_ctrl(int mode);
 
 # define OPENSSL_malloc(num) \
         CRYPTO_malloc(num, OPENSSL_FILE, OPENSSL_LINE)
@@ -143,17 +143,17 @@ int CRYPTO_mem_ctrl(int mode);
 # define OPENSSL_secure_actual_size(ptr) \
         CRYPTO_secure_actual_size(ptr)
 
-size_t OPENSSL_strlcpy(char *dst, const char *src, size_t siz);
-size_t OPENSSL_strlcat(char *dst, const char *src, size_t siz);
-size_t OPENSSL_strnlen(const char *str, size_t maxlen);
-char *OPENSSL_buf2hexstr(const unsigned char *buffer, long len);
-unsigned char *OPENSSL_hexstr2buf(const char *str, long *len);
-int OPENSSL_hexchar2int(unsigned char c);
+size_t __cdecl OPENSSL_strlcpy(char *dst, const char *src, size_t siz);
+size_t __cdecl OPENSSL_strlcat(char *dst, const char *src, size_t siz);
+size_t __cdecl OPENSSL_strnlen(const char *str, size_t maxlen);
+char * __cdecl OPENSSL_buf2hexstr(const unsigned char *buffer, long len);
+unsigned char * __cdecl OPENSSL_hexstr2buf(const char *str, long *len);
+int __cdecl OPENSSL_hexchar2int(unsigned char c);
 
 # define OPENSSL_MALLOC_MAX_NELEMS(type)  (((1U<<(sizeof(int)*8-1))-1)/sizeof(type))
 
-unsigned long OpenSSL_version_num(void);
-const char *OpenSSL_version(int type);
+unsigned long __cdecl OpenSSL_version_num(void);
+const char * __cdecl OpenSSL_version(int type);
 # define OPENSSL_VERSION          0
 # define OPENSSL_CFLAGS           1
 # define OPENSSL_BUILT_ON         2
@@ -161,7 +161,7 @@ const char *OpenSSL_version(int type);
 # define OPENSSL_DIR              4
 # define OPENSSL_ENGINES_DIR      5
 
-int OPENSSL_issetugid(void);
+int __cdecl OPENSSL_issetugid(void);
 
 typedef void CRYPTO_EX_new (void *parent, void *ptr, CRYPTO_EX_DATA *ad,
                            int idx, long argl, void *argp);
@@ -169,28 +169,28 @@ typedef void CRYPTO_EX_free (void *parent, void *ptr, CRYPTO_EX_DATA *ad,
                              int idx, long argl, void *argp);
 typedef int CRYPTO_EX_dup (CRYPTO_EX_DATA *to, const CRYPTO_EX_DATA *from,
                            void *from_d, int idx, long argl, void *argp);
-__owur int CRYPTO_get_ex_new_index(int class_index, long argl, void *argp,
+__owur int __cdecl CRYPTO_get_ex_new_index(int class_index, long argl, void *argp,
                             CRYPTO_EX_new *new_func, CRYPTO_EX_dup *dup_func,
                             CRYPTO_EX_free *free_func);
 /* No longer use an index. */
-int CRYPTO_free_ex_index(int class_index, int idx);
+int __cdecl CRYPTO_free_ex_index(int class_index, int idx);
 
 /*
  * Initialise/duplicate/free CRYPTO_EX_DATA variables corresponding to a
  * given class (invokes whatever per-class callbacks are applicable)
  */
-int CRYPTO_new_ex_data(int class_index, void *obj, CRYPTO_EX_DATA *ad);
-int CRYPTO_dup_ex_data(int class_index, CRYPTO_EX_DATA *to,
+int __cdecl CRYPTO_new_ex_data(int class_index, void *obj, CRYPTO_EX_DATA *ad);
+int __cdecl CRYPTO_dup_ex_data(int class_index, CRYPTO_EX_DATA *to,
                        const CRYPTO_EX_DATA *from);
 
-void CRYPTO_free_ex_data(int class_index, void *obj, CRYPTO_EX_DATA *ad);
+void __cdecl CRYPTO_free_ex_data(int class_index, void *obj, CRYPTO_EX_DATA *ad);
 
 /*
  * Get/set data in a CRYPTO_EX_DATA variable corresponding to a particular
  * index (relative to the class type involved)
  */
-int CRYPTO_set_ex_data(CRYPTO_EX_DATA *ad, int idx, void *val);
-void *CRYPTO_get_ex_data(const CRYPTO_EX_DATA *ad, int idx);
+int __cdecl CRYPTO_set_ex_data(CRYPTO_EX_DATA *ad, int idx, void *val);
+void * __cdecl CRYPTO_get_ex_data(const CRYPTO_EX_DATA *ad, int idx);
 
 # if OPENSSL_API_COMPAT < 0x10100000L
 /*
@@ -253,49 +253,49 @@ typedef struct crypto_threadid_st {
 #  define CRYPTO_get_dynlock_destroy_callback()         (NULL)
 # endif /* OPENSSL_API_COMPAT < 0x10100000L */
 
-int CRYPTO_set_mem_functions(
-        void *(*m) (size_t, const char *, int),
-        void *(*r) (void *, size_t, const char *, int),
-        void (*f) (void *, const char *, int));
-int CRYPTO_set_mem_debug(int flag);
-void CRYPTO_get_mem_functions(
-        void *(**m) (size_t, const char *, int),
-        void *(**r) (void *, size_t, const char *, int),
-        void (**f) (void *, const char *, int));
-
-void *CRYPTO_malloc(size_t num, const char *file, int line);
-void *CRYPTO_zalloc(size_t num, const char *file, int line);
-void *CRYPTO_memdup(const void *str, size_t siz, const char *file, int line);
-char *CRYPTO_strdup(const char *str, const char *file, int line);
-char *CRYPTO_strndup(const char *str, size_t s, const char *file, int line);
-void CRYPTO_free(void *ptr, const char *file, int line);
-void CRYPTO_clear_free(void *ptr, size_t num, const char *file, int line);
-void *CRYPTO_realloc(void *addr, size_t num, const char *file, int line);
-void *CRYPTO_clear_realloc(void *addr, size_t old_num, size_t num,
+int __cdecl CRYPTO_set_mem_functions(
+        void *(__cdecl *m) (size_t, const char *, int),
+        void *(__cdecl *r) (void *, size_t, const char *, int),
+        void (__cdecl *f) (void *, const char *, int));
+int __cdecl CRYPTO_set_mem_debug(int flag);
+void __cdecl CRYPTO_get_mem_functions(
+        void *(__cdecl **m) (size_t, const char *, int),
+        void *(__cdecl **r) (void *, size_t, const char *, int),
+        void (__cdecl **f) (void *, const char *, int));
+
+void * __cdecl CRYPTO_malloc(size_t num, const char *file, int line);
+void * __cdecl CRYPTO_zalloc(size_t num, const char *file, int line);
+void * __cdecl CRYPTO_memdup(const void *str, size_t siz, const char *file, int line);
+char * __cdecl CRYPTO_strdup(const char *str, const char *file, int line);
+char * __cdecl CRYPTO_strndup(const char *str, size_t s, const char *file, int line);
+void __cdecl CRYPTO_free(void *ptr, const char *file, int line);
+void __cdecl CRYPTO_clear_free(void *ptr, size_t num, const char *file, int line);
+void * __cdecl CRYPTO_realloc(void *addr, size_t num, const char *file, int line);
+void * __cdecl CRYPTO_clear_realloc(void *addr, size_t old_num, size_t num,
                            const char *file, int line);
 
-int CRYPTO_secure_malloc_init(size_t sz, int minsize);
-int CRYPTO_secure_malloc_done(void);
-void *CRYPTO_secure_malloc(size_t num, const char *file, int line);
-void *CRYPTO_secure_zalloc(size_t num, const char *file, int line);
-void CRYPTO_secure_free(void *ptr, const char *file, int line);
-void CRYPTO_secure_clear_free(void *ptr, size_t num,
+int __cdecl CRYPTO_secure_malloc_init(size_t sz, int minsize);
+int __cdecl CRYPTO_secure_malloc_done(void);
+void * __cdecl CRYPTO_secure_malloc(size_t num, const char *file, int line);
+void * __cdecl CRYPTO_secure_zalloc(size_t num, const char *file, int line);
+void __cdecl CRYPTO_secure_free(void *ptr, const char *file, int line);
+void __cdecl CRYPTO_secure_clear_free(void *ptr, size_t num,
                               const char *file, int line);
-int CRYPTO_secure_allocated(const void *ptr);
-int CRYPTO_secure_malloc_initialized(void);
-size_t CRYPTO_secure_actual_size(void *ptr);
-size_t CRYPTO_secure_used(void);
+int __cdecl CRYPTO_secure_allocated(const void *ptr);
+int __cdecl CRYPTO_secure_malloc_initialized(void);
+size_t __cdecl CRYPTO_secure_actual_size(void *ptr);
+size_t __cdecl CRYPTO_secure_used(void);
 
-void OPENSSL_cleanse(void *ptr, size_t len);
+void __cdecl OPENSSL_cleanse(void *ptr, size_t len);
 
 # ifndef OPENSSL_NO_CRYPTO_MDEBUG
 #  define OPENSSL_mem_debug_push(info) \
         CRYPTO_mem_debug_push(info, OPENSSL_FILE, OPENSSL_LINE)
 #  define OPENSSL_mem_debug_pop() \
         CRYPTO_mem_debug_pop()
-int CRYPTO_mem_debug_push(const char *info, const char *file, int line);
-int CRYPTO_mem_debug_pop(void);
-void CRYPTO_get_alloc_counts(int *mcount, int *rcount, int *fcount);
+int __cdecl CRYPTO_mem_debug_push(const char *info, const char *file, int line);
+int __cdecl CRYPTO_mem_debug_pop(void);
+void __cdecl CRYPTO_get_alloc_counts(int *mcount, int *rcount, int *fcount);
 
 /*-
  * Debugging functions (enabled by CRYPTO_set_mem_debug(1))
@@ -303,44 +303,44 @@ void CRYPTO_get_alloc_counts(int *mcount, int *rcount, int *fcount);
  *   0:   called before the actual memory allocation has taken place
  *   1:   called after the actual memory allocation has taken place
  */
-void CRYPTO_mem_debug_malloc(void *addr, size_t num, int flag,
+void __cdecl CRYPTO_mem_debug_malloc(void *addr, size_t num, int flag,
         const char *file, int line);
-void CRYPTO_mem_debug_realloc(void *addr1, void *addr2, size_t num, int flag,
+void __cdecl CRYPTO_mem_debug_realloc(void *addr1, void *addr2, size_t num, int flag,
         const char *file, int line);
-void CRYPTO_mem_debug_free(void *addr, int flag,
+void __cdecl CRYPTO_mem_debug_free(void *addr, int flag,
         const char *file, int line);
 
-int CRYPTO_mem_leaks_cb(int (*cb) (const char *str, size_t len, void *u),
+int __cdecl CRYPTO_mem_leaks_cb(int (*cb) (const char *str, size_t len, void *u),
                         void *u);
 #  ifndef OPENSSL_NO_STDIO
-int CRYPTO_mem_leaks_fp(FILE *);
+int __cdecl CRYPTO_mem_leaks_fp(FILE *);
 #  endif
-int CRYPTO_mem_leaks(BIO *bio);
+int __cdecl CRYPTO_mem_leaks(BIO *bio);
 # endif
 
 /* die if we have to */
-ossl_noreturn void OPENSSL_die(const char *assertion, const char *file, int line);
+ossl_noreturn void __cdecl OPENSSL_die(const char *assertion, const char *file, int line);
 # if OPENSSL_API_COMPAT < 0x10100000L
 #  define OpenSSLDie(f,l,a) OPENSSL_die((a),(f),(l))
 # endif
 # define OPENSSL_assert(e) \
     (void)((e) ? 0 : (OPENSSL_die("assertion failed: " #e, OPENSSL_FILE, OPENSSL_LINE), 1))
 
-int OPENSSL_isservice(void);
+int __cdecl OPENSSL_isservice(void);
 
-int FIPS_mode(void);
-int FIPS_mode_set(int r);
+int __cdecl FIPS_mode(void);
+int __cdecl FIPS_mode_set(int r);
 
-void OPENSSL_init(void);
+void __cdecl OPENSSL_init(void);
 # ifdef OPENSSL_SYS_UNIX
-void OPENSSL_fork_prepare(void);
-void OPENSSL_fork_parent(void);
-void OPENSSL_fork_child(void);
+void __cdecl OPENSSL_fork_prepare(void);
+void __cdecl OPENSSL_fork_parent(void);
+void __cdecl OPENSSL_fork_child(void);
 # endif
 
-struct tm *OPENSSL_gmtime(const time_t *timer, struct tm *result);
-int OPENSSL_gmtime_adj(struct tm *tm, int offset_day, long offset_sec);
-int OPENSSL_gmtime_diff(int *pday, int *psec,
+struct tm * __cdecl OPENSSL_gmtime(const time_t *timer, struct tm *result);
+int __cdecl OPENSSL_gmtime_adj(struct tm *tm, int offset_day, long offset_sec);
+int __cdecl OPENSSL_gmtime_diff(int *pday, int *psec,
                         const struct tm *from, const struct tm *to);
 
 /*
@@ -350,7 +350,7 @@ int OPENSSL_gmtime_diff(int *pday, int *psec,
  * into a defined order as the return value when a != b is undefined, other
  * than to be non-zero.
  */
-int CRYPTO_memcmp(const void * in_a, const void * in_b, size_t len);
+int __cdecl CRYPTO_memcmp(const void * in_a, const void * in_b, size_t len);
 
 /* Standard initialisation options */
 # define OPENSSL_INIT_NO_LOAD_CRYPTO_STRINGS 0x00000001L
@@ -384,22 +384,22 @@ int CRYPTO_memcmp(const void * in_a, const void * in_b, size_t len);
 
 
 /* Library initialisation functions */
-void OPENSSL_cleanup(void);
-int OPENSSL_init_crypto(uint64_t opts, const OPENSSL_INIT_SETTINGS *settings);
-int OPENSSL_atexit(void (*handler)(void));
-void OPENSSL_thread_stop(void);
+void __cdecl OPENSSL_cleanup(void);
+int __cdecl OPENSSL_init_crypto(uint64_t opts, const OPENSSL_INIT_SETTINGS *settings);
+int __cdecl OPENSSL_atexit(void (*handler)(void));
+void __cdecl OPENSSL_thread_stop(void);
 
 /* Low-level control of initialization */
-OPENSSL_INIT_SETTINGS *OPENSSL_INIT_new(void);
+OPENSSL_INIT_SETTINGS * __cdecl OPENSSL_INIT_new(void);
 # ifndef OPENSSL_NO_STDIO
-int OPENSSL_INIT_set_config_filename(OPENSSL_INIT_SETTINGS *settings,
+int __cdecl OPENSSL_INIT_set_config_filename(OPENSSL_INIT_SETTINGS *settings,
                                      const char *config_filename);
-void OPENSSL_INIT_set_config_file_flags(OPENSSL_INIT_SETTINGS *settings,
+void __cdecl OPENSSL_INIT_set_config_file_flags(OPENSSL_INIT_SETTINGS *settings,
                                         unsigned long flags);
-int OPENSSL_INIT_set_config_appname(OPENSSL_INIT_SETTINGS *settings,
+int __cdecl OPENSSL_INIT_set_config_appname(OPENSSL_INIT_SETTINGS *settings,
                                     const char *config_appname);
 # endif
-void OPENSSL_INIT_free(OPENSSL_INIT_SETTINGS *settings);
+void __cdecl OPENSSL_INIT_free(OPENSSL_INIT_SETTINGS *settings);
 
 # if defined(OPENSSL_THREADS) && !defined(CRYPTO_TDEBUG)
 #  if defined(_WIN32)
@@ -428,15 +428,15 @@ typedef unsigned int CRYPTO_THREAD_ID;
 #  define CRYPTO_ONCE_STATIC_INIT 0
 # endif
 
-int CRYPTO_THREAD_run_once(CRYPTO_ONCE *once, void (*init)(void));
+int __cdecl CRYPTO_THREAD_run_once(CRYPTO_ONCE *once, void (*init)(void));
 
-int CRYPTO_THREAD_init_local(CRYPTO_THREAD_LOCAL *key, void (*cleanup)(void *));
-void *CRYPTO_THREAD_get_local(CRYPTO_THREAD_LOCAL *key);
-int CRYPTO_THREAD_set_local(CRYPTO_THREAD_LOCAL *key, void *val);
-int CRYPTO_THREAD_cleanup_local(CRYPTO_THREAD_LOCAL *key);
+int __cdecl CRYPTO_THREAD_init_local(CRYPTO_THREAD_LOCAL *key, void (*cleanup)(void *));
+void * __cdecl CRYPTO_THREAD_get_local(CRYPTO_THREAD_LOCAL *key);
+int __cdecl CRYPTO_THREAD_set_local(CRYPTO_THREAD_LOCAL *key, void *val);
+int __cdecl CRYPTO_THREAD_cleanup_local(CRYPTO_THREAD_LOCAL *key);
 
-CRYPTO_THREAD_ID CRYPTO_THREAD_get_current_id(void);
-int CRYPTO_THREAD_compare_id(CRYPTO_THREAD_ID a, CRYPTO_THREAD_ID b);
+CRYPTO_THREAD_ID __cdecl CRYPTO_THREAD_get_current_id(void);
+int __cdecl CRYPTO_THREAD_compare_id(CRYPTO_THREAD_ID a, CRYPTO_THREAD_ID b);
 
 
 # ifdef  __cplusplus
diff --git a/include/openssl/cryptoerr.h b/include/openssl/cryptoerr.h
index 3db5a4ee99..ec1f1e5d1a 100644
--- a/include/openssl/cryptoerr.h
+++ b/include/openssl/cryptoerr.h
@@ -18,7 +18,7 @@
 # ifdef  __cplusplus
 extern "C"
 # endif
-int ERR_load_CRYPTO_strings(void);
+int __cdecl ERR_load_CRYPTO_strings(void);
 
 /*
  * CRYPTO function codes.
diff --git a/include/openssl/ct.h b/include/openssl/ct.h
index d4262fa048..6b778647c3 100644
--- a/include/openssl/ct.h
+++ b/include/openssl/ct.h
@@ -67,36 +67,36 @@ DEFINE_STACK_OF(CTLOG)
  * The caller is responsible for calling CT_POLICY_EVAL_CTX_free when finished
  * with the CT_POLICY_EVAL_CTX.
  */
-CT_POLICY_EVAL_CTX *CT_POLICY_EVAL_CTX_new(void);
+CT_POLICY_EVAL_CTX * __cdecl CT_POLICY_EVAL_CTX_new(void);
 
 /* Deletes a policy evaluation context and anything it owns. */
-void CT_POLICY_EVAL_CTX_free(CT_POLICY_EVAL_CTX *ctx);
+void __cdecl CT_POLICY_EVAL_CTX_free(CT_POLICY_EVAL_CTX *ctx);
 
 /* Gets the peer certificate that the SCTs are for */
-X509* CT_POLICY_EVAL_CTX_get0_cert(const CT_POLICY_EVAL_CTX *ctx);
+X509* __cdecl CT_POLICY_EVAL_CTX_get0_cert(const CT_POLICY_EVAL_CTX *ctx);
 
 /*
  * Sets the certificate associated with the received SCTs.
  * Increments the reference count of cert.
  * Returns 1 on success, 0 otherwise.
  */
-int CT_POLICY_EVAL_CTX_set1_cert(CT_POLICY_EVAL_CTX *ctx, X509 *cert);
+int __cdecl CT_POLICY_EVAL_CTX_set1_cert(CT_POLICY_EVAL_CTX *ctx, X509 *cert);
 
 /* Gets the issuer of the aforementioned certificate */
-X509* CT_POLICY_EVAL_CTX_get0_issuer(const CT_POLICY_EVAL_CTX *ctx);
+X509* __cdecl CT_POLICY_EVAL_CTX_get0_issuer(const CT_POLICY_EVAL_CTX *ctx);
 
 /*
  * Sets the issuer of the certificate associated with the received SCTs.
  * Increments the reference count of issuer.
  * Returns 1 on success, 0 otherwise.
  */
-int CT_POLICY_EVAL_CTX_set1_issuer(CT_POLICY_EVAL_CTX *ctx, X509 *issuer);
+int __cdecl CT_POLICY_EVAL_CTX_set1_issuer(CT_POLICY_EVAL_CTX *ctx, X509 *issuer);
 
 /* Gets the CT logs that are trusted sources of SCTs */
-const CTLOG_STORE *CT_POLICY_EVAL_CTX_get0_log_store(const CT_POLICY_EVAL_CTX *ctx);
+const CTLOG_STORE * __cdecl CT_POLICY_EVAL_CTX_get0_log_store(const CT_POLICY_EVAL_CTX *ctx);
 
 /* Sets the log store that is in use. It must outlive the CT_POLICY_EVAL_CTX. */
-void CT_POLICY_EVAL_CTX_set_shared_CTLOG_STORE(CT_POLICY_EVAL_CTX *ctx,
+void __cdecl CT_POLICY_EVAL_CTX_set_shared_CTLOG_STORE(CT_POLICY_EVAL_CTX *ctx,
                                                CTLOG_STORE *log_store);
 
 /*
@@ -104,7 +104,7 @@ void CT_POLICY_EVAL_CTX_set_shared_CTLOG_STORE(CT_POLICY_EVAL_CTX *ctx,
  * current time when checking whether an SCT was issued in the future.
  * Such SCTs will fail validation, as required by RFC6962.
  */
-uint64_t CT_POLICY_EVAL_CTX_get_time(const CT_POLICY_EVAL_CTX *ctx);
+uint64_t __cdecl CT_POLICY_EVAL_CTX_get_time(const CT_POLICY_EVAL_CTX *ctx);
 
 /*
  * Sets the time to evaluate SCTs against, in milliseconds since the Unix epoch.
@@ -112,7 +112,7 @@ uint64_t CT_POLICY_EVAL_CTX_get_time(const CT_POLICY_EVAL_CTX *ctx);
  * been issued in the future. RFC6962 states that "TLS clients MUST reject SCTs
  * whose timestamp is in the future", so an SCT will not validate in this case.
  */
-void CT_POLICY_EVAL_CTX_set_time(CT_POLICY_EVAL_CTX *ctx, uint64_t time_in_ms);
+void __cdecl CT_POLICY_EVAL_CTX_set_time(CT_POLICY_EVAL_CTX *ctx, uint64_t time_in_ms);
 
 /*****************
  * SCT functions *
@@ -122,13 +122,13 @@ void CT_POLICY_EVAL_CTX_set_time(CT_POLICY_EVAL_CTX *ctx, uint64_t time_in_ms);
  * Creates a new, blank SCT.
  * The caller is responsible for calling SCT_free when finished with the SCT.
  */
-SCT *SCT_new(void);
+SCT * __cdecl SCT_new(void);
 
 /*
  * Creates a new SCT from some base64-encoded strings.
  * The caller is responsible for calling SCT_free when finished with the SCT.
  */
-SCT *SCT_new_from_base64(unsigned char version,
+SCT * __cdecl SCT_new_from_base64(unsigned char version,
                          const char *logid_base64,
                          ct_log_entry_type_t entry_type,
                          uint64_t timestamp,
@@ -138,74 +138,74 @@ SCT *SCT_new_from_base64(unsigned char version,
 /*
  * Frees the SCT and the underlying data structures.
  */
-void SCT_free(SCT *sct);
+void __cdecl SCT_free(SCT *sct);
 
 /*
  * Free a stack of SCTs, and the underlying SCTs themselves.
  * Intended to be compatible with X509V3_EXT_FREE.
  */
-void SCT_LIST_free(STACK_OF(SCT) *a);
+void __cdecl SCT_LIST_free(STACK_OF(SCT) *a);
 
 /*
  * Returns the version of the SCT.
  */
-sct_version_t SCT_get_version(const SCT *sct);
+sct_version_t __cdecl SCT_get_version(const SCT *sct);
 
 /*
  * Set the version of an SCT.
  * Returns 1 on success, 0 if the version is unrecognized.
  */
-__owur int SCT_set_version(SCT *sct, sct_version_t version);
+__owur int __cdecl SCT_set_version(SCT *sct, sct_version_t version);
 
 /*
  * Returns the log entry type of the SCT.
  */
-ct_log_entry_type_t SCT_get_log_entry_type(const SCT *sct);
+ct_log_entry_type_t __cdecl SCT_get_log_entry_type(const SCT *sct);
 
 /*
  * Set the log entry type of an SCT.
  * Returns 1 on success, 0 otherwise.
  */
-__owur int SCT_set_log_entry_type(SCT *sct, ct_log_entry_type_t entry_type);
+__owur int __cdecl SCT_set_log_entry_type(SCT *sct, ct_log_entry_type_t entry_type);
 
 /*
  * Gets the ID of the log that an SCT came from.
  * Ownership of the log ID remains with the SCT.
  * Returns the length of the log ID.
  */
-size_t SCT_get0_log_id(const SCT *sct, unsigned char **log_id);
+size_t __cdecl SCT_get0_log_id(const SCT *sct, unsigned char **log_id);
 
 /*
  * Set the log ID of an SCT to point directly to the *log_id specified.
  * The SCT takes ownership of the specified pointer.
  * Returns 1 on success, 0 otherwise.
  */
-__owur int SCT_set0_log_id(SCT *sct, unsigned char *log_id, size_t log_id_len);
+__owur int __cdecl SCT_set0_log_id(SCT *sct, unsigned char *log_id, size_t log_id_len);
 
 /*
  * Set the log ID of an SCT.
  * This makes a copy of the log_id.
  * Returns 1 on success, 0 otherwise.
  */
-__owur int SCT_set1_log_id(SCT *sct, const unsigned char *log_id,
+__owur int __cdecl SCT_set1_log_id(SCT *sct, const unsigned char *log_id,
                            size_t log_id_len);
 
 /*
  * Returns the timestamp for the SCT (epoch time in milliseconds).
  */
-uint64_t SCT_get_timestamp(const SCT *sct);
+uint64_t __cdecl SCT_get_timestamp(const SCT *sct);
 
 /*
  * Set the timestamp of an SCT (epoch time in milliseconds).
  */
-void SCT_set_timestamp(SCT *sct, uint64_t timestamp);
+void __cdecl SCT_set_timestamp(SCT *sct, uint64_t timestamp);
 
 /*
  * Return the NID for the signature used by the SCT.
  * For CT v1, this will be either NID_sha256WithRSAEncryption or
  * NID_ecdsa_with_SHA256 (or NID_undef if incorrect/unset).
  */
-int SCT_get_signature_nid(const SCT *sct);
+int __cdecl SCT_get_signature_nid(const SCT *sct);
 
 /*
  * Set the signature type of an SCT
@@ -213,27 +213,27 @@ int SCT_get_signature_nid(const SCT *sct);
  * NID_ecdsa_with_SHA256.
  * Returns 1 on success, 0 otherwise.
  */
-__owur int SCT_set_signature_nid(SCT *sct, int nid);
+__owur int __cdecl SCT_set_signature_nid(SCT *sct, int nid);
 
 /*
  * Set *ext to point to the extension data for the SCT. ext must not be NULL.
  * The SCT retains ownership of this pointer.
  * Returns length of the data pointed to.
  */
-size_t SCT_get0_extensions(const SCT *sct, unsigned char **ext);
+size_t __cdecl SCT_get0_extensions(const SCT *sct, unsigned char **ext);
 
 /*
  * Set the extensions of an SCT to point directly to the *ext specified.
  * The SCT takes ownership of the specified pointer.
  */
-void SCT_set0_extensions(SCT *sct, unsigned char *ext, size_t ext_len);
+void __cdecl SCT_set0_extensions(SCT *sct, unsigned char *ext, size_t ext_len);
 
 /*
  * Set the extensions of an SCT.
  * This takes a copy of the ext.
  * Returns 1 on success, 0 otherwise.
  */
-__owur int SCT_set1_extensions(SCT *sct, const unsigned char *ext,
+__owur int __cdecl SCT_set1_extensions(SCT *sct, const unsigned char *ext,
                                size_t ext_len);
 
 /*
@@ -241,36 +241,36 @@ __owur int SCT_set1_extensions(SCT *sct, const unsigned char *ext,
  * The SCT retains ownership of this pointer.
  * Returns length of the data pointed to.
  */
-size_t SCT_get0_signature(const SCT *sct, unsigned char **sig);
+size_t __cdecl SCT_get0_signature(const SCT *sct, unsigned char **sig);
 
 /*
  * Set the signature of an SCT to point directly to the *sig specified.
  * The SCT takes ownership of the specified pointer.
  */
-void SCT_set0_signature(SCT *sct, unsigned char *sig, size_t sig_len);
+void __cdecl SCT_set0_signature(SCT *sct, unsigned char *sig, size_t sig_len);
 
 /*
  * Set the signature of an SCT to be a copy of the *sig specified.
  * Returns 1 on success, 0 otherwise.
  */
-__owur int SCT_set1_signature(SCT *sct, const unsigned char *sig,
+__owur int __cdecl SCT_set1_signature(SCT *sct, const unsigned char *sig,
                               size_t sig_len);
 
 /*
  * The origin of this SCT, e.g. TLS extension, OCSP response, etc.
  */
-sct_source_t SCT_get_source(const SCT *sct);
+sct_source_t __cdecl SCT_get_source(const SCT *sct);
 
 /*
  * Set the origin of this SCT, e.g. TLS extension, OCSP response, etc.
  * Returns 1 on success, 0 otherwise.
  */
-__owur int SCT_set_source(SCT *sct, sct_source_t source);
+__owur int __cdecl SCT_set_source(SCT *sct, sct_source_t source);
 
 /*
  * Returns a text string describing the validation status of |sct|.
  */
-const char *SCT_validation_status_string(const SCT *sct);
+const char * __cdecl SCT_validation_status_string(const SCT *sct);
 
 /*
  * Pretty-prints an |sct| to |out|.
@@ -278,7 +278,7 @@ const char *SCT_validation_status_string(const SCT *sct);
  * If |logs| is not NULL, it will be used to lookup the CT log that the SCT came
  * from, so that the log name can be printed.
  */
-void SCT_print(const SCT *sct, BIO *out, int indent, const CTLOG_STORE *logs);
+void __cdecl SCT_print(const SCT *sct, BIO *out, int indent, const CTLOG_STORE *logs);
 
 /*
  * Pretty-prints an |sct_list| to |out|.
@@ -287,14 +287,14 @@ void SCT_print(const SCT *sct, BIO *out, int indent, const CTLOG_STORE *logs);
  * If |logs| is not NULL, it will be used to lookup the CT log that each SCT
  * came from, so that the log names can be printed.
  */
-void SCT_LIST_print(const STACK_OF(SCT) *sct_list, BIO *out, int indent,
+void __cdecl SCT_LIST_print(const STACK_OF(SCT) *sct_list, BIO *out, int indent,
                     const char *separator, const CTLOG_STORE *logs);
 
 /*
  * Gets the last result of validating this SCT.
  * If it has not been validated yet, returns SCT_VALIDATION_STATUS_NOT_SET.
  */
-sct_validation_status_t SCT_get_validation_status(const SCT *sct);
+sct_validation_status_t __cdecl SCT_get_validation_status(const SCT *sct);
 
 /*
  * Validates the given SCT with the provided context.
@@ -303,7 +303,7 @@ sct_validation_status_t SCT_get_validation_status(const SCT *sct);
  * Returns 0 if the SCT is invalid or could not be verified.
  * Returns -1 if an error occurs.
  */
-__owur int SCT_validate(SCT *sct, const CT_POLICY_EVAL_CTX *ctx);
+__owur int __cdecl SCT_validate(SCT *sct, const CT_POLICY_EVAL_CTX *ctx);
 
 /*
  * Validates the given list of SCTs with the provided context.
@@ -312,7 +312,7 @@ __owur int SCT_validate(SCT *sct, const CT_POLICY_EVAL_CTX *ctx);
  * Returns 0 if at least one SCT is invalid or could not be verified.
  * Returns a negative integer if an error occurs.
  */
-__owur int SCT_LIST_validate(const STACK_OF(SCT) *scts,
+__owur int __cdecl SCT_LIST_validate(const STACK_OF(SCT) *scts,
                              CT_POLICY_EVAL_CTX *ctx);
 
 
@@ -332,7 +332,7 @@ __owur int SCT_LIST_validate(const STACK_OF(SCT) *scts,
  * Returns < 0 on error, >= 0 indicating bytes written (or would have been)
  * on success.
  */
-__owur int i2o_SCT_LIST(const STACK_OF(SCT) *a, unsigned char **pp);
+__owur int __cdecl i2o_SCT_LIST(const STACK_OF(SCT) *a, unsigned char **pp);
 
 /*
  * Convert TLS format SCT list to a stack of SCTs.
@@ -344,7 +344,7 @@ __owur int i2o_SCT_LIST(const STACK_OF(SCT) *a, unsigned char **pp);
  * Upon failure, a NULL pointer will be returned, and the position of "*pp" is
  * not defined.
  */
-STACK_OF(SCT) *o2i_SCT_LIST(STACK_OF(SCT) **a, const unsigned char **pp,
+STACK_OF(SCT) * __cdecl o2i_SCT_LIST(STACK_OF(SCT) **a, const unsigned char **pp,
                             size_t len);
 
 /*
@@ -359,7 +359,7 @@ STACK_OF(SCT) *o2i_SCT_LIST(STACK_OF(SCT) **a, const unsigned char **pp,
  * Returns < 0 on error, >= 0 indicating bytes written (or would have been)
  * on success.
  */
-__owur int i2d_SCT_LIST(const STACK_OF(SCT) *a, unsigned char **pp);
+__owur int __cdecl i2d_SCT_LIST(const STACK_OF(SCT) *a, unsigned char **pp);
 
 /*
  * Parses an SCT list in DER format and returns it.
@@ -371,7 +371,7 @@ __owur int i2d_SCT_LIST(const STACK_OF(SCT) *a, unsigned char **pp);
  * Upon failure, a NULL pointer will be returned, and the position of "*pp" is
  * not defined.
  */
-STACK_OF(SCT) *d2i_SCT_LIST(STACK_OF(SCT) **a, const unsigned char **pp,
+STACK_OF(SCT) * __cdecl d2i_SCT_LIST(STACK_OF(SCT) **a, const unsigned char **pp,
                             long len);
 
 /*
@@ -383,7 +383,7 @@ STACK_OF(SCT) *d2i_SCT_LIST(STACK_OF(SCT) **a, const unsigned char **pp,
  * to it.
  * The length of the SCT in TLS format will be returned.
  */
-__owur int i2o_SCT(const SCT *sct, unsigned char **out);
+__owur int __cdecl i2o_SCT(const SCT *sct, unsigned char **out);
 
 /*
  * Parses an SCT in TLS format and returns it.
@@ -396,7 +396,7 @@ __owur int i2o_SCT(const SCT *sct, unsigned char **out);
  * If the SCT is an unsupported version, only the SCT's 'sct' and 'sct_len'
  * fields will be populated (with |in| and |len| respectively).
  */
-SCT *o2i_SCT(SCT **psct, const unsigned char **in, size_t len);
+SCT * __cdecl o2i_SCT(SCT **psct, const unsigned char **in, size_t len);
 
 /********************
  * CT log functions *
@@ -408,7 +408,7 @@ SCT *o2i_SCT(SCT **psct, const unsigned char **in, size_t len);
  * Returns NULL if malloc fails or if |public_key| cannot be converted to DER.
  * Should be deleted by the caller using CTLOG_free when no longer needed.
  */
-CTLOG *CTLOG_new(EVP_PKEY *public_key, const char *name);
+CTLOG * __cdecl CTLOG_new(EVP_PKEY *public_key, const char *name);
 
 /*
  * Creates a new CTLOG instance with the base64-encoded SubjectPublicKeyInfo DER
@@ -416,21 +416,21 @@ CTLOG *CTLOG_new(EVP_PKEY *public_key, const char *name);
  * Returns 1 on success, 0 on failure.
  * Should be deleted by the caller using CTLOG_free when no longer needed.
  */
-int CTLOG_new_from_base64(CTLOG ** ct_log,
+int __cdecl CTLOG_new_from_base64(CTLOG ** ct_log,
                           const char *pkey_base64, const char *name);
 
 /*
  * Deletes a CT log instance and its fields.
  */
-void CTLOG_free(CTLOG *log);
+void __cdecl CTLOG_free(CTLOG *log);
 
 /* Gets the name of the CT log */
-const char *CTLOG_get0_name(const CTLOG *log);
+const char * __cdecl CTLOG_get0_name(const CTLOG *log);
 /* Gets the ID of the CT log */
-void CTLOG_get0_log_id(const CTLOG *log, const uint8_t **log_id,
+void __cdecl CTLOG_get0_log_id(const CTLOG *log, const uint8_t **log_id,
                        size_t *log_id_len);
 /* Gets the public key of the CT log */
-EVP_PKEY *CTLOG_get0_public_key(const CTLOG *log);
+EVP_PKEY * __cdecl CTLOG_get0_public_key(const CTLOG *log);
 
 /**************************
  * CT log store functions *
@@ -440,18 +440,18 @@ EVP_PKEY *CTLOG_get0_public_key(const CTLOG *log);
  * Creates a new CT log store.
  * Should be deleted by the caller using CTLOG_STORE_free when no longer needed.
  */
-CTLOG_STORE *CTLOG_STORE_new(void);
+CTLOG_STORE * __cdecl CTLOG_STORE_new(void);
 
 /*
  * Deletes a CT log store and all of the CT log instances held within.
  */
-void CTLOG_STORE_free(CTLOG_STORE *store);
+void __cdecl CTLOG_STORE_free(CTLOG_STORE *store);
 
 /*
  * Finds a CT log in the store based on its log ID.
  * Returns the CT log, or NULL if no match is found.
  */
-const CTLOG *CTLOG_STORE_get0_log_by_id(const CTLOG_STORE *store,
+const CTLOG * __cdecl CTLOG_STORE_get0_log_by_id(const CTLOG_STORE *store,
                                         const uint8_t *log_id,
                                         size_t log_id_len);
 
@@ -459,7 +459,7 @@ const CTLOG *CTLOG_STORE_get0_log_by_id(const CTLOG_STORE *store,
  * Loads a CT log list into a |store| from a |file|.
  * Returns 1 if loading is successful, or 0 otherwise.
  */
-__owur int CTLOG_STORE_load_file(CTLOG_STORE *store, const char *file);
+__owur int __cdecl CTLOG_STORE_load_file(CTLOG_STORE *store, const char *file);
 
 /*
  * Loads the default CT log list into a |store|.
@@ -467,7 +467,7 @@ __owur int CTLOG_STORE_load_file(CTLOG_STORE *store, const char *file);
  * consulted to find the default file.
  * Returns 1 if loading is successful, or 0 otherwise.
  */
-__owur int CTLOG_STORE_load_default_file(CTLOG_STORE *store);
+__owur int __cdecl CTLOG_STORE_load_default_file(CTLOG_STORE *store);
 
 #  ifdef  __cplusplus
 }
diff --git a/include/openssl/cterr.h b/include/openssl/cterr.h
index feb7bc5663..a5cfb116bc 100644
--- a/include/openssl/cterr.h
+++ b/include/openssl/cterr.h
@@ -22,7 +22,7 @@
 #  ifdef  __cplusplus
 extern "C"
 #  endif
-int ERR_load_CT_strings(void);
+int __cdecl ERR_load_CT_strings(void);
 
 /*
  * CT function codes.
diff --git a/include/openssl/des.h b/include/openssl/des.h
index be4abbdfd0..e684a43b34 100644
--- a/include/openssl/des.h
+++ b/include/openssl/des.h
@@ -66,28 +66,28 @@ typedef struct DES_ks {
 OPENSSL_DECLARE_GLOBAL(int, DES_check_key); /* defaults to false */
 # define DES_check_key OPENSSL_GLOBAL_REF(DES_check_key)
 
-const char *DES_options(void);
-void DES_ecb3_encrypt(const_DES_cblock *input, DES_cblock *output,
+const char * __cdecl DES_options(void);
+void __cdecl DES_ecb3_encrypt(const_DES_cblock *input, DES_cblock *output,
                       DES_key_schedule *ks1, DES_key_schedule *ks2,
                       DES_key_schedule *ks3, int enc);
-DES_LONG DES_cbc_cksum(const unsigned char *input, DES_cblock *output,
+DES_LONG __cdecl DES_cbc_cksum(const unsigned char *input, DES_cblock *output,
                        long length, DES_key_schedule *schedule,
                        const_DES_cblock *ivec);
 /* DES_cbc_encrypt does not update the IV!  Use DES_ncbc_encrypt instead. */
-void DES_cbc_encrypt(const unsigned char *input, unsigned char *output,
+void __cdecl DES_cbc_encrypt(const unsigned char *input, unsigned char *output,
                      long length, DES_key_schedule *schedule,
                      DES_cblock *ivec, int enc);
-void DES_ncbc_encrypt(const unsigned char *input, unsigned char *output,
+void __cdecl DES_ncbc_encrypt(const unsigned char *input, unsigned char *output,
                       long length, DES_key_schedule *schedule,
                       DES_cblock *ivec, int enc);
-void DES_xcbc_encrypt(const unsigned char *input, unsigned char *output,
+void __cdecl DES_xcbc_encrypt(const unsigned char *input, unsigned char *output,
                       long length, DES_key_schedule *schedule,
                       DES_cblock *ivec, const_DES_cblock *inw,
                       const_DES_cblock *outw, int enc);
-void DES_cfb_encrypt(const unsigned char *in, unsigned char *out, int numbits,
+void __cdecl DES_cfb_encrypt(const unsigned char *in, unsigned char *out, int numbits,
                      long length, DES_key_schedule *schedule,
                      DES_cblock *ivec, int enc);
-void DES_ecb_encrypt(const_DES_cblock *input, DES_cblock *output,
+void __cdecl DES_ecb_encrypt(const_DES_cblock *input, DES_cblock *output,
                      DES_key_schedule *ks, int enc);
 
 /*
@@ -100,7 +100,7 @@ void DES_ecb_encrypt(const_DES_cblock *input, DES_cblock *output,
  * long's and ks is the DES_key_schedule to use.  enc, is non zero specifies
  * encryption, zero if decryption.
  */
-void DES_encrypt1(DES_LONG *data, DES_key_schedule *ks, int enc);
+void __cdecl DES_encrypt1(DES_LONG *data, DES_key_schedule *ks, int enc);
 
 /*
  * This functions is the same as DES_encrypt1() except that the DES initial
@@ -110,57 +110,57 @@ void DES_encrypt1(DES_LONG *data, DES_key_schedule *ks, int enc);
  * DES_encrypt2() DES_encrypt2() FP() is the same as DES_encrypt1()
  * DES_encrypt1() DES_encrypt1() except faster :-).
  */
-void DES_encrypt2(DES_LONG *data, DES_key_schedule *ks, int enc);
+void __cdecl DES_encrypt2(DES_LONG *data, DES_key_schedule *ks, int enc);
 
-void DES_encrypt3(DES_LONG *data, DES_key_schedule *ks1,
+void __cdecl DES_encrypt3(DES_LONG *data, DES_key_schedule *ks1,
                   DES_key_schedule *ks2, DES_key_schedule *ks3);
-void DES_decrypt3(DES_LONG *data, DES_key_schedule *ks1,
+void __cdecl DES_decrypt3(DES_LONG *data, DES_key_schedule *ks1,
                   DES_key_schedule *ks2, DES_key_schedule *ks3);
-void DES_ede3_cbc_encrypt(const unsigned char *input, unsigned char *output,
+void __cdecl DES_ede3_cbc_encrypt(const unsigned char *input, unsigned char *output,
                           long length,
                           DES_key_schedule *ks1, DES_key_schedule *ks2,
                           DES_key_schedule *ks3, DES_cblock *ivec, int enc);
-void DES_ede3_cfb64_encrypt(const unsigned char *in, unsigned char *out,
+void __cdecl DES_ede3_cfb64_encrypt(const unsigned char *in, unsigned char *out,
                             long length, DES_key_schedule *ks1,
                             DES_key_schedule *ks2, DES_key_schedule *ks3,
                             DES_cblock *ivec, int *num, int enc);
-void DES_ede3_cfb_encrypt(const unsigned char *in, unsigned char *out,
+void __cdecl DES_ede3_cfb_encrypt(const unsigned char *in, unsigned char *out,
                           int numbits, long length, DES_key_schedule *ks1,
                           DES_key_schedule *ks2, DES_key_schedule *ks3,
                           DES_cblock *ivec, int enc);
-void DES_ede3_ofb64_encrypt(const unsigned char *in, unsigned char *out,
+void __cdecl DES_ede3_ofb64_encrypt(const unsigned char *in, unsigned char *out,
                             long length, DES_key_schedule *ks1,
                             DES_key_schedule *ks2, DES_key_schedule *ks3,
                             DES_cblock *ivec, int *num);
-char *DES_fcrypt(const char *buf, const char *salt, char *ret);
-char *DES_crypt(const char *buf, const char *salt);
-void DES_ofb_encrypt(const unsigned char *in, unsigned char *out, int numbits,
+char * __cdecl DES_fcrypt(const char *buf, const char *salt, char *ret);
+char * __cdecl DES_crypt(const char *buf, const char *salt);
+void __cdecl DES_ofb_encrypt(const unsigned char *in, unsigned char *out, int numbits,
                      long length, DES_key_schedule *schedule,
                      DES_cblock *ivec);
-void DES_pcbc_encrypt(const unsigned char *input, unsigned char *output,
+void __cdecl DES_pcbc_encrypt(const unsigned char *input, unsigned char *output,
                       long length, DES_key_schedule *schedule,
                       DES_cblock *ivec, int enc);
-DES_LONG DES_quad_cksum(const unsigned char *input, DES_cblock output[],
+DES_LONG __cdecl DES_quad_cksum(const unsigned char *input, DES_cblock output[],
                         long length, int out_count, DES_cblock *seed);
-int DES_random_key(DES_cblock *ret);
-void DES_set_odd_parity(DES_cblock *key);
-int DES_check_key_parity(const_DES_cblock *key);
-int DES_is_weak_key(const_DES_cblock *key);
+int __cdecl DES_random_key(DES_cblock *ret);
+void __cdecl DES_set_odd_parity(DES_cblock *key);
+int __cdecl DES_check_key_parity(const_DES_cblock *key);
+int __cdecl DES_is_weak_key(const_DES_cblock *key);
 /*
  * DES_set_key (= set_key = DES_key_sched = key_sched) calls
  * DES_set_key_checked if global variable DES_check_key is set,
  * DES_set_key_unchecked otherwise.
  */
-int DES_set_key(const_DES_cblock *key, DES_key_schedule *schedule);
-int DES_key_sched(const_DES_cblock *key, DES_key_schedule *schedule);
-int DES_set_key_checked(const_DES_cblock *key, DES_key_schedule *schedule);
-void DES_set_key_unchecked(const_DES_cblock *key, DES_key_schedule *schedule);
-void DES_string_to_key(const char *str, DES_cblock *key);
-void DES_string_to_2keys(const char *str, DES_cblock *key1, DES_cblock *key2);
-void DES_cfb64_encrypt(const unsigned char *in, unsigned char *out,
+int __cdecl DES_set_key(const_DES_cblock *key, DES_key_schedule *schedule);
+int __cdecl DES_key_sched(const_DES_cblock *key, DES_key_schedule *schedule);
+int __cdecl DES_set_key_checked(const_DES_cblock *key, DES_key_schedule *schedule);
+void __cdecl DES_set_key_unchecked(const_DES_cblock *key, DES_key_schedule *schedule);
+void __cdecl DES_string_to_key(const char *str, DES_cblock *key);
+void __cdecl DES_string_to_2keys(const char *str, DES_cblock *key1, DES_cblock *key2);
+void __cdecl DES_cfb64_encrypt(const unsigned char *in, unsigned char *out,
                        long length, DES_key_schedule *schedule,
                        DES_cblock *ivec, int *num, int enc);
-void DES_ofb64_encrypt(const unsigned char *in, unsigned char *out,
+void __cdecl DES_ofb64_encrypt(const unsigned char *in, unsigned char *out,
                        long length, DES_key_schedule *schedule,
                        DES_cblock *ivec, int *num);
 
diff --git a/include/openssl/dh.h b/include/openssl/dh.h
index 3527540cdd..2177cc3c4e 100644
--- a/include/openssl/dh.h
+++ b/include/openssl/dh.h
@@ -112,25 +112,25 @@ DECLARE_ASN1_ITEM(DHparams)
 # define i2d_DHxparams_bio(bp,x) \
     ASN1_i2d_bio_of_const(DH, i2d_DHxparams, bp, x)
 
-DH *DHparams_dup(DH *);
+DH * __cdecl DHparams_dup(DH *);
 
-const DH_METHOD *DH_OpenSSL(void);
+const DH_METHOD * __cdecl DH_OpenSSL(void);
 
-void DH_set_default_method(const DH_METHOD *meth);
-const DH_METHOD *DH_get_default_method(void);
-int DH_set_method(DH *dh, const DH_METHOD *meth);
-DH *DH_new_method(ENGINE *engine);
+void __cdecl DH_set_default_method(const DH_METHOD *meth);
+const DH_METHOD * __cdecl DH_get_default_method(void);
+int __cdecl DH_set_method(DH *dh, const DH_METHOD *meth);
+DH * __cdecl DH_new_method(ENGINE *engine);
 
-DH *DH_new(void);
-void DH_free(DH *dh);
-int DH_up_ref(DH *dh);
-int DH_bits(const DH *dh);
-int DH_size(const DH *dh);
-int DH_security_bits(const DH *dh);
+DH * __cdecl DH_new(void);
+void __cdecl DH_free(DH *dh);
+int __cdecl DH_up_ref(DH *dh);
+int __cdecl DH_bits(const DH *dh);
+int __cdecl DH_size(const DH *dh);
+int __cdecl DH_security_bits(const DH *dh);
 #define DH_get_ex_new_index(l, p, newf, dupf, freef) \
     CRYPTO_get_ex_new_index(CRYPTO_EX_INDEX_DH, l, p, newf, dupf, freef)
-int DH_set_ex_data(DH *d, int idx, void *arg);
-void *DH_get_ex_data(DH *d, int idx);
+int __cdecl DH_set_ex_data(DH *d, int idx, void *arg);
+void * __cdecl DH_get_ex_data(DH *d, int idx);
 
 /* Deprecated version */
 DEPRECATEDIN_0_9_8(DH *DH_generate_parameters(int prime_len, int generator,
@@ -139,90 +139,90 @@ DEPRECATEDIN_0_9_8(DH *DH_generate_parameters(int prime_len, int generator,
                                               void *cb_arg))
 
 /* New version */
-int DH_generate_parameters_ex(DH *dh, int prime_len, int generator,
+int __cdecl DH_generate_parameters_ex(DH *dh, int prime_len, int generator,
                               BN_GENCB *cb);
 
-int DH_check_params_ex(const DH *dh);
-int DH_check_ex(const DH *dh);
-int DH_check_pub_key_ex(const DH *dh, const BIGNUM *pub_key);
-int DH_check_params(const DH *dh, int *ret);
-int DH_check(const DH *dh, int *codes);
-int DH_check_pub_key(const DH *dh, const BIGNUM *pub_key, int *codes);
-int DH_generate_key(DH *dh);
-int DH_compute_key(unsigned char *key, const BIGNUM *pub_key, DH *dh);
-int DH_compute_key_padded(unsigned char *key, const BIGNUM *pub_key, DH *dh);
-DH *d2i_DHparams(DH **a, const unsigned char **pp, long length);
-int i2d_DHparams(const DH *a, unsigned char **pp);
-DH *d2i_DHxparams(DH **a, const unsigned char **pp, long length);
-int i2d_DHxparams(const DH *a, unsigned char **pp);
+int __cdecl DH_check_params_ex(const DH *dh);
+int __cdecl DH_check_ex(const DH *dh);
+int __cdecl DH_check_pub_key_ex(const DH *dh, const BIGNUM *pub_key);
+int __cdecl DH_check_params(const DH *dh, int *ret);
+int __cdecl DH_check(const DH *dh, int *codes);
+int __cdecl DH_check_pub_key(const DH *dh, const BIGNUM *pub_key, int *codes);
+int __cdecl DH_generate_key(DH *dh);
+int __cdecl DH_compute_key(unsigned char *key, const BIGNUM *pub_key, DH *dh);
+int __cdecl DH_compute_key_padded(unsigned char *key, const BIGNUM *pub_key, DH *dh);
+DH * __cdecl d2i_DHparams(DH **a, const unsigned char **pp, long length);
+int __cdecl i2d_DHparams(const DH *a, unsigned char **pp);
+DH * __cdecl d2i_DHxparams(DH **a, const unsigned char **pp, long length);
+int __cdecl i2d_DHxparams(const DH *a, unsigned char **pp);
 # ifndef OPENSSL_NO_STDIO
-int DHparams_print_fp(FILE *fp, const DH *x);
+int __cdecl DHparams_print_fp(FILE *fp, const DH *x);
 # endif
-int DHparams_print(BIO *bp, const DH *x);
+int __cdecl DHparams_print(BIO *bp, const DH *x);
 
 /* RFC 5114 parameters */
-DH *DH_get_1024_160(void);
-DH *DH_get_2048_224(void);
-DH *DH_get_2048_256(void);
+DH * __cdecl DH_get_1024_160(void);
+DH * __cdecl DH_get_2048_224(void);
+DH * __cdecl DH_get_2048_256(void);
 
 /* Named parameters, currently RFC7919 */
-DH *DH_new_by_nid(int nid);
-int DH_get_nid(const DH *dh);
+DH * __cdecl DH_new_by_nid(int nid);
+int __cdecl DH_get_nid(const DH *dh);
 
 # ifndef OPENSSL_NO_CMS
 /* RFC2631 KDF */
-int DH_KDF_X9_42(unsigned char *out, size_t outlen,
+int __cdecl DH_KDF_X9_42(unsigned char *out, size_t outlen,
                  const unsigned char *Z, size_t Zlen,
                  ASN1_OBJECT *key_oid,
                  const unsigned char *ukm, size_t ukmlen, const EVP_MD *md);
 # endif
 
-void DH_get0_pqg(const DH *dh,
+void __cdecl DH_get0_pqg(const DH *dh,
                  const BIGNUM **p, const BIGNUM **q, const BIGNUM **g);
-int DH_set0_pqg(DH *dh, BIGNUM *p, BIGNUM *q, BIGNUM *g);
-void DH_get0_key(const DH *dh,
+int __cdecl DH_set0_pqg(DH *dh, BIGNUM *p, BIGNUM *q, BIGNUM *g);
+void __cdecl DH_get0_key(const DH *dh,
                  const BIGNUM **pub_key, const BIGNUM **priv_key);
-int DH_set0_key(DH *dh, BIGNUM *pub_key, BIGNUM *priv_key);
-const BIGNUM *DH_get0_p(const DH *dh);
-const BIGNUM *DH_get0_q(const DH *dh);
-const BIGNUM *DH_get0_g(const DH *dh);
-const BIGNUM *DH_get0_priv_key(const DH *dh);
-const BIGNUM *DH_get0_pub_key(const DH *dh);
-void DH_clear_flags(DH *dh, int flags);
-int DH_test_flags(const DH *dh, int flags);
-void DH_set_flags(DH *dh, int flags);
-ENGINE *DH_get0_engine(DH *d);
-long DH_get_length(const DH *dh);
-int DH_set_length(DH *dh, long length);
-
-DH_METHOD *DH_meth_new(const char *name, int flags);
-void DH_meth_free(DH_METHOD *dhm);
-DH_METHOD *DH_meth_dup(const DH_METHOD *dhm);
-const char *DH_meth_get0_name(const DH_METHOD *dhm);
-int DH_meth_set1_name(DH_METHOD *dhm, const char *name);
-int DH_meth_get_flags(const DH_METHOD *dhm);
-int DH_meth_set_flags(DH_METHOD *dhm, int flags);
-void *DH_meth_get0_app_data(const DH_METHOD *dhm);
-int DH_meth_set0_app_data(DH_METHOD *dhm, void *app_data);
-int (*DH_meth_get_generate_key(const DH_METHOD *dhm)) (DH *);
-int DH_meth_set_generate_key(DH_METHOD *dhm, int (*generate_key) (DH *));
-int (*DH_meth_get_compute_key(const DH_METHOD *dhm))
+int __cdecl DH_set0_key(DH *dh, BIGNUM *pub_key, BIGNUM *priv_key);
+const BIGNUM * __cdecl DH_get0_p(const DH *dh);
+const BIGNUM * __cdecl DH_get0_q(const DH *dh);
+const BIGNUM * __cdecl DH_get0_g(const DH *dh);
+const BIGNUM * __cdecl DH_get0_priv_key(const DH *dh);
+const BIGNUM * __cdecl DH_get0_pub_key(const DH *dh);
+void __cdecl DH_clear_flags(DH *dh, int flags);
+int __cdecl DH_test_flags(const DH *dh, int flags);
+void __cdecl DH_set_flags(DH *dh, int flags);
+ENGINE * __cdecl DH_get0_engine(DH *d);
+long __cdecl DH_get_length(const DH *dh);
+int __cdecl DH_set_length(DH *dh, long length);
+
+DH_METHOD * __cdecl DH_meth_new(const char *name, int flags);
+void __cdecl DH_meth_free(DH_METHOD *dhm);
+DH_METHOD * __cdecl DH_meth_dup(const DH_METHOD *dhm);
+const char * __cdecl DH_meth_get0_name(const DH_METHOD *dhm);
+int __cdecl DH_meth_set1_name(DH_METHOD *dhm, const char *name);
+int __cdecl DH_meth_get_flags(const DH_METHOD *dhm);
+int __cdecl DH_meth_set_flags(DH_METHOD *dhm, int flags);
+void * __cdecl DH_meth_get0_app_data(const DH_METHOD *dhm);
+int __cdecl DH_meth_set0_app_data(DH_METHOD *dhm, void *app_data);
+int (* __cdecl DH_meth_get_generate_key(const DH_METHOD *dhm)) (DH *);
+int __cdecl DH_meth_set_generate_key(DH_METHOD *dhm, int (*generate_key) (DH *));
+int (* __cdecl DH_meth_get_compute_key(const DH_METHOD *dhm))
         (unsigned char *key, const BIGNUM *pub_key, DH *dh);
-int DH_meth_set_compute_key(DH_METHOD *dhm,
+int __cdecl DH_meth_set_compute_key(DH_METHOD *dhm,
         int (*compute_key) (unsigned char *key, const BIGNUM *pub_key, DH *dh));
-int (*DH_meth_get_bn_mod_exp(const DH_METHOD *dhm))
+int (* __cdecl DH_meth_get_bn_mod_exp(const DH_METHOD *dhm))
     (const DH *, BIGNUM *, const BIGNUM *, const BIGNUM *, const BIGNUM *,
      BN_CTX *, BN_MONT_CTX *);
-int DH_meth_set_bn_mod_exp(DH_METHOD *dhm,
+int __cdecl DH_meth_set_bn_mod_exp(DH_METHOD *dhm,
     int (*bn_mod_exp) (const DH *, BIGNUM *, const BIGNUM *, const BIGNUM *,
                        const BIGNUM *, BN_CTX *, BN_MONT_CTX *));
-int (*DH_meth_get_init(const DH_METHOD *dhm))(DH *);
-int DH_meth_set_init(DH_METHOD *dhm, int (*init)(DH *));
-int (*DH_meth_get_finish(const DH_METHOD *dhm)) (DH *);
-int DH_meth_set_finish(DH_METHOD *dhm, int (*finish) (DH *));
-int (*DH_meth_get_generate_params(const DH_METHOD *dhm))
+int (* __cdecl DH_meth_get_init(const DH_METHOD *dhm))(DH *);
+int __cdecl DH_meth_set_init(DH_METHOD *dhm, int (*init)(DH *));
+int (* __cdecl DH_meth_get_finish(const DH_METHOD *dhm)) (DH *);
+int __cdecl DH_meth_set_finish(DH_METHOD *dhm, int (*finish) (DH *));
+int (* __cdecl DH_meth_get_generate_params(const DH_METHOD *dhm))
         (DH *, int, int, BN_GENCB *);
-int DH_meth_set_generate_params(DH_METHOD *dhm,
+int __cdecl DH_meth_set_generate_params(DH_METHOD *dhm,
         int (*generate_params) (DH *, int, int, BN_GENCB *));
 
 
diff --git a/include/openssl/dherr.h b/include/openssl/dherr.h
index 916b3bed0b..7b3098fe06 100644
--- a/include/openssl/dherr.h
+++ b/include/openssl/dherr.h
@@ -22,7 +22,7 @@
 #  ifdef  __cplusplus
 extern "C"
 #  endif
-int ERR_load_DH_strings(void);
+int __cdecl ERR_load_DH_strings(void);
 
 /*
  * DH function codes.
diff --git a/include/openssl/dsa.h b/include/openssl/dsa.h
index 822eff347a..396c1f12e8 100644
--- a/include/openssl/dsa.h
+++ b/include/openssl/dsa.h
@@ -71,47 +71,47 @@ typedef struct DSA_SIG_st DSA_SIG;
 # define d2i_DSAparams_bio(bp,x) ASN1_d2i_bio_of(DSA,DSA_new,d2i_DSAparams,bp,x)
 # define i2d_DSAparams_bio(bp,x) ASN1_i2d_bio_of_const(DSA,i2d_DSAparams,bp,x)
 
-DSA *DSAparams_dup(DSA *x);
-DSA_SIG *DSA_SIG_new(void);
-void DSA_SIG_free(DSA_SIG *a);
-int i2d_DSA_SIG(const DSA_SIG *a, unsigned char **pp);
-DSA_SIG *d2i_DSA_SIG(DSA_SIG **v, const unsigned char **pp, long length);
-void DSA_SIG_get0(const DSA_SIG *sig, const BIGNUM **pr, const BIGNUM **ps);
-int DSA_SIG_set0(DSA_SIG *sig, BIGNUM *r, BIGNUM *s);
-
-DSA_SIG *DSA_do_sign(const unsigned char *dgst, int dlen, DSA *dsa);
-int DSA_do_verify(const unsigned char *dgst, int dgst_len,
+DSA * __cdecl DSAparams_dup(DSA *x);
+DSA_SIG * __cdecl DSA_SIG_new(void);
+void __cdecl DSA_SIG_free(DSA_SIG *a);
+int __cdecl i2d_DSA_SIG(const DSA_SIG *a, unsigned char **pp);
+DSA_SIG * __cdecl d2i_DSA_SIG(DSA_SIG **v, const unsigned char **pp, long length);
+void __cdecl DSA_SIG_get0(const DSA_SIG *sig, const BIGNUM **pr, const BIGNUM **ps);
+int __cdecl DSA_SIG_set0(DSA_SIG *sig, BIGNUM *r, BIGNUM *s);
+
+DSA_SIG * __cdecl DSA_do_sign(const unsigned char *dgst, int dlen, DSA *dsa);
+int __cdecl DSA_do_verify(const unsigned char *dgst, int dgst_len,
                   DSA_SIG *sig, DSA *dsa);
 
-const DSA_METHOD *DSA_OpenSSL(void);
+const DSA_METHOD * __cdecl DSA_OpenSSL(void);
 
-void DSA_set_default_method(const DSA_METHOD *);
-const DSA_METHOD *DSA_get_default_method(void);
-int DSA_set_method(DSA *dsa, const DSA_METHOD *);
-const DSA_METHOD *DSA_get_method(DSA *d);
+void __cdecl DSA_set_default_method(const DSA_METHOD *);
+const DSA_METHOD * __cdecl DSA_get_default_method(void);
+int __cdecl DSA_set_method(DSA *dsa, const DSA_METHOD *);
+const DSA_METHOD * __cdecl DSA_get_method(DSA *d);
 
-DSA *DSA_new(void);
-DSA *DSA_new_method(ENGINE *engine);
-void DSA_free(DSA *r);
+DSA * __cdecl DSA_new(void);
+DSA * __cdecl DSA_new_method(ENGINE *engine);
+void __cdecl DSA_free(DSA *r);
 /* "up" the DSA object's reference count */
-int DSA_up_ref(DSA *r);
-int DSA_size(const DSA *);
-int DSA_bits(const DSA *d);
-int DSA_security_bits(const DSA *d);
+int __cdecl DSA_up_ref(DSA *r);
+int __cdecl DSA_size(const DSA *);
+int __cdecl DSA_bits(const DSA *d);
+int __cdecl DSA_security_bits(const DSA *d);
         /* next 4 return -1 on error */
-DEPRECATEDIN_1_2_0(int DSA_sign_setup(DSA *dsa, BN_CTX *ctx_in, BIGNUM **kinvp, BIGNUM **rp))
-int DSA_sign(int type, const unsigned char *dgst, int dlen,
+DEPRECATEDIN_1_2_0(int __cdecl DSA_sign_setup(DSA *dsa, BN_CTX *ctx_in, BIGNUM **kinvp, BIGNUM **rp))
+int __cdecl DSA_sign(int type, const unsigned char *dgst, int dlen,
              unsigned char *sig, unsigned int *siglen, DSA *dsa);
-int DSA_verify(int type, const unsigned char *dgst, int dgst_len,
+int __cdecl DSA_verify(int type, const unsigned char *dgst, int dgst_len,
                const unsigned char *sigbuf, int siglen, DSA *dsa);
 #define DSA_get_ex_new_index(l, p, newf, dupf, freef) \
     CRYPTO_get_ex_new_index(CRYPTO_EX_INDEX_DSA, l, p, newf, dupf, freef)
-int DSA_set_ex_data(DSA *d, int idx, void *arg);
-void *DSA_get_ex_data(DSA *d, int idx);
+int __cdecl DSA_set_ex_data(DSA *d, int idx, void *arg);
+void * __cdecl DSA_get_ex_data(DSA *d, int idx);
 
-DSA *d2i_DSAPublicKey(DSA **a, const unsigned char **pp, long length);
-DSA *d2i_DSAPrivateKey(DSA **a, const unsigned char **pp, long length);
-DSA *d2i_DSAparams(DSA **a, const unsigned char **pp, long length);
+DSA * __cdecl d2i_DSAPublicKey(DSA **a, const unsigned char **pp, long length);
+DSA * __cdecl d2i_DSAPrivateKey(DSA **a, const unsigned char **pp, long length);
+DSA * __cdecl d2i_DSAparams(DSA **a, const unsigned char **pp, long length);
 
 /* Deprecated version */
 DEPRECATEDIN_0_9_8(DSA *DSA_generate_parameters(int bits,
@@ -124,21 +124,21 @@ DEPRECATEDIN_0_9_8(DSA *DSA_generate_parameters(int bits,
                                                 void *cb_arg))
 
 /* New version */
-int DSA_generate_parameters_ex(DSA *dsa, int bits,
+int __cdecl DSA_generate_parameters_ex(DSA *dsa, int bits,
                                const unsigned char *seed, int seed_len,
                                int *counter_ret, unsigned long *h_ret,
                                BN_GENCB *cb);
 
-int DSA_generate_key(DSA *a);
-int i2d_DSAPublicKey(const DSA *a, unsigned char **pp);
-int i2d_DSAPrivateKey(const DSA *a, unsigned char **pp);
-int i2d_DSAparams(const DSA *a, unsigned char **pp);
+int __cdecl DSA_generate_key(DSA *a);
+int __cdecl i2d_DSAPublicKey(const DSA *a, unsigned char **pp);
+int __cdecl i2d_DSAPrivateKey(const DSA *a, unsigned char **pp);
+int __cdecl i2d_DSAparams(const DSA *a, unsigned char **pp);
 
-int DSAparams_print(BIO *bp, const DSA *x);
-int DSA_print(BIO *bp, const DSA *x, int off);
+int __cdecl DSAparams_print(BIO *bp, const DSA *x);
+int __cdecl DSA_print(BIO *bp, const DSA *x, int off);
 # ifndef OPENSSL_NO_STDIO
-int DSAparams_print_fp(FILE *fp, const DSA *x);
-int DSA_print_fp(FILE *bp, const DSA *x, int off);
+int __cdecl DSAparams_print_fp(FILE *fp, const DSA *x);
+int __cdecl DSA_print_fp(FILE *bp, const DSA *x, int off);
 # endif
 
 # define DSS_prime_checks 64
@@ -156,7 +156,7 @@ int DSA_print_fp(FILE *bp, const DSA *x, int off);
  * Convert DSA structure (key or just parameters) into DH structure (be
  * careful to avoid small subgroup attacks when using this!)
  */
-DH *DSA_dup_DH(const DSA *r);
+DH * __cdecl DSA_dup_DH(const DSA *r);
 # endif
 
 # define EVP_PKEY_CTX_set_dsa_paramgen_bits(ctx, nbits) \
@@ -167,68 +167,68 @@ DH *DSA_dup_DH(const DSA *r);
 # define EVP_PKEY_CTRL_DSA_PARAMGEN_Q_BITS       (EVP_PKEY_ALG_CTRL + 2)
 # define EVP_PKEY_CTRL_DSA_PARAMGEN_MD           (EVP_PKEY_ALG_CTRL + 3)
 
-void DSA_get0_pqg(const DSA *d,
+void __cdecl DSA_get0_pqg(const DSA *d,
                   const BIGNUM **p, const BIGNUM **q, const BIGNUM **g);
-int DSA_set0_pqg(DSA *d, BIGNUM *p, BIGNUM *q, BIGNUM *g);
-void DSA_get0_key(const DSA *d,
+int __cdecl DSA_set0_pqg(DSA *d, BIGNUM *p, BIGNUM *q, BIGNUM *g);
+void __cdecl DSA_get0_key(const DSA *d,
                   const BIGNUM **pub_key, const BIGNUM **priv_key);
-int DSA_set0_key(DSA *d, BIGNUM *pub_key, BIGNUM *priv_key);
-const BIGNUM *DSA_get0_p(const DSA *d);
-const BIGNUM *DSA_get0_q(const DSA *d);
-const BIGNUM *DSA_get0_g(const DSA *d);
-const BIGNUM *DSA_get0_pub_key(const DSA *d);
-const BIGNUM *DSA_get0_priv_key(const DSA *d);
-void DSA_clear_flags(DSA *d, int flags);
-int DSA_test_flags(const DSA *d, int flags);
-void DSA_set_flags(DSA *d, int flags);
-ENGINE *DSA_get0_engine(DSA *d);
-
-DSA_METHOD *DSA_meth_new(const char *name, int flags);
-void DSA_meth_free(DSA_METHOD *dsam);
-DSA_METHOD *DSA_meth_dup(const DSA_METHOD *dsam);
-const char *DSA_meth_get0_name(const DSA_METHOD *dsam);
-int DSA_meth_set1_name(DSA_METHOD *dsam, const char *name);
-int DSA_meth_get_flags(const DSA_METHOD *dsam);
-int DSA_meth_set_flags(DSA_METHOD *dsam, int flags);
-void *DSA_meth_get0_app_data(const DSA_METHOD *dsam);
-int DSA_meth_set0_app_data(DSA_METHOD *dsam, void *app_data);
-DSA_SIG *(*DSA_meth_get_sign(const DSA_METHOD *dsam))
+int __cdecl DSA_set0_key(DSA *d, BIGNUM *pub_key, BIGNUM *priv_key);
+const BIGNUM * __cdecl DSA_get0_p(const DSA *d);
+const BIGNUM * __cdecl DSA_get0_q(const DSA *d);
+const BIGNUM * __cdecl DSA_get0_g(const DSA *d);
+const BIGNUM * __cdecl DSA_get0_pub_key(const DSA *d);
+const BIGNUM * __cdecl DSA_get0_priv_key(const DSA *d);
+void __cdecl DSA_clear_flags(DSA *d, int flags);
+int __cdecl DSA_test_flags(const DSA *d, int flags);
+void __cdecl DSA_set_flags(DSA *d, int flags);
+ENGINE * __cdecl DSA_get0_engine(DSA *d);
+
+DSA_METHOD * __cdecl DSA_meth_new(const char *name, int flags);
+void __cdecl DSA_meth_free(DSA_METHOD *dsam);
+DSA_METHOD * __cdecl DSA_meth_dup(const DSA_METHOD *dsam);
+const char * __cdecl DSA_meth_get0_name(const DSA_METHOD *dsam);
+int __cdecl DSA_meth_set1_name(DSA_METHOD *dsam, const char *name);
+int __cdecl DSA_meth_get_flags(const DSA_METHOD *dsam);
+int __cdecl DSA_meth_set_flags(DSA_METHOD *dsam, int flags);
+void * __cdecl DSA_meth_get0_app_data(const DSA_METHOD *dsam);
+int __cdecl DSA_meth_set0_app_data(DSA_METHOD *dsam, void *app_data);
+DSA_SIG *(__cdecl *DSA_meth_get_sign(const DSA_METHOD *dsam))
         (const unsigned char *, int, DSA *);
-int DSA_meth_set_sign(DSA_METHOD *dsam,
-                       DSA_SIG *(*sign) (const unsigned char *, int, DSA *));
-int (*DSA_meth_get_sign_setup(const DSA_METHOD *dsam))
+int __cdecl DSA_meth_set_sign(DSA_METHOD *dsam,
+                       DSA_SIG *(__cdecl *sign) (const unsigned char *, int, DSA *));
+int (* __cdecl DSA_meth_get_sign_setup(const DSA_METHOD *dsam))
         (DSA *, BN_CTX *, BIGNUM **, BIGNUM **);
-int DSA_meth_set_sign_setup(DSA_METHOD *dsam,
+int __cdecl DSA_meth_set_sign_setup(DSA_METHOD *dsam,
         int (*sign_setup) (DSA *, BN_CTX *, BIGNUM **, BIGNUM **));
-int (*DSA_meth_get_verify(const DSA_METHOD *dsam))
+int (* __cdecl DSA_meth_get_verify(const DSA_METHOD *dsam))
         (const unsigned char *, int, DSA_SIG *, DSA *);
-int DSA_meth_set_verify(DSA_METHOD *dsam,
+int __cdecl DSA_meth_set_verify(DSA_METHOD *dsam,
     int (*verify) (const unsigned char *, int, DSA_SIG *, DSA *));
-int (*DSA_meth_get_mod_exp(const DSA_METHOD *dsam))
+int (* __cdecl DSA_meth_get_mod_exp(const DSA_METHOD *dsam))
         (DSA *, BIGNUM *, const BIGNUM *, const BIGNUM *, const BIGNUM *,
          const BIGNUM *, const BIGNUM *, BN_CTX *, BN_MONT_CTX *);
-int DSA_meth_set_mod_exp(DSA_METHOD *dsam,
+int __cdecl DSA_meth_set_mod_exp(DSA_METHOD *dsam,
     int (*mod_exp) (DSA *, BIGNUM *, const BIGNUM *, const BIGNUM *,
                     const BIGNUM *, const BIGNUM *, const BIGNUM *, BN_CTX *,
                     BN_MONT_CTX *));
-int (*DSA_meth_get_bn_mod_exp(const DSA_METHOD *dsam))
+int (* __cdecl DSA_meth_get_bn_mod_exp(const DSA_METHOD *dsam))
     (DSA *, BIGNUM *, const BIGNUM *, const BIGNUM *, const BIGNUM *,
      BN_CTX *, BN_MONT_CTX *);
-int DSA_meth_set_bn_mod_exp(DSA_METHOD *dsam,
+int __cdecl DSA_meth_set_bn_mod_exp(DSA_METHOD *dsam,
     int (*bn_mod_exp) (DSA *, BIGNUM *, const BIGNUM *, const BIGNUM *,
                        const BIGNUM *, BN_CTX *, BN_MONT_CTX *));
-int (*DSA_meth_get_init(const DSA_METHOD *dsam))(DSA *);
-int DSA_meth_set_init(DSA_METHOD *dsam, int (*init)(DSA *));
-int (*DSA_meth_get_finish(const DSA_METHOD *dsam)) (DSA *);
-int DSA_meth_set_finish(DSA_METHOD *dsam, int (*finish) (DSA *));
-int (*DSA_meth_get_paramgen(const DSA_METHOD *dsam))
+int (* __cdecl DSA_meth_get_init(const DSA_METHOD *dsam))(DSA *);
+int __cdecl DSA_meth_set_init(DSA_METHOD *dsam, int (*init)(DSA *));
+int (* __cdecl DSA_meth_get_finish(const DSA_METHOD *dsam)) (DSA *);
+int __cdecl DSA_meth_set_finish(DSA_METHOD *dsam, int (*finish) (DSA *));
+int (* __cdecl DSA_meth_get_paramgen(const DSA_METHOD *dsam))
         (DSA *, int, const unsigned char *, int, int *, unsigned long *,
          BN_GENCB *);
-int DSA_meth_set_paramgen(DSA_METHOD *dsam,
+int __cdecl DSA_meth_set_paramgen(DSA_METHOD *dsam,
         int (*paramgen) (DSA *, int, const unsigned char *, int, int *,
                          unsigned long *, BN_GENCB *));
-int (*DSA_meth_get_keygen(const DSA_METHOD *dsam)) (DSA *);
-int DSA_meth_set_keygen(DSA_METHOD *dsam, int (*keygen) (DSA *));
+int (* __cdecl DSA_meth_get_keygen(const DSA_METHOD *dsam)) (DSA *);
+int __cdecl DSA_meth_set_keygen(DSA_METHOD *dsam, int (*keygen) (DSA *));
 
 
 #  ifdef  __cplusplus
diff --git a/include/openssl/dsaerr.h b/include/openssl/dsaerr.h
index 495a1ac89d..c5e5fd2fe9 100644
--- a/include/openssl/dsaerr.h
+++ b/include/openssl/dsaerr.h
@@ -22,7 +22,7 @@
 #  ifdef  __cplusplus
 extern "C"
 #  endif
-int ERR_load_DSA_strings(void);
+int __cdecl ERR_load_DSA_strings(void);
 
 /*
  * DSA function codes.
diff --git a/include/openssl/ebcdic.h b/include/openssl/ebcdic.h
index aa01285599..c672624cc0 100644
--- a/include/openssl/ebcdic.h
+++ b/include/openssl/ebcdic.h
@@ -24,8 +24,8 @@ extern "C" {
 
 extern const unsigned char os_toascii[256];
 extern const unsigned char os_toebcdic[256];
-void *ebcdic2ascii(void *dest, const void *srce, size_t count);
-void *ascii2ebcdic(void *dest, const void *srce, size_t count);
+void * __cdecl ebcdic2ascii(void *dest, const void *srce, size_t count);
+void * __cdecl ascii2ebcdic(void *dest, const void *srce, size_t count);
 
 #ifdef  __cplusplus
 }
diff --git a/include/openssl/ec.h b/include/openssl/ec.h
index 5af9ebdc7f..1e899652c6 100644
--- a/include/openssl/ec.h
+++ b/include/openssl/ec.h
@@ -55,33 +55,33 @@ typedef struct ec_parameters_st ECPARAMETERS;
  *  optimized methods.
  *  \return  EC_METHOD object
  */
-const EC_METHOD *EC_GFp_simple_method(void);
+const EC_METHOD * __cdecl EC_GFp_simple_method(void);
 
 /** Returns GFp methods using montgomery multiplication.
  *  \return  EC_METHOD object
  */
-const EC_METHOD *EC_GFp_mont_method(void);
+const EC_METHOD * __cdecl EC_GFp_mont_method(void);
 
 /** Returns GFp methods using optimized methods for NIST recommended curves
  *  \return  EC_METHOD object
  */
-const EC_METHOD *EC_GFp_nist_method(void);
+const EC_METHOD * __cdecl EC_GFp_nist_method(void);
 
 # ifndef OPENSSL_NO_EC_NISTP_64_GCC_128
 /** Returns 64-bit optimized methods for nistp224
  *  \return  EC_METHOD object
  */
-const EC_METHOD *EC_GFp_nistp224_method(void);
+const EC_METHOD * __cdecl EC_GFp_nistp224_method(void);
 
 /** Returns 64-bit optimized methods for nistp256
  *  \return  EC_METHOD object
  */
-const EC_METHOD *EC_GFp_nistp256_method(void);
+const EC_METHOD * __cdecl EC_GFp_nistp256_method(void);
 
 /** Returns 64-bit optimized methods for nistp521
  *  \return  EC_METHOD object
  */
-const EC_METHOD *EC_GFp_nistp521_method(void);
+const EC_METHOD * __cdecl EC_GFp_nistp521_method(void);
 # endif
 
 # ifndef OPENSSL_NO_EC2M
@@ -92,7 +92,7 @@ const EC_METHOD *EC_GFp_nistp521_method(void);
 /** Returns the basic GF2m ec method
  *  \return  EC_METHOD object
  */
-const EC_METHOD *EC_GF2m_simple_method(void);
+const EC_METHOD * __cdecl EC_GF2m_simple_method(void);
 
 # endif
 
@@ -104,43 +104,43 @@ const EC_METHOD *EC_GF2m_simple_method(void);
  *  \param   meth  EC_METHOD to use
  *  \return  newly created EC_GROUP object or NULL in case of an error.
  */
-EC_GROUP *EC_GROUP_new(const EC_METHOD *meth);
+EC_GROUP * __cdecl EC_GROUP_new(const EC_METHOD *meth);
 
 /** Frees a EC_GROUP object
  *  \param  group  EC_GROUP object to be freed.
  */
-void EC_GROUP_free(EC_GROUP *group);
+void __cdecl EC_GROUP_free(EC_GROUP *group);
 
 /** Clears and frees a EC_GROUP object
  *  \param  group  EC_GROUP object to be cleared and freed.
  */
-void EC_GROUP_clear_free(EC_GROUP *group);
+void __cdecl EC_GROUP_clear_free(EC_GROUP *group);
 
 /** Copies EC_GROUP objects. Note: both EC_GROUPs must use the same EC_METHOD.
  *  \param  dst  destination EC_GROUP object
  *  \param  src  source EC_GROUP object
  *  \return 1 on success and 0 if an error occurred.
  */
-int EC_GROUP_copy(EC_GROUP *dst, const EC_GROUP *src);
+int __cdecl EC_GROUP_copy(EC_GROUP *dst, const EC_GROUP *src);
 
 /** Creates a new EC_GROUP object and copies the copies the content
  *  form src to the newly created EC_KEY object
  *  \param  src  source EC_GROUP object
  *  \return newly created EC_GROUP object or NULL in case of an error.
  */
-EC_GROUP *EC_GROUP_dup(const EC_GROUP *src);
+EC_GROUP * __cdecl EC_GROUP_dup(const EC_GROUP *src);
 
 /** Returns the EC_METHOD of the EC_GROUP object.
  *  \param  group  EC_GROUP object
  *  \return EC_METHOD used in this EC_GROUP object.
  */
-const EC_METHOD *EC_GROUP_method_of(const EC_GROUP *group);
+const EC_METHOD * __cdecl EC_GROUP_method_of(const EC_GROUP *group);
 
 /** Returns the field type of the EC_METHOD.
  *  \param  meth  EC_METHOD object
  *  \return NID of the underlying field type OID.
  */
-int EC_METHOD_get_field_type(const EC_METHOD *meth);
+int __cdecl EC_METHOD_get_field_type(const EC_METHOD *meth);
 
 /** Sets the generator and its order/cofactor of a EC_GROUP object.
  *  \param  group      EC_GROUP object
@@ -150,20 +150,20 @@ int EC_METHOD_get_field_type(const EC_METHOD *meth);
  *                     in the group of all points on the elliptic curve.
  *  \return 1 on success and 0 if an error occurred
  */
-int EC_GROUP_set_generator(EC_GROUP *group, const EC_POINT *generator,
+int __cdecl EC_GROUP_set_generator(EC_GROUP *group, const EC_POINT *generator,
                            const BIGNUM *order, const BIGNUM *cofactor);
 
 /** Returns the generator of a EC_GROUP object.
  *  \param  group  EC_GROUP object
  *  \return the currently used generator (possibly NULL).
  */
-const EC_POINT *EC_GROUP_get0_generator(const EC_GROUP *group);
+const EC_POINT * __cdecl EC_GROUP_get0_generator(const EC_GROUP *group);
 
 /** Returns the montgomery data for order(Generator)
  *  \param  group  EC_GROUP object
  *  \return the currently used montgomery data (possibly NULL).
 */
-BN_MONT_CTX *EC_GROUP_get_mont_data(const EC_GROUP *group);
+BN_MONT_CTX * __cdecl EC_GROUP_get_mont_data(const EC_GROUP *group);
 
 /** Gets the order of a EC_GROUP
  *  \param  group  EC_GROUP object
@@ -171,19 +171,19 @@ BN_MONT_CTX *EC_GROUP_get_mont_data(const EC_GROUP *group);
  *  \param  ctx    unused
  *  \return 1 on success and 0 if an error occurred
  */
-int EC_GROUP_get_order(const EC_GROUP *group, BIGNUM *order, BN_CTX *ctx);
+int __cdecl EC_GROUP_get_order(const EC_GROUP *group, BIGNUM *order, BN_CTX *ctx);
 
 /** Gets the order of an EC_GROUP
  *  \param  group  EC_GROUP object
  *  \return the group order
  */
-const BIGNUM *EC_GROUP_get0_order(const EC_GROUP *group);
+const BIGNUM * __cdecl EC_GROUP_get0_order(const EC_GROUP *group);
 
 /** Gets the number of bits of the order of an EC_GROUP
  *  \param  group  EC_GROUP object
  *  \return number of bits of group order.
  */
-int EC_GROUP_order_bits(const EC_GROUP *group);
+int __cdecl EC_GROUP_order_bits(const EC_GROUP *group);
 
 /** Gets the cofactor of a EC_GROUP
  *  \param  group     EC_GROUP object
@@ -191,37 +191,37 @@ int EC_GROUP_order_bits(const EC_GROUP *group);
  *  \param  ctx       unused
  *  \return 1 on success and 0 if an error occurred
  */
-int EC_GROUP_get_cofactor(const EC_GROUP *group, BIGNUM *cofactor,
+int __cdecl EC_GROUP_get_cofactor(const EC_GROUP *group, BIGNUM *cofactor,
                           BN_CTX *ctx);
 
 /** Gets the cofactor of an EC_GROUP
  *  \param  group  EC_GROUP object
  *  \return the group cofactor
  */
-const BIGNUM *EC_GROUP_get0_cofactor(const EC_GROUP *group);
+const BIGNUM * __cdecl EC_GROUP_get0_cofactor(const EC_GROUP *group);
 
 /** Sets the name of a EC_GROUP object
  *  \param  group  EC_GROUP object
  *  \param  nid    NID of the curve name OID
  */
-void EC_GROUP_set_curve_name(EC_GROUP *group, int nid);
+void __cdecl EC_GROUP_set_curve_name(EC_GROUP *group, int nid);
 
 /** Returns the curve name of a EC_GROUP object
  *  \param  group  EC_GROUP object
  *  \return NID of the curve name OID or 0 if not set.
  */
-int EC_GROUP_get_curve_name(const EC_GROUP *group);
+int __cdecl EC_GROUP_get_curve_name(const EC_GROUP *group);
 
-void EC_GROUP_set_asn1_flag(EC_GROUP *group, int flag);
-int EC_GROUP_get_asn1_flag(const EC_GROUP *group);
+void __cdecl EC_GROUP_set_asn1_flag(EC_GROUP *group, int flag);
+int __cdecl EC_GROUP_get_asn1_flag(const EC_GROUP *group);
 
-void EC_GROUP_set_point_conversion_form(EC_GROUP *group,
+void __cdecl EC_GROUP_set_point_conversion_form(EC_GROUP *group,
                                         point_conversion_form_t form);
-point_conversion_form_t EC_GROUP_get_point_conversion_form(const EC_GROUP *);
+point_conversion_form_t __cdecl EC_GROUP_get_point_conversion_form(const EC_GROUP *);
 
-unsigned char *EC_GROUP_get0_seed(const EC_GROUP *x);
-size_t EC_GROUP_get_seed_len(const EC_GROUP *);
-size_t EC_GROUP_set_seed(EC_GROUP *, const unsigned char *, size_t len);
+unsigned char * __cdecl EC_GROUP_get0_seed(const EC_GROUP *x);
+size_t __cdecl EC_GROUP_get_seed_len(const EC_GROUP *);
+size_t __cdecl EC_GROUP_set_seed(EC_GROUP *, const unsigned char *, size_t len);
 
 /** Sets the parameters of a ec curve defined by y^2 = x^3 + a*x + b (for GFp)
  *  or y^2 + x*y = x^3 + a*x^2 + b (for GF2m)
@@ -233,7 +233,7 @@ size_t EC_GROUP_set_seed(EC_GROUP *, const unsigned char *, size_t len);
  *  \param  ctx    BN_CTX object (optional)
  *  \return 1 on success and 0 if an error occurred
  */
-int EC_GROUP_set_curve(EC_GROUP *group, const BIGNUM *p, const BIGNUM *a,
+int __cdecl EC_GROUP_set_curve(EC_GROUP *group, const BIGNUM *p, const BIGNUM *a,
                        const BIGNUM *b, BN_CTX *ctx);
 
 /** Gets the parameters of the ec curve defined by y^2 = x^3 + a*x + b (for GFp)
@@ -246,7 +246,7 @@ int EC_GROUP_set_curve(EC_GROUP *group, const BIGNUM *p, const BIGNUM *a,
  *  \param  ctx    BN_CTX object (optional)
  *  \return 1 on success and 0 if an error occurred
  */
-int EC_GROUP_get_curve(const EC_GROUP *group, BIGNUM *p, BIGNUM *a, BIGNUM *b,
+int __cdecl EC_GROUP_get_curve(const EC_GROUP *group, BIGNUM *p, BIGNUM *a, BIGNUM *b,
                        BN_CTX *ctx);
 
 /** Sets the parameters of an ec curve. Synonym for EC_GROUP_set_curve
@@ -258,7 +258,7 @@ int EC_GROUP_get_curve(const EC_GROUP *group, BIGNUM *p, BIGNUM *a, BIGNUM *b,
  *  \param  ctx    BN_CTX object (optional)
  *  \return 1 on success and 0 if an error occurred
  */
-DEPRECATEDIN_1_2_0(int EC_GROUP_set_curve_GFp(EC_GROUP *group, const BIGNUM *p,
+DEPRECATEDIN_1_2_0(int __cdecl EC_GROUP_set_curve_GFp(EC_GROUP *group, const BIGNUM *p,
                                               const BIGNUM *a, const BIGNUM *b,
                                               BN_CTX *ctx))
 
@@ -271,7 +271,7 @@ DEPRECATEDIN_1_2_0(int EC_GROUP_set_curve_GFp(EC_GROUP *group, const BIGNUM *p,
  *  \param  ctx    BN_CTX object (optional)
  *  \return 1 on success and 0 if an error occurred
  */
-DEPRECATEDIN_1_2_0(int EC_GROUP_get_curve_GFp(const EC_GROUP *group, BIGNUM *p,
+DEPRECATEDIN_1_2_0(int __cdecl EC_GROUP_get_curve_GFp(const EC_GROUP *group, BIGNUM *p,
                                               BIGNUM *a, BIGNUM *b,
                                               BN_CTX *ctx))
 
@@ -285,7 +285,7 @@ DEPRECATEDIN_1_2_0(int EC_GROUP_get_curve_GFp(const EC_GROUP *group, BIGNUM *p,
  *  \param  ctx    BN_CTX object (optional)
  *  \return 1 on success and 0 if an error occurred
  */
-DEPRECATEDIN_1_2_0(int EC_GROUP_set_curve_GF2m(EC_GROUP *group, const BIGNUM *p,
+DEPRECATEDIN_1_2_0(int __cdecl EC_GROUP_set_curve_GF2m(EC_GROUP *group, const BIGNUM *p,
                                                const BIGNUM *a, const BIGNUM *b,
                                                BN_CTX *ctx))
 
@@ -298,7 +298,7 @@ DEPRECATEDIN_1_2_0(int EC_GROUP_set_curve_GF2m(EC_GROUP *group, const BIGNUM *p,
  *  \param  ctx    BN_CTX object (optional)
  *  \return 1 on success and 0 if an error occurred
  */
-DEPRECATEDIN_1_2_0(int EC_GROUP_get_curve_GF2m(const EC_GROUP *group, BIGNUM *p,
+DEPRECATEDIN_1_2_0(int __cdecl EC_GROUP_get_curve_GF2m(const EC_GROUP *group, BIGNUM *p,
                                                BIGNUM *a, BIGNUM *b,
                                                BN_CTX *ctx))
 # endif
@@ -306,21 +306,21 @@ DEPRECATEDIN_1_2_0(int EC_GROUP_get_curve_GF2m(const EC_GROUP *group, BIGNUM *p,
  *  \param  group  EC_GROUP object
  *  \return number of bits needed to represent a field element
  */
-int EC_GROUP_get_degree(const EC_GROUP *group);
+int __cdecl EC_GROUP_get_degree(const EC_GROUP *group);
 
 /** Checks whether the parameter in the EC_GROUP define a valid ec group
  *  \param  group  EC_GROUP object
  *  \param  ctx    BN_CTX object (optional)
  *  \return 1 if group is a valid ec group and 0 otherwise
  */
-int EC_GROUP_check(const EC_GROUP *group, BN_CTX *ctx);
+int __cdecl EC_GROUP_check(const EC_GROUP *group, BN_CTX *ctx);
 
 /** Checks whether the discriminant of the elliptic curve is zero or not
  *  \param  group  EC_GROUP object
  *  \param  ctx    BN_CTX object (optional)
  *  \return 1 if the discriminant is not zero and 0 otherwise
  */
-int EC_GROUP_check_discriminant(const EC_GROUP *group, BN_CTX *ctx);
+int __cdecl EC_GROUP_check_discriminant(const EC_GROUP *group, BN_CTX *ctx);
 
 /** Compares two EC_GROUP objects
  *  \param  a    first EC_GROUP object
@@ -328,7 +328,7 @@ int EC_GROUP_check_discriminant(const EC_GROUP *group, BN_CTX *ctx);
  *  \param  ctx  BN_CTX object (optional)
  *  \return 0 if the groups are equal, 1 if not, or -1 on error
  */
-int EC_GROUP_cmp(const EC_GROUP *a, const EC_GROUP *b, BN_CTX *ctx);
+int __cdecl EC_GROUP_cmp(const EC_GROUP *a, const EC_GROUP *b, BN_CTX *ctx);
 
 /*
  * EC_GROUP_new_GF*() calls EC_GROUP_new() and EC_GROUP_set_GF*() after
@@ -343,7 +343,7 @@ int EC_GROUP_cmp(const EC_GROUP *a, const EC_GROUP *b, BN_CTX *ctx);
  *  \param  ctx  BN_CTX object (optional)
  *  \return newly created EC_GROUP object with the specified parameters
  */
-EC_GROUP *EC_GROUP_new_curve_GFp(const BIGNUM *p, const BIGNUM *a,
+EC_GROUP * __cdecl EC_GROUP_new_curve_GFp(const BIGNUM *p, const BIGNUM *a,
                                  const BIGNUM *b, BN_CTX *ctx);
 # ifndef OPENSSL_NO_EC2M
 /** Creates a new EC_GROUP object with the specified parameters defined
@@ -354,7 +354,7 @@ EC_GROUP *EC_GROUP_new_curve_GFp(const BIGNUM *p, const BIGNUM *a,
  *  \param  ctx  BN_CTX object (optional)
  *  \return newly created EC_GROUP object with the specified parameters
  */
-EC_GROUP *EC_GROUP_new_curve_GF2m(const BIGNUM *p, const BIGNUM *a,
+EC_GROUP * __cdecl EC_GROUP_new_curve_GF2m(const BIGNUM *p, const BIGNUM *a,
                                   const BIGNUM *b, BN_CTX *ctx);
 # endif
 
@@ -363,14 +363,14 @@ EC_GROUP *EC_GROUP_new_curve_GF2m(const BIGNUM *p, const BIGNUM *a,
  *  \return newly created EC_GROUP object with specified curve or NULL
  *          if an error occurred
  */
-EC_GROUP *EC_GROUP_new_by_curve_name(int nid);
+EC_GROUP * __cdecl EC_GROUP_new_by_curve_name(int nid);
 
 /** Creates a new EC_GROUP object from an ECPARAMETERS object
  *  \param  params  pointer to the ECPARAMETERS object
  *  \return newly created EC_GROUP object with specified curve or NULL
  *          if an error occurred
  */
-EC_GROUP *EC_GROUP_new_from_ecparameters(const ECPARAMETERS *params);
+EC_GROUP * __cdecl EC_GROUP_new_from_ecparameters(const ECPARAMETERS *params);
 
 /** Creates an ECPARAMETERS object for the given EC_GROUP object.
  *  \param  group   pointer to the EC_GROUP object
@@ -378,7 +378,7 @@ EC_GROUP *EC_GROUP_new_from_ecparameters(const ECPARAMETERS *params);
  *  \return pointer to the new ECPARAMETERS object or NULL
  *          if an error occurred.
  */
-ECPARAMETERS *EC_GROUP_get_ecparameters(const EC_GROUP *group,
+ECPARAMETERS * __cdecl EC_GROUP_get_ecparameters(const EC_GROUP *group,
                                         ECPARAMETERS *params);
 
 /** Creates a new EC_GROUP object from an ECPKPARAMETERS object
@@ -386,7 +386,7 @@ ECPARAMETERS *EC_GROUP_get_ecparameters(const EC_GROUP *group,
  *  \return newly created EC_GROUP object with specified curve, or NULL
  *          if an error occurred
  */
-EC_GROUP *EC_GROUP_new_from_ecpkparameters(const ECPKPARAMETERS *params);
+EC_GROUP * __cdecl EC_GROUP_new_from_ecpkparameters(const ECPKPARAMETERS *params);
 
 /** Creates an ECPKPARAMETERS object for the given EC_GROUP object.
  *  \param  group   pointer to the EC_GROUP object
@@ -394,7 +394,7 @@ EC_GROUP *EC_GROUP_new_from_ecpkparameters(const ECPKPARAMETERS *params);
  *  \return pointer to the new ECPKPARAMETERS object or NULL
  *          if an error occurred.
  */
-ECPKPARAMETERS *EC_GROUP_get_ecpkparameters(const EC_GROUP *group,
+ECPKPARAMETERS * __cdecl EC_GROUP_get_ecpkparameters(const EC_GROUP *group,
                                             ECPKPARAMETERS *params);
 
 /********************************************************************/
@@ -412,10 +412,10 @@ typedef struct {
  * nitems EC_builtin_curve structures are filled with the data of the first
  * nitems internal groups
  */
-size_t EC_get_builtin_curves(EC_builtin_curve *r, size_t nitems);
+size_t __cdecl EC_get_builtin_curves(EC_builtin_curve *r, size_t nitems);
 
-const char *EC_curve_nid2nist(int nid);
-int EC_curve_nist2nid(const char *name);
+const char * __cdecl EC_curve_nid2nist(int nid);
+int __cdecl EC_curve_nist2nid(const char *name);
 
 /********************************************************************/
 /*                    EC_POINT functions                            */
@@ -425,24 +425,24 @@ int EC_curve_nist2nid(const char *name);
  *  \param  group  EC_GROUP the underlying EC_GROUP object
  *  \return newly created EC_POINT object or NULL if an error occurred
  */
-EC_POINT *EC_POINT_new(const EC_GROUP *group);
+EC_POINT * __cdecl EC_POINT_new(const EC_GROUP *group);
 
 /** Frees a EC_POINT object
  *  \param  point  EC_POINT object to be freed
  */
-void EC_POINT_free(EC_POINT *point);
+void __cdecl EC_POINT_free(EC_POINT *point);
 
 /** Clears and frees a EC_POINT object
  *  \param  point  EC_POINT object to be cleared and freed
  */
-void EC_POINT_clear_free(EC_POINT *point);
+void __cdecl EC_POINT_clear_free(EC_POINT *point);
 
 /** Copies EC_POINT object
  *  \param  dst  destination EC_POINT object
  *  \param  src  source EC_POINT object
  *  \return 1 on success and 0 if an error occurred
  */
-int EC_POINT_copy(EC_POINT *dst, const EC_POINT *src);
+int __cdecl EC_POINT_copy(EC_POINT *dst, const EC_POINT *src);
 
 /** Creates a new EC_POINT object and copies the content of the supplied
  *  EC_POINT
@@ -450,20 +450,20 @@ int EC_POINT_copy(EC_POINT *dst, const EC_POINT *src);
  *  \param  group  underlying the EC_GROUP object
  *  \return newly created EC_POINT object or NULL if an error occurred
  */
-EC_POINT *EC_POINT_dup(const EC_POINT *src, const EC_GROUP *group);
+EC_POINT * __cdecl EC_POINT_dup(const EC_POINT *src, const EC_GROUP *group);
 
 /** Returns the EC_METHOD used in EC_POINT object
  *  \param  point  EC_POINT object
  *  \return the EC_METHOD used
  */
-const EC_METHOD *EC_POINT_method_of(const EC_POINT *point);
+const EC_METHOD * __cdecl EC_POINT_method_of(const EC_POINT *point);
 
 /** Sets a point to infinity (neutral element)
  *  \param  group  underlying EC_GROUP object
  *  \param  point  EC_POINT to set to infinity
  *  \return 1 on success and 0 if an error occurred
  */
-int EC_POINT_set_to_infinity(const EC_GROUP *group, EC_POINT *point);
+int __cdecl EC_POINT_set_to_infinity(const EC_GROUP *group, EC_POINT *point);
 
 /** Sets the jacobian projective coordinates of a EC_POINT over GFp
  *  \param  group  underlying EC_GROUP object
@@ -474,7 +474,7 @@ int EC_POINT_set_to_infinity(const EC_GROUP *group, EC_POINT *point);
  *  \param  ctx    BN_CTX object (optional)
  *  \return 1 on success and 0 if an error occurred
  */
-int EC_POINT_set_Jprojective_coordinates_GFp(const EC_GROUP *group,
+int __cdecl EC_POINT_set_Jprojective_coordinates_GFp(const EC_GROUP *group,
                                              EC_POINT *p, const BIGNUM *x,
                                              const BIGNUM *y, const BIGNUM *z,
                                              BN_CTX *ctx);
@@ -488,7 +488,7 @@ int EC_POINT_set_Jprojective_coordinates_GFp(const EC_GROUP *group,
  *  \param  ctx    BN_CTX object (optional)
  *  \return 1 on success and 0 if an error occurred
  */
-int EC_POINT_get_Jprojective_coordinates_GFp(const EC_GROUP *group,
+int __cdecl EC_POINT_get_Jprojective_coordinates_GFp(const EC_GROUP *group,
                                              const EC_POINT *p, BIGNUM *x,
                                              BIGNUM *y, BIGNUM *z,
                                              BN_CTX *ctx);
@@ -501,7 +501,7 @@ int EC_POINT_get_Jprojective_coordinates_GFp(const EC_GROUP *group,
  *  \param  ctx    BN_CTX object (optional)
  *  \return 1 on success and 0 if an error occurred
  */
-int EC_POINT_set_affine_coordinates(const EC_GROUP *group, EC_POINT *p,
+int __cdecl EC_POINT_set_affine_coordinates(const EC_GROUP *group, EC_POINT *p,
                                     const BIGNUM *x, const BIGNUM *y,
                                     BN_CTX *ctx);
 
@@ -513,7 +513,7 @@ int EC_POINT_set_affine_coordinates(const EC_GROUP *group, EC_POINT *p,
  *  \param  ctx    BN_CTX object (optional)
  *  \return 1 on success and 0 if an error occurred
  */
-int EC_POINT_get_affine_coordinates(const EC_GROUP *group, const EC_POINT *p,
+int __cdecl EC_POINT_get_affine_coordinates(const EC_GROUP *group, const EC_POINT *p,
                                     BIGNUM *x, BIGNUM *y, BN_CTX *ctx);
 
 /** Sets the affine coordinates of an EC_POINT. A synonym of
@@ -525,7 +525,7 @@ int EC_POINT_get_affine_coordinates(const EC_GROUP *group, const EC_POINT *p,
  *  \param  ctx    BN_CTX object (optional)
  *  \return 1 on success and 0 if an error occurred
  */
-DEPRECATEDIN_1_2_0(int EC_POINT_set_affine_coordinates_GFp(const EC_GROUP *group,
+DEPRECATEDIN_1_2_0(int __cdecl EC_POINT_set_affine_coordinates_GFp(const EC_GROUP *group,
                                                            EC_POINT *p,
                                                            const BIGNUM *x,
                                                            const BIGNUM *y,
@@ -540,7 +540,7 @@ DEPRECATEDIN_1_2_0(int EC_POINT_set_affine_coordinates_GFp(const EC_GROUP *group
  *  \param  ctx    BN_CTX object (optional)
  *  \return 1 on success and 0 if an error occurred
  */
-DEPRECATEDIN_1_2_0(int EC_POINT_get_affine_coordinates_GFp(const EC_GROUP *group,
+DEPRECATEDIN_1_2_0(int __cdecl EC_POINT_get_affine_coordinates_GFp(const EC_GROUP *group,
                                                            const EC_POINT *p,
                                                            BIGNUM *x,
                                                            BIGNUM *y,
@@ -554,7 +554,7 @@ DEPRECATEDIN_1_2_0(int EC_POINT_get_affine_coordinates_GFp(const EC_GROUP *group
  *  \param  ctx    BN_CTX object (optional)
  *  \return 1 on success and 0 if an error occurred
  */
-int EC_POINT_set_compressed_coordinates(const EC_GROUP *group, EC_POINT *p,
+int __cdecl EC_POINT_set_compressed_coordinates(const EC_GROUP *group, EC_POINT *p,
                                         const BIGNUM *x, int y_bit,
                                         BN_CTX *ctx);
 
@@ -567,7 +567,7 @@ int EC_POINT_set_compressed_coordinates(const EC_GROUP *group, EC_POINT *p,
  *  \param  ctx    BN_CTX object (optional)
  *  \return 1 on success and 0 if an error occurred
  */
-DEPRECATEDIN_1_2_0(int EC_POINT_set_compressed_coordinates_GFp(const EC_GROUP *group,
+DEPRECATEDIN_1_2_0(int __cdecl EC_POINT_set_compressed_coordinates_GFp(const EC_GROUP *group,
                                                                EC_POINT *p,
                                                                const BIGNUM *x,
                                                                int y_bit,
@@ -582,7 +582,7 @@ DEPRECATEDIN_1_2_0(int EC_POINT_set_compressed_coordinates_GFp(const EC_GROUP *g
  *  \param  ctx    BN_CTX object (optional)
  *  \return 1 on success and 0 if an error occurred
  */
-DEPRECATEDIN_1_2_0(int EC_POINT_set_affine_coordinates_GF2m(const EC_GROUP *group,
+DEPRECATEDIN_1_2_0(int __cdecl EC_POINT_set_affine_coordinates_GF2m(const EC_GROUP *group,
                                                             EC_POINT *p,
                                                             const BIGNUM *x,
                                                             const BIGNUM *y,
@@ -597,7 +597,7 @@ DEPRECATEDIN_1_2_0(int EC_POINT_set_affine_coordinates_GF2m(const EC_GROUP *grou
  *  \param  ctx    BN_CTX object (optional)
  *  \return 1 on success and 0 if an error occurred
  */
-DEPRECATEDIN_1_2_0(int EC_POINT_get_affine_coordinates_GF2m(const EC_GROUP *group,
+DEPRECATEDIN_1_2_0(int __cdecl EC_POINT_get_affine_coordinates_GF2m(const EC_GROUP *group,
                                                             const EC_POINT *p,
                                                             BIGNUM *x,
                                                             BIGNUM *y,
@@ -612,7 +612,7 @@ DEPRECATEDIN_1_2_0(int EC_POINT_get_affine_coordinates_GF2m(const EC_GROUP *grou
  *  \param  ctx    BN_CTX object (optional)
  *  \return 1 on success and 0 if an error occurred
  */
-DEPRECATEDIN_1_2_0(int EC_POINT_set_compressed_coordinates_GF2m(const EC_GROUP *group,
+DEPRECATEDIN_1_2_0(int __cdecl EC_POINT_set_compressed_coordinates_GF2m(const EC_GROUP *group,
                                                                 EC_POINT *p,
                                                                 const BIGNUM *x,
                                                                 int y_bit,
@@ -628,7 +628,7 @@ DEPRECATEDIN_1_2_0(int EC_POINT_set_compressed_coordinates_GF2m(const EC_GROUP *
  *  \param  ctx    BN_CTX object (optional)
  *  \return the length of the encoded octet string or 0 if an error occurred
  */
-size_t EC_POINT_point2oct(const EC_GROUP *group, const EC_POINT *p,
+size_t __cdecl EC_POINT_point2oct(const EC_GROUP *group, const EC_POINT *p,
                           point_conversion_form_t form,
                           unsigned char *buf, size_t len, BN_CTX *ctx);
 
@@ -640,7 +640,7 @@ size_t EC_POINT_point2oct(const EC_GROUP *group, const EC_POINT *p,
  *  \param  ctx    BN_CTX object (optional)
  *  \return 1 on success and 0 if an error occurred
  */
-int EC_POINT_oct2point(const EC_GROUP *group, EC_POINT *p,
+int __cdecl EC_POINT_oct2point(const EC_GROUP *group, EC_POINT *p,
                        const unsigned char *buf, size_t len, BN_CTX *ctx);
 
 /** Encodes an EC_POINT object to an allocated octet string
@@ -651,18 +651,18 @@ int EC_POINT_oct2point(const EC_GROUP *group, EC_POINT *p,
  *  \param  ctx    BN_CTX object (optional)
  *  \return the length of the encoded octet string or 0 if an error occurred
  */
-size_t EC_POINT_point2buf(const EC_GROUP *group, const EC_POINT *point,
+size_t __cdecl EC_POINT_point2buf(const EC_GROUP *group, const EC_POINT *point,
                           point_conversion_form_t form,
                           unsigned char **pbuf, BN_CTX *ctx);
 
 /* other interfaces to point2oct/oct2point: */
-BIGNUM *EC_POINT_point2bn(const EC_GROUP *, const EC_POINT *,
+BIGNUM * __cdecl EC_POINT_point2bn(const EC_GROUP *, const EC_POINT *,
                           point_conversion_form_t form, BIGNUM *, BN_CTX *);
-EC_POINT *EC_POINT_bn2point(const EC_GROUP *, const BIGNUM *,
+EC_POINT * __cdecl EC_POINT_bn2point(const EC_GROUP *, const BIGNUM *,
                             EC_POINT *, BN_CTX *);
-char *EC_POINT_point2hex(const EC_GROUP *, const EC_POINT *,
+char * __cdecl EC_POINT_point2hex(const EC_GROUP *, const EC_POINT *,
                          point_conversion_form_t form, BN_CTX *);
-EC_POINT *EC_POINT_hex2point(const EC_GROUP *, const char *,
+EC_POINT * __cdecl EC_POINT_hex2point(const EC_GROUP *, const char *,
                              EC_POINT *, BN_CTX *);
 
 /********************************************************************/
@@ -677,7 +677,7 @@ EC_POINT *EC_POINT_hex2point(const EC_GROUP *, const char *,
  *  \param  ctx    BN_CTX object (optional)
  *  \return 1 on success and 0 if an error occurred
  */
-int EC_POINT_add(const EC_GROUP *group, EC_POINT *r, const EC_POINT *a,
+int __cdecl EC_POINT_add(const EC_GROUP *group, EC_POINT *r, const EC_POINT *a,
                  const EC_POINT *b, BN_CTX *ctx);
 
 /** Computes the double of a EC_POINT
@@ -687,7 +687,7 @@ int EC_POINT_add(const EC_GROUP *group, EC_POINT *r, const EC_POINT *a,
  *  \param  ctx    BN_CTX object (optional)
  *  \return 1 on success and 0 if an error occurred
  */
-int EC_POINT_dbl(const EC_GROUP *group, EC_POINT *r, const EC_POINT *a,
+int __cdecl EC_POINT_dbl(const EC_GROUP *group, EC_POINT *r, const EC_POINT *a,
                  BN_CTX *ctx);
 
 /** Computes the inverse of a EC_POINT
@@ -696,14 +696,14 @@ int EC_POINT_dbl(const EC_GROUP *group, EC_POINT *r, const EC_POINT *a,
  *  \param  ctx    BN_CTX object (optional)
  *  \return 1 on success and 0 if an error occurred
  */
-int EC_POINT_invert(const EC_GROUP *group, EC_POINT *a, BN_CTX *ctx);
+int __cdecl EC_POINT_invert(const EC_GROUP *group, EC_POINT *a, BN_CTX *ctx);
 
 /** Checks whether the point is the neutral element of the group
  *  \param  group  the underlying EC_GROUP object
  *  \param  p      EC_POINT object
  *  \return 1 if the point is the neutral element and 0 otherwise
  */
-int EC_POINT_is_at_infinity(const EC_GROUP *group, const EC_POINT *p);
+int __cdecl EC_POINT_is_at_infinity(const EC_GROUP *group, const EC_POINT *p);
 
 /** Checks whether the point is on the curve
  *  \param  group  underlying EC_GROUP object
@@ -711,7 +711,7 @@ int EC_POINT_is_at_infinity(const EC_GROUP *group, const EC_POINT *p);
  *  \param  ctx    BN_CTX object (optional)
  *  \return 1 if the point is on the curve, 0 if not, or -1 on error
  */
-int EC_POINT_is_on_curve(const EC_GROUP *group, const EC_POINT *point,
+int __cdecl EC_POINT_is_on_curve(const EC_GROUP *group, const EC_POINT *point,
                          BN_CTX *ctx);
 
 /** Compares two EC_POINTs
@@ -721,11 +721,11 @@ int EC_POINT_is_on_curve(const EC_GROUP *group, const EC_POINT *point,
  *  \param  ctx    BN_CTX object (optional)
  *  \return 1 if the points are not equal, 0 if they are, or -1 on error
  */
-int EC_POINT_cmp(const EC_GROUP *group, const EC_POINT *a, const EC_POINT *b,
+int __cdecl EC_POINT_cmp(const EC_GROUP *group, const EC_POINT *a, const EC_POINT *b,
                  BN_CTX *ctx);
 
-int EC_POINT_make_affine(const EC_GROUP *group, EC_POINT *point, BN_CTX *ctx);
-int EC_POINTs_make_affine(const EC_GROUP *group, size_t num,
+int __cdecl EC_POINT_make_affine(const EC_GROUP *group, EC_POINT *point, BN_CTX *ctx);
+int __cdecl EC_POINTs_make_affine(const EC_GROUP *group, size_t num,
                           EC_POINT *points[], BN_CTX *ctx);
 
 /** Computes r = generator * n + sum_{i=0}^{num-1} p[i] * m[i]
@@ -738,7 +738,7 @@ int EC_POINTs_make_affine(const EC_GROUP *group, size_t num,
  *  \param  ctx    BN_CTX object (optional)
  *  \return 1 on success and 0 if an error occurred
  */
-int EC_POINTs_mul(const EC_GROUP *group, EC_POINT *r, const BIGNUM *n,
+int __cdecl EC_POINTs_mul(const EC_GROUP *group, EC_POINT *r, const BIGNUM *n,
                   size_t num, const EC_POINT *p[], const BIGNUM *m[],
                   BN_CTX *ctx);
 
@@ -751,7 +751,7 @@ int EC_POINTs_mul(const EC_GROUP *group, EC_POINT *r, const BIGNUM *n,
  *  \param  ctx    BN_CTX object (optional)
  *  \return 1 on success and 0 if an error occurred
  */
-int EC_POINT_mul(const EC_GROUP *group, EC_POINT *r, const BIGNUM *n,
+int __cdecl EC_POINT_mul(const EC_GROUP *group, EC_POINT *r, const BIGNUM *n,
                  const EC_POINT *q, const BIGNUM *m, BN_CTX *ctx);
 
 /** Stores multiples of generator for faster point multiplication
@@ -759,13 +759,13 @@ int EC_POINT_mul(const EC_GROUP *group, EC_POINT *r, const BIGNUM *n,
  *  \param  ctx    BN_CTX object (optional)
  *  \return 1 on success and 0 if an error occurred
  */
-int EC_GROUP_precompute_mult(EC_GROUP *group, BN_CTX *ctx);
+int __cdecl EC_GROUP_precompute_mult(EC_GROUP *group, BN_CTX *ctx);
 
 /** Reports whether a precomputation has been done
  *  \param  group  EC_GROUP object
  *  \return 1 if a pre-computation has been done and 0 otherwise
  */
-int EC_GROUP_have_precompute_mult(const EC_GROUP *group);
+int __cdecl EC_GROUP_have_precompute_mult(const EC_GROUP *group);
 
 /********************************************************************/
 /*                       ASN1 stuff                                 */
@@ -780,18 +780,18 @@ DECLARE_ASN1_ALLOC_FUNCTIONS(ECPARAMETERS)
  * EC_GROUP_get_basis_type() returns the NID of the basis type used to
  * represent the field elements
  */
-int EC_GROUP_get_basis_type(const EC_GROUP *);
+int __cdecl EC_GROUP_get_basis_type(const EC_GROUP *);
 # ifndef OPENSSL_NO_EC2M
-int EC_GROUP_get_trinomial_basis(const EC_GROUP *, unsigned int *k);
-int EC_GROUP_get_pentanomial_basis(const EC_GROUP *, unsigned int *k1,
+int __cdecl EC_GROUP_get_trinomial_basis(const EC_GROUP *, unsigned int *k);
+int __cdecl EC_GROUP_get_pentanomial_basis(const EC_GROUP *, unsigned int *k1,
                                    unsigned int *k2, unsigned int *k3);
 # endif
 
 # define OPENSSL_EC_EXPLICIT_CURVE  0x000
 # define OPENSSL_EC_NAMED_CURVE     0x001
 
-EC_GROUP *d2i_ECPKParameters(EC_GROUP **, const unsigned char **in, long len);
-int i2d_ECPKParameters(const EC_GROUP *, unsigned char **out);
+EC_GROUP * __cdecl d2i_ECPKParameters(EC_GROUP **, const unsigned char **in, long len);
+int __cdecl i2d_ECPKParameters(const EC_GROUP *, unsigned char **out);
 
 # define d2i_ECPKParameters_bio(bp,x) ASN1_d2i_bio_of(EC_GROUP,NULL,d2i_ECPKParameters,bp,x)
 # define i2d_ECPKParameters_bio(bp,x) ASN1_i2d_bio_of_const(EC_GROUP,i2d_ECPKParameters,bp,x)
@@ -800,9 +800,9 @@ int i2d_ECPKParameters(const EC_GROUP *, unsigned char **out);
 # define i2d_ECPKParameters_fp(fp,x) ASN1_i2d_fp(i2d_ECPKParameters,(fp), \
                 (unsigned char *)(x))
 
-int ECPKParameters_print(BIO *bp, const EC_GROUP *x, int off);
+int __cdecl ECPKParameters_print(BIO *bp, const EC_GROUP *x, int off);
 # ifndef OPENSSL_NO_STDIO
-int ECPKParameters_print_fp(FILE *fp, const EC_GROUP *x, int off);
+int __cdecl ECPKParameters_print_fp(FILE *fp, const EC_GROUP *x, int off);
 # endif
 
 /********************************************************************/
@@ -821,56 +821,56 @@ int ECPKParameters_print_fp(FILE *fp, const EC_GROUP *x, int off);
 /** Creates a new EC_KEY object.
  *  \return EC_KEY object or NULL if an error occurred.
  */
-EC_KEY *EC_KEY_new(void);
+EC_KEY * __cdecl EC_KEY_new(void);
 
-int EC_KEY_get_flags(const EC_KEY *key);
+int __cdecl EC_KEY_get_flags(const EC_KEY *key);
 
-void EC_KEY_set_flags(EC_KEY *key, int flags);
+void __cdecl EC_KEY_set_flags(EC_KEY *key, int flags);
 
-void EC_KEY_clear_flags(EC_KEY *key, int flags);
+void __cdecl EC_KEY_clear_flags(EC_KEY *key, int flags);
 
 /** Creates a new EC_KEY object using a named curve as underlying
  *  EC_GROUP object.
  *  \param  nid  NID of the named curve.
  *  \return EC_KEY object or NULL if an error occurred.
  */
-EC_KEY *EC_KEY_new_by_curve_name(int nid);
+EC_KEY * __cdecl EC_KEY_new_by_curve_name(int nid);
 
 /** Frees a EC_KEY object.
  *  \param  key  EC_KEY object to be freed.
  */
-void EC_KEY_free(EC_KEY *key);
+void __cdecl EC_KEY_free(EC_KEY *key);
 
 /** Copies a EC_KEY object.
  *  \param  dst  destination EC_KEY object
  *  \param  src  src EC_KEY object
  *  \return dst or NULL if an error occurred.
  */
-EC_KEY *EC_KEY_copy(EC_KEY *dst, const EC_KEY *src);
+EC_KEY * __cdecl EC_KEY_copy(EC_KEY *dst, const EC_KEY *src);
 
 /** Creates a new EC_KEY object and copies the content from src to it.
  *  \param  src  the source EC_KEY object
  *  \return newly created EC_KEY object or NULL if an error occurred.
  */
-EC_KEY *EC_KEY_dup(const EC_KEY *src);
+EC_KEY * __cdecl EC_KEY_dup(const EC_KEY *src);
 
 /** Increases the internal reference count of a EC_KEY object.
  *  \param  key  EC_KEY object
  *  \return 1 on success and 0 if an error occurred.
  */
-int EC_KEY_up_ref(EC_KEY *key);
+int __cdecl EC_KEY_up_ref(EC_KEY *key);
 
 /** Returns the ENGINE object of a EC_KEY object
  *  \param  eckey  EC_KEY object
  *  \return the ENGINE object (possibly NULL).
  */
-ENGINE *EC_KEY_get0_engine(const EC_KEY *eckey);
+ENGINE * __cdecl EC_KEY_get0_engine(const EC_KEY *eckey);
 
 /** Returns the EC_GROUP object of a EC_KEY object
  *  \param  key  EC_KEY object
  *  \return the EC_GROUP object (possibly NULL).
  */
-const EC_GROUP *EC_KEY_get0_group(const EC_KEY *key);
+const EC_GROUP * __cdecl EC_KEY_get0_group(const EC_KEY *key);
 
 /** Sets the EC_GROUP of a EC_KEY object.
  *  \param  key    EC_KEY object
@@ -878,13 +878,13 @@ const EC_GROUP *EC_KEY_get0_group(const EC_KEY *key);
  *                 object will use an own copy of the EC_GROUP).
  *  \return 1 on success and 0 if an error occurred.
  */
-int EC_KEY_set_group(EC_KEY *key, const EC_GROUP *group);
+int __cdecl EC_KEY_set_group(EC_KEY *key, const EC_GROUP *group);
 
 /** Returns the private key of a EC_KEY object.
  *  \param  key  EC_KEY object
  *  \return a BIGNUM with the private key (possibly NULL).
  */
-const BIGNUM *EC_KEY_get0_private_key(const EC_KEY *key);
+const BIGNUM * __cdecl EC_KEY_get0_private_key(const EC_KEY *key);
 
 /** Sets the private key of a EC_KEY object.
  *  \param  key  EC_KEY object
@@ -892,13 +892,13 @@ const BIGNUM *EC_KEY_get0_private_key(const EC_KEY *key);
  *               will use an own copy of the BIGNUM).
  *  \return 1 on success and 0 if an error occurred.
  */
-int EC_KEY_set_private_key(EC_KEY *key, const BIGNUM *prv);
+int __cdecl EC_KEY_set_private_key(EC_KEY *key, const BIGNUM *prv);
 
 /** Returns the public key of a EC_KEY object.
  *  \param  key  the EC_KEY object
  *  \return a EC_POINT object with the public key (possibly NULL)
  */
-const EC_POINT *EC_KEY_get0_public_key(const EC_KEY *key);
+const EC_POINT * __cdecl EC_KEY_get0_public_key(const EC_KEY *key);
 
 /** Sets the public key of a EC_KEY object.
  *  \param  key  EC_KEY object
@@ -906,20 +906,20 @@ const EC_POINT *EC_KEY_get0_public_key(const EC_KEY *key);
  *               will use an own copy of the EC_POINT object).
  *  \return 1 on success and 0 if an error occurred.
  */
-int EC_KEY_set_public_key(EC_KEY *key, const EC_POINT *pub);
+int __cdecl EC_KEY_set_public_key(EC_KEY *key, const EC_POINT *pub);
 
-unsigned EC_KEY_get_enc_flags(const EC_KEY *key);
-void EC_KEY_set_enc_flags(EC_KEY *eckey, unsigned int flags);
-point_conversion_form_t EC_KEY_get_conv_form(const EC_KEY *key);
-void EC_KEY_set_conv_form(EC_KEY *eckey, point_conversion_form_t cform);
+unsigned __cdecl EC_KEY_get_enc_flags(const EC_KEY *key);
+void __cdecl EC_KEY_set_enc_flags(EC_KEY *eckey, unsigned int flags);
+point_conversion_form_t __cdecl EC_KEY_get_conv_form(const EC_KEY *key);
+void __cdecl EC_KEY_set_conv_form(EC_KEY *eckey, point_conversion_form_t cform);
 
 #define EC_KEY_get_ex_new_index(l, p, newf, dupf, freef) \
     CRYPTO_get_ex_new_index(CRYPTO_EX_INDEX_EC_KEY, l, p, newf, dupf, freef)
-int EC_KEY_set_ex_data(EC_KEY *key, int idx, void *arg);
-void *EC_KEY_get_ex_data(const EC_KEY *key, int idx);
+int __cdecl EC_KEY_set_ex_data(EC_KEY *key, int idx, void *arg);
+void * __cdecl EC_KEY_get_ex_data(const EC_KEY *key, int idx);
 
 /* wrapper functions for the underlying EC_GROUP object */
-void EC_KEY_set_asn1_flag(EC_KEY *eckey, int asn1_flag);
+void __cdecl EC_KEY_set_asn1_flag(EC_KEY *eckey, int asn1_flag);
 
 /** Creates a table of pre-computed multiples of the generator to
  *  accelerate further EC_KEY operations.
@@ -927,25 +927,25 @@ void EC_KEY_set_asn1_flag(EC_KEY *eckey, int asn1_flag);
  *  \param  ctx  BN_CTX object (optional)
  *  \return 1 on success and 0 if an error occurred.
  */
-int EC_KEY_precompute_mult(EC_KEY *key, BN_CTX *ctx);
+int __cdecl EC_KEY_precompute_mult(EC_KEY *key, BN_CTX *ctx);
 
 /** Creates a new ec private (and optional a new public) key.
  *  \param  key  EC_KEY object
  *  \return 1 on success and 0 if an error occurred.
  */
-int EC_KEY_generate_key(EC_KEY *key);
+int __cdecl EC_KEY_generate_key(EC_KEY *key);
 
 /** Verifies that a private and/or public key is valid.
  *  \param  key  the EC_KEY object
  *  \return 1 on success and 0 otherwise.
  */
-int EC_KEY_check_key(const EC_KEY *key);
+int __cdecl EC_KEY_check_key(const EC_KEY *key);
 
 /** Indicates if an EC_KEY can be used for signing.
  *  \param  eckey  the EC_KEY object
  *  \return 1 if can can sign and 0 otherwise.
  */
-int EC_KEY_can_sign(const EC_KEY *eckey);
+int __cdecl EC_KEY_can_sign(const EC_KEY *eckey);
 
 /** Sets a public key from affine coordinates performing
  *  necessary NIST PKV tests.
@@ -954,7 +954,7 @@ int EC_KEY_can_sign(const EC_KEY *eckey);
  *  \param  y    public key y coordinate
  *  \return 1 on success and 0 otherwise.
  */
-int EC_KEY_set_public_key_affine_coordinates(EC_KEY *key, BIGNUM *x,
+int __cdecl EC_KEY_set_public_key_affine_coordinates(EC_KEY *key, BIGNUM *x,
                                              BIGNUM *y);
 
 /** Encodes an EC_KEY public key to an allocated octet string
@@ -964,7 +964,7 @@ int EC_KEY_set_public_key_affine_coordinates(EC_KEY *key, BIGNUM *x,
  *  \param  ctx    BN_CTX object (optional)
  *  \return the length of the encoded octet string or 0 if an error occurred
  */
-size_t EC_KEY_key2buf(const EC_KEY *key, point_conversion_form_t form,
+size_t __cdecl EC_KEY_key2buf(const EC_KEY *key, point_conversion_form_t form,
                       unsigned char **pbuf, BN_CTX *ctx);
 
 /** Decodes a EC_KEY public key from a octet string
@@ -975,7 +975,7 @@ size_t EC_KEY_key2buf(const EC_KEY *key, point_conversion_form_t form,
  *  \return 1 on success and 0 if an error occurred
  */
 
-int EC_KEY_oct2key(EC_KEY *key, const unsigned char *buf, size_t len,
+int __cdecl EC_KEY_oct2key(EC_KEY *key, const unsigned char *buf, size_t len,
                    BN_CTX *ctx);
 
 /** Decodes an EC_KEY private key from an octet string
@@ -985,7 +985,7 @@ int EC_KEY_oct2key(EC_KEY *key, const unsigned char *buf, size_t len,
  *  \return 1 on success and 0 if an error occurred
  */
 
-int EC_KEY_oct2priv(EC_KEY *key, const unsigned char *buf, size_t len);
+int __cdecl EC_KEY_oct2priv(EC_KEY *key, const unsigned char *buf, size_t len);
 
 /** Encodes a EC_KEY private key to an octet string
  *  \param  key    key to encode
@@ -995,14 +995,14 @@ int EC_KEY_oct2priv(EC_KEY *key, const unsigned char *buf, size_t len);
  *  \return the length of the encoded octet string or 0 if an error occurred
  */
 
-size_t EC_KEY_priv2oct(const EC_KEY *key, unsigned char *buf, size_t len);
+size_t __cdecl EC_KEY_priv2oct(const EC_KEY *key, unsigned char *buf, size_t len);
 
 /** Encodes an EC_KEY private key to an allocated octet string
  *  \param  eckey  key to encode
  *  \param  pbuf   returns pointer to allocated buffer
  *  \return the length of the encoded octet string or 0 if an error occurred
  */
-size_t EC_KEY_priv2buf(const EC_KEY *eckey, unsigned char **pbuf);
+size_t __cdecl EC_KEY_priv2buf(const EC_KEY *eckey, unsigned char **pbuf);
 
 /********************************************************************/
 /*        de- and encoding functions for SEC1 ECPrivateKey          */
@@ -1014,7 +1014,7 @@ size_t EC_KEY_priv2buf(const EC_KEY *eckey, unsigned char **pbuf);
  *  \param  len  length of the DER encoded private key
  *  \return the decoded private key or NULL if an error occurred.
  */
-EC_KEY *d2i_ECPrivateKey(EC_KEY **key, const unsigned char **in, long len);
+EC_KEY * __cdecl d2i_ECPrivateKey(EC_KEY **key, const unsigned char **in, long len);
 
 /** Encodes a private key object and stores the result in a buffer.
  *  \param  key  the EC_KEY object to encode
@@ -1022,7 +1022,7 @@ EC_KEY *d2i_ECPrivateKey(EC_KEY **key, const unsigned char **in, long len);
  *               of bytes needed).
  *  \return 1 on success and 0 if an error occurred.
  */
-int i2d_ECPrivateKey(EC_KEY *key, unsigned char **out);
+int __cdecl i2d_ECPrivateKey(EC_KEY *key, unsigned char **out);
 
 /********************************************************************/
 /*        de- and encoding functions for EC parameters              */
@@ -1035,7 +1035,7 @@ int i2d_ECPrivateKey(EC_KEY *key, unsigned char **out);
  *  \return a EC_KEY object with the decoded parameters or NULL if an error
  *          occurred.
  */
-EC_KEY *d2i_ECParameters(EC_KEY **key, const unsigned char **in, long len);
+EC_KEY * __cdecl d2i_ECParameters(EC_KEY **key, const unsigned char **in, long len);
 
 /** Encodes ec parameter and stores the result in a buffer.
  *  \param  key  the EC_KEY object with ec parameters to encode
@@ -1043,7 +1043,7 @@ EC_KEY *d2i_ECParameters(EC_KEY **key, const unsigned char **in, long len);
  *               of bytes needed).
  *  \return 1 on success and 0 if an error occurred.
  */
-int i2d_ECParameters(EC_KEY *key, unsigned char **out);
+int __cdecl i2d_ECParameters(EC_KEY *key, unsigned char **out);
 
 /********************************************************************/
 /*         de- and encoding functions for EC public key             */
@@ -1057,7 +1057,7 @@ int i2d_ECParameters(EC_KEY *key, unsigned char **out);
  *  \return EC_KEY object with decoded public key or NULL if an error
  *          occurred.
  */
-EC_KEY *o2i_ECPublicKey(EC_KEY **key, const unsigned char **in, long len);
+EC_KEY * __cdecl o2i_ECPublicKey(EC_KEY **key, const unsigned char **in, long len);
 
 /** Encodes a ec public key in an octet string.
  *  \param  key  the EC_KEY object with the public key
@@ -1065,14 +1065,14 @@ EC_KEY *o2i_ECPublicKey(EC_KEY **key, const unsigned char **in, long len);
  *               of bytes needed).
  *  \return 1 on success and 0 if an error occurred
  */
-int i2o_ECPublicKey(const EC_KEY *key, unsigned char **out);
+int __cdecl i2o_ECPublicKey(const EC_KEY *key, unsigned char **out);
 
 /** Prints out the ec parameters on human readable form.
  *  \param  bp   BIO object to which the information is printed
  *  \param  key  EC_KEY object
  *  \return 1 on success and 0 if an error occurred
  */
-int ECParameters_print(BIO *bp, const EC_KEY *key);
+int __cdecl ECParameters_print(BIO *bp, const EC_KEY *key);
 
 /** Prints out the contents of a EC_KEY object
  *  \param  bp   BIO object to which the information is printed
@@ -1080,7 +1080,7 @@ int ECParameters_print(BIO *bp, const EC_KEY *key);
  *  \param  off  line offset
  *  \return 1 on success and 0 if an error occurred
  */
-int EC_KEY_print(BIO *bp, const EC_KEY *key, int off);
+int __cdecl EC_KEY_print(BIO *bp, const EC_KEY *key, int off);
 
 # ifndef OPENSSL_NO_STDIO
 /** Prints out the ec parameters on human readable form.
@@ -1088,7 +1088,7 @@ int EC_KEY_print(BIO *bp, const EC_KEY *key, int off);
  *  \param  key  EC_KEY object
  *  \return 1 on success and 0 if an error occurred
  */
-int ECParameters_print_fp(FILE *fp, const EC_KEY *key);
+int __cdecl ECParameters_print_fp(FILE *fp, const EC_KEY *key);
 
 /** Prints out the contents of a EC_KEY object
  *  \param  fp   file descriptor to which the information is printed
@@ -1096,28 +1096,28 @@ int ECParameters_print_fp(FILE *fp, const EC_KEY *key);
  *  \param  off  line offset
  *  \return 1 on success and 0 if an error occurred
  */
-int EC_KEY_print_fp(FILE *fp, const EC_KEY *key, int off);
+int __cdecl EC_KEY_print_fp(FILE *fp, const EC_KEY *key, int off);
 
 # endif
 
-const EC_KEY_METHOD *EC_KEY_OpenSSL(void);
-const EC_KEY_METHOD *EC_KEY_get_default_method(void);
-void EC_KEY_set_default_method(const EC_KEY_METHOD *meth);
-const EC_KEY_METHOD *EC_KEY_get_method(const EC_KEY *key);
-int EC_KEY_set_method(EC_KEY *key, const EC_KEY_METHOD *meth);
-EC_KEY *EC_KEY_new_method(ENGINE *engine);
+const EC_KEY_METHOD * __cdecl EC_KEY_OpenSSL(void);
+const EC_KEY_METHOD * __cdecl EC_KEY_get_default_method(void);
+void __cdecl EC_KEY_set_default_method(const EC_KEY_METHOD *meth);
+const EC_KEY_METHOD * __cdecl EC_KEY_get_method(const EC_KEY *key);
+int __cdecl EC_KEY_set_method(EC_KEY *key, const EC_KEY_METHOD *meth);
+EC_KEY * __cdecl EC_KEY_new_method(ENGINE *engine);
 
 /** The old name for ecdh_KDF_X9_63
  *  The ECDH KDF specification has been mistakingly attributed to ANSI X9.62,
  *  it is actually specified in ANSI X9.63.
  *  This identifier is retained for backwards compatibility
  */
-int ECDH_KDF_X9_62(unsigned char *out, size_t outlen,
+int __cdecl ECDH_KDF_X9_62(unsigned char *out, size_t outlen,
                    const unsigned char *Z, size_t Zlen,
                    const unsigned char *sinfo, size_t sinfolen,
                    const EVP_MD *md);
 
-int ECDH_compute_key(void *out, size_t outlen, const EC_POINT *pub_key,
+int __cdecl ECDH_compute_key(void *out, size_t outlen, const EC_POINT *pub_key,
                      const EC_KEY *ecdh,
                      void *(*KDF) (const void *in, size_t inlen,
                                    void *out, size_t *outlen));
@@ -1127,12 +1127,12 @@ typedef struct ECDSA_SIG_st ECDSA_SIG;
 /** Allocates and initialize a ECDSA_SIG structure
  *  \return pointer to a ECDSA_SIG structure or NULL if an error occurred
  */
-ECDSA_SIG *ECDSA_SIG_new(void);
+ECDSA_SIG * __cdecl ECDSA_SIG_new(void);
 
 /** frees a ECDSA_SIG structure
  *  \param  sig  pointer to the ECDSA_SIG structure
  */
-void ECDSA_SIG_free(ECDSA_SIG *sig);
+void __cdecl ECDSA_SIG_free(ECDSA_SIG *sig);
 
 /** DER encode content of ECDSA_SIG object (note: this function modifies *pp
  *  (*pp += length of the DER encoded signature)).
@@ -1141,7 +1141,7 @@ void ECDSA_SIG_free(ECDSA_SIG *sig);
  *  \return the length of the DER encoded ECDSA_SIG object or a negative value
  *          on error
  */
-int i2d_ECDSA_SIG(const ECDSA_SIG *sig, unsigned char **pp);
+int __cdecl i2d_ECDSA_SIG(const ECDSA_SIG *sig, unsigned char **pp);
 
 /** Decodes a DER encoded ECDSA signature (note: this function changes *pp
  *  (*pp += len)).
@@ -1150,31 +1150,31 @@ int i2d_ECDSA_SIG(const ECDSA_SIG *sig, unsigned char **pp);
  *  \param  len  length of the buffer
  *  \return pointer to the decoded ECDSA_SIG structure (or NULL)
  */
-ECDSA_SIG *d2i_ECDSA_SIG(ECDSA_SIG **sig, const unsigned char **pp, long len);
+ECDSA_SIG * __cdecl d2i_ECDSA_SIG(ECDSA_SIG **sig, const unsigned char **pp, long len);
 
 /** Accessor for r and s fields of ECDSA_SIG
  *  \param  sig  pointer to ECDSA_SIG structure
  *  \param  pr   pointer to BIGNUM pointer for r (may be NULL)
  *  \param  ps   pointer to BIGNUM pointer for s (may be NULL)
  */
-void ECDSA_SIG_get0(const ECDSA_SIG *sig, const BIGNUM **pr, const BIGNUM **ps);
+void __cdecl ECDSA_SIG_get0(const ECDSA_SIG *sig, const BIGNUM **pr, const BIGNUM **ps);
 
 /** Accessor for r field of ECDSA_SIG
  *  \param  sig  pointer to ECDSA_SIG structure
  */
-const BIGNUM *ECDSA_SIG_get0_r(const ECDSA_SIG *sig);
+const BIGNUM * __cdecl ECDSA_SIG_get0_r(const ECDSA_SIG *sig);
 
 /** Accessor for s field of ECDSA_SIG
  *  \param  sig  pointer to ECDSA_SIG structure
  */
-const BIGNUM *ECDSA_SIG_get0_s(const ECDSA_SIG *sig);
+const BIGNUM * __cdecl ECDSA_SIG_get0_s(const ECDSA_SIG *sig);
 
 /** Setter for r and s fields of ECDSA_SIG
  *  \param  sig  pointer to ECDSA_SIG structure
  *  \param  r    pointer to BIGNUM for r (may be NULL)
  *  \param  s    pointer to BIGNUM for s (may be NULL)
  */
-int ECDSA_SIG_set0(ECDSA_SIG *sig, BIGNUM *r, BIGNUM *s);
+int __cdecl ECDSA_SIG_set0(ECDSA_SIG *sig, BIGNUM *r, BIGNUM *s);
 
 /** Computes the ECDSA signature of the given hash value using
  *  the supplied private key and returns the created signature.
@@ -1183,7 +1183,7 @@ int ECDSA_SIG_set0(ECDSA_SIG *sig, BIGNUM *r, BIGNUM *s);
  *  \param  eckey     EC_KEY object containing a private EC key
  *  \return pointer to a ECDSA_SIG structure or NULL if an error occurred
  */
-ECDSA_SIG *ECDSA_do_sign(const unsigned char *dgst, int dgst_len,
+ECDSA_SIG * __cdecl ECDSA_do_sign(const unsigned char *dgst, int dgst_len,
                          EC_KEY *eckey);
 
 /** Computes ECDSA signature of a given hash value using the supplied
@@ -1196,7 +1196,7 @@ ECDSA_SIG *ECDSA_do_sign(const unsigned char *dgst, int dgst_len,
  *  \param  eckey    EC_KEY object containing a private EC key
  *  \return pointer to a ECDSA_SIG structure or NULL if an error occurred
  */
-ECDSA_SIG *ECDSA_do_sign_ex(const unsigned char *dgst, int dgstlen,
+ECDSA_SIG * __cdecl ECDSA_do_sign_ex(const unsigned char *dgst, int dgstlen,
                             const BIGNUM *kinv, const BIGNUM *rp,
                             EC_KEY *eckey);
 
@@ -1209,7 +1209,7 @@ ECDSA_SIG *ECDSA_do_sign_ex(const unsigned char *dgst, int dgstlen,
  *  \return 1 if the signature is valid, 0 if the signature is invalid
  *          and -1 on error
  */
-int ECDSA_do_verify(const unsigned char *dgst, int dgst_len,
+int __cdecl ECDSA_do_verify(const unsigned char *dgst, int dgst_len,
                     const ECDSA_SIG *sig, EC_KEY *eckey);
 
 /** Precompute parts of the signing operation
@@ -1219,7 +1219,7 @@ int ECDSA_do_verify(const unsigned char *dgst, int dgst_len,
  *  \param  rp     BIGNUM pointer for x coordinate of k * generator
  *  \return 1 on success and 0 otherwise
  */
-int ECDSA_sign_setup(EC_KEY *eckey, BN_CTX *ctx, BIGNUM **kinv, BIGNUM **rp);
+int __cdecl ECDSA_sign_setup(EC_KEY *eckey, BN_CTX *ctx, BIGNUM **kinv, BIGNUM **rp);
 
 /** Computes ECDSA signature of a given hash value using the supplied
  *  private key (note: sig must point to ECDSA_size(eckey) bytes of memory).
@@ -1231,7 +1231,7 @@ int ECDSA_sign_setup(EC_KEY *eckey, BN_CTX *ctx, BIGNUM **kinv, BIGNUM **rp);
  *  \param  eckey    EC_KEY object containing a private EC key
  *  \return 1 on success and 0 otherwise
  */
-int ECDSA_sign(int type, const unsigned char *dgst, int dgstlen,
+int __cdecl ECDSA_sign(int type, const unsigned char *dgst, int dgstlen,
                unsigned char *sig, unsigned int *siglen, EC_KEY *eckey);
 
 /** Computes ECDSA signature of a given hash value using the supplied
@@ -1247,7 +1247,7 @@ int ECDSA_sign(int type, const unsigned char *dgst, int dgstlen,
  *  \param  eckey    EC_KEY object containing a private EC key
  *  \return 1 on success and 0 otherwise
  */
-int ECDSA_sign_ex(int type, const unsigned char *dgst, int dgstlen,
+int __cdecl ECDSA_sign_ex(int type, const unsigned char *dgst, int dgstlen,
                   unsigned char *sig, unsigned int *siglen,
                   const BIGNUM *kinv, const BIGNUM *rp, EC_KEY *eckey);
 
@@ -1262,22 +1262,22 @@ int ECDSA_sign_ex(int type, const unsigned char *dgst, int dgstlen,
  *  \return 1 if the signature is valid, 0 if the signature is invalid
  *          and -1 on error
  */
-int ECDSA_verify(int type, const unsigned char *dgst, int dgstlen,
+int __cdecl ECDSA_verify(int type, const unsigned char *dgst, int dgstlen,
                  const unsigned char *sig, int siglen, EC_KEY *eckey);
 
 /** Returns the maximum length of the DER encoded signature
  *  \param  eckey  EC_KEY object
  *  \return numbers of bytes required for the DER encoded signature
  */
-int ECDSA_size(const EC_KEY *eckey);
+int __cdecl ECDSA_size(const EC_KEY *eckey);
 
 /********************************************************************/
 /*  EC_KEY_METHOD constructors, destructors, writers and accessors  */
 /********************************************************************/
 
-EC_KEY_METHOD *EC_KEY_METHOD_new(const EC_KEY_METHOD *meth);
-void EC_KEY_METHOD_free(EC_KEY_METHOD *meth);
-void EC_KEY_METHOD_set_init(EC_KEY_METHOD *meth,
+EC_KEY_METHOD * __cdecl EC_KEY_METHOD_new(const EC_KEY_METHOD *meth);
+void __cdecl EC_KEY_METHOD_free(EC_KEY_METHOD *meth);
+void __cdecl EC_KEY_METHOD_set_init(EC_KEY_METHOD *meth,
                             int (*init)(EC_KEY *key),
                             void (*finish)(EC_KEY *key),
                             int (*copy)(EC_KEY *dest, const EC_KEY *src),
@@ -1287,16 +1287,16 @@ void EC_KEY_METHOD_set_init(EC_KEY_METHOD *meth,
                             int (*set_public)(EC_KEY *key,
                                               const EC_POINT *pub_key));
 
-void EC_KEY_METHOD_set_keygen(EC_KEY_METHOD *meth,
+void __cdecl EC_KEY_METHOD_set_keygen(EC_KEY_METHOD *meth,
                               int (*keygen)(EC_KEY *key));
 
-void EC_KEY_METHOD_set_compute_key(EC_KEY_METHOD *meth,
+void __cdecl EC_KEY_METHOD_set_compute_key(EC_KEY_METHOD *meth,
                                    int (*ckey)(unsigned char **psec,
                                                size_t *pseclen,
                                                const EC_POINT *pub_key,
                                                const EC_KEY *ecdh));
 
-void EC_KEY_METHOD_set_sign(EC_KEY_METHOD *meth,
+void __cdecl EC_KEY_METHOD_set_sign(EC_KEY_METHOD *meth,
                             int (*sign)(int type, const unsigned char *dgst,
                                         int dlen, unsigned char *sig,
                                         unsigned int *siglen,
@@ -1310,7 +1310,7 @@ void EC_KEY_METHOD_set_sign(EC_KEY_METHOD *meth,
                                                    const BIGNUM *in_r,
                                                    EC_KEY *eckey));
 
-void EC_KEY_METHOD_set_verify(EC_KEY_METHOD *meth,
+void __cdecl EC_KEY_METHOD_set_verify(EC_KEY_METHOD *meth,
                               int (*verify)(int type, const unsigned
                                             char *dgst, int dgst_len,
                                             const unsigned char *sigbuf,
@@ -1320,7 +1320,7 @@ void EC_KEY_METHOD_set_verify(EC_KEY_METHOD *meth,
                                                 const ECDSA_SIG *sig,
                                                 EC_KEY *eckey));
 
-void EC_KEY_METHOD_get_init(const EC_KEY_METHOD *meth,
+void __cdecl EC_KEY_METHOD_get_init(const EC_KEY_METHOD *meth,
                             int (**pinit)(EC_KEY *key),
                             void (**pfinish)(EC_KEY *key),
                             int (**pcopy)(EC_KEY *dest, const EC_KEY *src),
@@ -1331,16 +1331,16 @@ void EC_KEY_METHOD_get_init(const EC_KEY_METHOD *meth,
                             int (**pset_public)(EC_KEY *key,
                                                 const EC_POINT *pub_key));
 
-void EC_KEY_METHOD_get_keygen(const EC_KEY_METHOD *meth,
+void __cdecl EC_KEY_METHOD_get_keygen(const EC_KEY_METHOD *meth,
                               int (**pkeygen)(EC_KEY *key));
 
-void EC_KEY_METHOD_get_compute_key(const EC_KEY_METHOD *meth,
+void __cdecl EC_KEY_METHOD_get_compute_key(const EC_KEY_METHOD *meth,
                                    int (**pck)(unsigned char **psec,
                                                size_t *pseclen,
                                                const EC_POINT *pub_key,
                                                const EC_KEY *ecdh));
 
-void EC_KEY_METHOD_get_sign(const EC_KEY_METHOD *meth,
+void __cdecl EC_KEY_METHOD_get_sign(const EC_KEY_METHOD *meth,
                             int (**psign)(int type, const unsigned char *dgst,
                                           int dlen, unsigned char *sig,
                                           unsigned int *siglen,
@@ -1354,7 +1354,7 @@ void EC_KEY_METHOD_get_sign(const EC_KEY_METHOD *meth,
                                                      const BIGNUM *in_r,
                                                      EC_KEY *eckey));
 
-void EC_KEY_METHOD_get_verify(const EC_KEY_METHOD *meth,
+void __cdecl EC_KEY_METHOD_get_verify(const EC_KEY_METHOD *meth,
                               int (**pverify)(int type, const unsigned
                                               char *dgst, int dgst_len,
                                               const unsigned char *sigbuf,
diff --git a/include/openssl/ecerr.h b/include/openssl/ecerr.h
index f7b9183456..e1b9ba1a1e 100644
--- a/include/openssl/ecerr.h
+++ b/include/openssl/ecerr.h
@@ -22,7 +22,7 @@
 #  ifdef  __cplusplus
 extern "C"
 #  endif
-int ERR_load_EC_strings(void);
+int __cdecl ERR_load_EC_strings(void);
 
 /*
  * EC function codes.
diff --git a/include/openssl/engine.h b/include/openssl/engine.h
index 0780f0fb5f..599088da5f 100644
--- a/include/openssl/engine.h
+++ b/include/openssl/engine.h
@@ -308,17 +308,17 @@ typedef int (*ENGINE_PKEY_ASN1_METHS_PTR) (ENGINE *, EVP_PKEY_ASN1_METHOD **,
  */
 
 /* Get the first/last "ENGINE" type available. */
-ENGINE *ENGINE_get_first(void);
-ENGINE *ENGINE_get_last(void);
+ENGINE * __cdecl ENGINE_get_first(void);
+ENGINE * __cdecl ENGINE_get_last(void);
 /* Iterate to the next/previous "ENGINE" type (NULL = end of the list). */
-ENGINE *ENGINE_get_next(ENGINE *e);
-ENGINE *ENGINE_get_prev(ENGINE *e);
+ENGINE * __cdecl ENGINE_get_next(ENGINE *e);
+ENGINE * __cdecl ENGINE_get_prev(ENGINE *e);
 /* Add another "ENGINE" type into the array. */
-int ENGINE_add(ENGINE *e);
+int __cdecl ENGINE_add(ENGINE *e);
 /* Remove an existing "ENGINE" type from the array. */
-int ENGINE_remove(ENGINE *e);
+int __cdecl ENGINE_remove(ENGINE *e);
 /* Retrieve an engine from the list by its unique "id" value. */
-ENGINE *ENGINE_by_id(const char *id);
+ENGINE * __cdecl ENGINE_by_id(const char *id);
 
 #if OPENSSL_API_COMPAT < 0x10100000L
 # define ENGINE_load_openssl() \
@@ -338,14 +338,14 @@ ENGINE *ENGINE_by_id(const char *id);
 # define ENGINE_load_rdrand() \
     OPENSSL_init_crypto(OPENSSL_INIT_ENGINE_RDRAND, NULL)
 #endif
-void ENGINE_load_builtin_engines(void);
+void __cdecl ENGINE_load_builtin_engines(void);
 
 /*
  * Get and set global flags (ENGINE_TABLE_FLAG_***) for the implementation
  * "registry" handling.
  */
-unsigned int ENGINE_get_table_flags(void);
-void ENGINE_set_table_flags(unsigned int flags);
+unsigned int __cdecl ENGINE_get_table_flags(void);
+void __cdecl ENGINE_set_table_flags(unsigned int flags);
 
 /*- Manage registration of ENGINEs per "table". For each type, there are 3
  * functions;
@@ -355,41 +355,41 @@ void ENGINE_set_table_flags(unsigned int flags);
  * Cleanup is automatically registered from each table when required.
  */
 
-int ENGINE_register_RSA(ENGINE *e);
-void ENGINE_unregister_RSA(ENGINE *e);
-void ENGINE_register_all_RSA(void);
+int __cdecl ENGINE_register_RSA(ENGINE *e);
+void __cdecl ENGINE_unregister_RSA(ENGINE *e);
+void __cdecl ENGINE_register_all_RSA(void);
 
-int ENGINE_register_DSA(ENGINE *e);
-void ENGINE_unregister_DSA(ENGINE *e);
-void ENGINE_register_all_DSA(void);
+int __cdecl ENGINE_register_DSA(ENGINE *e);
+void __cdecl ENGINE_unregister_DSA(ENGINE *e);
+void __cdecl ENGINE_register_all_DSA(void);
 
-int ENGINE_register_EC(ENGINE *e);
-void ENGINE_unregister_EC(ENGINE *e);
-void ENGINE_register_all_EC(void);
+int __cdecl ENGINE_register_EC(ENGINE *e);
+void __cdecl ENGINE_unregister_EC(ENGINE *e);
+void __cdecl ENGINE_register_all_EC(void);
 
-int ENGINE_register_DH(ENGINE *e);
-void ENGINE_unregister_DH(ENGINE *e);
-void ENGINE_register_all_DH(void);
+int __cdecl ENGINE_register_DH(ENGINE *e);
+void __cdecl ENGINE_unregister_DH(ENGINE *e);
+void __cdecl ENGINE_register_all_DH(void);
 
-int ENGINE_register_RAND(ENGINE *e);
-void ENGINE_unregister_RAND(ENGINE *e);
-void ENGINE_register_all_RAND(void);
+int __cdecl ENGINE_register_RAND(ENGINE *e);
+void __cdecl ENGINE_unregister_RAND(ENGINE *e);
+void __cdecl ENGINE_register_all_RAND(void);
 
-int ENGINE_register_ciphers(ENGINE *e);
-void ENGINE_unregister_ciphers(ENGINE *e);
-void ENGINE_register_all_ciphers(void);
+int __cdecl ENGINE_register_ciphers(ENGINE *e);
+void __cdecl ENGINE_unregister_ciphers(ENGINE *e);
+void __cdecl ENGINE_register_all_ciphers(void);
 
-int ENGINE_register_digests(ENGINE *e);
-void ENGINE_unregister_digests(ENGINE *e);
-void ENGINE_register_all_digests(void);
+int __cdecl ENGINE_register_digests(ENGINE *e);
+void __cdecl ENGINE_unregister_digests(ENGINE *e);
+void __cdecl ENGINE_register_all_digests(void);
 
-int ENGINE_register_pkey_meths(ENGINE *e);
-void ENGINE_unregister_pkey_meths(ENGINE *e);
-void ENGINE_register_all_pkey_meths(void);
+int __cdecl ENGINE_register_pkey_meths(ENGINE *e);
+void __cdecl ENGINE_unregister_pkey_meths(ENGINE *e);
+void __cdecl ENGINE_register_all_pkey_meths(void);
 
-int ENGINE_register_pkey_asn1_meths(ENGINE *e);
-void ENGINE_unregister_pkey_asn1_meths(ENGINE *e);
-void ENGINE_register_all_pkey_asn1_meths(void);
+int __cdecl ENGINE_register_pkey_asn1_meths(ENGINE *e);
+void __cdecl ENGINE_unregister_pkey_asn1_meths(ENGINE *e);
+void __cdecl ENGINE_register_all_pkey_asn1_meths(void);
 
 /*
  * These functions register all support from the above categories. Note, use
@@ -397,8 +397,8 @@ void ENGINE_register_all_pkey_asn1_meths(void);
  * may not need. If you only need a subset of functionality, consider using
  * more selective initialisation.
  */
-int ENGINE_register_complete(ENGINE *e);
-int ENGINE_register_all_complete(void);
+int __cdecl ENGINE_register_complete(ENGINE *e);
+int __cdecl ENGINE_register_all_complete(void);
 
 /*
  * Send parameterised control commands to the engine. The possibilities to
@@ -410,7 +410,7 @@ int ENGINE_register_all_complete(void);
  * commands that require an operational ENGINE, and only use functional
  * references in such situations.
  */
-int ENGINE_ctrl(ENGINE *e, int cmd, long i, void *p, void (*f) (void));
+int __cdecl ENGINE_ctrl(ENGINE *e, int cmd, long i, void *p, void (*f) (void));
 
 /*
  * This function tests if an ENGINE-specific command is usable as a
@@ -418,7 +418,7 @@ int ENGINE_ctrl(ENGINE *e, int cmd, long i, void *p, void (*f) (void));
  * ENGINE_ctrl_cmd_string(). If this returns zero, it is not available to
  * ENGINE_ctrl_cmd_string(), only ENGINE_ctrl().
  */
-int ENGINE_cmd_is_executable(ENGINE *e, int cmd);
+int __cdecl ENGINE_cmd_is_executable(ENGINE *e, int cmd);
 
 /*
  * This function works like ENGINE_ctrl() with the exception of taking a
@@ -426,7 +426,7 @@ int ENGINE_cmd_is_executable(ENGINE *e, int cmd);
  * commands. See the comment on ENGINE_ctrl_cmd_string() for an explanation
  * on how to use the cmd_name and cmd_optional.
  */
-int ENGINE_ctrl_cmd(ENGINE *e, const char *cmd_name,
+int __cdecl ENGINE_ctrl_cmd(ENGINE *e, const char *cmd_name,
                     long i, void *p, void (*f) (void), int cmd_optional);
 
 /*
@@ -451,7 +451,7 @@ int ENGINE_ctrl_cmd(ENGINE *e, const char *cmd_name,
  * applications can work consistently with the same configuration for the
  * same ENGINE-enabled devices, across applications.
  */
-int ENGINE_ctrl_cmd_string(ENGINE *e, const char *cmd_name, const char *arg,
+int __cdecl ENGINE_ctrl_cmd_string(ENGINE *e, const char *cmd_name, const char *arg,
                            int cmd_optional);
 
 /*
@@ -462,37 +462,37 @@ int ENGINE_ctrl_cmd_string(ENGINE *e, const char *cmd_name, const char *arg,
  * These are also here so that the ENGINE structure doesn't have to be
  * exposed and break binary compatibility!
  */
-ENGINE *ENGINE_new(void);
-int ENGINE_free(ENGINE *e);
-int ENGINE_up_ref(ENGINE *e);
-int ENGINE_set_id(ENGINE *e, const char *id);
-int ENGINE_set_name(ENGINE *e, const char *name);
-int ENGINE_set_RSA(ENGINE *e, const RSA_METHOD *rsa_meth);
-int ENGINE_set_DSA(ENGINE *e, const DSA_METHOD *dsa_meth);
-int ENGINE_set_EC(ENGINE *e, const EC_KEY_METHOD *ecdsa_meth);
-int ENGINE_set_DH(ENGINE *e, const DH_METHOD *dh_meth);
-int ENGINE_set_RAND(ENGINE *e, const RAND_METHOD *rand_meth);
-int ENGINE_set_destroy_function(ENGINE *e, ENGINE_GEN_INT_FUNC_PTR destroy_f);
-int ENGINE_set_init_function(ENGINE *e, ENGINE_GEN_INT_FUNC_PTR init_f);
-int ENGINE_set_finish_function(ENGINE *e, ENGINE_GEN_INT_FUNC_PTR finish_f);
-int ENGINE_set_ctrl_function(ENGINE *e, ENGINE_CTRL_FUNC_PTR ctrl_f);
-int ENGINE_set_load_privkey_function(ENGINE *e,
+ENGINE * __cdecl ENGINE_new(void);
+int __cdecl ENGINE_free(ENGINE *e);
+int __cdecl ENGINE_up_ref(ENGINE *e);
+int __cdecl ENGINE_set_id(ENGINE *e, const char *id);
+int __cdecl ENGINE_set_name(ENGINE *e, const char *name);
+int __cdecl ENGINE_set_RSA(ENGINE *e, const RSA_METHOD *rsa_meth);
+int __cdecl ENGINE_set_DSA(ENGINE *e, const DSA_METHOD *dsa_meth);
+int __cdecl ENGINE_set_EC(ENGINE *e, const EC_KEY_METHOD *ecdsa_meth);
+int __cdecl ENGINE_set_DH(ENGINE *e, const DH_METHOD *dh_meth);
+int __cdecl ENGINE_set_RAND(ENGINE *e, const RAND_METHOD *rand_meth);
+int __cdecl ENGINE_set_destroy_function(ENGINE *e, ENGINE_GEN_INT_FUNC_PTR destroy_f);
+int __cdecl ENGINE_set_init_function(ENGINE *e, ENGINE_GEN_INT_FUNC_PTR init_f);
+int __cdecl ENGINE_set_finish_function(ENGINE *e, ENGINE_GEN_INT_FUNC_PTR finish_f);
+int __cdecl ENGINE_set_ctrl_function(ENGINE *e, ENGINE_CTRL_FUNC_PTR ctrl_f);
+int __cdecl ENGINE_set_load_privkey_function(ENGINE *e,
                                      ENGINE_LOAD_KEY_PTR loadpriv_f);
-int ENGINE_set_load_pubkey_function(ENGINE *e, ENGINE_LOAD_KEY_PTR loadpub_f);
-int ENGINE_set_load_ssl_client_cert_function(ENGINE *e,
+int __cdecl ENGINE_set_load_pubkey_function(ENGINE *e, ENGINE_LOAD_KEY_PTR loadpub_f);
+int __cdecl ENGINE_set_load_ssl_client_cert_function(ENGINE *e,
                                              ENGINE_SSL_CLIENT_CERT_PTR
                                              loadssl_f);
-int ENGINE_set_ciphers(ENGINE *e, ENGINE_CIPHERS_PTR f);
-int ENGINE_set_digests(ENGINE *e, ENGINE_DIGESTS_PTR f);
-int ENGINE_set_pkey_meths(ENGINE *e, ENGINE_PKEY_METHS_PTR f);
-int ENGINE_set_pkey_asn1_meths(ENGINE *e, ENGINE_PKEY_ASN1_METHS_PTR f);
-int ENGINE_set_flags(ENGINE *e, int flags);
-int ENGINE_set_cmd_defns(ENGINE *e, const ENGINE_CMD_DEFN *defns);
+int __cdecl ENGINE_set_ciphers(ENGINE *e, ENGINE_CIPHERS_PTR f);
+int __cdecl ENGINE_set_digests(ENGINE *e, ENGINE_DIGESTS_PTR f);
+int __cdecl ENGINE_set_pkey_meths(ENGINE *e, ENGINE_PKEY_METHS_PTR f);
+int __cdecl ENGINE_set_pkey_asn1_meths(ENGINE *e, ENGINE_PKEY_ASN1_METHS_PTR f);
+int __cdecl ENGINE_set_flags(ENGINE *e, int flags);
+int __cdecl ENGINE_set_cmd_defns(ENGINE *e, const ENGINE_CMD_DEFN *defns);
 /* These functions allow control over any per-structure ENGINE data. */
 #define ENGINE_get_ex_new_index(l, p, newf, dupf, freef) \
     CRYPTO_get_ex_new_index(CRYPTO_EX_INDEX_ENGINE, l, p, newf, dupf, freef)
-int ENGINE_set_ex_data(ENGINE *e, int idx, void *arg);
-void *ENGINE_get_ex_data(const ENGINE *e, int idx);
+int __cdecl ENGINE_set_ex_data(ENGINE *e, int idx, void *arg);
+void * __cdecl ENGINE_get_ex_data(const ENGINE *e, int idx);
 
 #if OPENSSL_API_COMPAT < 0x10100000L
 /*
@@ -508,37 +508,37 @@ void *ENGINE_get_ex_data(const ENGINE *e, int idx);
  * which you obtained. Using the result for functional purposes if you only
  * obtained a structural reference may be problematic!
  */
-const char *ENGINE_get_id(const ENGINE *e);
-const char *ENGINE_get_name(const ENGINE *e);
-const RSA_METHOD *ENGINE_get_RSA(const ENGINE *e);
-const DSA_METHOD *ENGINE_get_DSA(const ENGINE *e);
-const EC_KEY_METHOD *ENGINE_get_EC(const ENGINE *e);
-const DH_METHOD *ENGINE_get_DH(const ENGINE *e);
-const RAND_METHOD *ENGINE_get_RAND(const ENGINE *e);
-ENGINE_GEN_INT_FUNC_PTR ENGINE_get_destroy_function(const ENGINE *e);
-ENGINE_GEN_INT_FUNC_PTR ENGINE_get_init_function(const ENGINE *e);
-ENGINE_GEN_INT_FUNC_PTR ENGINE_get_finish_function(const ENGINE *e);
-ENGINE_CTRL_FUNC_PTR ENGINE_get_ctrl_function(const ENGINE *e);
-ENGINE_LOAD_KEY_PTR ENGINE_get_load_privkey_function(const ENGINE *e);
-ENGINE_LOAD_KEY_PTR ENGINE_get_load_pubkey_function(const ENGINE *e);
-ENGINE_SSL_CLIENT_CERT_PTR ENGINE_get_ssl_client_cert_function(const ENGINE
+const char * __cdecl ENGINE_get_id(const ENGINE *e);
+const char * __cdecl ENGINE_get_name(const ENGINE *e);
+const RSA_METHOD * __cdecl ENGINE_get_RSA(const ENGINE *e);
+const DSA_METHOD * __cdecl ENGINE_get_DSA(const ENGINE *e);
+const EC_KEY_METHOD * __cdecl ENGINE_get_EC(const ENGINE *e);
+const DH_METHOD * __cdecl ENGINE_get_DH(const ENGINE *e);
+const RAND_METHOD * __cdecl ENGINE_get_RAND(const ENGINE *e);
+ENGINE_GEN_INT_FUNC_PTR __cdecl ENGINE_get_destroy_function(const ENGINE *e);
+ENGINE_GEN_INT_FUNC_PTR __cdecl ENGINE_get_init_function(const ENGINE *e);
+ENGINE_GEN_INT_FUNC_PTR __cdecl ENGINE_get_finish_function(const ENGINE *e);
+ENGINE_CTRL_FUNC_PTR __cdecl ENGINE_get_ctrl_function(const ENGINE *e);
+ENGINE_LOAD_KEY_PTR __cdecl ENGINE_get_load_privkey_function(const ENGINE *e);
+ENGINE_LOAD_KEY_PTR __cdecl ENGINE_get_load_pubkey_function(const ENGINE *e);
+ENGINE_SSL_CLIENT_CERT_PTR __cdecl ENGINE_get_ssl_client_cert_function(const ENGINE
                                                                *e);
-ENGINE_CIPHERS_PTR ENGINE_get_ciphers(const ENGINE *e);
-ENGINE_DIGESTS_PTR ENGINE_get_digests(const ENGINE *e);
-ENGINE_PKEY_METHS_PTR ENGINE_get_pkey_meths(const ENGINE *e);
-ENGINE_PKEY_ASN1_METHS_PTR ENGINE_get_pkey_asn1_meths(const ENGINE *e);
-const EVP_CIPHER *ENGINE_get_cipher(ENGINE *e, int nid);
-const EVP_MD *ENGINE_get_digest(ENGINE *e, int nid);
-const EVP_PKEY_METHOD *ENGINE_get_pkey_meth(ENGINE *e, int nid);
-const EVP_PKEY_ASN1_METHOD *ENGINE_get_pkey_asn1_meth(ENGINE *e, int nid);
-const EVP_PKEY_ASN1_METHOD *ENGINE_get_pkey_asn1_meth_str(ENGINE *e,
+ENGINE_CIPHERS_PTR __cdecl ENGINE_get_ciphers(const ENGINE *e);
+ENGINE_DIGESTS_PTR __cdecl ENGINE_get_digests(const ENGINE *e);
+ENGINE_PKEY_METHS_PTR __cdecl ENGINE_get_pkey_meths(const ENGINE *e);
+ENGINE_PKEY_ASN1_METHS_PTR __cdecl ENGINE_get_pkey_asn1_meths(const ENGINE *e);
+const EVP_CIPHER * __cdecl ENGINE_get_cipher(ENGINE *e, int nid);
+const EVP_MD * __cdecl ENGINE_get_digest(ENGINE *e, int nid);
+const EVP_PKEY_METHOD * __cdecl ENGINE_get_pkey_meth(ENGINE *e, int nid);
+const EVP_PKEY_ASN1_METHOD * __cdecl ENGINE_get_pkey_asn1_meth(ENGINE *e, int nid);
+const EVP_PKEY_ASN1_METHOD * __cdecl ENGINE_get_pkey_asn1_meth_str(ENGINE *e,
                                                           const char *str,
                                                           int len);
-const EVP_PKEY_ASN1_METHOD *ENGINE_pkey_asn1_find_str(ENGINE **pe,
+const EVP_PKEY_ASN1_METHOD * __cdecl ENGINE_pkey_asn1_find_str(ENGINE **pe,
                                                       const char *str,
                                                       int len);
-const ENGINE_CMD_DEFN *ENGINE_get_cmd_defns(const ENGINE *e);
-int ENGINE_get_flags(const ENGINE *e);
+const ENGINE_CMD_DEFN * __cdecl ENGINE_get_cmd_defns(const ENGINE *e);
+int __cdecl ENGINE_get_flags(const ENGINE *e);
 
 /*
  * FUNCTIONAL functions. These functions deal with ENGINE structures that
@@ -558,24 +558,24 @@ int ENGINE_get_flags(const ENGINE *e);
  * already in use). This will fail if the engine is not currently operational
  * and cannot initialise.
  */
-int ENGINE_init(ENGINE *e);
+int __cdecl ENGINE_init(ENGINE *e);
 /*
  * Free a functional reference to a engine type. This does not require a
  * corresponding call to ENGINE_free as it also releases a structural
  * reference.
  */
-int ENGINE_finish(ENGINE *e);
+int __cdecl ENGINE_finish(ENGINE *e);
 
 /*
  * The following functions handle keys that are stored in some secondary
  * location, handled by the engine.  The storage may be on a card or
  * whatever.
  */
-EVP_PKEY *ENGINE_load_private_key(ENGINE *e, const char *key_id,
+EVP_PKEY * __cdecl ENGINE_load_private_key(ENGINE *e, const char *key_id,
                                   UI_METHOD *ui_method, void *callback_data);
-EVP_PKEY *ENGINE_load_public_key(ENGINE *e, const char *key_id,
+EVP_PKEY * __cdecl ENGINE_load_public_key(ENGINE *e, const char *key_id,
                                  UI_METHOD *ui_method, void *callback_data);
-int ENGINE_load_ssl_client_cert(ENGINE *e, SSL *s,
+int __cdecl ENGINE_load_ssl_client_cert(ENGINE *e, SSL *s,
                                 STACK_OF(X509_NAME) *ca_dn, X509 **pcert,
                                 EVP_PKEY **ppkey, STACK_OF(X509) **pother,
                                 UI_METHOD *ui_method, void *callback_data);
@@ -586,20 +586,20 @@ int ENGINE_load_ssl_client_cert(ENGINE *e, SSL *s,
  * incremented reference, so it should be free'd (ENGINE_finish) before it is
  * discarded.
  */
-ENGINE *ENGINE_get_default_RSA(void);
+ENGINE * __cdecl ENGINE_get_default_RSA(void);
 /* Same for the other "methods" */
-ENGINE *ENGINE_get_default_DSA(void);
-ENGINE *ENGINE_get_default_EC(void);
-ENGINE *ENGINE_get_default_DH(void);
-ENGINE *ENGINE_get_default_RAND(void);
+ENGINE * __cdecl ENGINE_get_default_DSA(void);
+ENGINE * __cdecl ENGINE_get_default_EC(void);
+ENGINE * __cdecl ENGINE_get_default_DH(void);
+ENGINE * __cdecl ENGINE_get_default_RAND(void);
 /*
  * These functions can be used to get a functional reference to perform
  * ciphering or digesting corresponding to "nid".
  */
-ENGINE *ENGINE_get_cipher_engine(int nid);
-ENGINE *ENGINE_get_digest_engine(int nid);
-ENGINE *ENGINE_get_pkey_meth_engine(int nid);
-ENGINE *ENGINE_get_pkey_asn1_meth_engine(int nid);
+ENGINE * __cdecl ENGINE_get_cipher_engine(int nid);
+ENGINE * __cdecl ENGINE_get_digest_engine(int nid);
+ENGINE * __cdecl ENGINE_get_pkey_meth_engine(int nid);
+ENGINE * __cdecl ENGINE_get_pkey_asn1_meth_engine(int nid);
 
 /*
  * This sets a new default ENGINE structure for performing RSA operations. If
@@ -607,17 +607,17 @@ ENGINE *ENGINE_get_pkey_asn1_meth_engine(int nid);
  * its reference count up'd so the caller should still free their own
  * reference 'e'.
  */
-int ENGINE_set_default_RSA(ENGINE *e);
-int ENGINE_set_default_string(ENGINE *e, const char *def_list);
+int __cdecl ENGINE_set_default_RSA(ENGINE *e);
+int __cdecl ENGINE_set_default_string(ENGINE *e, const char *def_list);
 /* Same for the other "methods" */
-int ENGINE_set_default_DSA(ENGINE *e);
-int ENGINE_set_default_EC(ENGINE *e);
-int ENGINE_set_default_DH(ENGINE *e);
-int ENGINE_set_default_RAND(ENGINE *e);
-int ENGINE_set_default_ciphers(ENGINE *e);
-int ENGINE_set_default_digests(ENGINE *e);
-int ENGINE_set_default_pkey_meths(ENGINE *e);
-int ENGINE_set_default_pkey_asn1_meths(ENGINE *e);
+int __cdecl ENGINE_set_default_DSA(ENGINE *e);
+int __cdecl ENGINE_set_default_EC(ENGINE *e);
+int __cdecl ENGINE_set_default_DH(ENGINE *e);
+int __cdecl ENGINE_set_default_RAND(ENGINE *e);
+int __cdecl ENGINE_set_default_ciphers(ENGINE *e);
+int __cdecl ENGINE_set_default_digests(ENGINE *e);
+int __cdecl ENGINE_set_default_pkey_meths(ENGINE *e);
+int __cdecl ENGINE_set_default_pkey_asn1_meths(ENGINE *e);
 
 /*
  * The combination "set" - the flags are bitwise "OR"d from the
@@ -626,9 +626,9 @@ int ENGINE_set_default_pkey_asn1_meths(ENGINE *e);
  * application requires only specific functionality, consider using more
  * selective functions.
  */
-int ENGINE_set_default(ENGINE *e, unsigned int flags);
+int __cdecl ENGINE_set_default(ENGINE *e, unsigned int flags);
 
-void ENGINE_add_conf_module(void);
+void __cdecl ENGINE_add_conf_module(void);
 
 /* Deprecated functions ... */
 /* int ENGINE_clear_defaults(void); */
@@ -656,9 +656,9 @@ void ENGINE_add_conf_module(void);
  * same static data as the calling application (or library), and thus whether
  * these callbacks need to be set or not.
  */
-typedef void *(*dyn_MEM_malloc_fn) (size_t, const char *, int);
-typedef void *(*dyn_MEM_realloc_fn) (void *, size_t, const char *, int);
-typedef void (*dyn_MEM_free_fn) (void *, const char *, int);
+typedef void *(__cdecl *dyn_MEM_malloc_fn) (size_t, const char *, int);
+typedef void *(__cdecl *dyn_MEM_realloc_fn) (void *, size_t, const char *, int);
+typedef void (__cdecl *dyn_MEM_free_fn) (void *, const char *, int);
 typedef struct st_dynamic_MEM_fns {
     dyn_MEM_malloc_fn malloc_fn;
     dyn_MEM_realloc_fn realloc_fn;
@@ -737,7 +737,7 @@ typedef int (*dynamic_bind_engine) (ENGINE *e, const char *id,
  * static data and let the loading application and loaded ENGINE compare
  * their respective values.
  */
-void *ENGINE_get_static_state(void);
+void * __cdecl ENGINE_get_static_state(void);
 
 # if defined(__OpenBSD__) || defined(__FreeBSD__) || defined(__DragonFly__)
 DEPRECATEDIN_1_1_0(void ENGINE_setup_bsd_cryptodev(void))
diff --git a/include/openssl/engineerr.h b/include/openssl/engineerr.h
index 05e84bd2a2..9741156b33 100644
--- a/include/openssl/engineerr.h
+++ b/include/openssl/engineerr.h
@@ -22,7 +22,7 @@
 #  ifdef  __cplusplus
 extern "C"
 #  endif
-int ERR_load_ENGINE_strings(void);
+int __cdecl ERR_load_ENGINE_strings(void);
 
 /*
  * ENGINE function codes.
diff --git a/include/openssl/err.h b/include/openssl/err.h
index b49f88129e..6c81f0ec16 100644
--- a/include/openssl/err.h
+++ b/include/openssl/err.h
@@ -217,39 +217,39 @@ typedef struct ERR_string_data_st {
 
 DEFINE_LHASH_OF(ERR_STRING_DATA);
 
-void ERR_put_error(int lib, int func, int reason, const char *file, int line);
-void ERR_set_error_data(char *data, int flags);
+void __cdecl ERR_put_error(int lib, int func, int reason, const char *file, int line);
+void __cdecl ERR_set_error_data(char *data, int flags);
 
-unsigned long ERR_get_error(void);
-unsigned long ERR_get_error_line(const char **file, int *line);
-unsigned long ERR_get_error_line_data(const char **file, int *line,
+unsigned long __cdecl ERR_get_error(void);
+unsigned long __cdecl ERR_get_error_line(const char **file, int *line);
+unsigned long __cdecl ERR_get_error_line_data(const char **file, int *line,
                                       const char **data, int *flags);
-unsigned long ERR_peek_error(void);
-unsigned long ERR_peek_error_line(const char **file, int *line);
-unsigned long ERR_peek_error_line_data(const char **file, int *line,
+unsigned long __cdecl ERR_peek_error(void);
+unsigned long __cdecl ERR_peek_error_line(const char **file, int *line);
+unsigned long __cdecl ERR_peek_error_line_data(const char **file, int *line,
                                        const char **data, int *flags);
-unsigned long ERR_peek_last_error(void);
-unsigned long ERR_peek_last_error_line(const char **file, int *line);
-unsigned long ERR_peek_last_error_line_data(const char **file, int *line,
+unsigned long __cdecl ERR_peek_last_error(void);
+unsigned long __cdecl ERR_peek_last_error_line(const char **file, int *line);
+unsigned long __cdecl ERR_peek_last_error_line_data(const char **file, int *line,
                                             const char **data, int *flags);
-void ERR_clear_error(void);
-char *ERR_error_string(unsigned long e, char *buf);
-void ERR_error_string_n(unsigned long e, char *buf, size_t len);
-const char *ERR_lib_error_string(unsigned long e);
-const char *ERR_func_error_string(unsigned long e);
-const char *ERR_reason_error_string(unsigned long e);
-void ERR_print_errors_cb(int (*cb) (const char *str, size_t len, void *u),
+void __cdecl ERR_clear_error(void);
+char *__cdecl ERR_error_string(unsigned long e, char *buf);
+void __cdecl ERR_error_string_n(unsigned long e, char *buf, size_t len);
+const char * __cdecl ERR_lib_error_string(unsigned long e);
+const char * __cdecl ERR_func_error_string(unsigned long e);
+const char * __cdecl ERR_reason_error_string(unsigned long e);
+void __cdecl ERR_print_errors_cb(int (*cb) (const char *str, size_t len, void *u),
                          void *u);
 # ifndef OPENSSL_NO_STDIO
-void ERR_print_errors_fp(FILE *fp);
+void __cdecl ERR_print_errors_fp(FILE *fp);
 # endif
-void ERR_print_errors(BIO *bp);
-void ERR_add_error_data(int num, ...);
-void ERR_add_error_vdata(int num, va_list args);
-int ERR_load_strings(int lib, ERR_STRING_DATA *str);
-int ERR_load_strings_const(const ERR_STRING_DATA *str);
-int ERR_unload_strings(int lib, ERR_STRING_DATA *str);
-int ERR_load_ERR_strings(void);
+void __cdecl ERR_print_errors(BIO *bp);
+void __cdecl ERR_add_error_data(int num, ...);
+void __cdecl ERR_add_error_vdata(int num, va_list args);
+int __cdecl ERR_load_strings(int lib, ERR_STRING_DATA *str);
+int __cdecl ERR_load_strings_const(const ERR_STRING_DATA *str);
+int __cdecl ERR_unload_strings(int lib, ERR_STRING_DATA *str);
+int __cdecl ERR_load_ERR_strings(void);
 
 #if OPENSSL_API_COMPAT < 0x10100000L
 # define ERR_load_crypto_strings() \
@@ -259,13 +259,13 @@ int ERR_load_ERR_strings(void);
 
 DEPRECATEDIN_1_1_0(void ERR_remove_thread_state(void *))
 DEPRECATEDIN_1_0_0(void ERR_remove_state(unsigned long pid))
-ERR_STATE *ERR_get_state(void);
+ERR_STATE * __cdecl ERR_get_state(void);
 
-int ERR_get_next_error_library(void);
+int __cdecl ERR_get_next_error_library(void);
 
-int ERR_set_mark(void);
-int ERR_pop_to_mark(void);
-int ERR_clear_last_mark(void);
+int __cdecl ERR_set_mark(void);
+int __cdecl ERR_pop_to_mark(void);
+int __cdecl ERR_clear_last_mark(void);
 
 #ifdef  __cplusplus
 }
diff --git a/include/openssl/evp.h b/include/openssl/evp.h
index 545654a98b..89a6a667b3 100644
--- a/include/openssl/evp.h
+++ b/include/openssl/evp.h
@@ -73,40 +73,40 @@ extern "C" {
 # define EVP_PKEY_MO_DECRYPT     0x0008
 
 # ifndef EVP_MD
-EVP_MD *EVP_MD_meth_new(int md_type, int pkey_type);
-EVP_MD *EVP_MD_meth_dup(const EVP_MD *md);
-void EVP_MD_meth_free(EVP_MD *md);
-
-int EVP_MD_meth_set_input_blocksize(EVP_MD *md, int blocksize);
-int EVP_MD_meth_set_result_size(EVP_MD *md, int resultsize);
-int EVP_MD_meth_set_app_datasize(EVP_MD *md, int datasize);
-int EVP_MD_meth_set_flags(EVP_MD *md, unsigned long flags);
-int EVP_MD_meth_set_init(EVP_MD *md, int (*init)(EVP_MD_CTX *ctx));
-int EVP_MD_meth_set_update(EVP_MD *md, int (*update)(EVP_MD_CTX *ctx,
+EVP_MD * __cdecl EVP_MD_meth_new(int md_type, int pkey_type);
+EVP_MD * __cdecl EVP_MD_meth_dup(const EVP_MD *md);
+void __cdecl EVP_MD_meth_free(EVP_MD *md);
+
+int __cdecl EVP_MD_meth_set_input_blocksize(EVP_MD *md, int blocksize);
+int __cdecl EVP_MD_meth_set_result_size(EVP_MD *md, int resultsize);
+int __cdecl EVP_MD_meth_set_app_datasize(EVP_MD *md, int datasize);
+int __cdecl EVP_MD_meth_set_flags(EVP_MD *md, unsigned long flags);
+int __cdecl EVP_MD_meth_set_init(EVP_MD *md, int (*init)(EVP_MD_CTX *ctx));
+int __cdecl EVP_MD_meth_set_update(EVP_MD *md, int (*update)(EVP_MD_CTX *ctx,
                                                      const void *data,
                                                      size_t count));
-int EVP_MD_meth_set_final(EVP_MD *md, int (*final)(EVP_MD_CTX *ctx,
+int __cdecl EVP_MD_meth_set_final(EVP_MD *md, int (*final)(EVP_MD_CTX *ctx,
                                                    unsigned char *md));
-int EVP_MD_meth_set_copy(EVP_MD *md, int (*copy)(EVP_MD_CTX *to,
+int __cdecl EVP_MD_meth_set_copy(EVP_MD *md, int (*copy)(EVP_MD_CTX *to,
                                                  const EVP_MD_CTX *from));
-int EVP_MD_meth_set_cleanup(EVP_MD *md, int (*cleanup)(EVP_MD_CTX *ctx));
-int EVP_MD_meth_set_ctrl(EVP_MD *md, int (*ctrl)(EVP_MD_CTX *ctx, int cmd,
+int __cdecl EVP_MD_meth_set_cleanup(EVP_MD *md, int (*cleanup)(EVP_MD_CTX *ctx));
+int __cdecl EVP_MD_meth_set_ctrl(EVP_MD *md, int (*ctrl)(EVP_MD_CTX *ctx, int cmd,
                                                  int p1, void *p2));
 
-int EVP_MD_meth_get_input_blocksize(const EVP_MD *md);
-int EVP_MD_meth_get_result_size(const EVP_MD *md);
-int EVP_MD_meth_get_app_datasize(const EVP_MD *md);
-unsigned long EVP_MD_meth_get_flags(const EVP_MD *md);
-int (*EVP_MD_meth_get_init(const EVP_MD *md))(EVP_MD_CTX *ctx);
-int (*EVP_MD_meth_get_update(const EVP_MD *md))(EVP_MD_CTX *ctx,
+int __cdecl EVP_MD_meth_get_input_blocksize(const EVP_MD *md);
+int __cdecl EVP_MD_meth_get_result_size(const EVP_MD *md);
+int __cdecl EVP_MD_meth_get_app_datasize(const EVP_MD *md);
+unsigned long __cdecl EVP_MD_meth_get_flags(const EVP_MD *md);
+int (* __cdecl EVP_MD_meth_get_init(const EVP_MD *md))(EVP_MD_CTX *ctx);
+int (* __cdecl EVP_MD_meth_get_update(const EVP_MD *md))(EVP_MD_CTX *ctx,
                                                 const void *data,
                                                 size_t count);
-int (*EVP_MD_meth_get_final(const EVP_MD *md))(EVP_MD_CTX *ctx,
+int (* __cdecl EVP_MD_meth_get_final(const EVP_MD *md))(EVP_MD_CTX *ctx,
                                                unsigned char *md);
-int (*EVP_MD_meth_get_copy(const EVP_MD *md))(EVP_MD_CTX *to,
+int (* __cdecl EVP_MD_meth_get_copy(const EVP_MD *md))(EVP_MD_CTX *to,
                                               const EVP_MD_CTX *from);
-int (*EVP_MD_meth_get_cleanup(const EVP_MD *md))(EVP_MD_CTX *ctx);
-int (*EVP_MD_meth_get_ctrl(const EVP_MD *md))(EVP_MD_CTX *ctx, int cmd,
+int (* __cdecl EVP_MD_meth_get_cleanup(const EVP_MD *md))(EVP_MD_CTX *ctx);
+int (* __cdecl EVP_MD_meth_get_ctrl(const EVP_MD *md))(EVP_MD_CTX *ctx, int cmd,
                                               int p1, void *p2);
 
 /* digest can only handle a single block */
@@ -182,49 +182,49 @@ int (*EVP_MD_meth_get_ctrl(const EVP_MD *md))(EVP_MD_CTX *ctx, int cmd,
 # define EVP_MD_CTX_FLAG_FINALISE        0x0200
 /* NOTE: 0x0400 is reserved for internal usage in evp_int.h */
 
-EVP_CIPHER *EVP_CIPHER_meth_new(int cipher_type, int block_size, int key_len);
-EVP_CIPHER *EVP_CIPHER_meth_dup(const EVP_CIPHER *cipher);
-void EVP_CIPHER_meth_free(EVP_CIPHER *cipher);
+EVP_CIPHER * __cdecl EVP_CIPHER_meth_new(int cipher_type, int block_size, int key_len);
+EVP_CIPHER * __cdecl EVP_CIPHER_meth_dup(const EVP_CIPHER *cipher);
+void __cdecl EVP_CIPHER_meth_free(EVP_CIPHER *cipher);
 
-int EVP_CIPHER_meth_set_iv_length(EVP_CIPHER *cipher, int iv_len);
-int EVP_CIPHER_meth_set_flags(EVP_CIPHER *cipher, unsigned long flags);
-int EVP_CIPHER_meth_set_impl_ctx_size(EVP_CIPHER *cipher, int ctx_size);
-int EVP_CIPHER_meth_set_init(EVP_CIPHER *cipher,
+int __cdecl EVP_CIPHER_meth_set_iv_length(EVP_CIPHER *cipher, int iv_len);
+int __cdecl EVP_CIPHER_meth_set_flags(EVP_CIPHER *cipher, unsigned long flags);
+int __cdecl EVP_CIPHER_meth_set_impl_ctx_size(EVP_CIPHER *cipher, int ctx_size);
+int __cdecl EVP_CIPHER_meth_set_init(EVP_CIPHER *cipher,
                              int (*init) (EVP_CIPHER_CTX *ctx,
                                           const unsigned char *key,
                                           const unsigned char *iv,
                                           int enc));
-int EVP_CIPHER_meth_set_do_cipher(EVP_CIPHER *cipher,
+int __cdecl EVP_CIPHER_meth_set_do_cipher(EVP_CIPHER *cipher,
                                   int (*do_cipher) (EVP_CIPHER_CTX *ctx,
                                                     unsigned char *out,
                                                     const unsigned char *in,
                                                     size_t inl));
-int EVP_CIPHER_meth_set_cleanup(EVP_CIPHER *cipher,
+int __cdecl EVP_CIPHER_meth_set_cleanup(EVP_CIPHER *cipher,
                                 int (*cleanup) (EVP_CIPHER_CTX *));
-int EVP_CIPHER_meth_set_set_asn1_params(EVP_CIPHER *cipher,
-                                        int (*set_asn1_parameters) (EVP_CIPHER_CTX *,
+int __cdecl EVP_CIPHER_meth_set_set_asn1_params(EVP_CIPHER *cipher,
+                                        int (__cdecl *set_asn1_parameters) (EVP_CIPHER_CTX *,
                                                                     ASN1_TYPE *));
-int EVP_CIPHER_meth_set_get_asn1_params(EVP_CIPHER *cipher,
-                                        int (*get_asn1_parameters) (EVP_CIPHER_CTX *,
+int __cdecl EVP_CIPHER_meth_set_get_asn1_params(EVP_CIPHER *cipher,
+                                        int (__cdecl *get_asn1_parameters) (EVP_CIPHER_CTX *,
                                                                     ASN1_TYPE *));
-int EVP_CIPHER_meth_set_ctrl(EVP_CIPHER *cipher,
+int __cdecl EVP_CIPHER_meth_set_ctrl(EVP_CIPHER *cipher,
                              int (*ctrl) (EVP_CIPHER_CTX *, int type,
                                           int arg, void *ptr));
 
-int (*EVP_CIPHER_meth_get_init(const EVP_CIPHER *cipher))(EVP_CIPHER_CTX *ctx,
+int (* __cdecl EVP_CIPHER_meth_get_init(const EVP_CIPHER *cipher))(EVP_CIPHER_CTX *ctx,
                                                           const unsigned char *key,
                                                           const unsigned char *iv,
                                                           int enc);
-int (*EVP_CIPHER_meth_get_do_cipher(const EVP_CIPHER *cipher))(EVP_CIPHER_CTX *ctx,
+int (* __cdecl EVP_CIPHER_meth_get_do_cipher(const EVP_CIPHER *cipher))(EVP_CIPHER_CTX *ctx,
                                                                unsigned char *out,
                                                                const unsigned char *in,
                                                                size_t inl);
-int (*EVP_CIPHER_meth_get_cleanup(const EVP_CIPHER *cipher))(EVP_CIPHER_CTX *);
-int (*EVP_CIPHER_meth_get_set_asn1_params(const EVP_CIPHER *cipher))(EVP_CIPHER_CTX *,
+int (* __cdecl EVP_CIPHER_meth_get_cleanup(const EVP_CIPHER *cipher))(EVP_CIPHER_CTX *);
+int (__cdecl * EVP_CIPHER_meth_get_set_asn1_params(const EVP_CIPHER *cipher))(EVP_CIPHER_CTX *,
                                                                      ASN1_TYPE *);
-int (*EVP_CIPHER_meth_get_get_asn1_params(const EVP_CIPHER *cipher))(EVP_CIPHER_CTX *,
+int (__cdecl * EVP_CIPHER_meth_get_get_asn1_params(const EVP_CIPHER *cipher))(EVP_CIPHER_CTX *,
                                                                ASN1_TYPE *);
-int (*EVP_CIPHER_meth_get_ctrl(const EVP_CIPHER *cipher))(EVP_CIPHER_CTX *,
+int (* __cdecl EVP_CIPHER_meth_get_ctrl(const EVP_CIPHER *cipher))(EVP_CIPHER_CTX *,
                                                           int type, int arg,
                                                           void *ptr);
 
@@ -400,7 +400,7 @@ typedef struct evp_cipher_info_st {
 
 
 /* Password based encryption function */
-typedef int (EVP_PBE_KEYGEN) (EVP_CIPHER_CTX *ctx, const char *pass,
+typedef int (__cdecl EVP_PBE_KEYGEN) (EVP_CIPHER_CTX *ctx, const char *pass,
                               int passlen, ASN1_TYPE *param,
                               const EVP_CIPHER *cipher, const EVP_MD *md,
                               int en_de);
@@ -440,53 +440,53 @@ typedef int (EVP_PBE_KEYGEN) (EVP_CIPHER_CTX *ctx, const char *pass,
 # define EVP_get_cipherbynid(a) EVP_get_cipherbyname(OBJ_nid2sn(a))
 # define EVP_get_cipherbyobj(a) EVP_get_cipherbynid(OBJ_obj2nid(a))
 
-int EVP_MD_type(const EVP_MD *md);
+int __cdecl EVP_MD_type(const EVP_MD *md);
 # define EVP_MD_nid(e)                   EVP_MD_type(e)
 # define EVP_MD_name(e)                  OBJ_nid2sn(EVP_MD_nid(e))
-int EVP_MD_pkey_type(const EVP_MD *md);
-int EVP_MD_size(const EVP_MD *md);
-int EVP_MD_block_size(const EVP_MD *md);
-unsigned long EVP_MD_flags(const EVP_MD *md);
+int __cdecl EVP_MD_pkey_type(const EVP_MD *md);
+int __cdecl EVP_MD_size(const EVP_MD *md);
+int __cdecl EVP_MD_block_size(const EVP_MD *md);
+unsigned long __cdecl EVP_MD_flags(const EVP_MD *md);
 
-const EVP_MD *EVP_MD_CTX_md(const EVP_MD_CTX *ctx);
-int (*EVP_MD_CTX_update_fn(EVP_MD_CTX *ctx))(EVP_MD_CTX *ctx,
+const EVP_MD * __cdecl EVP_MD_CTX_md(const EVP_MD_CTX *ctx);
+int (* __cdecl EVP_MD_CTX_update_fn(EVP_MD_CTX *ctx))(EVP_MD_CTX *ctx,
                                              const void *data, size_t count);
-void EVP_MD_CTX_set_update_fn(EVP_MD_CTX *ctx,
+void __cdecl EVP_MD_CTX_set_update_fn(EVP_MD_CTX *ctx,
                               int (*update) (EVP_MD_CTX *ctx,
                                              const void *data, size_t count));
 # define EVP_MD_CTX_size(e)              EVP_MD_size(EVP_MD_CTX_md(e))
 # define EVP_MD_CTX_block_size(e)        EVP_MD_block_size(EVP_MD_CTX_md(e))
 # define EVP_MD_CTX_type(e)              EVP_MD_type(EVP_MD_CTX_md(e))
-EVP_PKEY_CTX *EVP_MD_CTX_pkey_ctx(const EVP_MD_CTX *ctx);
-void EVP_MD_CTX_set_pkey_ctx(EVP_MD_CTX *ctx, EVP_PKEY_CTX *pctx);
-void *EVP_MD_CTX_md_data(const EVP_MD_CTX *ctx);
+EVP_PKEY_CTX * __cdecl EVP_MD_CTX_pkey_ctx(const EVP_MD_CTX *ctx);
+void __cdecl EVP_MD_CTX_set_pkey_ctx(EVP_MD_CTX *ctx, EVP_PKEY_CTX *pctx);
+void * __cdecl EVP_MD_CTX_md_data(const EVP_MD_CTX *ctx);
 
-int EVP_CIPHER_nid(const EVP_CIPHER *cipher);
+int __cdecl EVP_CIPHER_nid(const EVP_CIPHER *cipher);
 # define EVP_CIPHER_name(e)              OBJ_nid2sn(EVP_CIPHER_nid(e))
-int EVP_CIPHER_block_size(const EVP_CIPHER *cipher);
-int EVP_CIPHER_impl_ctx_size(const EVP_CIPHER *cipher);
-int EVP_CIPHER_key_length(const EVP_CIPHER *cipher);
-int EVP_CIPHER_iv_length(const EVP_CIPHER *cipher);
-unsigned long EVP_CIPHER_flags(const EVP_CIPHER *cipher);
+int __cdecl EVP_CIPHER_block_size(const EVP_CIPHER *cipher);
+int __cdecl EVP_CIPHER_impl_ctx_size(const EVP_CIPHER *cipher);
+int __cdecl EVP_CIPHER_key_length(const EVP_CIPHER *cipher);
+int __cdecl EVP_CIPHER_iv_length(const EVP_CIPHER *cipher);
+unsigned long __cdecl EVP_CIPHER_flags(const EVP_CIPHER *cipher);
 # define EVP_CIPHER_mode(e)              (EVP_CIPHER_flags(e) & EVP_CIPH_MODE)
 
-const EVP_CIPHER *EVP_CIPHER_CTX_cipher(const EVP_CIPHER_CTX *ctx);
-int EVP_CIPHER_CTX_encrypting(const EVP_CIPHER_CTX *ctx);
-int EVP_CIPHER_CTX_nid(const EVP_CIPHER_CTX *ctx);
-int EVP_CIPHER_CTX_block_size(const EVP_CIPHER_CTX *ctx);
-int EVP_CIPHER_CTX_key_length(const EVP_CIPHER_CTX *ctx);
-int EVP_CIPHER_CTX_iv_length(const EVP_CIPHER_CTX *ctx);
-const unsigned char *EVP_CIPHER_CTX_iv(const EVP_CIPHER_CTX *ctx);
-const unsigned char *EVP_CIPHER_CTX_original_iv(const EVP_CIPHER_CTX *ctx);
-unsigned char *EVP_CIPHER_CTX_iv_noconst(EVP_CIPHER_CTX *ctx);
-unsigned char *EVP_CIPHER_CTX_buf_noconst(EVP_CIPHER_CTX *ctx);
-int EVP_CIPHER_CTX_num(const EVP_CIPHER_CTX *ctx);
-void EVP_CIPHER_CTX_set_num(EVP_CIPHER_CTX *ctx, int num);
-int EVP_CIPHER_CTX_copy(EVP_CIPHER_CTX *out, const EVP_CIPHER_CTX *in);
-void *EVP_CIPHER_CTX_get_app_data(const EVP_CIPHER_CTX *ctx);
-void EVP_CIPHER_CTX_set_app_data(EVP_CIPHER_CTX *ctx, void *data);
-void *EVP_CIPHER_CTX_get_cipher_data(const EVP_CIPHER_CTX *ctx);
-void *EVP_CIPHER_CTX_set_cipher_data(EVP_CIPHER_CTX *ctx, void *cipher_data);
+const EVP_CIPHER * __cdecl EVP_CIPHER_CTX_cipher(const EVP_CIPHER_CTX *ctx);
+int __cdecl EVP_CIPHER_CTX_encrypting(const EVP_CIPHER_CTX *ctx);
+int __cdecl EVP_CIPHER_CTX_nid(const EVP_CIPHER_CTX *ctx);
+int __cdecl EVP_CIPHER_CTX_block_size(const EVP_CIPHER_CTX *ctx);
+int __cdecl EVP_CIPHER_CTX_key_length(const EVP_CIPHER_CTX *ctx);
+int __cdecl EVP_CIPHER_CTX_iv_length(const EVP_CIPHER_CTX *ctx);
+const unsigned char * __cdecl EVP_CIPHER_CTX_iv(const EVP_CIPHER_CTX *ctx);
+const unsigned char * __cdecl EVP_CIPHER_CTX_original_iv(const EVP_CIPHER_CTX *ctx);
+unsigned char * __cdecl EVP_CIPHER_CTX_iv_noconst(EVP_CIPHER_CTX *ctx);
+unsigned char * __cdecl EVP_CIPHER_CTX_buf_noconst(EVP_CIPHER_CTX *ctx);
+int __cdecl EVP_CIPHER_CTX_num(const EVP_CIPHER_CTX *ctx);
+void __cdecl EVP_CIPHER_CTX_set_num(EVP_CIPHER_CTX *ctx, int num);
+int __cdecl EVP_CIPHER_CTX_copy(EVP_CIPHER_CTX *out, const EVP_CIPHER_CTX *in);
+void * __cdecl EVP_CIPHER_CTX_get_app_data(const EVP_CIPHER_CTX *ctx);
+void __cdecl EVP_CIPHER_CTX_set_app_data(EVP_CIPHER_CTX *ctx, void *data);
+void * __cdecl EVP_CIPHER_CTX_get_cipher_data(const EVP_CIPHER_CTX *ctx);
+void * __cdecl EVP_CIPHER_CTX_set_cipher_data(EVP_CIPHER_CTX *ctx, void *cipher_data);
 # define EVP_CIPHER_CTX_type(c)         EVP_CIPHER_type(EVP_CIPHER_CTX_cipher(c))
 # if OPENSSL_API_COMPAT < 0x10100000L
 #  define EVP_CIPHER_CTX_flags(c)       EVP_CIPHER_flags(EVP_CIPHER_CTX_cipher(c))
@@ -521,7 +521,7 @@ void BIO_set_md(BIO *, const EVP_MD *md);
 # define BIO_get_cipher_ctx(b,c_pp) BIO_ctrl(b,BIO_C_GET_CIPHER_CTX,0, \
                                              (char *)(c_pp))
 
-/*__owur*/ int EVP_Cipher(EVP_CIPHER_CTX *c,
+/*__owur*/ int __cdecl EVP_Cipher(EVP_CIPHER_CTX *c,
                           unsigned char *out,
                           const unsigned char *in, unsigned int inl);
 
@@ -534,228 +534,228 @@ void BIO_set_md(BIO *, const EVP_MD *md);
 # define EVP_delete_digest_alias(alias) \
         OBJ_NAME_remove(alias,OBJ_NAME_TYPE_MD_METH|OBJ_NAME_ALIAS);
 
-int EVP_MD_CTX_ctrl(EVP_MD_CTX *ctx, int cmd, int p1, void *p2);
-EVP_MD_CTX *EVP_MD_CTX_new(void);
-int EVP_MD_CTX_reset(EVP_MD_CTX *ctx);
-void EVP_MD_CTX_free(EVP_MD_CTX *ctx);
+int __cdecl EVP_MD_CTX_ctrl(EVP_MD_CTX *ctx, int cmd, int p1, void *p2);
+EVP_MD_CTX * __cdecl EVP_MD_CTX_new(void);
+int __cdecl EVP_MD_CTX_reset(EVP_MD_CTX *ctx);
+void __cdecl EVP_MD_CTX_free(EVP_MD_CTX *ctx);
 # define EVP_MD_CTX_create()     EVP_MD_CTX_new()
 # define EVP_MD_CTX_init(ctx)    EVP_MD_CTX_reset((ctx))
 # define EVP_MD_CTX_destroy(ctx) EVP_MD_CTX_free((ctx))
-__owur int EVP_MD_CTX_copy_ex(EVP_MD_CTX *out, const EVP_MD_CTX *in);
-void EVP_MD_CTX_set_flags(EVP_MD_CTX *ctx, int flags);
-void EVP_MD_CTX_clear_flags(EVP_MD_CTX *ctx, int flags);
-int EVP_MD_CTX_test_flags(const EVP_MD_CTX *ctx, int flags);
-__owur int EVP_DigestInit_ex(EVP_MD_CTX *ctx, const EVP_MD *type,
+__owur int __cdecl EVP_MD_CTX_copy_ex(EVP_MD_CTX *out, const EVP_MD_CTX *in);
+void __cdecl EVP_MD_CTX_set_flags(EVP_MD_CTX *ctx, int flags);
+void __cdecl EVP_MD_CTX_clear_flags(EVP_MD_CTX *ctx, int flags);
+int __cdecl EVP_MD_CTX_test_flags(const EVP_MD_CTX *ctx, int flags);
+__owur int __cdecl EVP_DigestInit_ex(EVP_MD_CTX *ctx, const EVP_MD *type,
                                  ENGINE *impl);
-__owur int EVP_DigestUpdate(EVP_MD_CTX *ctx, const void *d,
+__owur int __cdecl EVP_DigestUpdate(EVP_MD_CTX *ctx, const void *d,
                                 size_t cnt);
-__owur int EVP_DigestFinal_ex(EVP_MD_CTX *ctx, unsigned char *md,
+__owur int __cdecl EVP_DigestFinal_ex(EVP_MD_CTX *ctx, unsigned char *md,
                                   unsigned int *s);
-__owur int EVP_Digest(const void *data, size_t count,
+__owur int __cdecl EVP_Digest(const void *data, size_t count,
                           unsigned char *md, unsigned int *size,
                           const EVP_MD *type, ENGINE *impl);
 
-__owur int EVP_MD_CTX_copy(EVP_MD_CTX *out, const EVP_MD_CTX *in);
-__owur int EVP_DigestInit(EVP_MD_CTX *ctx, const EVP_MD *type);
-__owur int EVP_DigestFinal(EVP_MD_CTX *ctx, unsigned char *md,
+__owur int __cdecl EVP_MD_CTX_copy(EVP_MD_CTX *out, const EVP_MD_CTX *in);
+__owur int __cdecl EVP_DigestInit(EVP_MD_CTX *ctx, const EVP_MD *type);
+__owur int __cdecl EVP_DigestFinal(EVP_MD_CTX *ctx, unsigned char *md,
                            unsigned int *s);
-__owur int EVP_DigestFinalXOF(EVP_MD_CTX *ctx, unsigned char *md,
+__owur int __cdecl EVP_DigestFinalXOF(EVP_MD_CTX *ctx, unsigned char *md,
                               size_t len);
 
-int EVP_read_pw_string(char *buf, int length, const char *prompt, int verify);
-int EVP_read_pw_string_min(char *buf, int minlen, int maxlen,
+int __cdecl EVP_read_pw_string(char *buf, int length, const char *prompt, int verify);
+int __cdecl EVP_read_pw_string_min(char *buf, int minlen, int maxlen,
                            const char *prompt, int verify);
-void EVP_set_pw_prompt(const char *prompt);
-char *EVP_get_pw_prompt(void);
+void __cdecl EVP_set_pw_prompt(const char *prompt);
+char * __cdecl EVP_get_pw_prompt(void);
 
-__owur int EVP_BytesToKey(const EVP_CIPHER *type, const EVP_MD *md,
+__owur int __cdecl EVP_BytesToKey(const EVP_CIPHER *type, const EVP_MD *md,
                           const unsigned char *salt,
                           const unsigned char *data, int datal, int count,
                           unsigned char *key, unsigned char *iv);
 
-void EVP_CIPHER_CTX_set_flags(EVP_CIPHER_CTX *ctx, int flags);
-void EVP_CIPHER_CTX_clear_flags(EVP_CIPHER_CTX *ctx, int flags);
-int EVP_CIPHER_CTX_test_flags(const EVP_CIPHER_CTX *ctx, int flags);
+void __cdecl EVP_CIPHER_CTX_set_flags(EVP_CIPHER_CTX *ctx, int flags);
+void __cdecl EVP_CIPHER_CTX_clear_flags(EVP_CIPHER_CTX *ctx, int flags);
+int __cdecl EVP_CIPHER_CTX_test_flags(const EVP_CIPHER_CTX *ctx, int flags);
 
-__owur int EVP_EncryptInit(EVP_CIPHER_CTX *ctx, const EVP_CIPHER *cipher,
+__owur int __cdecl EVP_EncryptInit(EVP_CIPHER_CTX *ctx, const EVP_CIPHER *cipher,
                            const unsigned char *key, const unsigned char *iv);
-/*__owur*/ int EVP_EncryptInit_ex(EVP_CIPHER_CTX *ctx,
+/*__owur*/ int __cdecl EVP_EncryptInit_ex(EVP_CIPHER_CTX *ctx,
                                   const EVP_CIPHER *cipher, ENGINE *impl,
                                   const unsigned char *key,
                                   const unsigned char *iv);
-/*__owur*/ int EVP_EncryptUpdate(EVP_CIPHER_CTX *ctx, unsigned char *out,
+/*__owur*/ int __cdecl EVP_EncryptUpdate(EVP_CIPHER_CTX *ctx, unsigned char *out,
                                  int *outl, const unsigned char *in, int inl);
-/*__owur*/ int EVP_EncryptFinal_ex(EVP_CIPHER_CTX *ctx, unsigned char *out,
+/*__owur*/ int __cdecl EVP_EncryptFinal_ex(EVP_CIPHER_CTX *ctx, unsigned char *out,
                                    int *outl);
-/*__owur*/ int EVP_EncryptFinal(EVP_CIPHER_CTX *ctx, unsigned char *out,
+/*__owur*/ int __cdecl EVP_EncryptFinal(EVP_CIPHER_CTX *ctx, unsigned char *out,
                                 int *outl);
 
-__owur int EVP_DecryptInit(EVP_CIPHER_CTX *ctx, const EVP_CIPHER *cipher,
+__owur int __cdecl EVP_DecryptInit(EVP_CIPHER_CTX *ctx, const EVP_CIPHER *cipher,
                            const unsigned char *key, const unsigned char *iv);
-/*__owur*/ int EVP_DecryptInit_ex(EVP_CIPHER_CTX *ctx,
+/*__owur*/ int __cdecl EVP_DecryptInit_ex(EVP_CIPHER_CTX *ctx,
                                   const EVP_CIPHER *cipher, ENGINE *impl,
                                   const unsigned char *key,
                                   const unsigned char *iv);
-/*__owur*/ int EVP_DecryptUpdate(EVP_CIPHER_CTX *ctx, unsigned char *out,
+/*__owur*/ int __cdecl EVP_DecryptUpdate(EVP_CIPHER_CTX *ctx, unsigned char *out,
                                  int *outl, const unsigned char *in, int inl);
-__owur int EVP_DecryptFinal(EVP_CIPHER_CTX *ctx, unsigned char *outm,
+__owur int __cdecl EVP_DecryptFinal(EVP_CIPHER_CTX *ctx, unsigned char *outm,
                             int *outl);
-/*__owur*/ int EVP_DecryptFinal_ex(EVP_CIPHER_CTX *ctx, unsigned char *outm,
+/*__owur*/ int __cdecl EVP_DecryptFinal_ex(EVP_CIPHER_CTX *ctx, unsigned char *outm,
                                    int *outl);
 
-__owur int EVP_CipherInit(EVP_CIPHER_CTX *ctx, const EVP_CIPHER *cipher,
+__owur int __cdecl EVP_CipherInit(EVP_CIPHER_CTX *ctx, const EVP_CIPHER *cipher,
                           const unsigned char *key, const unsigned char *iv,
                           int enc);
-/*__owur*/ int EVP_CipherInit_ex(EVP_CIPHER_CTX *ctx,
+/*__owur*/ int __cdecl EVP_CipherInit_ex(EVP_CIPHER_CTX *ctx,
                                  const EVP_CIPHER *cipher, ENGINE *impl,
                                  const unsigned char *key,
                                  const unsigned char *iv, int enc);
-__owur int EVP_CipherUpdate(EVP_CIPHER_CTX *ctx, unsigned char *out,
+__owur int __cdecl EVP_CipherUpdate(EVP_CIPHER_CTX *ctx, unsigned char *out,
                             int *outl, const unsigned char *in, int inl);
-__owur int EVP_CipherFinal(EVP_CIPHER_CTX *ctx, unsigned char *outm,
+__owur int __cdecl EVP_CipherFinal(EVP_CIPHER_CTX *ctx, unsigned char *outm,
                            int *outl);
-__owur int EVP_CipherFinal_ex(EVP_CIPHER_CTX *ctx, unsigned char *outm,
+__owur int __cdecl EVP_CipherFinal_ex(EVP_CIPHER_CTX *ctx, unsigned char *outm,
                               int *outl);
 
-__owur int EVP_SignFinal(EVP_MD_CTX *ctx, unsigned char *md, unsigned int *s,
+__owur int __cdecl EVP_SignFinal(EVP_MD_CTX *ctx, unsigned char *md, unsigned int *s,
                          EVP_PKEY *pkey);
 
-__owur int EVP_DigestSign(EVP_MD_CTX *ctx, unsigned char *sigret,
+__owur int __cdecl EVP_DigestSign(EVP_MD_CTX *ctx, unsigned char *sigret,
                           size_t *siglen, const unsigned char *tbs,
                           size_t tbslen);
 
-__owur int EVP_VerifyFinal(EVP_MD_CTX *ctx, const unsigned char *sigbuf,
+__owur int __cdecl EVP_VerifyFinal(EVP_MD_CTX *ctx, const unsigned char *sigbuf,
                            unsigned int siglen, EVP_PKEY *pkey);
 
-__owur int EVP_DigestVerify(EVP_MD_CTX *ctx, const unsigned char *sigret,
+__owur int __cdecl EVP_DigestVerify(EVP_MD_CTX *ctx, const unsigned char *sigret,
                             size_t siglen, const unsigned char *tbs,
                             size_t tbslen);
 
-/*__owur*/ int EVP_DigestSignInit(EVP_MD_CTX *ctx, EVP_PKEY_CTX **pctx,
+/*__owur*/ int __cdecl EVP_DigestSignInit(EVP_MD_CTX *ctx, EVP_PKEY_CTX **pctx,
                                   const EVP_MD *type, ENGINE *e,
                                   EVP_PKEY *pkey);
-__owur int EVP_DigestSignFinal(EVP_MD_CTX *ctx, unsigned char *sigret,
+__owur int __cdecl EVP_DigestSignFinal(EVP_MD_CTX *ctx, unsigned char *sigret,
                                size_t *siglen);
 
-__owur int EVP_DigestVerifyInit(EVP_MD_CTX *ctx, EVP_PKEY_CTX **pctx,
+__owur int __cdecl EVP_DigestVerifyInit(EVP_MD_CTX *ctx, EVP_PKEY_CTX **pctx,
                                 const EVP_MD *type, ENGINE *e,
                                 EVP_PKEY *pkey);
-__owur int EVP_DigestVerifyFinal(EVP_MD_CTX *ctx, const unsigned char *sig,
+__owur int __cdecl EVP_DigestVerifyFinal(EVP_MD_CTX *ctx, const unsigned char *sig,
                                  size_t siglen);
 
 # ifndef OPENSSL_NO_RSA
-__owur int EVP_OpenInit(EVP_CIPHER_CTX *ctx, const EVP_CIPHER *type,
+__owur int __cdecl EVP_OpenInit(EVP_CIPHER_CTX *ctx, const EVP_CIPHER *type,
                         const unsigned char *ek, int ekl,
                         const unsigned char *iv, EVP_PKEY *priv);
-__owur int EVP_OpenFinal(EVP_CIPHER_CTX *ctx, unsigned char *out, int *outl);
+__owur int __cdecl EVP_OpenFinal(EVP_CIPHER_CTX *ctx, unsigned char *out, int *outl);
 
-__owur int EVP_SealInit(EVP_CIPHER_CTX *ctx, const EVP_CIPHER *type,
+__owur int __cdecl EVP_SealInit(EVP_CIPHER_CTX *ctx, const EVP_CIPHER *type,
                         unsigned char **ek, int *ekl, unsigned char *iv,
                         EVP_PKEY **pubk, int npubk);
-__owur int EVP_SealFinal(EVP_CIPHER_CTX *ctx, unsigned char *out, int *outl);
+__owur int __cdecl EVP_SealFinal(EVP_CIPHER_CTX *ctx, unsigned char *out, int *outl);
 # endif
 
-EVP_ENCODE_CTX *EVP_ENCODE_CTX_new(void);
-void EVP_ENCODE_CTX_free(EVP_ENCODE_CTX *ctx);
-int EVP_ENCODE_CTX_copy(EVP_ENCODE_CTX *dctx, EVP_ENCODE_CTX *sctx);
-int EVP_ENCODE_CTX_num(EVP_ENCODE_CTX *ctx);
-void EVP_EncodeInit(EVP_ENCODE_CTX *ctx);
-int EVP_EncodeUpdate(EVP_ENCODE_CTX *ctx, unsigned char *out, int *outl,
+EVP_ENCODE_CTX * __cdecl EVP_ENCODE_CTX_new(void);
+void __cdecl EVP_ENCODE_CTX_free(EVP_ENCODE_CTX *ctx);
+int __cdecl EVP_ENCODE_CTX_copy(EVP_ENCODE_CTX *dctx, EVP_ENCODE_CTX *sctx);
+int __cdecl EVP_ENCODE_CTX_num(EVP_ENCODE_CTX *ctx);
+void __cdecl EVP_EncodeInit(EVP_ENCODE_CTX *ctx);
+int __cdecl EVP_EncodeUpdate(EVP_ENCODE_CTX *ctx, unsigned char *out, int *outl,
                      const unsigned char *in, int inl);
-void EVP_EncodeFinal(EVP_ENCODE_CTX *ctx, unsigned char *out, int *outl);
-int EVP_EncodeBlock(unsigned char *t, const unsigned char *f, int n);
+void __cdecl EVP_EncodeFinal(EVP_ENCODE_CTX *ctx, unsigned char *out, int *outl);
+int __cdecl EVP_EncodeBlock(unsigned char *t, const unsigned char *f, int n);
 
-void EVP_DecodeInit(EVP_ENCODE_CTX *ctx);
-int EVP_DecodeUpdate(EVP_ENCODE_CTX *ctx, unsigned char *out, int *outl,
+void __cdecl EVP_DecodeInit(EVP_ENCODE_CTX *ctx);
+int __cdecl EVP_DecodeUpdate(EVP_ENCODE_CTX *ctx, unsigned char *out, int *outl,
                      const unsigned char *in, int inl);
-int EVP_DecodeFinal(EVP_ENCODE_CTX *ctx, unsigned
+int __cdecl EVP_DecodeFinal(EVP_ENCODE_CTX *ctx, unsigned
                     char *out, int *outl);
-int EVP_DecodeBlock(unsigned char *t, const unsigned char *f, int n);
+int __cdecl EVP_DecodeBlock(unsigned char *t, const unsigned char *f, int n);
 
 # if OPENSSL_API_COMPAT < 0x10100000L
 #  define EVP_CIPHER_CTX_init(c)      EVP_CIPHER_CTX_reset(c)
 #  define EVP_CIPHER_CTX_cleanup(c)   EVP_CIPHER_CTX_reset(c)
 # endif
-EVP_CIPHER_CTX *EVP_CIPHER_CTX_new(void);
-int EVP_CIPHER_CTX_reset(EVP_CIPHER_CTX *c);
-void EVP_CIPHER_CTX_free(EVP_CIPHER_CTX *c);
-int EVP_CIPHER_CTX_set_key_length(EVP_CIPHER_CTX *x, int keylen);
-int EVP_CIPHER_CTX_set_padding(EVP_CIPHER_CTX *c, int pad);
-int EVP_CIPHER_CTX_ctrl(EVP_CIPHER_CTX *ctx, int type, int arg, void *ptr);
-int EVP_CIPHER_CTX_rand_key(EVP_CIPHER_CTX *ctx, unsigned char *key);
-
-const BIO_METHOD *BIO_f_md(void);
-const BIO_METHOD *BIO_f_base64(void);
-const BIO_METHOD *BIO_f_cipher(void);
-const BIO_METHOD *BIO_f_reliable(void);
-__owur int BIO_set_cipher(BIO *b, const EVP_CIPHER *c, const unsigned char *k,
+EVP_CIPHER_CTX * __cdecl EVP_CIPHER_CTX_new(void);
+int __cdecl EVP_CIPHER_CTX_reset(EVP_CIPHER_CTX *c);
+void __cdecl EVP_CIPHER_CTX_free(EVP_CIPHER_CTX *c);
+int __cdecl EVP_CIPHER_CTX_set_key_length(EVP_CIPHER_CTX *x, int keylen);
+int __cdecl EVP_CIPHER_CTX_set_padding(EVP_CIPHER_CTX *c, int pad);
+int __cdecl EVP_CIPHER_CTX_ctrl(EVP_CIPHER_CTX *ctx, int type, int arg, void *ptr);
+int __cdecl EVP_CIPHER_CTX_rand_key(EVP_CIPHER_CTX *ctx, unsigned char *key);
+
+const BIO_METHOD * __cdecl BIO_f_md(void);
+const BIO_METHOD * __cdecl BIO_f_base64(void);
+const BIO_METHOD * __cdecl BIO_f_cipher(void);
+const BIO_METHOD * __cdecl BIO_f_reliable(void);
+__owur int __cdecl BIO_set_cipher(BIO *b, const EVP_CIPHER *c, const unsigned char *k,
                           const unsigned char *i, int enc);
 
-const EVP_MD *EVP_md_null(void);
+const EVP_MD * __cdecl EVP_md_null(void);
 # ifndef OPENSSL_NO_MD2
-const EVP_MD *EVP_md2(void);
+const EVP_MD * __cdecl EVP_md2(void);
 # endif
 # ifndef OPENSSL_NO_MD4
-const EVP_MD *EVP_md4(void);
+const EVP_MD * __cdecl EVP_md4(void);
 # endif
 # ifndef OPENSSL_NO_MD5
-const EVP_MD *EVP_md5(void);
-const EVP_MD *EVP_md5_sha1(void);
+const EVP_MD * __cdecl EVP_md5(void);
+const EVP_MD * __cdecl EVP_md5_sha1(void);
 # endif
 # ifndef OPENSSL_NO_BLAKE2
-const EVP_MD *EVP_blake2b512(void);
-const EVP_MD *EVP_blake2s256(void);
+const EVP_MD * __cdecl EVP_blake2b512(void);
+const EVP_MD * __cdecl EVP_blake2s256(void);
 # endif
-const EVP_MD *EVP_sha1(void);
-const EVP_MD *EVP_sha224(void);
-const EVP_MD *EVP_sha256(void);
-const EVP_MD *EVP_sha384(void);
-const EVP_MD *EVP_sha512(void);
-const EVP_MD *EVP_sha512_224(void);
-const EVP_MD *EVP_sha512_256(void);
-const EVP_MD *EVP_sha3_224(void);
-const EVP_MD *EVP_sha3_256(void);
-const EVP_MD *EVP_sha3_384(void);
-const EVP_MD *EVP_sha3_512(void);
-const EVP_MD *EVP_shake128(void);
-const EVP_MD *EVP_shake256(void);
+const EVP_MD * __cdecl EVP_sha1(void);
+const EVP_MD * __cdecl EVP_sha224(void);
+const EVP_MD * __cdecl EVP_sha256(void);
+const EVP_MD * __cdecl EVP_sha384(void);
+const EVP_MD * __cdecl EVP_sha512(void);
+const EVP_MD * __cdecl EVP_sha512_224(void);
+const EVP_MD * __cdecl EVP_sha512_256(void);
+const EVP_MD * __cdecl EVP_sha3_224(void);
+const EVP_MD * __cdecl EVP_sha3_256(void);
+const EVP_MD * __cdecl EVP_sha3_384(void);
+const EVP_MD * __cdecl EVP_sha3_512(void);
+const EVP_MD * __cdecl EVP_shake128(void);
+const EVP_MD * __cdecl EVP_shake256(void);
 # ifndef OPENSSL_NO_MDC2
-const EVP_MD *EVP_mdc2(void);
+const EVP_MD * __cdecl EVP_mdc2(void);
 # endif
 # ifndef OPENSSL_NO_RMD160
-const EVP_MD *EVP_ripemd160(void);
+const EVP_MD * __cdecl EVP_ripemd160(void);
 # endif
 # ifndef OPENSSL_NO_WHIRLPOOL
-const EVP_MD *EVP_whirlpool(void);
+const EVP_MD * __cdecl EVP_whirlpool(void);
 # endif
 # ifndef OPENSSL_NO_SM3
-const EVP_MD *EVP_sm3(void);
+const EVP_MD * __cdecl EVP_sm3(void);
 # endif
-const EVP_CIPHER *EVP_enc_null(void); /* does nothing :-) */
+const EVP_CIPHER * __cdecl EVP_enc_null(void); /* does nothing :-) */
 # ifndef OPENSSL_NO_DES
-const EVP_CIPHER *EVP_des_ecb(void);
-const EVP_CIPHER *EVP_des_ede(void);
-const EVP_CIPHER *EVP_des_ede3(void);
-const EVP_CIPHER *EVP_des_ede_ecb(void);
-const EVP_CIPHER *EVP_des_ede3_ecb(void);
-const EVP_CIPHER *EVP_des_cfb64(void);
+const EVP_CIPHER * __cdecl EVP_des_ecb(void);
+const EVP_CIPHER * __cdecl EVP_des_ede(void);
+const EVP_CIPHER * __cdecl EVP_des_ede3(void);
+const EVP_CIPHER * __cdecl EVP_des_ede_ecb(void);
+const EVP_CIPHER * __cdecl EVP_des_ede3_ecb(void);
+const EVP_CIPHER * __cdecl EVP_des_cfb64(void);
 #  define EVP_des_cfb EVP_des_cfb64
-const EVP_CIPHER *EVP_des_cfb1(void);
-const EVP_CIPHER *EVP_des_cfb8(void);
-const EVP_CIPHER *EVP_des_ede_cfb64(void);
+const EVP_CIPHER * __cdecl EVP_des_cfb1(void);
+const EVP_CIPHER * __cdecl EVP_des_cfb8(void);
+const EVP_CIPHER * __cdecl EVP_des_ede_cfb64(void);
 #  define EVP_des_ede_cfb EVP_des_ede_cfb64
-const EVP_CIPHER *EVP_des_ede3_cfb64(void);
+const EVP_CIPHER * __cdecl EVP_des_ede3_cfb64(void);
 #  define EVP_des_ede3_cfb EVP_des_ede3_cfb64
-const EVP_CIPHER *EVP_des_ede3_cfb1(void);
-const EVP_CIPHER *EVP_des_ede3_cfb8(void);
-const EVP_CIPHER *EVP_des_ofb(void);
-const EVP_CIPHER *EVP_des_ede_ofb(void);
-const EVP_CIPHER *EVP_des_ede3_ofb(void);
-const EVP_CIPHER *EVP_des_cbc(void);
-const EVP_CIPHER *EVP_des_ede_cbc(void);
-const EVP_CIPHER *EVP_des_ede3_cbc(void);
-const EVP_CIPHER *EVP_desx_cbc(void);
-const EVP_CIPHER *EVP_des_ede3_wrap(void);
+const EVP_CIPHER * __cdecl EVP_des_ede3_cfb1(void);
+const EVP_CIPHER * __cdecl EVP_des_ede3_cfb8(void);
+const EVP_CIPHER * __cdecl EVP_des_ofb(void);
+const EVP_CIPHER * __cdecl EVP_des_ede_ofb(void);
+const EVP_CIPHER * __cdecl EVP_des_ede3_ofb(void);
+const EVP_CIPHER * __cdecl EVP_des_cbc(void);
+const EVP_CIPHER * __cdecl EVP_des_ede_cbc(void);
+const EVP_CIPHER * __cdecl EVP_des_ede3_cbc(void);
+const EVP_CIPHER * __cdecl EVP_desx_cbc(void);
+const EVP_CIPHER * __cdecl EVP_des_ede3_wrap(void);
 /*
  * This should now be supported through the dev_crypto ENGINE. But also, why
  * are rc4 and md5 declarations made here inside a "NO_DES" precompiler
@@ -763,180 +763,180 @@ const EVP_CIPHER *EVP_des_ede3_wrap(void);
  */
 # endif
 # ifndef OPENSSL_NO_RC4
-const EVP_CIPHER *EVP_rc4(void);
-const EVP_CIPHER *EVP_rc4_40(void);
+const EVP_CIPHER * __cdecl EVP_rc4(void);
+const EVP_CIPHER * __cdecl EVP_rc4_40(void);
 #  ifndef OPENSSL_NO_MD5
-const EVP_CIPHER *EVP_rc4_hmac_md5(void);
+const EVP_CIPHER * __cdecl EVP_rc4_hmac_md5(void);
 #  endif
 # endif
 # ifndef OPENSSL_NO_IDEA
-const EVP_CIPHER *EVP_idea_ecb(void);
-const EVP_CIPHER *EVP_idea_cfb64(void);
+const EVP_CIPHER * __cdecl EVP_idea_ecb(void);
+const EVP_CIPHER * __cdecl EVP_idea_cfb64(void);
 #  define EVP_idea_cfb EVP_idea_cfb64
-const EVP_CIPHER *EVP_idea_ofb(void);
-const EVP_CIPHER *EVP_idea_cbc(void);
+const EVP_CIPHER * __cdecl EVP_idea_ofb(void);
+const EVP_CIPHER * __cdecl EVP_idea_cbc(void);
 # endif
 # ifndef OPENSSL_NO_RC2
-const EVP_CIPHER *EVP_rc2_ecb(void);
-const EVP_CIPHER *EVP_rc2_cbc(void);
-const EVP_CIPHER *EVP_rc2_40_cbc(void);
-const EVP_CIPHER *EVP_rc2_64_cbc(void);
-const EVP_CIPHER *EVP_rc2_cfb64(void);
+const EVP_CIPHER * __cdecl EVP_rc2_ecb(void);
+const EVP_CIPHER * __cdecl EVP_rc2_cbc(void);
+const EVP_CIPHER * __cdecl EVP_rc2_40_cbc(void);
+const EVP_CIPHER * __cdecl EVP_rc2_64_cbc(void);
+const EVP_CIPHER * __cdecl EVP_rc2_cfb64(void);
 #  define EVP_rc2_cfb EVP_rc2_cfb64
-const EVP_CIPHER *EVP_rc2_ofb(void);
+const EVP_CIPHER * __cdecl EVP_rc2_ofb(void);
 # endif
 # ifndef OPENSSL_NO_BF
-const EVP_CIPHER *EVP_bf_ecb(void);
-const EVP_CIPHER *EVP_bf_cbc(void);
-const EVP_CIPHER *EVP_bf_cfb64(void);
+const EVP_CIPHER * __cdecl EVP_bf_ecb(void);
+const EVP_CIPHER * __cdecl EVP_bf_cbc(void);
+const EVP_CIPHER * __cdecl EVP_bf_cfb64(void);
 #  define EVP_bf_cfb EVP_bf_cfb64
-const EVP_CIPHER *EVP_bf_ofb(void);
+const EVP_CIPHER * __cdecl EVP_bf_ofb(void);
 # endif
 # ifndef OPENSSL_NO_CAST
-const EVP_CIPHER *EVP_cast5_ecb(void);
-const EVP_CIPHER *EVP_cast5_cbc(void);
-const EVP_CIPHER *EVP_cast5_cfb64(void);
+const EVP_CIPHER * __cdecl EVP_cast5_ecb(void);
+const EVP_CIPHER * __cdecl EVP_cast5_cbc(void);
+const EVP_CIPHER * __cdecl EVP_cast5_cfb64(void);
 #  define EVP_cast5_cfb EVP_cast5_cfb64
-const EVP_CIPHER *EVP_cast5_ofb(void);
+const EVP_CIPHER * __cdecl EVP_cast5_ofb(void);
 # endif
 # ifndef OPENSSL_NO_RC5
-const EVP_CIPHER *EVP_rc5_32_12_16_cbc(void);
-const EVP_CIPHER *EVP_rc5_32_12_16_ecb(void);
-const EVP_CIPHER *EVP_rc5_32_12_16_cfb64(void);
+const EVP_CIPHER * __cdecl EVP_rc5_32_12_16_cbc(void);
+const EVP_CIPHER * __cdecl EVP_rc5_32_12_16_ecb(void);
+const EVP_CIPHER * __cdecl EVP_rc5_32_12_16_cfb64(void);
 #  define EVP_rc5_32_12_16_cfb EVP_rc5_32_12_16_cfb64
-const EVP_CIPHER *EVP_rc5_32_12_16_ofb(void);
+const EVP_CIPHER * __cdecl EVP_rc5_32_12_16_ofb(void);
 # endif
-const EVP_CIPHER *EVP_aes_128_ecb(void);
-const EVP_CIPHER *EVP_aes_128_cbc(void);
-const EVP_CIPHER *EVP_aes_128_cfb1(void);
-const EVP_CIPHER *EVP_aes_128_cfb8(void);
-const EVP_CIPHER *EVP_aes_128_cfb128(void);
+const EVP_CIPHER * __cdecl EVP_aes_128_ecb(void);
+const EVP_CIPHER * __cdecl EVP_aes_128_cbc(void);
+const EVP_CIPHER * __cdecl EVP_aes_128_cfb1(void);
+const EVP_CIPHER * __cdecl EVP_aes_128_cfb8(void);
+const EVP_CIPHER * __cdecl EVP_aes_128_cfb128(void);
 # define EVP_aes_128_cfb EVP_aes_128_cfb128
-const EVP_CIPHER *EVP_aes_128_ofb(void);
-const EVP_CIPHER *EVP_aes_128_ctr(void);
-const EVP_CIPHER *EVP_aes_128_ccm(void);
-const EVP_CIPHER *EVP_aes_128_gcm(void);
-const EVP_CIPHER *EVP_aes_128_xts(void);
-const EVP_CIPHER *EVP_aes_128_wrap(void);
-const EVP_CIPHER *EVP_aes_128_wrap_pad(void);
+const EVP_CIPHER * __cdecl EVP_aes_128_ofb(void);
+const EVP_CIPHER * __cdecl EVP_aes_128_ctr(void);
+const EVP_CIPHER * __cdecl EVP_aes_128_ccm(void);
+const EVP_CIPHER * __cdecl EVP_aes_128_gcm(void);
+const EVP_CIPHER * __cdecl EVP_aes_128_xts(void);
+const EVP_CIPHER * __cdecl EVP_aes_128_wrap(void);
+const EVP_CIPHER * __cdecl EVP_aes_128_wrap_pad(void);
 # ifndef OPENSSL_NO_OCB
-const EVP_CIPHER *EVP_aes_128_ocb(void);
+const EVP_CIPHER * __cdecl EVP_aes_128_ocb(void);
 # endif
-const EVP_CIPHER *EVP_aes_192_ecb(void);
-const EVP_CIPHER *EVP_aes_192_cbc(void);
-const EVP_CIPHER *EVP_aes_192_cfb1(void);
-const EVP_CIPHER *EVP_aes_192_cfb8(void);
-const EVP_CIPHER *EVP_aes_192_cfb128(void);
+const EVP_CIPHER * __cdecl EVP_aes_192_ecb(void);
+const EVP_CIPHER * __cdecl EVP_aes_192_cbc(void);
+const EVP_CIPHER * __cdecl EVP_aes_192_cfb1(void);
+const EVP_CIPHER * __cdecl EVP_aes_192_cfb8(void);
+const EVP_CIPHER * __cdecl EVP_aes_192_cfb128(void);
 # define EVP_aes_192_cfb EVP_aes_192_cfb128
-const EVP_CIPHER *EVP_aes_192_ofb(void);
-const EVP_CIPHER *EVP_aes_192_ctr(void);
-const EVP_CIPHER *EVP_aes_192_ccm(void);
-const EVP_CIPHER *EVP_aes_192_gcm(void);
-const EVP_CIPHER *EVP_aes_192_wrap(void);
-const EVP_CIPHER *EVP_aes_192_wrap_pad(void);
+const EVP_CIPHER * __cdecl EVP_aes_192_ofb(void);
+const EVP_CIPHER * __cdecl EVP_aes_192_ctr(void);
+const EVP_CIPHER * __cdecl EVP_aes_192_ccm(void);
+const EVP_CIPHER * __cdecl EVP_aes_192_gcm(void);
+const EVP_CIPHER * __cdecl EVP_aes_192_wrap(void);
+const EVP_CIPHER * __cdecl EVP_aes_192_wrap_pad(void);
 # ifndef OPENSSL_NO_OCB
-const EVP_CIPHER *EVP_aes_192_ocb(void);
+const EVP_CIPHER * __cdecl EVP_aes_192_ocb(void);
 # endif
-const EVP_CIPHER *EVP_aes_256_ecb(void);
-const EVP_CIPHER *EVP_aes_256_cbc(void);
-const EVP_CIPHER *EVP_aes_256_cfb1(void);
-const EVP_CIPHER *EVP_aes_256_cfb8(void);
-const EVP_CIPHER *EVP_aes_256_cfb128(void);
+const EVP_CIPHER * __cdecl EVP_aes_256_ecb(void);
+const EVP_CIPHER * __cdecl EVP_aes_256_cbc(void);
+const EVP_CIPHER * __cdecl EVP_aes_256_cfb1(void);
+const EVP_CIPHER * __cdecl EVP_aes_256_cfb8(void);
+const EVP_CIPHER * __cdecl EVP_aes_256_cfb128(void);
 # define EVP_aes_256_cfb EVP_aes_256_cfb128
-const EVP_CIPHER *EVP_aes_256_ofb(void);
-const EVP_CIPHER *EVP_aes_256_ctr(void);
-const EVP_CIPHER *EVP_aes_256_ccm(void);
-const EVP_CIPHER *EVP_aes_256_gcm(void);
-const EVP_CIPHER *EVP_aes_256_xts(void);
-const EVP_CIPHER *EVP_aes_256_wrap(void);
-const EVP_CIPHER *EVP_aes_256_wrap_pad(void);
+const EVP_CIPHER * __cdecl EVP_aes_256_ofb(void);
+const EVP_CIPHER * __cdecl EVP_aes_256_ctr(void);
+const EVP_CIPHER * __cdecl EVP_aes_256_ccm(void);
+const EVP_CIPHER * __cdecl EVP_aes_256_gcm(void);
+const EVP_CIPHER * __cdecl EVP_aes_256_xts(void);
+const EVP_CIPHER * __cdecl EVP_aes_256_wrap(void);
+const EVP_CIPHER * __cdecl EVP_aes_256_wrap_pad(void);
 # ifndef OPENSSL_NO_OCB
-const EVP_CIPHER *EVP_aes_256_ocb(void);
+const EVP_CIPHER * __cdecl EVP_aes_256_ocb(void);
 # endif
-const EVP_CIPHER *EVP_aes_128_cbc_hmac_sha1(void);
-const EVP_CIPHER *EVP_aes_256_cbc_hmac_sha1(void);
-const EVP_CIPHER *EVP_aes_128_cbc_hmac_sha256(void);
-const EVP_CIPHER *EVP_aes_256_cbc_hmac_sha256(void);
+const EVP_CIPHER * __cdecl EVP_aes_128_cbc_hmac_sha1(void);
+const EVP_CIPHER * __cdecl EVP_aes_256_cbc_hmac_sha1(void);
+const EVP_CIPHER * __cdecl EVP_aes_128_cbc_hmac_sha256(void);
+const EVP_CIPHER * __cdecl EVP_aes_256_cbc_hmac_sha256(void);
 # ifndef OPENSSL_NO_ARIA
-const EVP_CIPHER *EVP_aria_128_ecb(void);
-const EVP_CIPHER *EVP_aria_128_cbc(void);
-const EVP_CIPHER *EVP_aria_128_cfb1(void);
-const EVP_CIPHER *EVP_aria_128_cfb8(void);
-const EVP_CIPHER *EVP_aria_128_cfb128(void);
+const EVP_CIPHER * __cdecl EVP_aria_128_ecb(void);
+const EVP_CIPHER * __cdecl EVP_aria_128_cbc(void);
+const EVP_CIPHER * __cdecl EVP_aria_128_cfb1(void);
+const EVP_CIPHER * __cdecl EVP_aria_128_cfb8(void);
+const EVP_CIPHER * __cdecl EVP_aria_128_cfb128(void);
 #  define EVP_aria_128_cfb EVP_aria_128_cfb128
-const EVP_CIPHER *EVP_aria_128_ctr(void);
-const EVP_CIPHER *EVP_aria_128_ofb(void);
-const EVP_CIPHER *EVP_aria_128_gcm(void);
-const EVP_CIPHER *EVP_aria_128_ccm(void);
-const EVP_CIPHER *EVP_aria_192_ecb(void);
-const EVP_CIPHER *EVP_aria_192_cbc(void);
-const EVP_CIPHER *EVP_aria_192_cfb1(void);
-const EVP_CIPHER *EVP_aria_192_cfb8(void);
-const EVP_CIPHER *EVP_aria_192_cfb128(void);
+const EVP_CIPHER * __cdecl EVP_aria_128_ctr(void);
+const EVP_CIPHER * __cdecl EVP_aria_128_ofb(void);
+const EVP_CIPHER * __cdecl EVP_aria_128_gcm(void);
+const EVP_CIPHER * __cdecl EVP_aria_128_ccm(void);
+const EVP_CIPHER * __cdecl EVP_aria_192_ecb(void);
+const EVP_CIPHER * __cdecl EVP_aria_192_cbc(void);
+const EVP_CIPHER * __cdecl EVP_aria_192_cfb1(void);
+const EVP_CIPHER * __cdecl EVP_aria_192_cfb8(void);
+const EVP_CIPHER * __cdecl EVP_aria_192_cfb128(void);
 #  define EVP_aria_192_cfb EVP_aria_192_cfb128
-const EVP_CIPHER *EVP_aria_192_ctr(void);
-const EVP_CIPHER *EVP_aria_192_ofb(void);
-const EVP_CIPHER *EVP_aria_192_gcm(void);
-const EVP_CIPHER *EVP_aria_192_ccm(void);
-const EVP_CIPHER *EVP_aria_256_ecb(void);
-const EVP_CIPHER *EVP_aria_256_cbc(void);
-const EVP_CIPHER *EVP_aria_256_cfb1(void);
-const EVP_CIPHER *EVP_aria_256_cfb8(void);
-const EVP_CIPHER *EVP_aria_256_cfb128(void);
+const EVP_CIPHER * __cdecl EVP_aria_192_ctr(void);
+const EVP_CIPHER * __cdecl EVP_aria_192_ofb(void);
+const EVP_CIPHER * __cdecl EVP_aria_192_gcm(void);
+const EVP_CIPHER * __cdecl EVP_aria_192_ccm(void);
+const EVP_CIPHER * __cdecl EVP_aria_256_ecb(void);
+const EVP_CIPHER * __cdecl EVP_aria_256_cbc(void);
+const EVP_CIPHER * __cdecl EVP_aria_256_cfb1(void);
+const EVP_CIPHER * __cdecl EVP_aria_256_cfb8(void);
+const EVP_CIPHER * __cdecl EVP_aria_256_cfb128(void);
 #  define EVP_aria_256_cfb EVP_aria_256_cfb128
-const EVP_CIPHER *EVP_aria_256_ctr(void);
-const EVP_CIPHER *EVP_aria_256_ofb(void);
-const EVP_CIPHER *EVP_aria_256_gcm(void);
-const EVP_CIPHER *EVP_aria_256_ccm(void);
+const EVP_CIPHER * __cdecl EVP_aria_256_ctr(void);
+const EVP_CIPHER * __cdecl EVP_aria_256_ofb(void);
+const EVP_CIPHER * __cdecl EVP_aria_256_gcm(void);
+const EVP_CIPHER * __cdecl EVP_aria_256_ccm(void);
 # endif
 # ifndef OPENSSL_NO_CAMELLIA
-const EVP_CIPHER *EVP_camellia_128_ecb(void);
-const EVP_CIPHER *EVP_camellia_128_cbc(void);
-const EVP_CIPHER *EVP_camellia_128_cfb1(void);
-const EVP_CIPHER *EVP_camellia_128_cfb8(void);
-const EVP_CIPHER *EVP_camellia_128_cfb128(void);
+const EVP_CIPHER * __cdecl EVP_camellia_128_ecb(void);
+const EVP_CIPHER * __cdecl EVP_camellia_128_cbc(void);
+const EVP_CIPHER * __cdecl EVP_camellia_128_cfb1(void);
+const EVP_CIPHER * __cdecl EVP_camellia_128_cfb8(void);
+const EVP_CIPHER * __cdecl EVP_camellia_128_cfb128(void);
 #  define EVP_camellia_128_cfb EVP_camellia_128_cfb128
-const EVP_CIPHER *EVP_camellia_128_ofb(void);
-const EVP_CIPHER *EVP_camellia_128_ctr(void);
-const EVP_CIPHER *EVP_camellia_192_ecb(void);
-const EVP_CIPHER *EVP_camellia_192_cbc(void);
-const EVP_CIPHER *EVP_camellia_192_cfb1(void);
-const EVP_CIPHER *EVP_camellia_192_cfb8(void);
-const EVP_CIPHER *EVP_camellia_192_cfb128(void);
+const EVP_CIPHER * __cdecl EVP_camellia_128_ofb(void);
+const EVP_CIPHER * __cdecl EVP_camellia_128_ctr(void);
+const EVP_CIPHER * __cdecl EVP_camellia_192_ecb(void);
+const EVP_CIPHER * __cdecl EVP_camellia_192_cbc(void);
+const EVP_CIPHER * __cdecl EVP_camellia_192_cfb1(void);
+const EVP_CIPHER * __cdecl EVP_camellia_192_cfb8(void);
+const EVP_CIPHER * __cdecl EVP_camellia_192_cfb128(void);
 #  define EVP_camellia_192_cfb EVP_camellia_192_cfb128
-const EVP_CIPHER *EVP_camellia_192_ofb(void);
-const EVP_CIPHER *EVP_camellia_192_ctr(void);
-const EVP_CIPHER *EVP_camellia_256_ecb(void);
-const EVP_CIPHER *EVP_camellia_256_cbc(void);
-const EVP_CIPHER *EVP_camellia_256_cfb1(void);
-const EVP_CIPHER *EVP_camellia_256_cfb8(void);
-const EVP_CIPHER *EVP_camellia_256_cfb128(void);
+const EVP_CIPHER * __cdecl EVP_camellia_192_ofb(void);
+const EVP_CIPHER * __cdecl EVP_camellia_192_ctr(void);
+const EVP_CIPHER * __cdecl EVP_camellia_256_ecb(void);
+const EVP_CIPHER * __cdecl EVP_camellia_256_cbc(void);
+const EVP_CIPHER * __cdecl EVP_camellia_256_cfb1(void);
+const EVP_CIPHER * __cdecl EVP_camellia_256_cfb8(void);
+const EVP_CIPHER * __cdecl EVP_camellia_256_cfb128(void);
 #  define EVP_camellia_256_cfb EVP_camellia_256_cfb128
-const EVP_CIPHER *EVP_camellia_256_ofb(void);
-const EVP_CIPHER *EVP_camellia_256_ctr(void);
+const EVP_CIPHER * __cdecl EVP_camellia_256_ofb(void);
+const EVP_CIPHER * __cdecl EVP_camellia_256_ctr(void);
 # endif
 # ifndef OPENSSL_NO_CHACHA
-const EVP_CIPHER *EVP_chacha20(void);
+const EVP_CIPHER * __cdecl EVP_chacha20(void);
 #  ifndef OPENSSL_NO_POLY1305
-const EVP_CIPHER *EVP_chacha20_poly1305(void);
+const EVP_CIPHER * __cdecl EVP_chacha20_poly1305(void);
 #  endif
 # endif
 
 # ifndef OPENSSL_NO_SEED
-const EVP_CIPHER *EVP_seed_ecb(void);
-const EVP_CIPHER *EVP_seed_cbc(void);
-const EVP_CIPHER *EVP_seed_cfb128(void);
+const EVP_CIPHER * __cdecl EVP_seed_ecb(void);
+const EVP_CIPHER * __cdecl EVP_seed_cbc(void);
+const EVP_CIPHER * __cdecl EVP_seed_cfb128(void);
 #  define EVP_seed_cfb EVP_seed_cfb128
-const EVP_CIPHER *EVP_seed_ofb(void);
+const EVP_CIPHER * __cdecl EVP_seed_ofb(void);
 # endif
 
 # ifndef OPENSSL_NO_SM4
-const EVP_CIPHER *EVP_sm4_ecb(void);
-const EVP_CIPHER *EVP_sm4_cbc(void);
-const EVP_CIPHER *EVP_sm4_cfb128(void);
+const EVP_CIPHER * __cdecl EVP_sm4_ecb(void);
+const EVP_CIPHER * __cdecl EVP_sm4_cbc(void);
+const EVP_CIPHER * __cdecl EVP_sm4_cfb128(void);
 #  define EVP_sm4_cfb EVP_sm4_cfb128
-const EVP_CIPHER *EVP_sm4_ofb(void);
-const EVP_CIPHER *EVP_sm4_ctr(void);
+const EVP_CIPHER * __cdecl EVP_sm4_ofb(void);
+const EVP_CIPHER * __cdecl EVP_sm4_ctr(void);
 # endif
 
 # if OPENSSL_API_COMPAT < 0x10100000L
@@ -962,152 +962,152 @@ const EVP_CIPHER *EVP_sm4_ctr(void);
 #  define EVP_cleanup() while(0) continue
 # endif
 
-int EVP_add_cipher(const EVP_CIPHER *cipher);
-int EVP_add_digest(const EVP_MD *digest);
+int __cdecl EVP_add_cipher(const EVP_CIPHER *cipher);
+int __cdecl EVP_add_digest(const EVP_MD *digest);
 
-const EVP_CIPHER *EVP_get_cipherbyname(const char *name);
-const EVP_MD *EVP_get_digestbyname(const char *name);
+const EVP_CIPHER * __cdecl EVP_get_cipherbyname(const char *name);
+const EVP_MD * __cdecl EVP_get_digestbyname(const char *name);
 
-void EVP_CIPHER_do_all(void (*fn) (const EVP_CIPHER *ciph,
+void __cdecl EVP_CIPHER_do_all(void (*fn) (const EVP_CIPHER *ciph,
                                    const char *from, const char *to, void *x),
                        void *arg);
-void EVP_CIPHER_do_all_sorted(void (*fn)
+void __cdecl EVP_CIPHER_do_all_sorted(void (*fn)
                                (const EVP_CIPHER *ciph, const char *from,
                                 const char *to, void *x), void *arg);
 
-void EVP_MD_do_all(void (*fn) (const EVP_MD *ciph,
+void __cdecl EVP_MD_do_all(void (*fn) (const EVP_MD *ciph,
                                const char *from, const char *to, void *x),
                    void *arg);
-void EVP_MD_do_all_sorted(void (*fn)
+void __cdecl EVP_MD_do_all_sorted(void (*fn)
                            (const EVP_MD *ciph, const char *from,
                             const char *to, void *x), void *arg);
 
-int EVP_PKEY_decrypt_old(unsigned char *dec_key,
+int __cdecl EVP_PKEY_decrypt_old(unsigned char *dec_key,
                          const unsigned char *enc_key, int enc_key_len,
                          EVP_PKEY *private_key);
-int EVP_PKEY_encrypt_old(unsigned char *enc_key,
+int __cdecl EVP_PKEY_encrypt_old(unsigned char *enc_key,
                          const unsigned char *key, int key_len,
                          EVP_PKEY *pub_key);
-int EVP_PKEY_type(int type);
-int EVP_PKEY_id(const EVP_PKEY *pkey);
-int EVP_PKEY_base_id(const EVP_PKEY *pkey);
-int EVP_PKEY_bits(const EVP_PKEY *pkey);
-int EVP_PKEY_security_bits(const EVP_PKEY *pkey);
-int EVP_PKEY_size(const EVP_PKEY *pkey);
-int EVP_PKEY_set_type(EVP_PKEY *pkey, int type);
-int EVP_PKEY_set_type_str(EVP_PKEY *pkey, const char *str, int len);
-int EVP_PKEY_set_alias_type(EVP_PKEY *pkey, int type);
+int __cdecl EVP_PKEY_type(int type);
+int __cdecl EVP_PKEY_id(const EVP_PKEY *pkey);
+int __cdecl EVP_PKEY_base_id(const EVP_PKEY *pkey);
+int __cdecl EVP_PKEY_bits(const EVP_PKEY *pkey);
+int __cdecl EVP_PKEY_security_bits(const EVP_PKEY *pkey);
+int __cdecl EVP_PKEY_size(const EVP_PKEY *pkey);
+int __cdecl EVP_PKEY_set_type(EVP_PKEY *pkey, int type);
+int __cdecl EVP_PKEY_set_type_str(EVP_PKEY *pkey, const char *str, int len);
+int __cdecl EVP_PKEY_set_alias_type(EVP_PKEY *pkey, int type);
 # ifndef OPENSSL_NO_ENGINE
-int EVP_PKEY_set1_engine(EVP_PKEY *pkey, ENGINE *e);
-ENGINE *EVP_PKEY_get0_engine(const EVP_PKEY *pkey);
+int __cdecl EVP_PKEY_set1_engine(EVP_PKEY *pkey, ENGINE *e);
+ENGINE * __cdecl EVP_PKEY_get0_engine(const EVP_PKEY *pkey);
 # endif
-int EVP_PKEY_assign(EVP_PKEY *pkey, int type, void *key);
-void *EVP_PKEY_get0(const EVP_PKEY *pkey);
-const unsigned char *EVP_PKEY_get0_hmac(const EVP_PKEY *pkey, size_t *len);
+int __cdecl EVP_PKEY_assign(EVP_PKEY *pkey, int type, void *key);
+void * __cdecl EVP_PKEY_get0(const EVP_PKEY *pkey);
+const unsigned char * __cdecl EVP_PKEY_get0_hmac(const EVP_PKEY *pkey, size_t *len);
 # ifndef OPENSSL_NO_POLY1305
-const unsigned char *EVP_PKEY_get0_poly1305(const EVP_PKEY *pkey, size_t *len);
+const unsigned char * __cdecl EVP_PKEY_get0_poly1305(const EVP_PKEY *pkey, size_t *len);
 # endif
 # ifndef OPENSSL_NO_SIPHASH
-const unsigned char *EVP_PKEY_get0_siphash(const EVP_PKEY *pkey, size_t *len);
+const unsigned char * __cdecl EVP_PKEY_get0_siphash(const EVP_PKEY *pkey, size_t *len);
 # endif
 
 # ifndef OPENSSL_NO_RSA
 struct rsa_st;
-int EVP_PKEY_set1_RSA(EVP_PKEY *pkey, struct rsa_st *key);
-struct rsa_st *EVP_PKEY_get0_RSA(EVP_PKEY *pkey);
-struct rsa_st *EVP_PKEY_get1_RSA(EVP_PKEY *pkey);
+int __cdecl EVP_PKEY_set1_RSA(EVP_PKEY *pkey, struct rsa_st *key);
+struct rsa_st * __cdecl EVP_PKEY_get0_RSA(EVP_PKEY *pkey);
+struct rsa_st * __cdecl EVP_PKEY_get1_RSA(EVP_PKEY *pkey);
 # endif
 # ifndef OPENSSL_NO_DSA
 struct dsa_st;
-int EVP_PKEY_set1_DSA(EVP_PKEY *pkey, struct dsa_st *key);
-struct dsa_st *EVP_PKEY_get0_DSA(EVP_PKEY *pkey);
-struct dsa_st *EVP_PKEY_get1_DSA(EVP_PKEY *pkey);
+int __cdecl EVP_PKEY_set1_DSA(EVP_PKEY *pkey, struct dsa_st *key);
+struct dsa_st * __cdecl EVP_PKEY_get0_DSA(EVP_PKEY *pkey);
+struct dsa_st * __cdecl EVP_PKEY_get1_DSA(EVP_PKEY *pkey);
 # endif
 # ifndef OPENSSL_NO_DH
 struct dh_st;
-int EVP_PKEY_set1_DH(EVP_PKEY *pkey, struct dh_st *key);
-struct dh_st *EVP_PKEY_get0_DH(EVP_PKEY *pkey);
-struct dh_st *EVP_PKEY_get1_DH(EVP_PKEY *pkey);
+int __cdecl EVP_PKEY_set1_DH(EVP_PKEY *pkey, struct dh_st *key);
+struct dh_st * __cdecl EVP_PKEY_get0_DH(EVP_PKEY *pkey);
+struct dh_st * __cdecl EVP_PKEY_get1_DH(EVP_PKEY *pkey);
 # endif
 # ifndef OPENSSL_NO_EC
 struct ec_key_st;
-int EVP_PKEY_set1_EC_KEY(EVP_PKEY *pkey, struct ec_key_st *key);
-struct ec_key_st *EVP_PKEY_get0_EC_KEY(EVP_PKEY *pkey);
-struct ec_key_st *EVP_PKEY_get1_EC_KEY(EVP_PKEY *pkey);
+int __cdecl EVP_PKEY_set1_EC_KEY(EVP_PKEY *pkey, struct ec_key_st *key);
+struct ec_key_st * __cdecl EVP_PKEY_get0_EC_KEY(EVP_PKEY *pkey);
+struct ec_key_st * __cdecl EVP_PKEY_get1_EC_KEY(EVP_PKEY *pkey);
 # endif
 
-EVP_PKEY *EVP_PKEY_new(void);
-int EVP_PKEY_up_ref(EVP_PKEY *pkey);
-void EVP_PKEY_free(EVP_PKEY *pkey);
+EVP_PKEY * __cdecl EVP_PKEY_new(void);
+int __cdecl EVP_PKEY_up_ref(EVP_PKEY *pkey);
+void __cdecl EVP_PKEY_free(EVP_PKEY *pkey);
 
-EVP_PKEY *d2i_PublicKey(int type, EVP_PKEY **a, const unsigned char **pp,
+EVP_PKEY * __cdecl d2i_PublicKey(int type, EVP_PKEY **a, const unsigned char **pp,
                         long length);
-int i2d_PublicKey(EVP_PKEY *a, unsigned char **pp);
+int __cdecl i2d_PublicKey(EVP_PKEY *a, unsigned char **pp);
 
-EVP_PKEY *d2i_PrivateKey(int type, EVP_PKEY **a, const unsigned char **pp,
+EVP_PKEY * __cdecl d2i_PrivateKey(int type, EVP_PKEY **a, const unsigned char **pp,
                          long length);
-EVP_PKEY *d2i_AutoPrivateKey(EVP_PKEY **a, const unsigned char **pp,
+EVP_PKEY * __cdecl d2i_AutoPrivateKey(EVP_PKEY **a, const unsigned char **pp,
                              long length);
-int i2d_PrivateKey(EVP_PKEY *a, unsigned char **pp);
+int __cdecl i2d_PrivateKey(EVP_PKEY *a, unsigned char **pp);
 
-int EVP_PKEY_copy_parameters(EVP_PKEY *to, const EVP_PKEY *from);
-int EVP_PKEY_missing_parameters(const EVP_PKEY *pkey);
-int EVP_PKEY_save_parameters(EVP_PKEY *pkey, int mode);
-int EVP_PKEY_cmp_parameters(const EVP_PKEY *a, const EVP_PKEY *b);
+int __cdecl EVP_PKEY_copy_parameters(EVP_PKEY *to, const EVP_PKEY *from);
+int __cdecl EVP_PKEY_missing_parameters(const EVP_PKEY *pkey);
+int __cdecl EVP_PKEY_save_parameters(EVP_PKEY *pkey, int mode);
+int __cdecl EVP_PKEY_cmp_parameters(const EVP_PKEY *a, const EVP_PKEY *b);
 
-int EVP_PKEY_cmp(const EVP_PKEY *a, const EVP_PKEY *b);
+int __cdecl EVP_PKEY_cmp(const EVP_PKEY *a, const EVP_PKEY *b);
 
-int EVP_PKEY_print_public(BIO *out, const EVP_PKEY *pkey,
+int __cdecl EVP_PKEY_print_public(BIO *out, const EVP_PKEY *pkey,
                           int indent, ASN1_PCTX *pctx);
-int EVP_PKEY_print_private(BIO *out, const EVP_PKEY *pkey,
+int __cdecl EVP_PKEY_print_private(BIO *out, const EVP_PKEY *pkey,
                            int indent, ASN1_PCTX *pctx);
-int EVP_PKEY_print_params(BIO *out, const EVP_PKEY *pkey,
+int __cdecl EVP_PKEY_print_params(BIO *out, const EVP_PKEY *pkey,
                           int indent, ASN1_PCTX *pctx);
 
-int EVP_PKEY_get_default_digest_nid(EVP_PKEY *pkey, int *pnid);
+int __cdecl EVP_PKEY_get_default_digest_nid(EVP_PKEY *pkey, int *pnid);
 
-int EVP_PKEY_set1_tls_encodedpoint(EVP_PKEY *pkey,
+int __cdecl EVP_PKEY_set1_tls_encodedpoint(EVP_PKEY *pkey,
                                    const unsigned char *pt, size_t ptlen);
-size_t EVP_PKEY_get1_tls_encodedpoint(EVP_PKEY *pkey, unsigned char **ppt);
+size_t __cdecl EVP_PKEY_get1_tls_encodedpoint(EVP_PKEY *pkey, unsigned char **ppt);
 
-int EVP_CIPHER_type(const EVP_CIPHER *ctx);
+int __cdecl EVP_CIPHER_type(const EVP_CIPHER *ctx);
 
 /* calls methods */
-int EVP_CIPHER_param_to_asn1(EVP_CIPHER_CTX *c, ASN1_TYPE *type);
-int EVP_CIPHER_asn1_to_param(EVP_CIPHER_CTX *c, ASN1_TYPE *type);
+int __cdecl EVP_CIPHER_param_to_asn1(EVP_CIPHER_CTX *c, ASN1_TYPE *type);
+int __cdecl EVP_CIPHER_asn1_to_param(EVP_CIPHER_CTX *c, ASN1_TYPE *type);
 
 /* These are used by EVP_CIPHER methods */
-int EVP_CIPHER_set_asn1_iv(EVP_CIPHER_CTX *c, ASN1_TYPE *type);
-int EVP_CIPHER_get_asn1_iv(EVP_CIPHER_CTX *c, ASN1_TYPE *type);
+int __cdecl EVP_CIPHER_set_asn1_iv(EVP_CIPHER_CTX *c, ASN1_TYPE *type);
+int __cdecl EVP_CIPHER_get_asn1_iv(EVP_CIPHER_CTX *c, ASN1_TYPE *type);
 
 /* PKCS5 password based encryption */
-int PKCS5_PBE_keyivgen(EVP_CIPHER_CTX *ctx, const char *pass, int passlen,
+int __cdecl PKCS5_PBE_keyivgen(EVP_CIPHER_CTX *ctx, const char *pass, int passlen,
                        ASN1_TYPE *param, const EVP_CIPHER *cipher,
                        const EVP_MD *md, int en_de);
-int PKCS5_PBKDF2_HMAC_SHA1(const char *pass, int passlen,
+int __cdecl PKCS5_PBKDF2_HMAC_SHA1(const char *pass, int passlen,
                            const unsigned char *salt, int saltlen, int iter,
                            int keylen, unsigned char *out);
-int PKCS5_PBKDF2_HMAC(const char *pass, int passlen,
+int __cdecl PKCS5_PBKDF2_HMAC(const char *pass, int passlen,
                       const unsigned char *salt, int saltlen, int iter,
                       const EVP_MD *digest, int keylen, unsigned char *out);
-int PKCS5_v2_PBE_keyivgen(EVP_CIPHER_CTX *ctx, const char *pass, int passlen,
+int __cdecl PKCS5_v2_PBE_keyivgen(EVP_CIPHER_CTX *ctx, const char *pass, int passlen,
                           ASN1_TYPE *param, const EVP_CIPHER *cipher,
                           const EVP_MD *md, int en_de);
 
 #ifndef OPENSSL_NO_SCRYPT
-int EVP_PBE_scrypt(const char *pass, size_t passlen,
+int __cdecl EVP_PBE_scrypt(const char *pass, size_t passlen,
                    const unsigned char *salt, size_t saltlen,
                    uint64_t N, uint64_t r, uint64_t p, uint64_t maxmem,
                    unsigned char *key, size_t keylen);
 
-int PKCS5_v2_scrypt_keyivgen(EVP_CIPHER_CTX *ctx, const char *pass,
+int __cdecl PKCS5_v2_scrypt_keyivgen(EVP_CIPHER_CTX *ctx, const char *pass,
                              int passlen, ASN1_TYPE *param,
                              const EVP_CIPHER *c, const EVP_MD *md, int en_de);
 #endif
 
-void PKCS5_PBE_add(void);
+void __cdecl PKCS5_PBE_add(void);
 
-int EVP_PBE_CipherInit(ASN1_OBJECT *pbe_obj, const char *pass, int passlen,
+int __cdecl EVP_PBE_CipherInit(ASN1_OBJECT *pbe_obj, const char *pass, int passlen,
                        ASN1_TYPE *param, EVP_CIPHER_CTX *ctx, int en_de);
 
 /* PBE type */
@@ -1119,14 +1119,14 @@ int EVP_PBE_CipherInit(ASN1_OBJECT *pbe_obj, const char *pass, int passlen,
 /* Is a PKCS#5 v2.0 KDF */
 # define EVP_PBE_TYPE_KDF        0x2
 
-int EVP_PBE_alg_add_type(int pbe_type, int pbe_nid, int cipher_nid,
+int __cdecl EVP_PBE_alg_add_type(int pbe_type, int pbe_nid, int cipher_nid,
                          int md_nid, EVP_PBE_KEYGEN *keygen);
-int EVP_PBE_alg_add(int nid, const EVP_CIPHER *cipher, const EVP_MD *md,
+int __cdecl EVP_PBE_alg_add(int nid, const EVP_CIPHER *cipher, const EVP_MD *md,
                     EVP_PBE_KEYGEN *keygen);
-int EVP_PBE_find(int type, int pbe_nid, int *pcnid, int *pmnid,
+int __cdecl EVP_PBE_find(int type, int pbe_nid, int *pcnid, int *pmnid,
                  EVP_PBE_KEYGEN **pkeygen);
-void EVP_PBE_cleanup(void);
-int EVP_PBE_get(int *ptype, int *ppbe_nid, size_t num);
+void __cdecl EVP_PBE_cleanup(void);
+int __cdecl EVP_PBE_get(int *ptype, int *ppbe_nid, size_t num);
 
 # define ASN1_PKEY_ALIAS         0x1
 # define ASN1_PKEY_DYNAMIC       0x2
@@ -1142,26 +1142,26 @@ int EVP_PBE_get(int *ptype, int *ppbe_nid, size_t num);
 # define ASN1_PKEY_CTRL_SET1_TLS_ENCPT   0x9
 # define ASN1_PKEY_CTRL_GET1_TLS_ENCPT   0xa
 
-int EVP_PKEY_asn1_get_count(void);
-const EVP_PKEY_ASN1_METHOD *EVP_PKEY_asn1_get0(int idx);
-const EVP_PKEY_ASN1_METHOD *EVP_PKEY_asn1_find(ENGINE **pe, int type);
-const EVP_PKEY_ASN1_METHOD *EVP_PKEY_asn1_find_str(ENGINE **pe,
+int __cdecl EVP_PKEY_asn1_get_count(void);
+const EVP_PKEY_ASN1_METHOD * __cdecl EVP_PKEY_asn1_get0(int idx);
+const EVP_PKEY_ASN1_METHOD * __cdecl EVP_PKEY_asn1_find(ENGINE **pe, int type);
+const EVP_PKEY_ASN1_METHOD * __cdecl EVP_PKEY_asn1_find_str(ENGINE **pe,
                                                    const char *str, int len);
-int EVP_PKEY_asn1_add0(const EVP_PKEY_ASN1_METHOD *ameth);
-int EVP_PKEY_asn1_add_alias(int to, int from);
-int EVP_PKEY_asn1_get0_info(int *ppkey_id, int *pkey_base_id,
+int __cdecl EVP_PKEY_asn1_add0(const EVP_PKEY_ASN1_METHOD *ameth);
+int __cdecl EVP_PKEY_asn1_add_alias(int to, int from);
+int __cdecl EVP_PKEY_asn1_get0_info(int *ppkey_id, int *pkey_base_id,
                             int *ppkey_flags, const char **pinfo,
                             const char **ppem_str,
                             const EVP_PKEY_ASN1_METHOD *ameth);
 
-const EVP_PKEY_ASN1_METHOD *EVP_PKEY_get0_asn1(const EVP_PKEY *pkey);
-EVP_PKEY_ASN1_METHOD *EVP_PKEY_asn1_new(int id, int flags,
+const EVP_PKEY_ASN1_METHOD * __cdecl EVP_PKEY_get0_asn1(const EVP_PKEY *pkey);
+EVP_PKEY_ASN1_METHOD * __cdecl EVP_PKEY_asn1_new(int id, int flags,
                                         const char *pem_str,
                                         const char *info);
-void EVP_PKEY_asn1_copy(EVP_PKEY_ASN1_METHOD *dst,
+void __cdecl EVP_PKEY_asn1_copy(EVP_PKEY_ASN1_METHOD *dst,
                         const EVP_PKEY_ASN1_METHOD *src);
-void EVP_PKEY_asn1_free(EVP_PKEY_ASN1_METHOD *ameth);
-void EVP_PKEY_asn1_set_public(EVP_PKEY_ASN1_METHOD *ameth,
+void __cdecl EVP_PKEY_asn1_free(EVP_PKEY_ASN1_METHOD *ameth);
+void __cdecl EVP_PKEY_asn1_set_public(EVP_PKEY_ASN1_METHOD *ameth,
                               int (*pub_decode) (EVP_PKEY *pk,
                                                  X509_PUBKEY *pub),
                               int (*pub_encode) (X509_PUBKEY *pub,
@@ -1173,7 +1173,7 @@ void EVP_PKEY_asn1_set_public(EVP_PKEY_ASN1_METHOD *ameth,
                                                 int indent, ASN1_PCTX *pctx),
                               int (*pkey_size) (const EVP_PKEY *pk),
                               int (*pkey_bits) (const EVP_PKEY *pk));
-void EVP_PKEY_asn1_set_private(EVP_PKEY_ASN1_METHOD *ameth,
+void __cdecl EVP_PKEY_asn1_set_private(EVP_PKEY_ASN1_METHOD *ameth,
                                int (*priv_decode) (EVP_PKEY *pk,
                                                    const PKCS8_PRIV_KEY_INFO
                                                    *p8inf),
@@ -1183,7 +1183,7 @@ void EVP_PKEY_asn1_set_private(EVP_PKEY_ASN1_METHOD *ameth,
                                                   const EVP_PKEY *pkey,
                                                   int indent,
                                                   ASN1_PCTX *pctx));
-void EVP_PKEY_asn1_set_param(EVP_PKEY_ASN1_METHOD *ameth,
+void __cdecl EVP_PKEY_asn1_set_param(EVP_PKEY_ASN1_METHOD *ameth,
                              int (*param_decode) (EVP_PKEY *pkey,
                                                   const unsigned char **pder,
                                                   int derlen),
@@ -1199,12 +1199,12 @@ void EVP_PKEY_asn1_set_param(EVP_PKEY_ASN1_METHOD *ameth,
                                                  int indent,
                                                  ASN1_PCTX *pctx));
 
-void EVP_PKEY_asn1_set_free(EVP_PKEY_ASN1_METHOD *ameth,
+void __cdecl EVP_PKEY_asn1_set_free(EVP_PKEY_ASN1_METHOD *ameth,
                             void (*pkey_free) (EVP_PKEY *pkey));
-void EVP_PKEY_asn1_set_ctrl(EVP_PKEY_ASN1_METHOD *ameth,
+void __cdecl EVP_PKEY_asn1_set_ctrl(EVP_PKEY_ASN1_METHOD *ameth,
                             int (*pkey_ctrl) (EVP_PKEY *pkey, int op,
                                               long arg1, void *arg2));
-void EVP_PKEY_asn1_set_item(EVP_PKEY_ASN1_METHOD *ameth,
+void __cdecl EVP_PKEY_asn1_set_item(EVP_PKEY_ASN1_METHOD *ameth,
                             int (*item_verify) (EVP_MD_CTX *ctx,
                                                 const ASN1_ITEM *it,
                                                 void *asn,
@@ -1218,39 +1218,39 @@ void EVP_PKEY_asn1_set_item(EVP_PKEY_ASN1_METHOD *ameth,
                                               X509_ALGOR *alg2,
                                               ASN1_BIT_STRING *sig));
 
-void EVP_PKEY_asn1_set_siginf(EVP_PKEY_ASN1_METHOD *ameth,
+void __cdecl EVP_PKEY_asn1_set_siginf(EVP_PKEY_ASN1_METHOD *ameth,
                               int (*siginf_set) (X509_SIG_INFO *siginf,
                                                  const X509_ALGOR *alg,
                                                  const ASN1_STRING *sig));
 
-void EVP_PKEY_asn1_set_check(EVP_PKEY_ASN1_METHOD *ameth,
+void __cdecl EVP_PKEY_asn1_set_check(EVP_PKEY_ASN1_METHOD *ameth,
                              int (*pkey_check) (const EVP_PKEY *pk));
 
-void EVP_PKEY_asn1_set_public_check(EVP_PKEY_ASN1_METHOD *ameth,
+void __cdecl EVP_PKEY_asn1_set_public_check(EVP_PKEY_ASN1_METHOD *ameth,
                                     int (*pkey_pub_check) (const EVP_PKEY *pk));
 
-void EVP_PKEY_asn1_set_param_check(EVP_PKEY_ASN1_METHOD *ameth,
+void __cdecl EVP_PKEY_asn1_set_param_check(EVP_PKEY_ASN1_METHOD *ameth,
                                    int (*pkey_param_check) (const EVP_PKEY *pk));
 
-void EVP_PKEY_asn1_set_set_priv_key(EVP_PKEY_ASN1_METHOD *ameth,
+void __cdecl EVP_PKEY_asn1_set_set_priv_key(EVP_PKEY_ASN1_METHOD *ameth,
                                     int (*set_priv_key) (EVP_PKEY *pk,
                                                          const unsigned char
                                                             *priv,
                                                          size_t len));
-void EVP_PKEY_asn1_set_set_pub_key(EVP_PKEY_ASN1_METHOD *ameth,
+void __cdecl EVP_PKEY_asn1_set_set_pub_key(EVP_PKEY_ASN1_METHOD *ameth,
                                    int (*set_pub_key) (EVP_PKEY *pk,
                                                        const unsigned char *pub,
                                                        size_t len));
-void EVP_PKEY_asn1_set_get_priv_key(EVP_PKEY_ASN1_METHOD *ameth,
+void __cdecl EVP_PKEY_asn1_set_get_priv_key(EVP_PKEY_ASN1_METHOD *ameth,
                                     int (*get_priv_key) (const EVP_PKEY *pk,
                                                          unsigned char *priv,
                                                          size_t *len));
-void EVP_PKEY_asn1_set_get_pub_key(EVP_PKEY_ASN1_METHOD *ameth,
+void __cdecl EVP_PKEY_asn1_set_get_pub_key(EVP_PKEY_ASN1_METHOD *ameth,
                                    int (*get_pub_key) (const EVP_PKEY *pk,
                                                        unsigned char *pub,
                                                        size_t *len));
 
-void EVP_PKEY_asn1_set_security_bits(EVP_PKEY_ASN1_METHOD *ameth,
+void __cdecl EVP_PKEY_asn1_set_security_bits(EVP_PKEY_ASN1_METHOD *ameth,
                                      int (*pkey_security_bits) (const EVP_PKEY
                                                                 *pk));
 
@@ -1324,130 +1324,130 @@ void EVP_PKEY_asn1_set_security_bits(EVP_PKEY_ASN1_METHOD *ameth,
  */
 # define EVP_PKEY_FLAG_SIGCTX_CUSTOM     4
 
-const EVP_PKEY_METHOD *EVP_PKEY_meth_find(int type);
-EVP_PKEY_METHOD *EVP_PKEY_meth_new(int id, int flags);
-void EVP_PKEY_meth_get0_info(int *ppkey_id, int *pflags,
+const EVP_PKEY_METHOD * __cdecl EVP_PKEY_meth_find(int type);
+EVP_PKEY_METHOD * __cdecl EVP_PKEY_meth_new(int id, int flags);
+void __cdecl EVP_PKEY_meth_get0_info(int *ppkey_id, int *pflags,
                              const EVP_PKEY_METHOD *meth);
-void EVP_PKEY_meth_copy(EVP_PKEY_METHOD *dst, const EVP_PKEY_METHOD *src);
-void EVP_PKEY_meth_free(EVP_PKEY_METHOD *pmeth);
-int EVP_PKEY_meth_add0(const EVP_PKEY_METHOD *pmeth);
-int EVP_PKEY_meth_remove(const EVP_PKEY_METHOD *pmeth);
-size_t EVP_PKEY_meth_get_count(void);
-const EVP_PKEY_METHOD *EVP_PKEY_meth_get0(size_t idx);
-
-EVP_PKEY_CTX *EVP_PKEY_CTX_new(EVP_PKEY *pkey, ENGINE *e);
-EVP_PKEY_CTX *EVP_PKEY_CTX_new_id(int id, ENGINE *e);
-EVP_PKEY_CTX *EVP_PKEY_CTX_dup(EVP_PKEY_CTX *ctx);
-void EVP_PKEY_CTX_free(EVP_PKEY_CTX *ctx);
-
-int EVP_PKEY_CTX_ctrl(EVP_PKEY_CTX *ctx, int keytype, int optype,
+void __cdecl EVP_PKEY_meth_copy(EVP_PKEY_METHOD *dst, const EVP_PKEY_METHOD *src);
+void __cdecl EVP_PKEY_meth_free(EVP_PKEY_METHOD *pmeth);
+int __cdecl EVP_PKEY_meth_add0(const EVP_PKEY_METHOD *pmeth);
+int __cdecl EVP_PKEY_meth_remove(const EVP_PKEY_METHOD *pmeth);
+size_t __cdecl EVP_PKEY_meth_get_count(void);
+const EVP_PKEY_METHOD * __cdecl EVP_PKEY_meth_get0(size_t idx);
+
+EVP_PKEY_CTX * __cdecl EVP_PKEY_CTX_new(EVP_PKEY *pkey, ENGINE *e);
+EVP_PKEY_CTX * __cdecl EVP_PKEY_CTX_new_id(int id, ENGINE *e);
+EVP_PKEY_CTX * __cdecl EVP_PKEY_CTX_dup(EVP_PKEY_CTX *ctx);
+void __cdecl EVP_PKEY_CTX_free(EVP_PKEY_CTX *ctx);
+
+int __cdecl EVP_PKEY_CTX_ctrl(EVP_PKEY_CTX *ctx, int keytype, int optype,
                       int cmd, int p1, void *p2);
-int EVP_PKEY_CTX_ctrl_str(EVP_PKEY_CTX *ctx, const char *type,
+int __cdecl EVP_PKEY_CTX_ctrl_str(EVP_PKEY_CTX *ctx, const char *type,
                           const char *value);
-int EVP_PKEY_CTX_ctrl_uint64(EVP_PKEY_CTX *ctx, int keytype, int optype,
+int __cdecl EVP_PKEY_CTX_ctrl_uint64(EVP_PKEY_CTX *ctx, int keytype, int optype,
                              int cmd, uint64_t value);
 
-int EVP_PKEY_CTX_str2ctrl(EVP_PKEY_CTX *ctx, int cmd, const char *str);
-int EVP_PKEY_CTX_hex2ctrl(EVP_PKEY_CTX *ctx, int cmd, const char *hex);
+int __cdecl EVP_PKEY_CTX_str2ctrl(EVP_PKEY_CTX *ctx, int cmd, const char *str);
+int __cdecl EVP_PKEY_CTX_hex2ctrl(EVP_PKEY_CTX *ctx, int cmd, const char *hex);
 
-int EVP_PKEY_CTX_md(EVP_PKEY_CTX *ctx, int optype, int cmd, const char *md);
+int __cdecl EVP_PKEY_CTX_md(EVP_PKEY_CTX *ctx, int optype, int cmd, const char *md);
 
-int EVP_PKEY_CTX_get_operation(EVP_PKEY_CTX *ctx);
-void EVP_PKEY_CTX_set0_keygen_info(EVP_PKEY_CTX *ctx, int *dat, int datlen);
+int __cdecl EVP_PKEY_CTX_get_operation(EVP_PKEY_CTX *ctx);
+void __cdecl EVP_PKEY_CTX_set0_keygen_info(EVP_PKEY_CTX *ctx, int *dat, int datlen);
 
-EVP_PKEY *EVP_PKEY_new_mac_key(int type, ENGINE *e,
+EVP_PKEY * __cdecl EVP_PKEY_new_mac_key(int type, ENGINE *e,
                                const unsigned char *key, int keylen);
-EVP_PKEY *EVP_PKEY_new_raw_private_key(int type, ENGINE *e,
+EVP_PKEY * __cdecl EVP_PKEY_new_raw_private_key(int type, ENGINE *e,
                                        const unsigned char *priv,
                                        size_t len);
-EVP_PKEY *EVP_PKEY_new_raw_public_key(int type, ENGINE *e,
+EVP_PKEY * __cdecl EVP_PKEY_new_raw_public_key(int type, ENGINE *e,
                                       const unsigned char *pub,
                                       size_t len);
-int EVP_PKEY_get_raw_private_key(const EVP_PKEY *pkey, unsigned char *priv,
+int __cdecl EVP_PKEY_get_raw_private_key(const EVP_PKEY *pkey, unsigned char *priv,
                                  size_t *len);
-int EVP_PKEY_get_raw_public_key(const EVP_PKEY *pkey, unsigned char *pub,
+int __cdecl EVP_PKEY_get_raw_public_key(const EVP_PKEY *pkey, unsigned char *pub,
                                 size_t *len);
 
-EVP_PKEY *EVP_PKEY_new_CMAC_key(ENGINE *e, const unsigned char *priv,
+EVP_PKEY * __cdecl EVP_PKEY_new_CMAC_key(ENGINE *e, const unsigned char *priv,
                                 size_t len, const EVP_CIPHER *cipher);
 
-void EVP_PKEY_CTX_set_data(EVP_PKEY_CTX *ctx, void *data);
-void *EVP_PKEY_CTX_get_data(EVP_PKEY_CTX *ctx);
-EVP_PKEY *EVP_PKEY_CTX_get0_pkey(EVP_PKEY_CTX *ctx);
+void __cdecl EVP_PKEY_CTX_set_data(EVP_PKEY_CTX *ctx, void *data);
+void * __cdecl EVP_PKEY_CTX_get_data(EVP_PKEY_CTX *ctx);
+EVP_PKEY * __cdecl EVP_PKEY_CTX_get0_pkey(EVP_PKEY_CTX *ctx);
 
-EVP_PKEY *EVP_PKEY_CTX_get0_peerkey(EVP_PKEY_CTX *ctx);
+EVP_PKEY * __cdecl EVP_PKEY_CTX_get0_peerkey(EVP_PKEY_CTX *ctx);
 
-void EVP_PKEY_CTX_set_app_data(EVP_PKEY_CTX *ctx, void *data);
-void *EVP_PKEY_CTX_get_app_data(EVP_PKEY_CTX *ctx);
+void __cdecl EVP_PKEY_CTX_set_app_data(EVP_PKEY_CTX *ctx, void *data);
+void * __cdecl EVP_PKEY_CTX_get_app_data(EVP_PKEY_CTX *ctx);
 
-int EVP_PKEY_sign_init(EVP_PKEY_CTX *ctx);
-int EVP_PKEY_sign(EVP_PKEY_CTX *ctx,
+int __cdecl EVP_PKEY_sign_init(EVP_PKEY_CTX *ctx);
+int __cdecl EVP_PKEY_sign(EVP_PKEY_CTX *ctx,
                   unsigned char *sig, size_t *siglen,
                   const unsigned char *tbs, size_t tbslen);
-int EVP_PKEY_verify_init(EVP_PKEY_CTX *ctx);
-int EVP_PKEY_verify(EVP_PKEY_CTX *ctx,
+int __cdecl EVP_PKEY_verify_init(EVP_PKEY_CTX *ctx);
+int __cdecl EVP_PKEY_verify(EVP_PKEY_CTX *ctx,
                     const unsigned char *sig, size_t siglen,
                     const unsigned char *tbs, size_t tbslen);
-int EVP_PKEY_verify_recover_init(EVP_PKEY_CTX *ctx);
-int EVP_PKEY_verify_recover(EVP_PKEY_CTX *ctx,
+int __cdecl EVP_PKEY_verify_recover_init(EVP_PKEY_CTX *ctx);
+int __cdecl EVP_PKEY_verify_recover(EVP_PKEY_CTX *ctx,
                             unsigned char *rout, size_t *routlen,
                             const unsigned char *sig, size_t siglen);
-int EVP_PKEY_encrypt_init(EVP_PKEY_CTX *ctx);
-int EVP_PKEY_encrypt(EVP_PKEY_CTX *ctx,
+int __cdecl EVP_PKEY_encrypt_init(EVP_PKEY_CTX *ctx);
+int __cdecl EVP_PKEY_encrypt(EVP_PKEY_CTX *ctx,
                      unsigned char *out, size_t *outlen,
                      const unsigned char *in, size_t inlen);
-int EVP_PKEY_decrypt_init(EVP_PKEY_CTX *ctx);
-int EVP_PKEY_decrypt(EVP_PKEY_CTX *ctx,
+int __cdecl EVP_PKEY_decrypt_init(EVP_PKEY_CTX *ctx);
+int __cdecl EVP_PKEY_decrypt(EVP_PKEY_CTX *ctx,
                      unsigned char *out, size_t *outlen,
                      const unsigned char *in, size_t inlen);
 
-int EVP_PKEY_derive_init(EVP_PKEY_CTX *ctx);
-int EVP_PKEY_derive_set_peer(EVP_PKEY_CTX *ctx, EVP_PKEY *peer);
-int EVP_PKEY_derive(EVP_PKEY_CTX *ctx, unsigned char *key, size_t *keylen);
+int __cdecl EVP_PKEY_derive_init(EVP_PKEY_CTX *ctx);
+int __cdecl EVP_PKEY_derive_set_peer(EVP_PKEY_CTX *ctx, EVP_PKEY *peer);
+int __cdecl EVP_PKEY_derive(EVP_PKEY_CTX *ctx, unsigned char *key, size_t *keylen);
 
 typedef int EVP_PKEY_gen_cb(EVP_PKEY_CTX *ctx);
 
-int EVP_PKEY_paramgen_init(EVP_PKEY_CTX *ctx);
-int EVP_PKEY_paramgen(EVP_PKEY_CTX *ctx, EVP_PKEY **ppkey);
-int EVP_PKEY_keygen_init(EVP_PKEY_CTX *ctx);
-int EVP_PKEY_keygen(EVP_PKEY_CTX *ctx, EVP_PKEY **ppkey);
-int EVP_PKEY_check(EVP_PKEY_CTX *ctx);
-int EVP_PKEY_public_check(EVP_PKEY_CTX *ctx);
-int EVP_PKEY_param_check(EVP_PKEY_CTX *ctx);
+int __cdecl EVP_PKEY_paramgen_init(EVP_PKEY_CTX *ctx);
+int __cdecl EVP_PKEY_paramgen(EVP_PKEY_CTX *ctx, EVP_PKEY **ppkey);
+int __cdecl EVP_PKEY_keygen_init(EVP_PKEY_CTX *ctx);
+int __cdecl EVP_PKEY_keygen(EVP_PKEY_CTX *ctx, EVP_PKEY **ppkey);
+int __cdecl EVP_PKEY_check(EVP_PKEY_CTX *ctx);
+int __cdecl EVP_PKEY_public_check(EVP_PKEY_CTX *ctx);
+int __cdecl EVP_PKEY_param_check(EVP_PKEY_CTX *ctx);
 
-void EVP_PKEY_CTX_set_cb(EVP_PKEY_CTX *ctx, EVP_PKEY_gen_cb *cb);
-EVP_PKEY_gen_cb *EVP_PKEY_CTX_get_cb(EVP_PKEY_CTX *ctx);
+void __cdecl EVP_PKEY_CTX_set_cb(EVP_PKEY_CTX *ctx, EVP_PKEY_gen_cb *cb);
+EVP_PKEY_gen_cb * __cdecl EVP_PKEY_CTX_get_cb(EVP_PKEY_CTX *ctx);
 
-int EVP_PKEY_CTX_get_keygen_info(EVP_PKEY_CTX *ctx, int idx);
+int __cdecl EVP_PKEY_CTX_get_keygen_info(EVP_PKEY_CTX *ctx, int idx);
 
-void EVP_PKEY_meth_set_init(EVP_PKEY_METHOD *pmeth,
+void __cdecl EVP_PKEY_meth_set_init(EVP_PKEY_METHOD *pmeth,
                             int (*init) (EVP_PKEY_CTX *ctx));
 
-void EVP_PKEY_meth_set_copy(EVP_PKEY_METHOD *pmeth,
+void __cdecl EVP_PKEY_meth_set_copy(EVP_PKEY_METHOD *pmeth,
                             int (*copy) (EVP_PKEY_CTX *dst,
                                          EVP_PKEY_CTX *src));
 
-void EVP_PKEY_meth_set_cleanup(EVP_PKEY_METHOD *pmeth,
+void __cdecl EVP_PKEY_meth_set_cleanup(EVP_PKEY_METHOD *pmeth,
                                void (*cleanup) (EVP_PKEY_CTX *ctx));
 
-void EVP_PKEY_meth_set_paramgen(EVP_PKEY_METHOD *pmeth,
+void __cdecl EVP_PKEY_meth_set_paramgen(EVP_PKEY_METHOD *pmeth,
                                 int (*paramgen_init) (EVP_PKEY_CTX *ctx),
                                 int (*paramgen) (EVP_PKEY_CTX *ctx,
                                                  EVP_PKEY *pkey));
 
-void EVP_PKEY_meth_set_keygen(EVP_PKEY_METHOD *pmeth,
+void __cdecl EVP_PKEY_meth_set_keygen(EVP_PKEY_METHOD *pmeth,
                               int (*keygen_init) (EVP_PKEY_CTX *ctx),
                               int (*keygen) (EVP_PKEY_CTX *ctx,
                                              EVP_PKEY *pkey));
 
-void EVP_PKEY_meth_set_sign(EVP_PKEY_METHOD *pmeth,
+void __cdecl EVP_PKEY_meth_set_sign(EVP_PKEY_METHOD *pmeth,
                             int (*sign_init) (EVP_PKEY_CTX *ctx),
                             int (*sign) (EVP_PKEY_CTX *ctx,
                                          unsigned char *sig, size_t *siglen,
                                          const unsigned char *tbs,
                                          size_t tbslen));
 
-void EVP_PKEY_meth_set_verify(EVP_PKEY_METHOD *pmeth,
+void __cdecl EVP_PKEY_meth_set_verify(EVP_PKEY_METHOD *pmeth,
                               int (*verify_init) (EVP_PKEY_CTX *ctx),
                               int (*verify) (EVP_PKEY_CTX *ctx,
                                              const unsigned char *sig,
@@ -1455,7 +1455,7 @@ void EVP_PKEY_meth_set_verify(EVP_PKEY_METHOD *pmeth,
                                              const unsigned char *tbs,
                                              size_t tbslen));
 
-void EVP_PKEY_meth_set_verify_recover(EVP_PKEY_METHOD *pmeth,
+void __cdecl EVP_PKEY_meth_set_verify_recover(EVP_PKEY_METHOD *pmeth,
                                       int (*verify_recover_init) (EVP_PKEY_CTX
                                                                   *ctx),
                                       int (*verify_recover) (EVP_PKEY_CTX
@@ -1467,7 +1467,7 @@ void EVP_PKEY_meth_set_verify_recover(EVP_PKEY_METHOD *pmeth,
                                                              char *tbs,
                                                              size_t tbslen));
 
-void EVP_PKEY_meth_set_signctx(EVP_PKEY_METHOD *pmeth,
+void __cdecl EVP_PKEY_meth_set_signctx(EVP_PKEY_METHOD *pmeth,
                                int (*signctx_init) (EVP_PKEY_CTX *ctx,
                                                     EVP_MD_CTX *mctx),
                                int (*signctx) (EVP_PKEY_CTX *ctx,
@@ -1475,7 +1475,7 @@ void EVP_PKEY_meth_set_signctx(EVP_PKEY_METHOD *pmeth,
                                                size_t *siglen,
                                                EVP_MD_CTX *mctx));
 
-void EVP_PKEY_meth_set_verifyctx(EVP_PKEY_METHOD *pmeth,
+void __cdecl EVP_PKEY_meth_set_verifyctx(EVP_PKEY_METHOD *pmeth,
                                  int (*verifyctx_init) (EVP_PKEY_CTX *ctx,
                                                         EVP_MD_CTX *mctx),
                                  int (*verifyctx) (EVP_PKEY_CTX *ctx,
@@ -1483,7 +1483,7 @@ void EVP_PKEY_meth_set_verifyctx(EVP_PKEY_METHOD *pmeth,
                                                    int siglen,
                                                    EVP_MD_CTX *mctx));
 
-void EVP_PKEY_meth_set_encrypt(EVP_PKEY_METHOD *pmeth,
+void __cdecl EVP_PKEY_meth_set_encrypt(EVP_PKEY_METHOD *pmeth,
                                int (*encrypt_init) (EVP_PKEY_CTX *ctx),
                                int (*encryptfn) (EVP_PKEY_CTX *ctx,
                                                  unsigned char *out,
@@ -1491,7 +1491,7 @@ void EVP_PKEY_meth_set_encrypt(EVP_PKEY_METHOD *pmeth,
                                                  const unsigned char *in,
                                                  size_t inlen));
 
-void EVP_PKEY_meth_set_decrypt(EVP_PKEY_METHOD *pmeth,
+void __cdecl EVP_PKEY_meth_set_decrypt(EVP_PKEY_METHOD *pmeth,
                                int (*decrypt_init) (EVP_PKEY_CTX *ctx),
                                int (*decrypt) (EVP_PKEY_CTX *ctx,
                                                unsigned char *out,
@@ -1499,60 +1499,60 @@ void EVP_PKEY_meth_set_decrypt(EVP_PKEY_METHOD *pmeth,
                                                const unsigned char *in,
                                                size_t inlen));
 
-void EVP_PKEY_meth_set_derive(EVP_PKEY_METHOD *pmeth,
+void __cdecl EVP_PKEY_meth_set_derive(EVP_PKEY_METHOD *pmeth,
                               int (*derive_init) (EVP_PKEY_CTX *ctx),
                               int (*derive) (EVP_PKEY_CTX *ctx,
                                              unsigned char *key,
                                              size_t *keylen));
 
-void EVP_PKEY_meth_set_ctrl(EVP_PKEY_METHOD *pmeth,
+void __cdecl EVP_PKEY_meth_set_ctrl(EVP_PKEY_METHOD *pmeth,
                             int (*ctrl) (EVP_PKEY_CTX *ctx, int type, int p1,
                                          void *p2),
                             int (*ctrl_str) (EVP_PKEY_CTX *ctx,
                                              const char *type,
                                              const char *value));
 
-void EVP_PKEY_meth_set_check(EVP_PKEY_METHOD *pmeth,
+void __cdecl EVP_PKEY_meth_set_check(EVP_PKEY_METHOD *pmeth,
                              int (*check) (EVP_PKEY *pkey));
 
-void EVP_PKEY_meth_set_public_check(EVP_PKEY_METHOD *pmeth,
+void __cdecl EVP_PKEY_meth_set_public_check(EVP_PKEY_METHOD *pmeth,
                                     int (*check) (EVP_PKEY *pkey));
 
-void EVP_PKEY_meth_set_param_check(EVP_PKEY_METHOD *pmeth,
+void __cdecl EVP_PKEY_meth_set_param_check(EVP_PKEY_METHOD *pmeth,
                                    int (*check) (EVP_PKEY *pkey));
 
-void EVP_PKEY_meth_set_digest_custom(EVP_PKEY_METHOD *pmeth,
+void  __cdecl EVP_PKEY_meth_set_digest_custom(EVP_PKEY_METHOD *pmeth,
                                      int (*digest_custom) (EVP_PKEY_CTX *ctx,
                                                            EVP_MD_CTX *mctx));
 
-void EVP_PKEY_meth_get_init(const EVP_PKEY_METHOD *pmeth,
+void __cdecl EVP_PKEY_meth_get_init(const EVP_PKEY_METHOD *pmeth,
                             int (**pinit) (EVP_PKEY_CTX *ctx));
 
-void EVP_PKEY_meth_get_copy(const EVP_PKEY_METHOD *pmeth,
+void __cdecl EVP_PKEY_meth_get_copy(const EVP_PKEY_METHOD *pmeth,
                             int (**pcopy) (EVP_PKEY_CTX *dst,
                                            EVP_PKEY_CTX *src));
 
-void EVP_PKEY_meth_get_cleanup(const EVP_PKEY_METHOD *pmeth,
+void __cdecl EVP_PKEY_meth_get_cleanup(const EVP_PKEY_METHOD *pmeth,
                                void (**pcleanup) (EVP_PKEY_CTX *ctx));
 
-void EVP_PKEY_meth_get_paramgen(const EVP_PKEY_METHOD *pmeth,
+void __cdecl EVP_PKEY_meth_get_paramgen(const EVP_PKEY_METHOD *pmeth,
                                 int (**pparamgen_init) (EVP_PKEY_CTX *ctx),
                                 int (**pparamgen) (EVP_PKEY_CTX *ctx,
                                                    EVP_PKEY *pkey));
 
-void EVP_PKEY_meth_get_keygen(const EVP_PKEY_METHOD *pmeth,
+void __cdecl EVP_PKEY_meth_get_keygen(const EVP_PKEY_METHOD *pmeth,
                               int (**pkeygen_init) (EVP_PKEY_CTX *ctx),
                               int (**pkeygen) (EVP_PKEY_CTX *ctx,
                                                EVP_PKEY *pkey));
 
-void EVP_PKEY_meth_get_sign(const EVP_PKEY_METHOD *pmeth,
+void __cdecl EVP_PKEY_meth_get_sign(const EVP_PKEY_METHOD *pmeth,
                             int (**psign_init) (EVP_PKEY_CTX *ctx),
                             int (**psign) (EVP_PKEY_CTX *ctx,
                                            unsigned char *sig, size_t *siglen,
                                            const unsigned char *tbs,
                                            size_t tbslen));
 
-void EVP_PKEY_meth_get_verify(const EVP_PKEY_METHOD *pmeth,
+void __cdecl EVP_PKEY_meth_get_verify(const EVP_PKEY_METHOD *pmeth,
                               int (**pverify_init) (EVP_PKEY_CTX *ctx),
                               int (**pverify) (EVP_PKEY_CTX *ctx,
                                                const unsigned char *sig,
@@ -1560,7 +1560,7 @@ void EVP_PKEY_meth_get_verify(const EVP_PKEY_METHOD *pmeth,
                                                const unsigned char *tbs,
                                                size_t tbslen));
 
-void EVP_PKEY_meth_get_verify_recover(const EVP_PKEY_METHOD *pmeth,
+void __cdecl EVP_PKEY_meth_get_verify_recover(const EVP_PKEY_METHOD *pmeth,
                                       int (**pverify_recover_init) (EVP_PKEY_CTX
                                                                     *ctx),
                                       int (**pverify_recover) (EVP_PKEY_CTX
@@ -1572,7 +1572,7 @@ void EVP_PKEY_meth_get_verify_recover(const EVP_PKEY_METHOD *pmeth,
                                                                char *tbs,
                                                                size_t tbslen));
 
-void EVP_PKEY_meth_get_signctx(const EVP_PKEY_METHOD *pmeth,
+void __cdecl EVP_PKEY_meth_get_signctx(const EVP_PKEY_METHOD *pmeth,
                                int (**psignctx_init) (EVP_PKEY_CTX *ctx,
                                                       EVP_MD_CTX *mctx),
                                int (**psignctx) (EVP_PKEY_CTX *ctx,
@@ -1580,7 +1580,7 @@ void EVP_PKEY_meth_get_signctx(const EVP_PKEY_METHOD *pmeth,
                                                  size_t *siglen,
                                                  EVP_MD_CTX *mctx));
 
-void EVP_PKEY_meth_get_verifyctx(const EVP_PKEY_METHOD *pmeth,
+void __cdecl EVP_PKEY_meth_get_verifyctx(const EVP_PKEY_METHOD *pmeth,
                                  int (**pverifyctx_init) (EVP_PKEY_CTX *ctx,
                                                           EVP_MD_CTX *mctx),
                                  int (**pverifyctx) (EVP_PKEY_CTX *ctx,
@@ -1588,7 +1588,7 @@ void EVP_PKEY_meth_get_verifyctx(const EVP_PKEY_METHOD *pmeth,
                                                      int siglen,
                                                      EVP_MD_CTX *mctx));
 
-void EVP_PKEY_meth_get_encrypt(const EVP_PKEY_METHOD *pmeth,
+void __cdecl EVP_PKEY_meth_get_encrypt(const EVP_PKEY_METHOD *pmeth,
                                int (**pencrypt_init) (EVP_PKEY_CTX *ctx),
                                int (**pencryptfn) (EVP_PKEY_CTX *ctx,
                                                    unsigned char *out,
@@ -1596,7 +1596,7 @@ void EVP_PKEY_meth_get_encrypt(const EVP_PKEY_METHOD *pmeth,
                                                    const unsigned char *in,
                                                    size_t inlen));
 
-void EVP_PKEY_meth_get_decrypt(const EVP_PKEY_METHOD *pmeth,
+void __cdecl EVP_PKEY_meth_get_decrypt(const EVP_PKEY_METHOD *pmeth,
                                int (**pdecrypt_init) (EVP_PKEY_CTX *ctx),
                                int (**pdecrypt) (EVP_PKEY_CTX *ctx,
                                                  unsigned char *out,
@@ -1604,32 +1604,32 @@ void EVP_PKEY_meth_get_decrypt(const EVP_PKEY_METHOD *pmeth,
                                                  const unsigned char *in,
                                                  size_t inlen));
 
-void EVP_PKEY_meth_get_derive(const EVP_PKEY_METHOD *pmeth,
+void __cdecl EVP_PKEY_meth_get_derive(const EVP_PKEY_METHOD *pmeth,
                               int (**pderive_init) (EVP_PKEY_CTX *ctx),
                               int (**pderive) (EVP_PKEY_CTX *ctx,
                                                unsigned char *key,
                                                size_t *keylen));
 
-void EVP_PKEY_meth_get_ctrl(const EVP_PKEY_METHOD *pmeth,
+void __cdecl EVP_PKEY_meth_get_ctrl(const EVP_PKEY_METHOD *pmeth,
                             int (**pctrl) (EVP_PKEY_CTX *ctx, int type, int p1,
                                            void *p2),
                             int (**pctrl_str) (EVP_PKEY_CTX *ctx,
                                                const char *type,
                                                const char *value));
 
-void EVP_PKEY_meth_get_check(const EVP_PKEY_METHOD *pmeth,
+void __cdecl EVP_PKEY_meth_get_check(const EVP_PKEY_METHOD *pmeth,
                              int (**pcheck) (EVP_PKEY *pkey));
 
-void EVP_PKEY_meth_get_public_check(const EVP_PKEY_METHOD *pmeth,
+void __cdecl EVP_PKEY_meth_get_public_check(const EVP_PKEY_METHOD *pmeth,
                                     int (**pcheck) (EVP_PKEY *pkey));
 
-void EVP_PKEY_meth_get_param_check(const EVP_PKEY_METHOD *pmeth,
+void __cdecl EVP_PKEY_meth_get_param_check(const EVP_PKEY_METHOD *pmeth,
                                    int (**pcheck) (EVP_PKEY *pkey));
 
-void EVP_PKEY_meth_get_digest_custom(EVP_PKEY_METHOD *pmeth,
+void __cdecl EVP_PKEY_meth_get_digest_custom(EVP_PKEY_METHOD *pmeth,
                                      int (**pdigest_custom) (EVP_PKEY_CTX *ctx,
                                                              EVP_MD_CTX *mctx));
-void EVP_add_alg_module(void);
+void __cdecl EVP_add_alg_module(void);
 
 
 # ifdef  __cplusplus
diff --git a/include/openssl/evperr.h b/include/openssl/evperr.h
index 6a651f5563..31d3100dfb 100644
--- a/include/openssl/evperr.h
+++ b/include/openssl/evperr.h
@@ -18,7 +18,7 @@
 # ifdef  __cplusplus
 extern "C"
 # endif
-int ERR_load_EVP_strings(void);
+int __cdecl ERR_load_EVP_strings(void);
 
 /*
  * EVP function codes.
diff --git a/include/openssl/hmac.h b/include/openssl/hmac.h
index 458efc1d51..835a686408 100644
--- a/include/openssl/hmac.h
+++ b/include/openssl/hmac.h
@@ -22,27 +22,27 @@
 extern "C" {
 #endif
 
-size_t HMAC_size(const HMAC_CTX *e);
-HMAC_CTX *HMAC_CTX_new(void);
-int HMAC_CTX_reset(HMAC_CTX *ctx);
-void HMAC_CTX_free(HMAC_CTX *ctx);
+size_t __cdecl HMAC_size(const HMAC_CTX *e);
+HMAC_CTX * __cdecl HMAC_CTX_new(void);
+int __cdecl HMAC_CTX_reset(HMAC_CTX *ctx);
+void __cdecl HMAC_CTX_free(HMAC_CTX *ctx);
 
 DEPRECATEDIN_1_1_0(__owur int HMAC_Init(HMAC_CTX *ctx, const void *key, int len,
                      const EVP_MD *md))
 
-/*__owur*/ int HMAC_Init_ex(HMAC_CTX *ctx, const void *key, int len,
+/*__owur*/ int __cdecl HMAC_Init_ex(HMAC_CTX *ctx, const void *key, int len,
                             const EVP_MD *md, ENGINE *impl);
-/*__owur*/ int HMAC_Update(HMAC_CTX *ctx, const unsigned char *data,
+/*__owur*/ int __cdecl HMAC_Update(HMAC_CTX *ctx, const unsigned char *data,
                            size_t len);
-/*__owur*/ int HMAC_Final(HMAC_CTX *ctx, unsigned char *md,
+/*__owur*/ int __cdecl HMAC_Final(HMAC_CTX *ctx, unsigned char *md,
                           unsigned int *len);
-unsigned char *HMAC(const EVP_MD *evp_md, const void *key, int key_len,
+unsigned char * __cdecl HMAC(const EVP_MD *evp_md, const void *key, int key_len,
                     const unsigned char *d, size_t n, unsigned char *md,
                     unsigned int *md_len);
-__owur int HMAC_CTX_copy(HMAC_CTX *dctx, HMAC_CTX *sctx);
+__owur int __cdecl HMAC_CTX_copy(HMAC_CTX *dctx, HMAC_CTX *sctx);
 
-void HMAC_CTX_set_flags(HMAC_CTX *ctx, unsigned long flags);
-const EVP_MD *HMAC_CTX_get_md(const HMAC_CTX *ctx);
+void __cdecl HMAC_CTX_set_flags(HMAC_CTX *ctx, unsigned long flags);
+const EVP_MD * __cdecl HMAC_CTX_get_md(const HMAC_CTX *ctx);
 
 #ifdef  __cplusplus
 }
diff --git a/include/openssl/idea.h b/include/openssl/idea.h
index 4334f3ea71..6b55edea2d 100644
--- a/include/openssl/idea.h
+++ b/include/openssl/idea.h
@@ -29,21 +29,21 @@ typedef struct idea_key_st {
     IDEA_INT data[9][6];
 } IDEA_KEY_SCHEDULE;
 
-const char *IDEA_options(void);
-void IDEA_ecb_encrypt(const unsigned char *in, unsigned char *out,
+const char * __cdecl IDEA_options(void);
+void __cdecl IDEA_ecb_encrypt(const unsigned char *in, unsigned char *out,
                       IDEA_KEY_SCHEDULE *ks);
-void IDEA_set_encrypt_key(const unsigned char *key, IDEA_KEY_SCHEDULE *ks);
-void IDEA_set_decrypt_key(IDEA_KEY_SCHEDULE *ek, IDEA_KEY_SCHEDULE *dk);
-void IDEA_cbc_encrypt(const unsigned char *in, unsigned char *out,
+void __cdecl IDEA_set_encrypt_key(const unsigned char *key, IDEA_KEY_SCHEDULE *ks);
+void __cdecl IDEA_set_decrypt_key(IDEA_KEY_SCHEDULE *ek, IDEA_KEY_SCHEDULE *dk);
+void __cdecl IDEA_cbc_encrypt(const unsigned char *in, unsigned char *out,
                       long length, IDEA_KEY_SCHEDULE *ks, unsigned char *iv,
                       int enc);
-void IDEA_cfb64_encrypt(const unsigned char *in, unsigned char *out,
+void __cdecl IDEA_cfb64_encrypt(const unsigned char *in, unsigned char *out,
                         long length, IDEA_KEY_SCHEDULE *ks, unsigned char *iv,
                         int *num, int enc);
-void IDEA_ofb64_encrypt(const unsigned char *in, unsigned char *out,
+void __cdecl IDEA_ofb64_encrypt(const unsigned char *in, unsigned char *out,
                         long length, IDEA_KEY_SCHEDULE *ks, unsigned char *iv,
                         int *num);
-void IDEA_encrypt(unsigned long *in, IDEA_KEY_SCHEDULE *ks);
+void __cdecl IDEA_encrypt(unsigned long *in, IDEA_KEY_SCHEDULE *ks);
 
 # if OPENSSL_API_COMPAT < 0x10100000L
 #  define idea_options          IDEA_options
diff --git a/include/openssl/kdferr.h b/include/openssl/kdferr.h
index 3f51bd0228..1b9a66a755 100644
--- a/include/openssl/kdferr.h
+++ b/include/openssl/kdferr.h
@@ -18,7 +18,7 @@
 # ifdef  __cplusplus
 extern "C"
 # endif
-int ERR_load_KDF_strings(void);
+int __cdecl ERR_load_KDF_strings(void);
 
 /*
  * KDF function codes.
diff --git a/include/openssl/lhash.h b/include/openssl/lhash.h
index 47b99d17fb..38eafe3c18 100644
--- a/include/openssl/lhash.h
+++ b/include/openssl/lhash.h
@@ -69,27 +69,27 @@ typedef struct lhash_st OPENSSL_LHASH;
 
 # define LH_LOAD_MULT    256
 
-int OPENSSL_LH_error(OPENSSL_LHASH *lh);
-OPENSSL_LHASH *OPENSSL_LH_new(OPENSSL_LH_HASHFUNC h, OPENSSL_LH_COMPFUNC c);
-void OPENSSL_LH_free(OPENSSL_LHASH *lh);
-void *OPENSSL_LH_insert(OPENSSL_LHASH *lh, void *data);
-void *OPENSSL_LH_delete(OPENSSL_LHASH *lh, const void *data);
-void *OPENSSL_LH_retrieve(OPENSSL_LHASH *lh, const void *data);
-void OPENSSL_LH_doall(OPENSSL_LHASH *lh, OPENSSL_LH_DOALL_FUNC func);
-void OPENSSL_LH_doall_arg(OPENSSL_LHASH *lh, OPENSSL_LH_DOALL_FUNCARG func, void *arg);
-unsigned long OPENSSL_LH_strhash(const char *c);
-unsigned long OPENSSL_LH_num_items(const OPENSSL_LHASH *lh);
-unsigned long OPENSSL_LH_get_down_load(const OPENSSL_LHASH *lh);
-void OPENSSL_LH_set_down_load(OPENSSL_LHASH *lh, unsigned long down_load);
+int __cdecl OPENSSL_LH_error(OPENSSL_LHASH *lh);
+OPENSSL_LHASH * __cdecl OPENSSL_LH_new(OPENSSL_LH_HASHFUNC h, OPENSSL_LH_COMPFUNC c);
+void __cdecl OPENSSL_LH_free(OPENSSL_LHASH *lh);
+void * __cdecl OPENSSL_LH_insert(OPENSSL_LHASH *lh, void *data);
+void * __cdecl OPENSSL_LH_delete(OPENSSL_LHASH *lh, const void *data);
+void * __cdecl OPENSSL_LH_retrieve(OPENSSL_LHASH *lh, const void *data);
+void __cdecl OPENSSL_LH_doall(OPENSSL_LHASH *lh, OPENSSL_LH_DOALL_FUNC func);
+void __cdecl OPENSSL_LH_doall_arg(OPENSSL_LHASH *lh, OPENSSL_LH_DOALL_FUNCARG func, void *arg);
+unsigned long __cdecl OPENSSL_LH_strhash(const char *c);
+unsigned long __cdecl OPENSSL_LH_num_items(const OPENSSL_LHASH *lh);
+unsigned long __cdecl OPENSSL_LH_get_down_load(const OPENSSL_LHASH *lh);
+void __cdecl OPENSSL_LH_set_down_load(OPENSSL_LHASH *lh, unsigned long down_load);
 
 # ifndef OPENSSL_NO_STDIO
-void OPENSSL_LH_stats(const OPENSSL_LHASH *lh, FILE *fp);
-void OPENSSL_LH_node_stats(const OPENSSL_LHASH *lh, FILE *fp);
-void OPENSSL_LH_node_usage_stats(const OPENSSL_LHASH *lh, FILE *fp);
+void __cdecl OPENSSL_LH_stats(const OPENSSL_LHASH *lh, FILE *fp);
+void __cdecl OPENSSL_LH_node_stats(const OPENSSL_LHASH *lh, FILE *fp);
+void __cdecl OPENSSL_LH_node_usage_stats(const OPENSSL_LHASH *lh, FILE *fp);
 # endif
-void OPENSSL_LH_stats_bio(const OPENSSL_LHASH *lh, BIO *out);
-void OPENSSL_LH_node_stats_bio(const OPENSSL_LHASH *lh, BIO *out);
-void OPENSSL_LH_node_usage_stats_bio(const OPENSSL_LHASH *lh, BIO *out);
+void __cdecl OPENSSL_LH_stats_bio(const OPENSSL_LHASH *lh, BIO *out);
+void __cdecl OPENSSL_LH_node_stats_bio(const OPENSSL_LHASH *lh, BIO *out);
+void __cdecl OPENSSL_LH_node_usage_stats_bio(const OPENSSL_LHASH *lh, BIO *out);
 
 # if OPENSSL_API_COMPAT < 0x10100000L
 #  define _LHASH OPENSSL_LHASH
@@ -122,7 +122,7 @@ void OPENSSL_LH_node_usage_stats_bio(const OPENSSL_LHASH *lh, BIO *out);
     LHASH_OF(type) { union lh_##type##_dummy { void* d1; unsigned long d2; int d3; } dummy; }; \
     static ossl_inline LHASH_OF(type) * \
         lh_##type##_new(unsigned long (*hfn)(const type *), \
-                        int (*cfn)(const type *, const type *)) \
+                        int (__cdecl *cfn)(const type *, const type *)) \
     { \
         return (LHASH_OF(type) *) \
             OPENSSL_LH_new((OPENSSL_LH_HASHFUNC)hfn, (OPENSSL_LH_COMPFUNC)cfn); \
diff --git a/include/openssl/md2.h b/include/openssl/md2.h
index 7faf8e3d65..597613226d 100644
--- a/include/openssl/md2.h
+++ b/include/openssl/md2.h
@@ -30,11 +30,11 @@ typedef struct MD2state_st {
     MD2_INT state[MD2_BLOCK];
 } MD2_CTX;
 
-const char *MD2_options(void);
-int MD2_Init(MD2_CTX *c);
-int MD2_Update(MD2_CTX *c, const unsigned char *data, size_t len);
-int MD2_Final(unsigned char *md, MD2_CTX *c);
-unsigned char *MD2(const unsigned char *d, size_t n, unsigned char *md);
+const char * __cdecl MD2_options(void);
+int __cdecl MD2_Init(MD2_CTX *c);
+int __cdecl MD2_Update(MD2_CTX *c, const unsigned char *data, size_t len);
+int __cdecl MD2_Final(unsigned char *md, MD2_CTX *c);
+unsigned char * __cdecl MD2(const unsigned char *d, size_t n, unsigned char *md);
 
 # ifdef  __cplusplus
 }
diff --git a/include/openssl/md4.h b/include/openssl/md4.h
index 940e29db40..72d0e4bad9 100644
--- a/include/openssl/md4.h
+++ b/include/openssl/md4.h
@@ -37,11 +37,11 @@ typedef struct MD4state_st {
     unsigned int num;
 } MD4_CTX;
 
-int MD4_Init(MD4_CTX *c);
-int MD4_Update(MD4_CTX *c, const void *data, size_t len);
-int MD4_Final(unsigned char *md, MD4_CTX *c);
-unsigned char *MD4(const unsigned char *d, size_t n, unsigned char *md);
-void MD4_Transform(MD4_CTX *c, const unsigned char *b);
+int __cdecl MD4_Init(MD4_CTX *c);
+int __cdecl MD4_Update(MD4_CTX *c, const void *data, size_t len);
+int __cdecl MD4_Final(unsigned char *md, MD4_CTX *c);
+unsigned char * __cdecl MD4(const unsigned char *d, size_t n, unsigned char *md);
+void __cdecl MD4_Transform(MD4_CTX *c, const unsigned char *b);
 
 # ifdef  __cplusplus
 }
diff --git a/include/openssl/md5.h b/include/openssl/md5.h
index 2deb772118..2a8761ce9e 100644
--- a/include/openssl/md5.h
+++ b/include/openssl/md5.h
@@ -37,11 +37,11 @@ typedef struct MD5state_st {
     unsigned int num;
 } MD5_CTX;
 
-int MD5_Init(MD5_CTX *c);
-int MD5_Update(MD5_CTX *c, const void *data, size_t len);
-int MD5_Final(unsigned char *md, MD5_CTX *c);
-unsigned char *MD5(const unsigned char *d, size_t n, unsigned char *md);
-void MD5_Transform(MD5_CTX *c, const unsigned char *b);
+int __cdecl MD5_Init(MD5_CTX *c);
+int __cdecl MD5_Update(MD5_CTX *c, const void *data, size_t len);
+int __cdecl MD5_Final(unsigned char *md, MD5_CTX *c);
+unsigned char * __cdecl MD5(const unsigned char *d, size_t n, unsigned char *md);
+void __cdecl MD5_Transform(MD5_CTX *c, const unsigned char *b);
 # ifdef  __cplusplus
 }
 # endif
diff --git a/include/openssl/mdc2.h b/include/openssl/mdc2.h
index aabd2bfaad..d10b60aa7b 100644
--- a/include/openssl/mdc2.h
+++ b/include/openssl/mdc2.h
@@ -29,10 +29,10 @@ typedef struct mdc2_ctx_st {
     int pad_type;               /* either 1 or 2, default 1 */
 } MDC2_CTX;
 
-int MDC2_Init(MDC2_CTX *c);
-int MDC2_Update(MDC2_CTX *c, const unsigned char *data, size_t len);
-int MDC2_Final(unsigned char *md, MDC2_CTX *c);
-unsigned char *MDC2(const unsigned char *d, size_t n, unsigned char *md);
+int __cdecl MDC2_Init(MDC2_CTX *c);
+int __cdecl MDC2_Update(MDC2_CTX *c, const unsigned char *data, size_t len);
+int __cdecl MDC2_Final(unsigned char *md, MDC2_CTX *c);
+unsigned char * __cdecl MDC2(const unsigned char *d, size_t n, unsigned char *md);
 
 # ifdef  __cplusplus
 }
diff --git a/include/openssl/modes.h b/include/openssl/modes.h
index d544f98d55..e15ef42843 100644
--- a/include/openssl/modes.h
+++ b/include/openssl/modes.h
@@ -31,141 +31,141 @@ typedef void (*ccm128_f) (const unsigned char *in, unsigned char *out,
                           const unsigned char ivec[16],
                           unsigned char cmac[16]);
 
-void CRYPTO_cbc128_encrypt(const unsigned char *in, unsigned char *out,
+void __cdecl CRYPTO_cbc128_encrypt(const unsigned char *in, unsigned char *out,
                            size_t len, const void *key,
                            unsigned char ivec[16], block128_f block);
-void CRYPTO_cbc128_decrypt(const unsigned char *in, unsigned char *out,
+void __cdecl CRYPTO_cbc128_decrypt(const unsigned char *in, unsigned char *out,
                            size_t len, const void *key,
                            unsigned char ivec[16], block128_f block);
 
-void CRYPTO_ctr128_encrypt(const unsigned char *in, unsigned char *out,
+void __cdecl CRYPTO_ctr128_encrypt(const unsigned char *in, unsigned char *out,
                            size_t len, const void *key,
                            unsigned char ivec[16],
                            unsigned char ecount_buf[16], unsigned int *num,
                            block128_f block);
 
-void CRYPTO_ctr128_encrypt_ctr32(const unsigned char *in, unsigned char *out,
+void __cdecl CRYPTO_ctr128_encrypt_ctr32(const unsigned char *in, unsigned char *out,
                                  size_t len, const void *key,
                                  unsigned char ivec[16],
                                  unsigned char ecount_buf[16],
                                  unsigned int *num, ctr128_f ctr);
 
-void CRYPTO_ofb128_encrypt(const unsigned char *in, unsigned char *out,
+void __cdecl CRYPTO_ofb128_encrypt(const unsigned char *in, unsigned char *out,
                            size_t len, const void *key,
                            unsigned char ivec[16], int *num,
                            block128_f block);
 
-void CRYPTO_cfb128_encrypt(const unsigned char *in, unsigned char *out,
+void __cdecl CRYPTO_cfb128_encrypt(const unsigned char *in, unsigned char *out,
                            size_t len, const void *key,
                            unsigned char ivec[16], int *num,
                            int enc, block128_f block);
-void CRYPTO_cfb128_8_encrypt(const unsigned char *in, unsigned char *out,
+void __cdecl CRYPTO_cfb128_8_encrypt(const unsigned char *in, unsigned char *out,
                              size_t length, const void *key,
                              unsigned char ivec[16], int *num,
                              int enc, block128_f block);
-void CRYPTO_cfb128_1_encrypt(const unsigned char *in, unsigned char *out,
+void __cdecl CRYPTO_cfb128_1_encrypt(const unsigned char *in, unsigned char *out,
                              size_t bits, const void *key,
                              unsigned char ivec[16], int *num,
                              int enc, block128_f block);
 
-size_t CRYPTO_cts128_encrypt_block(const unsigned char *in,
+size_t __cdecl CRYPTO_cts128_encrypt_block(const unsigned char *in,
                                    unsigned char *out, size_t len,
                                    const void *key, unsigned char ivec[16],
                                    block128_f block);
-size_t CRYPTO_cts128_encrypt(const unsigned char *in, unsigned char *out,
+size_t __cdecl CRYPTO_cts128_encrypt(const unsigned char *in, unsigned char *out,
                              size_t len, const void *key,
                              unsigned char ivec[16], cbc128_f cbc);
-size_t CRYPTO_cts128_decrypt_block(const unsigned char *in,
+size_t __cdecl CRYPTO_cts128_decrypt_block(const unsigned char *in,
                                    unsigned char *out, size_t len,
                                    const void *key, unsigned char ivec[16],
                                    block128_f block);
-size_t CRYPTO_cts128_decrypt(const unsigned char *in, unsigned char *out,
+size_t __cdecl CRYPTO_cts128_decrypt(const unsigned char *in, unsigned char *out,
                              size_t len, const void *key,
                              unsigned char ivec[16], cbc128_f cbc);
 
-size_t CRYPTO_nistcts128_encrypt_block(const unsigned char *in,
+size_t __cdecl CRYPTO_nistcts128_encrypt_block(const unsigned char *in,
                                        unsigned char *out, size_t len,
                                        const void *key,
                                        unsigned char ivec[16],
                                        block128_f block);
-size_t CRYPTO_nistcts128_encrypt(const unsigned char *in, unsigned char *out,
+size_t __cdecl CRYPTO_nistcts128_encrypt(const unsigned char *in, unsigned char *out,
                                  size_t len, const void *key,
                                  unsigned char ivec[16], cbc128_f cbc);
-size_t CRYPTO_nistcts128_decrypt_block(const unsigned char *in,
+size_t __cdecl CRYPTO_nistcts128_decrypt_block(const unsigned char *in,
                                        unsigned char *out, size_t len,
                                        const void *key,
                                        unsigned char ivec[16],
                                        block128_f block);
-size_t CRYPTO_nistcts128_decrypt(const unsigned char *in, unsigned char *out,
+size_t __cdecl CRYPTO_nistcts128_decrypt(const unsigned char *in, unsigned char *out,
                                  size_t len, const void *key,
                                  unsigned char ivec[16], cbc128_f cbc);
 
 typedef struct gcm128_context GCM128_CONTEXT;
 
-GCM128_CONTEXT *CRYPTO_gcm128_new(void *key, block128_f block);
-void CRYPTO_gcm128_init(GCM128_CONTEXT *ctx, void *key, block128_f block);
-void CRYPTO_gcm128_setiv(GCM128_CONTEXT *ctx, const unsigned char *iv,
+GCM128_CONTEXT * __cdecl CRYPTO_gcm128_new(void *key, block128_f block);
+void __cdecl CRYPTO_gcm128_init(GCM128_CONTEXT *ctx, void *key, block128_f block);
+void __cdecl CRYPTO_gcm128_setiv(GCM128_CONTEXT *ctx, const unsigned char *iv,
                          size_t len);
-int CRYPTO_gcm128_aad(GCM128_CONTEXT *ctx, const unsigned char *aad,
+int __cdecl CRYPTO_gcm128_aad(GCM128_CONTEXT *ctx, const unsigned char *aad,
                       size_t len);
-int CRYPTO_gcm128_encrypt(GCM128_CONTEXT *ctx,
+int __cdecl CRYPTO_gcm128_encrypt(GCM128_CONTEXT *ctx,
                           const unsigned char *in, unsigned char *out,
                           size_t len);
-int CRYPTO_gcm128_decrypt(GCM128_CONTEXT *ctx,
+int __cdecl CRYPTO_gcm128_decrypt(GCM128_CONTEXT *ctx,
                           const unsigned char *in, unsigned char *out,
                           size_t len);
-int CRYPTO_gcm128_encrypt_ctr32(GCM128_CONTEXT *ctx,
+int __cdecl CRYPTO_gcm128_encrypt_ctr32(GCM128_CONTEXT *ctx,
                                 const unsigned char *in, unsigned char *out,
                                 size_t len, ctr128_f stream);
-int CRYPTO_gcm128_decrypt_ctr32(GCM128_CONTEXT *ctx,
+int __cdecl CRYPTO_gcm128_decrypt_ctr32(GCM128_CONTEXT *ctx,
                                 const unsigned char *in, unsigned char *out,
                                 size_t len, ctr128_f stream);
-int CRYPTO_gcm128_finish(GCM128_CONTEXT *ctx, const unsigned char *tag,
+int __cdecl CRYPTO_gcm128_finish(GCM128_CONTEXT *ctx, const unsigned char *tag,
                          size_t len);
-void CRYPTO_gcm128_tag(GCM128_CONTEXT *ctx, unsigned char *tag, size_t len);
-void CRYPTO_gcm128_release(GCM128_CONTEXT *ctx);
+void __cdecl CRYPTO_gcm128_tag(GCM128_CONTEXT *ctx, unsigned char *tag, size_t len);
+void __cdecl CRYPTO_gcm128_release(GCM128_CONTEXT *ctx);
 
 typedef struct ccm128_context CCM128_CONTEXT;
 
-void CRYPTO_ccm128_init(CCM128_CONTEXT *ctx,
+void __cdecl CRYPTO_ccm128_init(CCM128_CONTEXT *ctx,
                         unsigned int M, unsigned int L, void *key,
                         block128_f block);
-int CRYPTO_ccm128_setiv(CCM128_CONTEXT *ctx, const unsigned char *nonce,
+int __cdecl CRYPTO_ccm128_setiv(CCM128_CONTEXT *ctx, const unsigned char *nonce,
                         size_t nlen, size_t mlen);
-void CRYPTO_ccm128_aad(CCM128_CONTEXT *ctx, const unsigned char *aad,
+void __cdecl CRYPTO_ccm128_aad(CCM128_CONTEXT *ctx, const unsigned char *aad,
                        size_t alen);
-int CRYPTO_ccm128_encrypt(CCM128_CONTEXT *ctx, const unsigned char *inp,
+int __cdecl CRYPTO_ccm128_encrypt(CCM128_CONTEXT *ctx, const unsigned char *inp,
                           unsigned char *out, size_t len);
-int CRYPTO_ccm128_decrypt(CCM128_CONTEXT *ctx, const unsigned char *inp,
+int __cdecl CRYPTO_ccm128_decrypt(CCM128_CONTEXT *ctx, const unsigned char *inp,
                           unsigned char *out, size_t len);
-int CRYPTO_ccm128_encrypt_ccm64(CCM128_CONTEXT *ctx, const unsigned char *inp,
+int __cdecl CRYPTO_ccm128_encrypt_ccm64(CCM128_CONTEXT *ctx, const unsigned char *inp,
                                 unsigned char *out, size_t len,
                                 ccm128_f stream);
-int CRYPTO_ccm128_decrypt_ccm64(CCM128_CONTEXT *ctx, const unsigned char *inp,
+int __cdecl CRYPTO_ccm128_decrypt_ccm64(CCM128_CONTEXT *ctx, const unsigned char *inp,
                                 unsigned char *out, size_t len,
                                 ccm128_f stream);
-size_t CRYPTO_ccm128_tag(CCM128_CONTEXT *ctx, unsigned char *tag, size_t len);
+size_t __cdecl CRYPTO_ccm128_tag(CCM128_CONTEXT *ctx, unsigned char *tag, size_t len);
 
 typedef struct xts128_context XTS128_CONTEXT;
 
-int CRYPTO_xts128_encrypt(const XTS128_CONTEXT *ctx,
+int __cdecl CRYPTO_xts128_encrypt(const XTS128_CONTEXT *ctx,
                           const unsigned char iv[16],
                           const unsigned char *inp, unsigned char *out,
                           size_t len, int enc);
 
-size_t CRYPTO_128_wrap(void *key, const unsigned char *iv,
+size_t __cdecl CRYPTO_128_wrap(void *key, const unsigned char *iv,
                        unsigned char *out,
                        const unsigned char *in, size_t inlen,
                        block128_f block);
 
-size_t CRYPTO_128_unwrap(void *key, const unsigned char *iv,
+size_t __cdecl CRYPTO_128_unwrap(void *key, const unsigned char *iv,
                          unsigned char *out,
                          const unsigned char *in, size_t inlen,
                          block128_f block);
-size_t CRYPTO_128_wrap_pad(void *key, const unsigned char *icv,
+size_t __cdecl CRYPTO_128_wrap_pad(void *key, const unsigned char *icv,
                            unsigned char *out, const unsigned char *in,
                            size_t inlen, block128_f block);
-size_t CRYPTO_128_unwrap_pad(void *key, const unsigned char *icv,
+size_t __cdecl CRYPTO_128_unwrap_pad(void *key, const unsigned char *icv,
                              unsigned char *out, const unsigned char *in,
                              size_t inlen, block128_f block);
 
@@ -179,26 +179,26 @@ typedef void (*ocb128_f) (const unsigned char *in, unsigned char *out,
                           const unsigned char L_[][16],
                           unsigned char checksum[16]);
 
-OCB128_CONTEXT *CRYPTO_ocb128_new(void *keyenc, void *keydec,
+OCB128_CONTEXT * __cdecl CRYPTO_ocb128_new(void *keyenc, void *keydec,
                                   block128_f encrypt, block128_f decrypt,
                                   ocb128_f stream);
-int CRYPTO_ocb128_init(OCB128_CONTEXT *ctx, void *keyenc, void *keydec,
+int __cdecl CRYPTO_ocb128_init(OCB128_CONTEXT *ctx, void *keyenc, void *keydec,
                        block128_f encrypt, block128_f decrypt,
                        ocb128_f stream);
-int CRYPTO_ocb128_copy_ctx(OCB128_CONTEXT *dest, OCB128_CONTEXT *src,
+int __cdecl CRYPTO_ocb128_copy_ctx(OCB128_CONTEXT *dest, OCB128_CONTEXT *src,
                            void *keyenc, void *keydec);
-int CRYPTO_ocb128_setiv(OCB128_CONTEXT *ctx, const unsigned char *iv,
+int __cdecl CRYPTO_ocb128_setiv(OCB128_CONTEXT *ctx, const unsigned char *iv,
                         size_t len, size_t taglen);
-int CRYPTO_ocb128_aad(OCB128_CONTEXT *ctx, const unsigned char *aad,
+int __cdecl CRYPTO_ocb128_aad(OCB128_CONTEXT *ctx, const unsigned char *aad,
                       size_t len);
-int CRYPTO_ocb128_encrypt(OCB128_CONTEXT *ctx, const unsigned char *in,
+int __cdecl CRYPTO_ocb128_encrypt(OCB128_CONTEXT *ctx, const unsigned char *in,
                           unsigned char *out, size_t len);
-int CRYPTO_ocb128_decrypt(OCB128_CONTEXT *ctx, const unsigned char *in,
+int __cdecl CRYPTO_ocb128_decrypt(OCB128_CONTEXT *ctx, const unsigned char *in,
                           unsigned char *out, size_t len);
-int CRYPTO_ocb128_finish(OCB128_CONTEXT *ctx, const unsigned char *tag,
+int __cdecl CRYPTO_ocb128_finish(OCB128_CONTEXT *ctx, const unsigned char *tag,
                          size_t len);
-int CRYPTO_ocb128_tag(OCB128_CONTEXT *ctx, unsigned char *tag, size_t len);
-void CRYPTO_ocb128_cleanup(OCB128_CONTEXT *ctx);
+int __cdecl CRYPTO_ocb128_tag(OCB128_CONTEXT *ctx, unsigned char *tag, size_t len);
+void __cdecl CRYPTO_ocb128_cleanup(OCB128_CONTEXT *ctx);
 # endif                          /* OPENSSL_NO_OCB */
 
 # ifdef  __cplusplus
diff --git a/include/openssl/objects.h b/include/openssl/objects.h
index 5e8b5762f8..af71998db9 100644
--- a/include/openssl/objects.h
+++ b/include/openssl/objects.h
@@ -41,41 +41,41 @@ typedef struct obj_name_st {
 
 # define         OBJ_create_and_add_object(a,b,c) OBJ_create(a,b,c)
 
-int OBJ_NAME_init(void);
-int OBJ_NAME_new_index(unsigned long (*hash_func) (const char *),
-                       int (*cmp_func) (const char *, const char *),
+int __cdecl OBJ_NAME_init(void);
+int __cdecl OBJ_NAME_new_index(unsigned long (*hash_func) (const char *),
+                       int (__cdecl *cmp_func) (const char *, const char *),
                        void (*free_func) (const char *, int, const char *));
-const char *OBJ_NAME_get(const char *name, int type);
-int OBJ_NAME_add(const char *name, int type, const char *data);
-int OBJ_NAME_remove(const char *name, int type);
-void OBJ_NAME_cleanup(int type); /* -1 for everything */
-void OBJ_NAME_do_all(int type, void (*fn) (const OBJ_NAME *, void *arg),
+const char * __cdecl OBJ_NAME_get(const char *name, int type);
+int __cdecl OBJ_NAME_add(const char *name, int type, const char *data);
+int __cdecl OBJ_NAME_remove(const char *name, int type);
+void __cdecl OBJ_NAME_cleanup(int type); /* -1 for everything */
+void __cdecl OBJ_NAME_do_all(int type, void (*fn) (const OBJ_NAME *, void *arg),
                      void *arg);
-void OBJ_NAME_do_all_sorted(int type,
+void __cdecl OBJ_NAME_do_all_sorted(int type,
                             void (*fn) (const OBJ_NAME *, void *arg),
                             void *arg);
 
-ASN1_OBJECT *OBJ_dup(const ASN1_OBJECT *o);
-ASN1_OBJECT *OBJ_nid2obj(int n);
-const char *OBJ_nid2ln(int n);
-const char *OBJ_nid2sn(int n);
-int OBJ_obj2nid(const ASN1_OBJECT *o);
-ASN1_OBJECT *OBJ_txt2obj(const char *s, int no_name);
-int OBJ_obj2txt(char *buf, int buf_len, const ASN1_OBJECT *a, int no_name);
-int OBJ_txt2nid(const char *s);
-int OBJ_ln2nid(const char *s);
-int OBJ_sn2nid(const char *s);
-int OBJ_cmp(const ASN1_OBJECT *a, const ASN1_OBJECT *b);
-const void *OBJ_bsearch_(const void *key, const void *base, int num, int size,
-                         int (*cmp) (const void *, const void *));
-const void *OBJ_bsearch_ex_(const void *key, const void *base, int num,
+ASN1_OBJECT * __cdecl OBJ_dup(const ASN1_OBJECT *o);
+ASN1_OBJECT * __cdecl OBJ_nid2obj(int n);
+const char * __cdecl OBJ_nid2ln(int n);
+const char * __cdecl OBJ_nid2sn(int n);
+int __cdecl OBJ_obj2nid(const ASN1_OBJECT *o);
+ASN1_OBJECT * __cdecl OBJ_txt2obj(const char *s, int no_name);
+int __cdecl OBJ_obj2txt(char *buf, int buf_len, const ASN1_OBJECT *a, int no_name);
+int __cdecl OBJ_txt2nid(const char *s);
+int __cdecl OBJ_ln2nid(const char *s);
+int __cdecl OBJ_sn2nid(const char *s);
+int __cdecl OBJ_cmp(const ASN1_OBJECT *a, const ASN1_OBJECT *b);
+const void * __cdecl OBJ_bsearch_(const void *key, const void *base, int num, int size,
+                         int (__cdecl *cmp) (const void *, const void *));
+const void * __cdecl OBJ_bsearch_ex_(const void *key, const void *base, int num,
                             int size,
-                            int (*cmp) (const void *, const void *),
+                            int (__cdecl *cmp) (const void *, const void *),
                             int flags);
 
 # define _DECLARE_OBJ_BSEARCH_CMP_FN(scope, type1, type2, nm)    \
-  static int nm##_cmp_BSEARCH_CMP_FN(const void *, const void *); \
-  static int nm##_cmp(type1 const *, type2 const *); \
+  static int __cdecl nm##_cmp_BSEARCH_CMP_FN(const void *, const void *); \
+  static int __cdecl nm##_cmp(type1 const *, type2 const *); \
   scope type2 * OBJ_bsearch_##nm(type1 *key, type2 const *base, int num)
 
 # define DECLARE_OBJ_BSEARCH_CMP_FN(type1, type2, cmp)   \
@@ -111,7 +111,7 @@ const void *OBJ_bsearch_ex_(const void *key, const void *base, int num,
  */
 
 # define IMPLEMENT_OBJ_BSEARCH_CMP_FN(type1, type2, nm)  \
-  static int nm##_cmp_BSEARCH_CMP_FN(const void *a_, const void *b_)    \
+  static int __cdecl nm##_cmp_BSEARCH_CMP_FN(const void *a_, const void *b_)    \
       { \
       type1 const *a = a_; \
       type2 const *b = b_; \
@@ -125,7 +125,7 @@ const void *OBJ_bsearch_ex_(const void *key, const void *base, int num,
       extern void dummy_prototype(void)
 
 # define IMPLEMENT_OBJ_BSEARCH_GLOBAL_CMP_FN(type1, type2, nm)   \
-  static int nm##_cmp_BSEARCH_CMP_FN(const void *a_, const void *b_)    \
+  static int __cdecl nm##_cmp_BSEARCH_CMP_FN(const void *a_, const void *b_)    \
       { \
       type1 const *a = a_; \
       type2 const *b = b_; \
@@ -152,21 +152,21 @@ const void *OBJ_bsearch_ex_(const void *key, const void *base, int num,
                           (void)type_2=CHECKED_PTR_OF(type2,cmp##_type_2), \
                           cmp##_BSEARCH_CMP_FN)),flags)
 
-int OBJ_new_nid(int num);
-int OBJ_add_object(const ASN1_OBJECT *obj);
-int OBJ_create(const char *oid, const char *sn, const char *ln);
+int __cdecl OBJ_new_nid(int num);
+int __cdecl OBJ_add_object(const ASN1_OBJECT *obj);
+int __cdecl OBJ_create(const char *oid, const char *sn, const char *ln);
 #if OPENSSL_API_COMPAT < 0x10100000L
 # define OBJ_cleanup() while(0) continue
 #endif
-int OBJ_create_objects(BIO *in);
+int __cdecl OBJ_create_objects(BIO *in);
 
-size_t OBJ_length(const ASN1_OBJECT *obj);
-const unsigned char *OBJ_get0_data(const ASN1_OBJECT *obj);
+size_t __cdecl OBJ_length(const ASN1_OBJECT *obj);
+const unsigned char * __cdecl OBJ_get0_data(const ASN1_OBJECT *obj);
 
-int OBJ_find_sigid_algs(int signid, int *pdig_nid, int *ppkey_nid);
-int OBJ_find_sigid_by_algs(int *psignid, int dig_nid, int pkey_nid);
-int OBJ_add_sigid(int signid, int dig_id, int pkey_id);
-void OBJ_sigid_free(void);
+int __cdecl OBJ_find_sigid_algs(int signid, int *pdig_nid, int *ppkey_nid);
+int __cdecl OBJ_find_sigid_by_algs(int *psignid, int dig_nid, int pkey_nid);
+int __cdecl OBJ_add_sigid(int signid, int dig_id, int pkey_id);
+void __cdecl OBJ_sigid_free(void);
 
 
 # ifdef  __cplusplus
diff --git a/include/openssl/objectserr.h b/include/openssl/objectserr.h
index 02e166f1ac..7888b96790 100644
--- a/include/openssl/objectserr.h
+++ b/include/openssl/objectserr.h
@@ -18,7 +18,7 @@
 # ifdef  __cplusplus
 extern "C"
 # endif
-int ERR_load_OBJ_strings(void);
+int __cdecl ERR_load_OBJ_strings(void);
 
 /*
  * OBJ function codes.
diff --git a/include/openssl/ocsp.h b/include/openssl/ocsp.h
index 8582fe1ee1..2ef8968d5e 100644
--- a/include/openssl/ocsp.h
+++ b/include/openssl/ocsp.h
@@ -146,177 +146,177 @@ typedef struct ocsp_service_locator_st OCSP_SERVICELOC;
                 (OCSP_CERTSTATUS*)ASN1_dup((int(*)())i2d_OCSP_CERTSTATUS,\
                 (char *(*)())d2i_OCSP_CERTSTATUS,(char *)(cs))
 
-OCSP_CERTID *OCSP_CERTID_dup(OCSP_CERTID *id);
+OCSP_CERTID * __cdecl OCSP_CERTID_dup(OCSP_CERTID *id);
 
-OCSP_RESPONSE *OCSP_sendreq_bio(BIO *b, const char *path, OCSP_REQUEST *req);
-OCSP_REQ_CTX *OCSP_sendreq_new(BIO *io, const char *path, OCSP_REQUEST *req,
+OCSP_RESPONSE * __cdecl OCSP_sendreq_bio(BIO *b, const char *path, OCSP_REQUEST *req);
+OCSP_REQ_CTX * __cdecl OCSP_sendreq_new(BIO *io, const char *path, OCSP_REQUEST *req,
                                int maxline);
-int OCSP_REQ_CTX_nbio(OCSP_REQ_CTX *rctx);
-int OCSP_sendreq_nbio(OCSP_RESPONSE **presp, OCSP_REQ_CTX *rctx);
-OCSP_REQ_CTX *OCSP_REQ_CTX_new(BIO *io, int maxline);
-void OCSP_REQ_CTX_free(OCSP_REQ_CTX *rctx);
-void OCSP_set_max_response_length(OCSP_REQ_CTX *rctx, unsigned long len);
-int OCSP_REQ_CTX_i2d(OCSP_REQ_CTX *rctx, const ASN1_ITEM *it,
+int __cdecl OCSP_REQ_CTX_nbio(OCSP_REQ_CTX *rctx);
+int __cdecl OCSP_sendreq_nbio(OCSP_RESPONSE **presp, OCSP_REQ_CTX *rctx);
+OCSP_REQ_CTX * __cdecl OCSP_REQ_CTX_new(BIO *io, int maxline);
+void __cdecl OCSP_REQ_CTX_free(OCSP_REQ_CTX *rctx);
+void __cdecl OCSP_set_max_response_length(OCSP_REQ_CTX *rctx, unsigned long len);
+int __cdecl OCSP_REQ_CTX_i2d(OCSP_REQ_CTX *rctx, const ASN1_ITEM *it,
                      ASN1_VALUE *val);
-int OCSP_REQ_CTX_nbio_d2i(OCSP_REQ_CTX *rctx, ASN1_VALUE **pval,
+int __cdecl OCSP_REQ_CTX_nbio_d2i(OCSP_REQ_CTX *rctx, ASN1_VALUE **pval,
                           const ASN1_ITEM *it);
-BIO *OCSP_REQ_CTX_get0_mem_bio(OCSP_REQ_CTX *rctx);
-int OCSP_REQ_CTX_http(OCSP_REQ_CTX *rctx, const char *op, const char *path);
-int OCSP_REQ_CTX_set1_req(OCSP_REQ_CTX *rctx, OCSP_REQUEST *req);
-int OCSP_REQ_CTX_add1_header(OCSP_REQ_CTX *rctx,
+BIO * __cdecl OCSP_REQ_CTX_get0_mem_bio(OCSP_REQ_CTX *rctx);
+int __cdecl OCSP_REQ_CTX_http(OCSP_REQ_CTX *rctx, const char *op, const char *path);
+int __cdecl OCSP_REQ_CTX_set1_req(OCSP_REQ_CTX *rctx, OCSP_REQUEST *req);
+int __cdecl OCSP_REQ_CTX_add1_header(OCSP_REQ_CTX *rctx,
                              const char *name, const char *value);
 
-OCSP_CERTID *OCSP_cert_to_id(const EVP_MD *dgst, const X509 *subject,
+OCSP_CERTID * __cdecl OCSP_cert_to_id(const EVP_MD *dgst, const X509 *subject,
                              const X509 *issuer);
 
-OCSP_CERTID *OCSP_cert_id_new(const EVP_MD *dgst,
+OCSP_CERTID * __cdecl OCSP_cert_id_new(const EVP_MD *dgst,
                               const X509_NAME *issuerName,
                               const ASN1_BIT_STRING *issuerKey,
                               const ASN1_INTEGER *serialNumber);
 
-OCSP_ONEREQ *OCSP_request_add0_id(OCSP_REQUEST *req, OCSP_CERTID *cid);
+OCSP_ONEREQ * __cdecl OCSP_request_add0_id(OCSP_REQUEST *req, OCSP_CERTID *cid);
 
-int OCSP_request_add1_nonce(OCSP_REQUEST *req, unsigned char *val, int len);
-int OCSP_basic_add1_nonce(OCSP_BASICRESP *resp, unsigned char *val, int len);
-int OCSP_check_nonce(OCSP_REQUEST *req, OCSP_BASICRESP *bs);
-int OCSP_copy_nonce(OCSP_BASICRESP *resp, OCSP_REQUEST *req);
+int __cdecl OCSP_request_add1_nonce(OCSP_REQUEST *req, unsigned char *val, int len);
+int __cdecl OCSP_basic_add1_nonce(OCSP_BASICRESP *resp, unsigned char *val, int len);
+int __cdecl OCSP_check_nonce(OCSP_REQUEST *req, OCSP_BASICRESP *bs);
+int __cdecl OCSP_copy_nonce(OCSP_BASICRESP *resp, OCSP_REQUEST *req);
 
-int OCSP_request_set1_name(OCSP_REQUEST *req, X509_NAME *nm);
-int OCSP_request_add1_cert(OCSP_REQUEST *req, X509 *cert);
+int __cdecl OCSP_request_set1_name(OCSP_REQUEST *req, X509_NAME *nm);
+int __cdecl OCSP_request_add1_cert(OCSP_REQUEST *req, X509 *cert);
 
-int OCSP_request_sign(OCSP_REQUEST *req,
+int __cdecl OCSP_request_sign(OCSP_REQUEST *req,
                       X509 *signer,
                       EVP_PKEY *key,
                       const EVP_MD *dgst,
                       STACK_OF(X509) *certs, unsigned long flags);
 
-int OCSP_response_status(OCSP_RESPONSE *resp);
-OCSP_BASICRESP *OCSP_response_get1_basic(OCSP_RESPONSE *resp);
+int __cdecl OCSP_response_status(OCSP_RESPONSE *resp);
+OCSP_BASICRESP * __cdecl OCSP_response_get1_basic(OCSP_RESPONSE *resp);
 
-const ASN1_OCTET_STRING *OCSP_resp_get0_signature(const OCSP_BASICRESP *bs);
-const X509_ALGOR *OCSP_resp_get0_tbs_sigalg(const OCSP_BASICRESP *bs);
-const OCSP_RESPDATA *OCSP_resp_get0_respdata(const OCSP_BASICRESP *bs);
-int OCSP_resp_get0_signer(OCSP_BASICRESP *bs, X509 **signer,
+const ASN1_OCTET_STRING * __cdecl OCSP_resp_get0_signature(const OCSP_BASICRESP *bs);
+const X509_ALGOR * __cdecl OCSP_resp_get0_tbs_sigalg(const OCSP_BASICRESP *bs);
+const OCSP_RESPDATA * __cdecl OCSP_resp_get0_respdata(const OCSP_BASICRESP *bs);
+int __cdecl OCSP_resp_get0_signer(OCSP_BASICRESP *bs, X509 **signer,
                           STACK_OF(X509) *extra_certs);
 
-int OCSP_resp_count(OCSP_BASICRESP *bs);
-OCSP_SINGLERESP *OCSP_resp_get0(OCSP_BASICRESP *bs, int idx);
-const ASN1_GENERALIZEDTIME *OCSP_resp_get0_produced_at(const OCSP_BASICRESP* bs);
-const STACK_OF(X509) *OCSP_resp_get0_certs(const OCSP_BASICRESP *bs);
-int OCSP_resp_get0_id(const OCSP_BASICRESP *bs,
+int __cdecl OCSP_resp_count(OCSP_BASICRESP *bs);
+OCSP_SINGLERESP * __cdecl OCSP_resp_get0(OCSP_BASICRESP *bs, int idx);
+const ASN1_GENERALIZEDTIME * __cdecl OCSP_resp_get0_produced_at(const OCSP_BASICRESP* bs);
+const STACK_OF(X509) * __cdecl OCSP_resp_get0_certs(const OCSP_BASICRESP *bs);
+int __cdecl OCSP_resp_get0_id(const OCSP_BASICRESP *bs,
                       const ASN1_OCTET_STRING **pid,
                       const X509_NAME **pname);
-int OCSP_resp_get1_id(const OCSP_BASICRESP *bs,
+int __cdecl OCSP_resp_get1_id(const OCSP_BASICRESP *bs,
                       ASN1_OCTET_STRING **pid,
                       X509_NAME **pname);
 
-int OCSP_resp_find(OCSP_BASICRESP *bs, OCSP_CERTID *id, int last);
-int OCSP_single_get0_status(OCSP_SINGLERESP *single, int *reason,
+int __cdecl OCSP_resp_find(OCSP_BASICRESP *bs, OCSP_CERTID *id, int last);
+int __cdecl OCSP_single_get0_status(OCSP_SINGLERESP *single, int *reason,
                             ASN1_GENERALIZEDTIME **revtime,
                             ASN1_GENERALIZEDTIME **thisupd,
                             ASN1_GENERALIZEDTIME **nextupd);
-int OCSP_resp_find_status(OCSP_BASICRESP *bs, OCSP_CERTID *id, int *status,
+int __cdecl OCSP_resp_find_status(OCSP_BASICRESP *bs, OCSP_CERTID *id, int *status,
                           int *reason,
                           ASN1_GENERALIZEDTIME **revtime,
                           ASN1_GENERALIZEDTIME **thisupd,
                           ASN1_GENERALIZEDTIME **nextupd);
-int OCSP_check_validity(ASN1_GENERALIZEDTIME *thisupd,
+int __cdecl OCSP_check_validity(ASN1_GENERALIZEDTIME *thisupd,
                         ASN1_GENERALIZEDTIME *nextupd, long sec, long maxsec);
 
-int OCSP_request_verify(OCSP_REQUEST *req, STACK_OF(X509) *certs,
+int __cdecl OCSP_request_verify(OCSP_REQUEST *req, STACK_OF(X509) *certs,
                         X509_STORE *store, unsigned long flags);
 
-int OCSP_parse_url(const char *url, char **phost, char **pport, char **ppath,
+int __cdecl OCSP_parse_url(const char *url, char **phost, char **pport, char **ppath,
                    int *pssl);
 
-int OCSP_id_issuer_cmp(const OCSP_CERTID *a, const OCSP_CERTID *b);
-int OCSP_id_cmp(const OCSP_CERTID *a, const OCSP_CERTID *b);
+int __cdecl OCSP_id_issuer_cmp(const OCSP_CERTID *a, const OCSP_CERTID *b);
+int __cdecl OCSP_id_cmp(const OCSP_CERTID *a, const OCSP_CERTID *b);
 
-int OCSP_request_onereq_count(OCSP_REQUEST *req);
-OCSP_ONEREQ *OCSP_request_onereq_get0(OCSP_REQUEST *req, int i);
-OCSP_CERTID *OCSP_onereq_get0_id(OCSP_ONEREQ *one);
-int OCSP_id_get0_info(ASN1_OCTET_STRING **piNameHash, ASN1_OBJECT **pmd,
+int __cdecl OCSP_request_onereq_count(OCSP_REQUEST *req);
+OCSP_ONEREQ * __cdecl OCSP_request_onereq_get0(OCSP_REQUEST *req, int i);
+OCSP_CERTID * __cdecl OCSP_onereq_get0_id(OCSP_ONEREQ *one);
+int __cdecl OCSP_id_get0_info(ASN1_OCTET_STRING **piNameHash, ASN1_OBJECT **pmd,
                       ASN1_OCTET_STRING **pikeyHash,
                       ASN1_INTEGER **pserial, OCSP_CERTID *cid);
-int OCSP_request_is_signed(OCSP_REQUEST *req);
-OCSP_RESPONSE *OCSP_response_create(int status, OCSP_BASICRESP *bs);
-OCSP_SINGLERESP *OCSP_basic_add1_status(OCSP_BASICRESP *rsp,
+int __cdecl OCSP_request_is_signed(OCSP_REQUEST *req);
+OCSP_RESPONSE * __cdecl OCSP_response_create(int status, OCSP_BASICRESP *bs);
+OCSP_SINGLERESP * __cdecl OCSP_basic_add1_status(OCSP_BASICRESP *rsp,
                                         OCSP_CERTID *cid,
                                         int status, int reason,
                                         ASN1_TIME *revtime,
                                         ASN1_TIME *thisupd,
                                         ASN1_TIME *nextupd);
-int OCSP_basic_add1_cert(OCSP_BASICRESP *resp, X509 *cert);
-int OCSP_basic_sign(OCSP_BASICRESP *brsp,
+int __cdecl OCSP_basic_add1_cert(OCSP_BASICRESP *resp, X509 *cert);
+int __cdecl OCSP_basic_sign(OCSP_BASICRESP *brsp,
                     X509 *signer, EVP_PKEY *key, const EVP_MD *dgst,
                     STACK_OF(X509) *certs, unsigned long flags);
-int OCSP_basic_sign_ctx(OCSP_BASICRESP *brsp,
+int __cdecl OCSP_basic_sign_ctx(OCSP_BASICRESP *brsp,
                         X509 *signer, EVP_MD_CTX *ctx,
                         STACK_OF(X509) *certs, unsigned long flags);
-int OCSP_RESPID_set_by_name(OCSP_RESPID *respid, X509 *cert);
-int OCSP_RESPID_set_by_key(OCSP_RESPID *respid, X509 *cert);
-int OCSP_RESPID_match(OCSP_RESPID *respid, X509 *cert);
+int __cdecl OCSP_RESPID_set_by_name(OCSP_RESPID *respid, X509 *cert);
+int __cdecl OCSP_RESPID_set_by_key(OCSP_RESPID *respid, X509 *cert);
+int __cdecl OCSP_RESPID_match(OCSP_RESPID *respid, X509 *cert);
 
-X509_EXTENSION *OCSP_crlID_new(const char *url, long *n, char *tim);
+X509_EXTENSION * __cdecl OCSP_crlID_new(const char *url, long *n, char *tim);
 
-X509_EXTENSION *OCSP_accept_responses_new(char **oids);
+X509_EXTENSION * __cdecl OCSP_accept_responses_new(char **oids);
 
-X509_EXTENSION *OCSP_archive_cutoff_new(char *tim);
+X509_EXTENSION * __cdecl OCSP_archive_cutoff_new(char *tim);
 
-X509_EXTENSION *OCSP_url_svcloc_new(X509_NAME *issuer, const char **urls);
+X509_EXTENSION * __cdecl OCSP_url_svcloc_new(X509_NAME *issuer, const char **urls);
 
-int OCSP_REQUEST_get_ext_count(OCSP_REQUEST *x);
-int OCSP_REQUEST_get_ext_by_NID(OCSP_REQUEST *x, int nid, int lastpos);
-int OCSP_REQUEST_get_ext_by_OBJ(OCSP_REQUEST *x, const ASN1_OBJECT *obj,
+int __cdecl OCSP_REQUEST_get_ext_count(OCSP_REQUEST *x);
+int __cdecl OCSP_REQUEST_get_ext_by_NID(OCSP_REQUEST *x, int nid, int lastpos);
+int __cdecl OCSP_REQUEST_get_ext_by_OBJ(OCSP_REQUEST *x, const ASN1_OBJECT *obj,
                                 int lastpos);
-int OCSP_REQUEST_get_ext_by_critical(OCSP_REQUEST *x, int crit, int lastpos);
-X509_EXTENSION *OCSP_REQUEST_get_ext(OCSP_REQUEST *x, int loc);
-X509_EXTENSION *OCSP_REQUEST_delete_ext(OCSP_REQUEST *x, int loc);
-void *OCSP_REQUEST_get1_ext_d2i(OCSP_REQUEST *x, int nid, int *crit,
+int __cdecl OCSP_REQUEST_get_ext_by_critical(OCSP_REQUEST *x, int crit, int lastpos);
+X509_EXTENSION * __cdecl OCSP_REQUEST_get_ext(OCSP_REQUEST *x, int loc);
+X509_EXTENSION * __cdecl OCSP_REQUEST_delete_ext(OCSP_REQUEST *x, int loc);
+void * __cdecl OCSP_REQUEST_get1_ext_d2i(OCSP_REQUEST *x, int nid, int *crit,
                                 int *idx);
-int OCSP_REQUEST_add1_ext_i2d(OCSP_REQUEST *x, int nid, void *value, int crit,
+int __cdecl OCSP_REQUEST_add1_ext_i2d(OCSP_REQUEST *x, int nid, void *value, int crit,
                               unsigned long flags);
-int OCSP_REQUEST_add_ext(OCSP_REQUEST *x, X509_EXTENSION *ex, int loc);
-
-int OCSP_ONEREQ_get_ext_count(OCSP_ONEREQ *x);
-int OCSP_ONEREQ_get_ext_by_NID(OCSP_ONEREQ *x, int nid, int lastpos);
-int OCSP_ONEREQ_get_ext_by_OBJ(OCSP_ONEREQ *x, const ASN1_OBJECT *obj, int lastpos);
-int OCSP_ONEREQ_get_ext_by_critical(OCSP_ONEREQ *x, int crit, int lastpos);
-X509_EXTENSION *OCSP_ONEREQ_get_ext(OCSP_ONEREQ *x, int loc);
-X509_EXTENSION *OCSP_ONEREQ_delete_ext(OCSP_ONEREQ *x, int loc);
-void *OCSP_ONEREQ_get1_ext_d2i(OCSP_ONEREQ *x, int nid, int *crit, int *idx);
-int OCSP_ONEREQ_add1_ext_i2d(OCSP_ONEREQ *x, int nid, void *value, int crit,
+int __cdecl OCSP_REQUEST_add_ext(OCSP_REQUEST *x, X509_EXTENSION *ex, int loc);
+
+int __cdecl OCSP_ONEREQ_get_ext_count(OCSP_ONEREQ *x);
+int __cdecl OCSP_ONEREQ_get_ext_by_NID(OCSP_ONEREQ *x, int nid, int lastpos);
+int __cdecl OCSP_ONEREQ_get_ext_by_OBJ(OCSP_ONEREQ *x, const ASN1_OBJECT *obj, int lastpos);
+int __cdecl OCSP_ONEREQ_get_ext_by_critical(OCSP_ONEREQ *x, int crit, int lastpos);
+X509_EXTENSION * __cdecl OCSP_ONEREQ_get_ext(OCSP_ONEREQ *x, int loc);
+X509_EXTENSION * __cdecl OCSP_ONEREQ_delete_ext(OCSP_ONEREQ *x, int loc);
+void * __cdecl OCSP_ONEREQ_get1_ext_d2i(OCSP_ONEREQ *x, int nid, int *crit, int *idx);
+int __cdecl OCSP_ONEREQ_add1_ext_i2d(OCSP_ONEREQ *x, int nid, void *value, int crit,
                              unsigned long flags);
-int OCSP_ONEREQ_add_ext(OCSP_ONEREQ *x, X509_EXTENSION *ex, int loc);
+int __cdecl OCSP_ONEREQ_add_ext(OCSP_ONEREQ *x, X509_EXTENSION *ex, int loc);
 
-int OCSP_BASICRESP_get_ext_count(OCSP_BASICRESP *x);
-int OCSP_BASICRESP_get_ext_by_NID(OCSP_BASICRESP *x, int nid, int lastpos);
-int OCSP_BASICRESP_get_ext_by_OBJ(OCSP_BASICRESP *x, const ASN1_OBJECT *obj,
+int __cdecl OCSP_BASICRESP_get_ext_count(OCSP_BASICRESP *x);
+int __cdecl OCSP_BASICRESP_get_ext_by_NID(OCSP_BASICRESP *x, int nid, int lastpos);
+int __cdecl OCSP_BASICRESP_get_ext_by_OBJ(OCSP_BASICRESP *x, const ASN1_OBJECT *obj,
                                   int lastpos);
-int OCSP_BASICRESP_get_ext_by_critical(OCSP_BASICRESP *x, int crit,
+int __cdecl OCSP_BASICRESP_get_ext_by_critical(OCSP_BASICRESP *x, int crit,
                                        int lastpos);
-X509_EXTENSION *OCSP_BASICRESP_get_ext(OCSP_BASICRESP *x, int loc);
-X509_EXTENSION *OCSP_BASICRESP_delete_ext(OCSP_BASICRESP *x, int loc);
-void *OCSP_BASICRESP_get1_ext_d2i(OCSP_BASICRESP *x, int nid, int *crit,
+X509_EXTENSION * __cdecl OCSP_BASICRESP_get_ext(OCSP_BASICRESP *x, int loc);
+X509_EXTENSION * __cdecl OCSP_BASICRESP_delete_ext(OCSP_BASICRESP *x, int loc);
+void * __cdecl OCSP_BASICRESP_get1_ext_d2i(OCSP_BASICRESP *x, int nid, int *crit,
                                   int *idx);
-int OCSP_BASICRESP_add1_ext_i2d(OCSP_BASICRESP *x, int nid, void *value,
+int __cdecl OCSP_BASICRESP_add1_ext_i2d(OCSP_BASICRESP *x, int nid, void *value,
                                 int crit, unsigned long flags);
-int OCSP_BASICRESP_add_ext(OCSP_BASICRESP *x, X509_EXTENSION *ex, int loc);
+int __cdecl OCSP_BASICRESP_add_ext(OCSP_BASICRESP *x, X509_EXTENSION *ex, int loc);
 
-int OCSP_SINGLERESP_get_ext_count(OCSP_SINGLERESP *x);
-int OCSP_SINGLERESP_get_ext_by_NID(OCSP_SINGLERESP *x, int nid, int lastpos);
-int OCSP_SINGLERESP_get_ext_by_OBJ(OCSP_SINGLERESP *x, const ASN1_OBJECT *obj,
+int __cdecl OCSP_SINGLERESP_get_ext_count(OCSP_SINGLERESP *x);
+int __cdecl OCSP_SINGLERESP_get_ext_by_NID(OCSP_SINGLERESP *x, int nid, int lastpos);
+int __cdecl OCSP_SINGLERESP_get_ext_by_OBJ(OCSP_SINGLERESP *x, const ASN1_OBJECT *obj,
                                    int lastpos);
-int OCSP_SINGLERESP_get_ext_by_critical(OCSP_SINGLERESP *x, int crit,
+int __cdecl OCSP_SINGLERESP_get_ext_by_critical(OCSP_SINGLERESP *x, int crit,
                                         int lastpos);
-X509_EXTENSION *OCSP_SINGLERESP_get_ext(OCSP_SINGLERESP *x, int loc);
-X509_EXTENSION *OCSP_SINGLERESP_delete_ext(OCSP_SINGLERESP *x, int loc);
-void *OCSP_SINGLERESP_get1_ext_d2i(OCSP_SINGLERESP *x, int nid, int *crit,
+X509_EXTENSION * __cdecl OCSP_SINGLERESP_get_ext(OCSP_SINGLERESP *x, int loc);
+X509_EXTENSION * __cdecl OCSP_SINGLERESP_delete_ext(OCSP_SINGLERESP *x, int loc);
+void * __cdecl OCSP_SINGLERESP_get1_ext_d2i(OCSP_SINGLERESP *x, int nid, int *crit,
                                    int *idx);
-int OCSP_SINGLERESP_add1_ext_i2d(OCSP_SINGLERESP *x, int nid, void *value,
+int __cdecl OCSP_SINGLERESP_add1_ext_i2d(OCSP_SINGLERESP *x, int nid, void *value,
                                  int crit, unsigned long flags);
-int OCSP_SINGLERESP_add_ext(OCSP_SINGLERESP *x, X509_EXTENSION *ex, int loc);
-const OCSP_CERTID *OCSP_SINGLERESP_get0_id(const OCSP_SINGLERESP *x);
+int __cdecl OCSP_SINGLERESP_add_ext(OCSP_SINGLERESP *x, X509_EXTENSION *ex, int loc);
+const OCSP_CERTID * __cdecl OCSP_SINGLERESP_get0_id(const OCSP_SINGLERESP *x);
 
 DECLARE_ASN1_FUNCTIONS(OCSP_SINGLERESP)
 DECLARE_ASN1_FUNCTIONS(OCSP_CERTSTATUS)
@@ -334,14 +334,14 @@ DECLARE_ASN1_FUNCTIONS(OCSP_REQINFO)
 DECLARE_ASN1_FUNCTIONS(OCSP_CRLID)
 DECLARE_ASN1_FUNCTIONS(OCSP_SERVICELOC)
 
-const char *OCSP_response_status_str(long s);
-const char *OCSP_cert_status_str(long s);
-const char *OCSP_crl_reason_str(long s);
+const char * __cdecl OCSP_response_status_str(long s);
+const char * __cdecl OCSP_cert_status_str(long s);
+const char * __cdecl OCSP_crl_reason_str(long s);
 
-int OCSP_REQUEST_print(BIO *bp, OCSP_REQUEST *a, unsigned long flags);
-int OCSP_RESPONSE_print(BIO *bp, OCSP_RESPONSE *o, unsigned long flags);
+int __cdecl OCSP_REQUEST_print(BIO *bp, OCSP_REQUEST *a, unsigned long flags);
+int __cdecl OCSP_RESPONSE_print(BIO *bp, OCSP_RESPONSE *o, unsigned long flags);
 
-int OCSP_basic_verify(OCSP_BASICRESP *bs, STACK_OF(X509) *certs,
+int __cdecl OCSP_basic_verify(OCSP_BASICRESP *bs, STACK_OF(X509) *certs,
                       X509_STORE *st, unsigned long flags);
 
 
diff --git a/include/openssl/ocsperr.h b/include/openssl/ocsperr.h
index 8dd9e01a17..bb512da35d 100644
--- a/include/openssl/ocsperr.h
+++ b/include/openssl/ocsperr.h
@@ -22,7 +22,7 @@
 #  ifdef  __cplusplus
 extern "C"
 #  endif
-int ERR_load_OCSP_strings(void);
+int __cdecl ERR_load_OCSP_strings(void);
 
 /*
  * OCSP function codes.
diff --git a/include/openssl/pem.h b/include/openssl/pem.h
index 2ef5b5d04c..122c277c24 100644
--- a/include/openssl/pem.h
+++ b/include/openssl/pem.h
@@ -230,60 +230,60 @@ int PEM_write_bio_##name(BIO *bp, type *x, const EVP_CIPHER *enc, \
         DECLARE_PEM_write_cb(name, type)
 typedef int pem_password_cb (char *buf, int size, int rwflag, void *userdata);
 
-int PEM_get_EVP_CIPHER_INFO(char *header, EVP_CIPHER_INFO *cipher);
-int PEM_do_header(EVP_CIPHER_INFO *cipher, unsigned char *data, long *len,
+int __cdecl PEM_get_EVP_CIPHER_INFO(char *header, EVP_CIPHER_INFO *cipher);
+int __cdecl PEM_do_header(EVP_CIPHER_INFO *cipher, unsigned char *data, long *len,
                   pem_password_cb *callback, void *u);
 
-int PEM_read_bio(BIO *bp, char **name, char **header,
+int __cdecl PEM_read_bio(BIO *bp, char **name, char **header,
                  unsigned char **data, long *len);
 #   define PEM_FLAG_SECURE             0x1
 #   define PEM_FLAG_EAY_COMPATIBLE     0x2
 #   define PEM_FLAG_ONLY_B64           0x4
-int PEM_read_bio_ex(BIO *bp, char **name, char **header,
+int __cdecl PEM_read_bio_ex(BIO *bp, char **name, char **header,
                     unsigned char **data, long *len, unsigned int flags);
-int PEM_bytes_read_bio_secmem(unsigned char **pdata, long *plen, char **pnm,
+int __cdecl PEM_bytes_read_bio_secmem(unsigned char **pdata, long *plen, char **pnm,
                               const char *name, BIO *bp, pem_password_cb *cb,
                               void *u);
-int PEM_write_bio(BIO *bp, const char *name, const char *hdr,
+int __cdecl PEM_write_bio(BIO *bp, const char *name, const char *hdr,
                   const unsigned char *data, long len);
-int PEM_bytes_read_bio(unsigned char **pdata, long *plen, char **pnm,
+int __cdecl PEM_bytes_read_bio(unsigned char **pdata, long *plen, char **pnm,
                        const char *name, BIO *bp, pem_password_cb *cb,
                        void *u);
-void *PEM_ASN1_read_bio(d2i_of_void *d2i, const char *name, BIO *bp, void **x,
+void * __cdecl PEM_ASN1_read_bio(d2i_of_void *d2i, const char *name, BIO *bp, void **x,
                         pem_password_cb *cb, void *u);
-int PEM_ASN1_write_bio(i2d_of_void *i2d, const char *name, BIO *bp, void *x,
+int __cdecl PEM_ASN1_write_bio(i2d_of_void *i2d, const char *name, BIO *bp, void *x,
                        const EVP_CIPHER *enc, unsigned char *kstr, int klen,
                        pem_password_cb *cb, void *u);
 
-STACK_OF(X509_INFO) *PEM_X509_INFO_read_bio(BIO *bp, STACK_OF(X509_INFO) *sk,
+STACK_OF(X509_INFO) * __cdecl PEM_X509_INFO_read_bio(BIO *bp, STACK_OF(X509_INFO) *sk,
                                             pem_password_cb *cb, void *u);
-int PEM_X509_INFO_write_bio(BIO *bp, X509_INFO *xi, EVP_CIPHER *enc,
+int __cdecl PEM_X509_INFO_write_bio(BIO *bp, X509_INFO *xi, EVP_CIPHER *enc,
                             unsigned char *kstr, int klen,
                             pem_password_cb *cd, void *u);
 
 #ifndef OPENSSL_NO_STDIO
-int PEM_read(FILE *fp, char **name, char **header,
+int __cdecl PEM_read(FILE *fp, char **name, char **header,
              unsigned char **data, long *len);
-int PEM_write(FILE *fp, const char *name, const char *hdr,
+int __cdecl PEM_write(FILE *fp, const char *name, const char *hdr,
               const unsigned char *data, long len);
-void *PEM_ASN1_read(d2i_of_void *d2i, const char *name, FILE *fp, void **x,
+void * __cdecl PEM_ASN1_read(d2i_of_void *d2i, const char *name, FILE *fp, void **x,
                     pem_password_cb *cb, void *u);
-int PEM_ASN1_write(i2d_of_void *i2d, const char *name, FILE *fp,
+int __cdecl PEM_ASN1_write(i2d_of_void *i2d, const char *name, FILE *fp,
                    void *x, const EVP_CIPHER *enc, unsigned char *kstr,
                    int klen, pem_password_cb *callback, void *u);
-STACK_OF(X509_INFO) *PEM_X509_INFO_read(FILE *fp, STACK_OF(X509_INFO) *sk,
+STACK_OF(X509_INFO) * __cdecl PEM_X509_INFO_read(FILE *fp, STACK_OF(X509_INFO) *sk,
                                         pem_password_cb *cb, void *u);
 #endif
 
-int PEM_SignInit(EVP_MD_CTX *ctx, EVP_MD *type);
-int PEM_SignUpdate(EVP_MD_CTX *ctx, unsigned char *d, unsigned int cnt);
-int PEM_SignFinal(EVP_MD_CTX *ctx, unsigned char *sigret,
+int __cdecl PEM_SignInit(EVP_MD_CTX *ctx, EVP_MD *type);
+int __cdecl PEM_SignUpdate(EVP_MD_CTX *ctx, unsigned char *d, unsigned int cnt);
+int __cdecl PEM_SignFinal(EVP_MD_CTX *ctx, unsigned char *sigret,
                   unsigned int *siglen, EVP_PKEY *pkey);
 
 /* The default pem_password_cb that's used internally */
-int PEM_def_callback(char *buf, int num, int rwflag, void *userdata);
-void PEM_proc_type(char *buf, int type);
-void PEM_dek_info(char *buf, const char *type, int len, char *str);
+int __cdecl PEM_def_callback(char *buf, int num, int rwflag, void *userdata);
+void __cdecl PEM_proc_type(char *buf, int type);
+void __cdecl PEM_dek_info(char *buf, const char *type, int len, char *str);
 
 # include <openssl/symhacks.h>
 
@@ -318,56 +318,56 @@ DECLARE_PEM_write_const(DHxparams, DH)
 DECLARE_PEM_rw_cb(PrivateKey, EVP_PKEY)
 DECLARE_PEM_rw(PUBKEY, EVP_PKEY)
 
-int PEM_write_bio_PrivateKey_traditional(BIO *bp, EVP_PKEY *x,
+int __cdecl PEM_write_bio_PrivateKey_traditional(BIO *bp, EVP_PKEY *x,
                                          const EVP_CIPHER *enc,
                                          unsigned char *kstr, int klen,
                                          pem_password_cb *cb, void *u);
 
-int PEM_write_bio_PKCS8PrivateKey_nid(BIO *bp, EVP_PKEY *x, int nid,
+int __cdecl PEM_write_bio_PKCS8PrivateKey_nid(BIO *bp, EVP_PKEY *x, int nid,
                                       char *kstr, int klen,
                                       pem_password_cb *cb, void *u);
-int PEM_write_bio_PKCS8PrivateKey(BIO *, EVP_PKEY *, const EVP_CIPHER *,
+int __cdecl PEM_write_bio_PKCS8PrivateKey(BIO *, EVP_PKEY *, const EVP_CIPHER *,
                                   char *, int, pem_password_cb *, void *);
-int i2d_PKCS8PrivateKey_bio(BIO *bp, EVP_PKEY *x, const EVP_CIPHER *enc,
+int __cdecl i2d_PKCS8PrivateKey_bio(BIO *bp, EVP_PKEY *x, const EVP_CIPHER *enc,
                             char *kstr, int klen,
                             pem_password_cb *cb, void *u);
-int i2d_PKCS8PrivateKey_nid_bio(BIO *bp, EVP_PKEY *x, int nid,
+int __cdecl i2d_PKCS8PrivateKey_nid_bio(BIO *bp, EVP_PKEY *x, int nid,
                                 char *kstr, int klen,
                                 pem_password_cb *cb, void *u);
-EVP_PKEY *d2i_PKCS8PrivateKey_bio(BIO *bp, EVP_PKEY **x, pem_password_cb *cb,
+EVP_PKEY * __cdecl d2i_PKCS8PrivateKey_bio(BIO *bp, EVP_PKEY **x, pem_password_cb *cb,
                                   void *u);
 
 # ifndef OPENSSL_NO_STDIO
-int i2d_PKCS8PrivateKey_fp(FILE *fp, EVP_PKEY *x, const EVP_CIPHER *enc,
+int __cdecl i2d_PKCS8PrivateKey_fp(FILE *fp, EVP_PKEY *x, const EVP_CIPHER *enc,
                            char *kstr, int klen,
                            pem_password_cb *cb, void *u);
-int i2d_PKCS8PrivateKey_nid_fp(FILE *fp, EVP_PKEY *x, int nid,
+int __cdecl i2d_PKCS8PrivateKey_nid_fp(FILE *fp, EVP_PKEY *x, int nid,
                                char *kstr, int klen,
                                pem_password_cb *cb, void *u);
-int PEM_write_PKCS8PrivateKey_nid(FILE *fp, EVP_PKEY *x, int nid,
+int __cdecl PEM_write_PKCS8PrivateKey_nid(FILE *fp, EVP_PKEY *x, int nid,
                                   char *kstr, int klen,
                                   pem_password_cb *cb, void *u);
 
-EVP_PKEY *d2i_PKCS8PrivateKey_fp(FILE *fp, EVP_PKEY **x, pem_password_cb *cb,
+EVP_PKEY * __cdecl d2i_PKCS8PrivateKey_fp(FILE *fp, EVP_PKEY **x, pem_password_cb *cb,
                                  void *u);
 
-int PEM_write_PKCS8PrivateKey(FILE *fp, EVP_PKEY *x, const EVP_CIPHER *enc,
+int __cdecl PEM_write_PKCS8PrivateKey(FILE *fp, EVP_PKEY *x, const EVP_CIPHER *enc,
                               char *kstr, int klen, pem_password_cb *cd,
                               void *u);
 # endif
-EVP_PKEY *PEM_read_bio_Parameters(BIO *bp, EVP_PKEY **x);
-int PEM_write_bio_Parameters(BIO *bp, EVP_PKEY *x);
+EVP_PKEY * __cdecl PEM_read_bio_Parameters(BIO *bp, EVP_PKEY **x);
+int __cdecl PEM_write_bio_Parameters(BIO *bp, EVP_PKEY *x);
 
 # ifndef OPENSSL_NO_DSA
-EVP_PKEY *b2i_PrivateKey(const unsigned char **in, long length);
-EVP_PKEY *b2i_PublicKey(const unsigned char **in, long length);
-EVP_PKEY *b2i_PrivateKey_bio(BIO *in);
-EVP_PKEY *b2i_PublicKey_bio(BIO *in);
-int i2b_PrivateKey_bio(BIO *out, EVP_PKEY *pk);
-int i2b_PublicKey_bio(BIO *out, EVP_PKEY *pk);
+EVP_PKEY * __cdecl b2i_PrivateKey(const unsigned char **in, long length);
+EVP_PKEY * __cdecl b2i_PublicKey(const unsigned char **in, long length);
+EVP_PKEY * __cdecl b2i_PrivateKey_bio(BIO *in);
+EVP_PKEY * __cdecl b2i_PublicKey_bio(BIO *in);
+int __cdecl i2b_PrivateKey_bio(BIO *out, EVP_PKEY *pk);
+int __cdecl i2b_PublicKey_bio(BIO *out, EVP_PKEY *pk);
 #  ifndef OPENSSL_NO_RC4
-EVP_PKEY *b2i_PVK_bio(BIO *in, pem_password_cb *cb, void *u);
-int i2b_PVK_bio(BIO *out, EVP_PKEY *pk, int enclevel,
+EVP_PKEY * __cdecl b2i_PVK_bio(BIO *in, pem_password_cb *cb, void *u);
+int __cdecl i2b_PVK_bio(BIO *out, EVP_PKEY *pk, int enclevel,
                 pem_password_cb *cb, void *u);
 #  endif
 # endif
diff --git a/include/openssl/pemerr.h b/include/openssl/pemerr.h
index 0c45918f3c..ae70878350 100644
--- a/include/openssl/pemerr.h
+++ b/include/openssl/pemerr.h
@@ -18,7 +18,7 @@
 # ifdef  __cplusplus
 extern "C"
 # endif
-int ERR_load_PEM_strings(void);
+int __cdecl ERR_load_PEM_strings(void);
 
 /*
  * PEM function codes.
diff --git a/include/openssl/pkcs12.h b/include/openssl/pkcs12.h
index 3f43dad6d9..ba93fb6e70 100644
--- a/include/openssl/pkcs12.h
+++ b/include/openssl/pkcs12.h
@@ -74,115 +74,115 @@ typedef struct pkcs12_bag_st PKCS12_BAGS;
 
 DEPRECATEDIN_1_1_0(ASN1_TYPE *PKCS12_get_attr(const PKCS12_SAFEBAG *bag, int attr_nid))
 
-ASN1_TYPE *PKCS8_get_attr(PKCS8_PRIV_KEY_INFO *p8, int attr_nid);
-int PKCS12_mac_present(const PKCS12 *p12);
-void PKCS12_get0_mac(const ASN1_OCTET_STRING **pmac,
+ASN1_TYPE * __cdecl PKCS8_get_attr(PKCS8_PRIV_KEY_INFO *p8, int attr_nid);
+int __cdecl PKCS12_mac_present(const PKCS12 *p12);
+void __cdecl PKCS12_get0_mac(const ASN1_OCTET_STRING **pmac,
                      const X509_ALGOR **pmacalg,
                      const ASN1_OCTET_STRING **psalt,
                      const ASN1_INTEGER **piter,
                      const PKCS12 *p12);
 
-const ASN1_TYPE *PKCS12_SAFEBAG_get0_attr(const PKCS12_SAFEBAG *bag,
+const ASN1_TYPE * __cdecl PKCS12_SAFEBAG_get0_attr(const PKCS12_SAFEBAG *bag,
                                           int attr_nid);
-const ASN1_OBJECT *PKCS12_SAFEBAG_get0_type(const PKCS12_SAFEBAG *bag);
-int PKCS12_SAFEBAG_get_nid(const PKCS12_SAFEBAG *bag);
-int PKCS12_SAFEBAG_get_bag_nid(const PKCS12_SAFEBAG *bag);
+const ASN1_OBJECT * __cdecl PKCS12_SAFEBAG_get0_type(const PKCS12_SAFEBAG *bag);
+int __cdecl PKCS12_SAFEBAG_get_nid(const PKCS12_SAFEBAG *bag);
+int __cdecl PKCS12_SAFEBAG_get_bag_nid(const PKCS12_SAFEBAG *bag);
 
-X509 *PKCS12_SAFEBAG_get1_cert(const PKCS12_SAFEBAG *bag);
-X509_CRL *PKCS12_SAFEBAG_get1_crl(const PKCS12_SAFEBAG *bag);
-const STACK_OF(PKCS12_SAFEBAG) *
+X509 * __cdecl PKCS12_SAFEBAG_get1_cert(const PKCS12_SAFEBAG *bag);
+X509_CRL * __cdecl PKCS12_SAFEBAG_get1_crl(const PKCS12_SAFEBAG *bag);
+const STACK_OF(PKCS12_SAFEBAG) * __cdecl 
 PKCS12_SAFEBAG_get0_safes(const PKCS12_SAFEBAG *bag);
-const PKCS8_PRIV_KEY_INFO *PKCS12_SAFEBAG_get0_p8inf(const PKCS12_SAFEBAG *bag);
-const X509_SIG *PKCS12_SAFEBAG_get0_pkcs8(const PKCS12_SAFEBAG *bag);
-
-PKCS12_SAFEBAG *PKCS12_SAFEBAG_create_cert(X509 *x509);
-PKCS12_SAFEBAG *PKCS12_SAFEBAG_create_crl(X509_CRL *crl);
-PKCS12_SAFEBAG *PKCS12_SAFEBAG_create0_p8inf(PKCS8_PRIV_KEY_INFO *p8);
-PKCS12_SAFEBAG *PKCS12_SAFEBAG_create0_pkcs8(X509_SIG *p8);
-PKCS12_SAFEBAG *PKCS12_SAFEBAG_create_pkcs8_encrypt(int pbe_nid,
+const PKCS8_PRIV_KEY_INFO * __cdecl PKCS12_SAFEBAG_get0_p8inf(const PKCS12_SAFEBAG *bag);
+const X509_SIG * __cdecl PKCS12_SAFEBAG_get0_pkcs8(const PKCS12_SAFEBAG *bag);
+
+PKCS12_SAFEBAG * __cdecl PKCS12_SAFEBAG_create_cert(X509 *x509);
+PKCS12_SAFEBAG * __cdecl PKCS12_SAFEBAG_create_crl(X509_CRL *crl);
+PKCS12_SAFEBAG * __cdecl PKCS12_SAFEBAG_create0_p8inf(PKCS8_PRIV_KEY_INFO *p8);
+PKCS12_SAFEBAG * __cdecl PKCS12_SAFEBAG_create0_pkcs8(X509_SIG *p8);
+PKCS12_SAFEBAG * __cdecl PKCS12_SAFEBAG_create_pkcs8_encrypt(int pbe_nid,
                                                     const char *pass,
                                                     int passlen,
                                                     unsigned char *salt,
                                                     int saltlen, int iter,
                                                     PKCS8_PRIV_KEY_INFO *p8inf);
 
-PKCS12_SAFEBAG *PKCS12_item_pack_safebag(void *obj, const ASN1_ITEM *it,
+PKCS12_SAFEBAG * __cdecl PKCS12_item_pack_safebag(void *obj, const ASN1_ITEM *it,
                                          int nid1, int nid2);
-PKCS8_PRIV_KEY_INFO *PKCS8_decrypt(const X509_SIG *p8, const char *pass,
+PKCS8_PRIV_KEY_INFO * __cdecl PKCS8_decrypt(const X509_SIG *p8, const char *pass,
                                    int passlen);
-PKCS8_PRIV_KEY_INFO *PKCS12_decrypt_skey(const PKCS12_SAFEBAG *bag,
+PKCS8_PRIV_KEY_INFO * __cdecl PKCS12_decrypt_skey(const PKCS12_SAFEBAG *bag,
                                          const char *pass, int passlen);
-X509_SIG *PKCS8_encrypt(int pbe_nid, const EVP_CIPHER *cipher,
+X509_SIG * __cdecl PKCS8_encrypt(int pbe_nid, const EVP_CIPHER *cipher,
                         const char *pass, int passlen, unsigned char *salt,
                         int saltlen, int iter, PKCS8_PRIV_KEY_INFO *p8);
-X509_SIG *PKCS8_set0_pbe(const char *pass, int passlen,
+X509_SIG * __cdecl PKCS8_set0_pbe(const char *pass, int passlen,
                         PKCS8_PRIV_KEY_INFO *p8inf, X509_ALGOR *pbe);
-PKCS7 *PKCS12_pack_p7data(STACK_OF(PKCS12_SAFEBAG) *sk);
-STACK_OF(PKCS12_SAFEBAG) *PKCS12_unpack_p7data(PKCS7 *p7);
-PKCS7 *PKCS12_pack_p7encdata(int pbe_nid, const char *pass, int passlen,
+PKCS7 * __cdecl PKCS12_pack_p7data(STACK_OF(PKCS12_SAFEBAG) *sk);
+STACK_OF(PKCS12_SAFEBAG) * __cdecl PKCS12_unpack_p7data(PKCS7 *p7);
+PKCS7 * __cdecl PKCS12_pack_p7encdata(int pbe_nid, const char *pass, int passlen,
                              unsigned char *salt, int saltlen, int iter,
                              STACK_OF(PKCS12_SAFEBAG) *bags);
-STACK_OF(PKCS12_SAFEBAG) *PKCS12_unpack_p7encdata(PKCS7 *p7, const char *pass,
+STACK_OF(PKCS12_SAFEBAG) * __cdecl PKCS12_unpack_p7encdata(PKCS7 *p7, const char *pass,
                                                   int passlen);
 
-int PKCS12_pack_authsafes(PKCS12 *p12, STACK_OF(PKCS7) *safes);
-STACK_OF(PKCS7) *PKCS12_unpack_authsafes(const PKCS12 *p12);
+int __cdecl PKCS12_pack_authsafes(PKCS12 *p12, STACK_OF(PKCS7) *safes);
+STACK_OF(PKCS7) * __cdecl PKCS12_unpack_authsafes(const PKCS12 *p12);
 
-int PKCS12_add_localkeyid(PKCS12_SAFEBAG *bag, unsigned char *name,
+int __cdecl PKCS12_add_localkeyid(PKCS12_SAFEBAG *bag, unsigned char *name,
                           int namelen);
-int PKCS12_add_friendlyname_asc(PKCS12_SAFEBAG *bag, const char *name,
+int __cdecl PKCS12_add_friendlyname_asc(PKCS12_SAFEBAG *bag, const char *name,
                                 int namelen);
-int PKCS12_add_friendlyname_utf8(PKCS12_SAFEBAG *bag, const char *name,
+int __cdecl PKCS12_add_friendlyname_utf8(PKCS12_SAFEBAG *bag, const char *name,
                                  int namelen);
-int PKCS12_add_CSPName_asc(PKCS12_SAFEBAG *bag, const char *name,
+int __cdecl PKCS12_add_CSPName_asc(PKCS12_SAFEBAG *bag, const char *name,
                            int namelen);
-int PKCS12_add_friendlyname_uni(PKCS12_SAFEBAG *bag,
+int __cdecl PKCS12_add_friendlyname_uni(PKCS12_SAFEBAG *bag,
                                 const unsigned char *name, int namelen);
-int PKCS8_add_keyusage(PKCS8_PRIV_KEY_INFO *p8, int usage);
-ASN1_TYPE *PKCS12_get_attr_gen(const STACK_OF(X509_ATTRIBUTE) *attrs,
+int __cdecl PKCS8_add_keyusage(PKCS8_PRIV_KEY_INFO *p8, int usage);
+ASN1_TYPE * __cdecl PKCS12_get_attr_gen(const STACK_OF(X509_ATTRIBUTE) *attrs,
                                int attr_nid);
-char *PKCS12_get_friendlyname(PKCS12_SAFEBAG *bag);
-const STACK_OF(X509_ATTRIBUTE) *
+char * __cdecl PKCS12_get_friendlyname(PKCS12_SAFEBAG *bag);
+const STACK_OF(X509_ATTRIBUTE) * __cdecl 
 PKCS12_SAFEBAG_get0_attrs(const PKCS12_SAFEBAG *bag);
-unsigned char *PKCS12_pbe_crypt(const X509_ALGOR *algor,
+unsigned char * __cdecl PKCS12_pbe_crypt(const X509_ALGOR *algor,
                                 const char *pass, int passlen,
                                 const unsigned char *in, int inlen,
                                 unsigned char **data, int *datalen,
                                 int en_de);
-void *PKCS12_item_decrypt_d2i(const X509_ALGOR *algor, const ASN1_ITEM *it,
+void * __cdecl PKCS12_item_decrypt_d2i(const X509_ALGOR *algor, const ASN1_ITEM *it,
                               const char *pass, int passlen,
                               const ASN1_OCTET_STRING *oct, int zbuf);
-ASN1_OCTET_STRING *PKCS12_item_i2d_encrypt(X509_ALGOR *algor,
+ASN1_OCTET_STRING * __cdecl PKCS12_item_i2d_encrypt(X509_ALGOR *algor,
                                            const ASN1_ITEM *it,
                                            const char *pass, int passlen,
                                            void *obj, int zbuf);
-PKCS12 *PKCS12_init(int mode);
-int PKCS12_key_gen_asc(const char *pass, int passlen, unsigned char *salt,
+PKCS12 * __cdecl PKCS12_init(int mode);
+int __cdecl PKCS12_key_gen_asc(const char *pass, int passlen, unsigned char *salt,
                        int saltlen, int id, int iter, int n,
                        unsigned char *out, const EVP_MD *md_type);
-int PKCS12_key_gen_uni(unsigned char *pass, int passlen, unsigned char *salt,
+int __cdecl PKCS12_key_gen_uni(unsigned char *pass, int passlen, unsigned char *salt,
                        int saltlen, int id, int iter, int n,
                        unsigned char *out, const EVP_MD *md_type);
-int PKCS12_key_gen_utf8(const char *pass, int passlen, unsigned char *salt,
+int __cdecl PKCS12_key_gen_utf8(const char *pass, int passlen, unsigned char *salt,
                         int saltlen, int id, int iter, int n,
                         unsigned char *out, const EVP_MD *md_type);
-int PKCS12_PBE_keyivgen(EVP_CIPHER_CTX *ctx, const char *pass, int passlen,
+int __cdecl PKCS12_PBE_keyivgen(EVP_CIPHER_CTX *ctx, const char *pass, int passlen,
                         ASN1_TYPE *param, const EVP_CIPHER *cipher,
                         const EVP_MD *md_type, int en_de);
-int PKCS12_gen_mac(PKCS12 *p12, const char *pass, int passlen,
+int __cdecl PKCS12_gen_mac(PKCS12 *p12, const char *pass, int passlen,
                    unsigned char *mac, unsigned int *maclen);
-int PKCS12_verify_mac(PKCS12 *p12, const char *pass, int passlen);
-int PKCS12_set_mac(PKCS12 *p12, const char *pass, int passlen,
+int __cdecl PKCS12_verify_mac(PKCS12 *p12, const char *pass, int passlen);
+int __cdecl PKCS12_set_mac(PKCS12 *p12, const char *pass, int passlen,
                    unsigned char *salt, int saltlen, int iter,
                    const EVP_MD *md_type);
-int PKCS12_setup_mac(PKCS12 *p12, int iter, unsigned char *salt,
+int __cdecl PKCS12_setup_mac(PKCS12 *p12, int iter, unsigned char *salt,
                      int saltlen, const EVP_MD *md_type);
-unsigned char *OPENSSL_asc2uni(const char *asc, int asclen,
+unsigned char * __cdecl OPENSSL_asc2uni(const char *asc, int asclen,
                                unsigned char **uni, int *unilen);
-char *OPENSSL_uni2asc(const unsigned char *uni, int unilen);
-unsigned char *OPENSSL_utf82uni(const char *asc, int asclen,
+char * __cdecl OPENSSL_uni2asc(const unsigned char *uni, int unilen);
+unsigned char * __cdecl OPENSSL_utf82uni(const char *asc, int asclen,
                                 unsigned char **uni, int *unilen);
-char *OPENSSL_uni2utf8(const unsigned char *uni, int unilen);
+char * __cdecl OPENSSL_uni2utf8(const unsigned char *uni, int unilen);
 
 DECLARE_ASN1_FUNCTIONS(PKCS12)
 DECLARE_ASN1_FUNCTIONS(PKCS12_MAC_DATA)
@@ -192,30 +192,30 @@ DECLARE_ASN1_FUNCTIONS(PKCS12_BAGS)
 DECLARE_ASN1_ITEM(PKCS12_SAFEBAGS)
 DECLARE_ASN1_ITEM(PKCS12_AUTHSAFES)
 
-void PKCS12_PBE_add(void);
-int PKCS12_parse(PKCS12 *p12, const char *pass, EVP_PKEY **pkey, X509 **cert,
+void __cdecl PKCS12_PBE_add(void);
+int __cdecl PKCS12_parse(PKCS12 *p12, const char *pass, EVP_PKEY **pkey, X509 **cert,
                  STACK_OF(X509) **ca);
-PKCS12 *PKCS12_create(const char *pass, const char *name, EVP_PKEY *pkey,
+PKCS12 * __cdecl PKCS12_create(const char *pass, const char *name, EVP_PKEY *pkey,
                       X509 *cert, STACK_OF(X509) *ca, int nid_key, int nid_cert,
                       int iter, int mac_iter, int keytype);
 
-PKCS12_SAFEBAG *PKCS12_add_cert(STACK_OF(PKCS12_SAFEBAG) **pbags, X509 *cert);
-PKCS12_SAFEBAG *PKCS12_add_key(STACK_OF(PKCS12_SAFEBAG) **pbags,
+PKCS12_SAFEBAG * __cdecl PKCS12_add_cert(STACK_OF(PKCS12_SAFEBAG) **pbags, X509 *cert);
+PKCS12_SAFEBAG * __cdecl PKCS12_add_key(STACK_OF(PKCS12_SAFEBAG) **pbags,
                                EVP_PKEY *key, int key_usage, int iter,
                                int key_nid, const char *pass);
-int PKCS12_add_safe(STACK_OF(PKCS7) **psafes, STACK_OF(PKCS12_SAFEBAG) *bags,
+int __cdecl PKCS12_add_safe(STACK_OF(PKCS7) **psafes, STACK_OF(PKCS12_SAFEBAG) *bags,
                     int safe_nid, int iter, const char *pass);
-PKCS12 *PKCS12_add_safes(STACK_OF(PKCS7) *safes, int p7_nid);
+PKCS12 * __cdecl PKCS12_add_safes(STACK_OF(PKCS7) *safes, int p7_nid);
 
-int i2d_PKCS12_bio(BIO *bp, PKCS12 *p12);
+int __cdecl i2d_PKCS12_bio(BIO *bp, PKCS12 *p12);
 # ifndef OPENSSL_NO_STDIO
-int i2d_PKCS12_fp(FILE *fp, PKCS12 *p12);
+int __cdecl i2d_PKCS12_fp(FILE *fp, PKCS12 *p12);
 # endif
-PKCS12 *d2i_PKCS12_bio(BIO *bp, PKCS12 **p12);
+PKCS12 * __cdecl d2i_PKCS12_bio(BIO *bp, PKCS12 **p12);
 # ifndef OPENSSL_NO_STDIO
-PKCS12 *d2i_PKCS12_fp(FILE *fp, PKCS12 **p12);
+PKCS12 * __cdecl d2i_PKCS12_fp(FILE *fp, PKCS12 **p12);
 # endif
-int PKCS12_newpass(PKCS12 *p12, const char *oldpass, const char *newpass);
+int __cdecl PKCS12_newpass(PKCS12 *p12, const char *oldpass, const char *newpass);
 
 # ifdef  __cplusplus
 }
diff --git a/include/openssl/pkcs12err.h b/include/openssl/pkcs12err.h
index eff5eb2602..7e661eb51d 100644
--- a/include/openssl/pkcs12err.h
+++ b/include/openssl/pkcs12err.h
@@ -18,7 +18,7 @@
 # ifdef  __cplusplus
 extern "C"
 # endif
-int ERR_load_PKCS12_strings(void);
+int __cdecl ERR_load_PKCS12_strings(void);
 
 /*
  * PKCS12 function codes.
diff --git a/include/openssl/pkcs7.h b/include/openssl/pkcs7.h
index 9b66e002d2..d46c2eccf5 100644
--- a/include/openssl/pkcs7.h
+++ b/include/openssl/pkcs7.h
@@ -203,18 +203,18 @@ DEFINE_STACK_OF(PKCS7)
 
 DECLARE_ASN1_FUNCTIONS(PKCS7_ISSUER_AND_SERIAL)
 
-int PKCS7_ISSUER_AND_SERIAL_digest(PKCS7_ISSUER_AND_SERIAL *data,
+int __cdecl PKCS7_ISSUER_AND_SERIAL_digest(PKCS7_ISSUER_AND_SERIAL *data,
                                    const EVP_MD *type, unsigned char *md,
                                    unsigned int *len);
 # ifndef OPENSSL_NO_STDIO
-PKCS7 *d2i_PKCS7_fp(FILE *fp, PKCS7 **p7);
-int i2d_PKCS7_fp(FILE *fp, PKCS7 *p7);
+PKCS7 * __cdecl d2i_PKCS7_fp(FILE *fp, PKCS7 **p7);
+int __cdecl i2d_PKCS7_fp(FILE *fp, PKCS7 *p7);
 # endif
-PKCS7 *PKCS7_dup(PKCS7 *p7);
-PKCS7 *d2i_PKCS7_bio(BIO *bp, PKCS7 **p7);
-int i2d_PKCS7_bio(BIO *bp, PKCS7 *p7);
-int i2d_PKCS7_bio_stream(BIO *out, PKCS7 *p7, BIO *in, int flags);
-int PEM_write_bio_PKCS7_stream(BIO *out, PKCS7 *p7, BIO *in, int flags);
+PKCS7 * __cdecl PKCS7_dup(PKCS7 *p7);
+PKCS7 * __cdecl d2i_PKCS7_bio(BIO *bp, PKCS7 **p7);
+int __cdecl i2d_PKCS7_bio(BIO *bp, PKCS7 *p7);
+int __cdecl i2d_PKCS7_bio_stream(BIO *out, PKCS7 *p7, BIO *in, int flags);
+int __cdecl PEM_write_bio_PKCS7_stream(BIO *out, PKCS7 *p7, BIO *in, int flags);
 
 DECLARE_ASN1_FUNCTIONS(PKCS7_SIGNER_INFO)
 DECLARE_ASN1_FUNCTIONS(PKCS7_RECIP_INFO)
@@ -232,86 +232,86 @@ DECLARE_ASN1_ITEM(PKCS7_ATTR_VERIFY)
 DECLARE_ASN1_NDEF_FUNCTION(PKCS7)
 DECLARE_ASN1_PRINT_FUNCTION(PKCS7)
 
-long PKCS7_ctrl(PKCS7 *p7, int cmd, long larg, char *parg);
+long __cdecl PKCS7_ctrl(PKCS7 *p7, int cmd, long larg, char *parg);
 
-int PKCS7_set_type(PKCS7 *p7, int type);
-int PKCS7_set0_type_other(PKCS7 *p7, int type, ASN1_TYPE *other);
-int PKCS7_set_content(PKCS7 *p7, PKCS7 *p7_data);
-int PKCS7_SIGNER_INFO_set(PKCS7_SIGNER_INFO *p7i, X509 *x509, EVP_PKEY *pkey,
+int __cdecl PKCS7_set_type(PKCS7 *p7, int type);
+int __cdecl PKCS7_set0_type_other(PKCS7 *p7, int type, ASN1_TYPE *other);
+int __cdecl PKCS7_set_content(PKCS7 *p7, PKCS7 *p7_data);
+int __cdecl PKCS7_SIGNER_INFO_set(PKCS7_SIGNER_INFO *p7i, X509 *x509, EVP_PKEY *pkey,
                           const EVP_MD *dgst);
-int PKCS7_SIGNER_INFO_sign(PKCS7_SIGNER_INFO *si);
-int PKCS7_add_signer(PKCS7 *p7, PKCS7_SIGNER_INFO *p7i);
-int PKCS7_add_certificate(PKCS7 *p7, X509 *x509);
-int PKCS7_add_crl(PKCS7 *p7, X509_CRL *x509);
-int PKCS7_content_new(PKCS7 *p7, int nid);
-int PKCS7_dataVerify(X509_STORE *cert_store, X509_STORE_CTX *ctx,
+int __cdecl PKCS7_SIGNER_INFO_sign(PKCS7_SIGNER_INFO *si);
+int __cdecl PKCS7_add_signer(PKCS7 *p7, PKCS7_SIGNER_INFO *p7i);
+int __cdecl PKCS7_add_certificate(PKCS7 *p7, X509 *x509);
+int __cdecl PKCS7_add_crl(PKCS7 *p7, X509_CRL *x509);
+int __cdecl PKCS7_content_new(PKCS7 *p7, int nid);
+int __cdecl PKCS7_dataVerify(X509_STORE *cert_store, X509_STORE_CTX *ctx,
                      BIO *bio, PKCS7 *p7, PKCS7_SIGNER_INFO *si);
-int PKCS7_signatureVerify(BIO *bio, PKCS7 *p7, PKCS7_SIGNER_INFO *si,
+int __cdecl PKCS7_signatureVerify(BIO *bio, PKCS7 *p7, PKCS7_SIGNER_INFO *si,
                           X509 *x509);
 
-BIO *PKCS7_dataInit(PKCS7 *p7, BIO *bio);
-int PKCS7_dataFinal(PKCS7 *p7, BIO *bio);
-BIO *PKCS7_dataDecode(PKCS7 *p7, EVP_PKEY *pkey, BIO *in_bio, X509 *pcert);
+BIO * __cdecl PKCS7_dataInit(PKCS7 *p7, BIO *bio);
+int __cdecl PKCS7_dataFinal(PKCS7 *p7, BIO *bio);
+BIO * __cdecl PKCS7_dataDecode(PKCS7 *p7, EVP_PKEY *pkey, BIO *in_bio, X509 *pcert);
 
-PKCS7_SIGNER_INFO *PKCS7_add_signature(PKCS7 *p7, X509 *x509,
+PKCS7_SIGNER_INFO * __cdecl PKCS7_add_signature(PKCS7 *p7, X509 *x509,
                                        EVP_PKEY *pkey, const EVP_MD *dgst);
-X509 *PKCS7_cert_from_signer_info(PKCS7 *p7, PKCS7_SIGNER_INFO *si);
-int PKCS7_set_digest(PKCS7 *p7, const EVP_MD *md);
-STACK_OF(PKCS7_SIGNER_INFO) *PKCS7_get_signer_info(PKCS7 *p7);
+X509 * __cdecl PKCS7_cert_from_signer_info(PKCS7 *p7, PKCS7_SIGNER_INFO *si);
+int __cdecl PKCS7_set_digest(PKCS7 *p7, const EVP_MD *md);
+STACK_OF(PKCS7_SIGNER_INFO) * __cdecl PKCS7_get_signer_info(PKCS7 *p7);
 
-PKCS7_RECIP_INFO *PKCS7_add_recipient(PKCS7 *p7, X509 *x509);
-void PKCS7_SIGNER_INFO_get0_algs(PKCS7_SIGNER_INFO *si, EVP_PKEY **pk,
+PKCS7_RECIP_INFO * __cdecl PKCS7_add_recipient(PKCS7 *p7, X509 *x509);
+void __cdecl PKCS7_SIGNER_INFO_get0_algs(PKCS7_SIGNER_INFO *si, EVP_PKEY **pk,
                                  X509_ALGOR **pdig, X509_ALGOR **psig);
-void PKCS7_RECIP_INFO_get0_alg(PKCS7_RECIP_INFO *ri, X509_ALGOR **penc);
-int PKCS7_add_recipient_info(PKCS7 *p7, PKCS7_RECIP_INFO *ri);
-int PKCS7_RECIP_INFO_set(PKCS7_RECIP_INFO *p7i, X509 *x509);
-int PKCS7_set_cipher(PKCS7 *p7, const EVP_CIPHER *cipher);
-int PKCS7_stream(unsigned char ***boundary, PKCS7 *p7);
-
-PKCS7_ISSUER_AND_SERIAL *PKCS7_get_issuer_and_serial(PKCS7 *p7, int idx);
-ASN1_OCTET_STRING *PKCS7_digest_from_attributes(STACK_OF(X509_ATTRIBUTE) *sk);
-int PKCS7_add_signed_attribute(PKCS7_SIGNER_INFO *p7si, int nid, int type,
+void __cdecl PKCS7_RECIP_INFO_get0_alg(PKCS7_RECIP_INFO *ri, X509_ALGOR **penc);
+int __cdecl PKCS7_add_recipient_info(PKCS7 *p7, PKCS7_RECIP_INFO *ri);
+int __cdecl PKCS7_RECIP_INFO_set(PKCS7_RECIP_INFO *p7i, X509 *x509);
+int __cdecl PKCS7_set_cipher(PKCS7 *p7, const EVP_CIPHER *cipher);
+int __cdecl PKCS7_stream(unsigned char ***boundary, PKCS7 *p7);
+
+PKCS7_ISSUER_AND_SERIAL * __cdecl PKCS7_get_issuer_and_serial(PKCS7 *p7, int idx);
+ASN1_OCTET_STRING * __cdecl PKCS7_digest_from_attributes(STACK_OF(X509_ATTRIBUTE) *sk);
+int __cdecl PKCS7_add_signed_attribute(PKCS7_SIGNER_INFO *p7si, int nid, int type,
                                void *data);
-int PKCS7_add_attribute(PKCS7_SIGNER_INFO *p7si, int nid, int atrtype,
+int __cdecl PKCS7_add_attribute(PKCS7_SIGNER_INFO *p7si, int nid, int atrtype,
                         void *value);
-ASN1_TYPE *PKCS7_get_attribute(PKCS7_SIGNER_INFO *si, int nid);
-ASN1_TYPE *PKCS7_get_signed_attribute(PKCS7_SIGNER_INFO *si, int nid);
-int PKCS7_set_signed_attributes(PKCS7_SIGNER_INFO *p7si,
+ASN1_TYPE * __cdecl PKCS7_get_attribute(PKCS7_SIGNER_INFO *si, int nid);
+ASN1_TYPE * __cdecl PKCS7_get_signed_attribute(PKCS7_SIGNER_INFO *si, int nid);
+int __cdecl PKCS7_set_signed_attributes(PKCS7_SIGNER_INFO *p7si,
                                 STACK_OF(X509_ATTRIBUTE) *sk);
-int PKCS7_set_attributes(PKCS7_SIGNER_INFO *p7si,
+int __cdecl PKCS7_set_attributes(PKCS7_SIGNER_INFO *p7si,
                          STACK_OF(X509_ATTRIBUTE) *sk);
 
-PKCS7 *PKCS7_sign(X509 *signcert, EVP_PKEY *pkey, STACK_OF(X509) *certs,
+PKCS7 * __cdecl PKCS7_sign(X509 *signcert, EVP_PKEY *pkey, STACK_OF(X509) *certs,
                   BIO *data, int flags);
 
-PKCS7_SIGNER_INFO *PKCS7_sign_add_signer(PKCS7 *p7,
+PKCS7_SIGNER_INFO * __cdecl PKCS7_sign_add_signer(PKCS7 *p7,
                                          X509 *signcert, EVP_PKEY *pkey,
                                          const EVP_MD *md, int flags);
 
-int PKCS7_final(PKCS7 *p7, BIO *data, int flags);
-int PKCS7_verify(PKCS7 *p7, STACK_OF(X509) *certs, X509_STORE *store,
+int __cdecl PKCS7_final(PKCS7 *p7, BIO *data, int flags);
+int __cdecl PKCS7_verify(PKCS7 *p7, STACK_OF(X509) *certs, X509_STORE *store,
                  BIO *indata, BIO *out, int flags);
-STACK_OF(X509) *PKCS7_get0_signers(PKCS7 *p7, STACK_OF(X509) *certs,
+STACK_OF(X509) * __cdecl PKCS7_get0_signers(PKCS7 *p7, STACK_OF(X509) *certs,
                                    int flags);
-PKCS7 *PKCS7_encrypt(STACK_OF(X509) *certs, BIO *in, const EVP_CIPHER *cipher,
+PKCS7 * __cdecl PKCS7_encrypt(STACK_OF(X509) *certs, BIO *in, const EVP_CIPHER *cipher,
                      int flags);
-int PKCS7_decrypt(PKCS7 *p7, EVP_PKEY *pkey, X509 *cert, BIO *data,
+int __cdecl PKCS7_decrypt(PKCS7 *p7, EVP_PKEY *pkey, X509 *cert, BIO *data,
                   int flags);
 
-int PKCS7_add_attrib_smimecap(PKCS7_SIGNER_INFO *si,
+int __cdecl PKCS7_add_attrib_smimecap(PKCS7_SIGNER_INFO *si,
                               STACK_OF(X509_ALGOR) *cap);
-STACK_OF(X509_ALGOR) *PKCS7_get_smimecap(PKCS7_SIGNER_INFO *si);
-int PKCS7_simple_smimecap(STACK_OF(X509_ALGOR) *sk, int nid, int arg);
+STACK_OF(X509_ALGOR) * __cdecl PKCS7_get_smimecap(PKCS7_SIGNER_INFO *si);
+int __cdecl PKCS7_simple_smimecap(STACK_OF(X509_ALGOR) *sk, int nid, int arg);
 
-int PKCS7_add_attrib_content_type(PKCS7_SIGNER_INFO *si, ASN1_OBJECT *coid);
-int PKCS7_add0_attrib_signing_time(PKCS7_SIGNER_INFO *si, ASN1_TIME *t);
-int PKCS7_add1_attrib_digest(PKCS7_SIGNER_INFO *si,
+int __cdecl PKCS7_add_attrib_content_type(PKCS7_SIGNER_INFO *si, ASN1_OBJECT *coid);
+int __cdecl PKCS7_add0_attrib_signing_time(PKCS7_SIGNER_INFO *si, ASN1_TIME *t);
+int __cdecl PKCS7_add1_attrib_digest(PKCS7_SIGNER_INFO *si,
                              const unsigned char *md, int mdlen);
 
-int SMIME_write_PKCS7(BIO *bio, PKCS7 *p7, BIO *data, int flags);
-PKCS7 *SMIME_read_PKCS7(BIO *bio, BIO **bcont);
+int __cdecl SMIME_write_PKCS7(BIO *bio, PKCS7 *p7, BIO *data, int flags);
+PKCS7 * __cdecl SMIME_read_PKCS7(BIO *bio, BIO **bcont);
 
-BIO *BIO_new_PKCS7(BIO *out, PKCS7 *p7);
+BIO * __cdecl BIO_new_PKCS7(BIO *out, PKCS7 *p7);
 
 # ifdef  __cplusplus
 }
diff --git a/include/openssl/pkcs7err.h b/include/openssl/pkcs7err.h
index 02e0299a3c..b1cb13ef72 100644
--- a/include/openssl/pkcs7err.h
+++ b/include/openssl/pkcs7err.h
@@ -18,7 +18,7 @@
 # ifdef  __cplusplus
 extern "C"
 # endif
-int ERR_load_PKCS7_strings(void);
+int __cdecl ERR_load_PKCS7_strings(void);
 
 /*
  * PKCS7 function codes.
diff --git a/include/openssl/ripemd.h b/include/openssl/ripemd.h
index c42026aa42..0c0845a545 100644
--- a/include/openssl/ripemd.h
+++ b/include/openssl/ripemd.h
@@ -32,11 +32,11 @@ typedef struct RIPEMD160state_st {
     unsigned int num;
 } RIPEMD160_CTX;
 
-int RIPEMD160_Init(RIPEMD160_CTX *c);
-int RIPEMD160_Update(RIPEMD160_CTX *c, const void *data, size_t len);
-int RIPEMD160_Final(unsigned char *md, RIPEMD160_CTX *c);
+int __cdecl RIPEMD160_Init(RIPEMD160_CTX *c);
+int __cdecl RIPEMD160_Update(RIPEMD160_CTX *c, const void *data, size_t len);
+int __cdecl RIPEMD160_Final(unsigned char *md, RIPEMD160_CTX *c);
 unsigned char *RIPEMD160(const unsigned char *d, size_t n, unsigned char *md);
-void RIPEMD160_Transform(RIPEMD160_CTX *c, const unsigned char *b);
+void __cdecl RIPEMD160_Transform(RIPEMD160_CTX *c, const unsigned char *b);
 
 # ifdef  __cplusplus
 }
diff --git a/include/openssl/rsa.h b/include/openssl/rsa.h
index cdce1264eb..037bf42a88 100644
--- a/include/openssl/rsa.h
+++ b/include/openssl/rsa.h
@@ -195,7 +195,7 @@ extern "C" {
 # define RSA_set_app_data(s,arg)         RSA_set_ex_data(s,0,arg)
 # define RSA_get_app_data(s)             RSA_get_ex_data(s,0)
 
-RSA *RSA_new(void);
+RSA * __cdecl RSA_new(void);
 RSA *RSA_new_method(ENGINE *engine);
 int RSA_bits(const RSA *rsa);
 int RSA_size(const RSA *rsa);
@@ -427,81 +427,81 @@ int RSA_meth_get_flags(const RSA_METHOD *meth);
 int RSA_meth_set_flags(RSA_METHOD *meth, int flags);
 void *RSA_meth_get0_app_data(const RSA_METHOD *meth);
 int RSA_meth_set0_app_data(RSA_METHOD *meth, void *app_data);
-int (*RSA_meth_get_pub_enc(const RSA_METHOD *meth))
+int (__cdecl *RSA_meth_get_pub_enc(const RSA_METHOD *meth))
     (int flen, const unsigned char *from,
      unsigned char *to, RSA *rsa, int padding);
-int RSA_meth_set_pub_enc(RSA_METHOD *rsa,
-                         int (*pub_enc) (int flen, const unsigned char *from,
+int __cdecl RSA_meth_set_pub_enc(RSA_METHOD *rsa,
+                         int (__cdecl *pub_enc) (int flen, const unsigned char *from,
                                          unsigned char *to, RSA *rsa,
                                          int padding));
-int (*RSA_meth_get_pub_dec(const RSA_METHOD *meth))
+int (__cdecl *RSA_meth_get_pub_dec(const RSA_METHOD *meth))
     (int flen, const unsigned char *from,
      unsigned char *to, RSA *rsa, int padding);
-int RSA_meth_set_pub_dec(RSA_METHOD *rsa,
-                         int (*pub_dec) (int flen, const unsigned char *from,
+int __cdecl RSA_meth_set_pub_dec(RSA_METHOD *rsa,
+                         int (__cdecl *pub_dec) (int flen, const unsigned char *from,
                                          unsigned char *to, RSA *rsa,
                                          int padding));
-int (*RSA_meth_get_priv_enc(const RSA_METHOD *meth))
+int (__cdecl *RSA_meth_get_priv_enc(const RSA_METHOD *meth))
     (int flen, const unsigned char *from,
      unsigned char *to, RSA *rsa, int padding);
-int RSA_meth_set_priv_enc(RSA_METHOD *rsa,
-                          int (*priv_enc) (int flen, const unsigned char *from,
+int __cdecl RSA_meth_set_priv_enc(RSA_METHOD *rsa,
+                          int (__cdecl *priv_enc) (int flen, const unsigned char *from,
                                            unsigned char *to, RSA *rsa,
                                            int padding));
-int (*RSA_meth_get_priv_dec(const RSA_METHOD *meth))
+int (__cdecl *RSA_meth_get_priv_dec(const RSA_METHOD *meth))
     (int flen, const unsigned char *from,
      unsigned char *to, RSA *rsa, int padding);
-int RSA_meth_set_priv_dec(RSA_METHOD *rsa,
-                          int (*priv_dec) (int flen, const unsigned char *from,
+int __cdecl RSA_meth_set_priv_dec(RSA_METHOD *rsa,
+                          int (__cdecl *priv_dec) (int flen, const unsigned char *from,
                                            unsigned char *to, RSA *rsa,
                                            int padding));
-int (*RSA_meth_get_mod_exp(const RSA_METHOD *meth))
+int (__cdecl *RSA_meth_get_mod_exp(const RSA_METHOD *meth))
     (BIGNUM *r0, const BIGNUM *i, RSA *rsa, BN_CTX *ctx);
-int RSA_meth_set_mod_exp(RSA_METHOD *rsa,
-                         int (*mod_exp) (BIGNUM *r0, const BIGNUM *i, RSA *rsa,
+int __cdecl RSA_meth_set_mod_exp(RSA_METHOD *rsa,
+                         int (__cdecl *mod_exp) (BIGNUM *r0, const BIGNUM *i, RSA *rsa,
                                          BN_CTX *ctx));
-int (*RSA_meth_get_bn_mod_exp(const RSA_METHOD *meth))
+int (__cdecl *RSA_meth_get_bn_mod_exp(const RSA_METHOD *meth))
     (BIGNUM *r, const BIGNUM *a, const BIGNUM *p,
      const BIGNUM *m, BN_CTX *ctx, BN_MONT_CTX *m_ctx);
-int RSA_meth_set_bn_mod_exp(RSA_METHOD *rsa,
-                            int (*bn_mod_exp) (BIGNUM *r,
+int __cdecl RSA_meth_set_bn_mod_exp(RSA_METHOD *rsa,
+                            int (__cdecl *bn_mod_exp) (BIGNUM *r,
                                                const BIGNUM *a,
                                                const BIGNUM *p,
                                                const BIGNUM *m,
                                                BN_CTX *ctx,
                                                BN_MONT_CTX *m_ctx));
-int (*RSA_meth_get_init(const RSA_METHOD *meth)) (RSA *rsa);
-int RSA_meth_set_init(RSA_METHOD *rsa, int (*init) (RSA *rsa));
-int (*RSA_meth_get_finish(const RSA_METHOD *meth)) (RSA *rsa);
-int RSA_meth_set_finish(RSA_METHOD *rsa, int (*finish) (RSA *rsa));
-int (*RSA_meth_get_sign(const RSA_METHOD *meth))
+int (__cdecl *RSA_meth_get_init(const RSA_METHOD *meth)) (RSA *rsa);
+int __cdecl RSA_meth_set_init(RSA_METHOD *rsa, int (__cdecl *init) (RSA *rsa));
+int (__cdecl *RSA_meth_get_finish(const RSA_METHOD *meth)) (RSA *rsa);
+int __cdecl RSA_meth_set_finish(RSA_METHOD *rsa, int (__cdecl *finish) (RSA *rsa));
+int (__cdecl *RSA_meth_get_sign(const RSA_METHOD *meth))
     (int type,
      const unsigned char *m, unsigned int m_length,
      unsigned char *sigret, unsigned int *siglen,
      const RSA *rsa);
-int RSA_meth_set_sign(RSA_METHOD *rsa,
-                      int (*sign) (int type, const unsigned char *m,
+int __cdecl RSA_meth_set_sign(RSA_METHOD *rsa,
+                      int (__cdecl *sign) (int type, const unsigned char *m,
                                    unsigned int m_length,
                                    unsigned char *sigret, unsigned int *siglen,
                                    const RSA *rsa));
-int (*RSA_meth_get_verify(const RSA_METHOD *meth))
+int (__cdecl *RSA_meth_get_verify(const RSA_METHOD *meth))
     (int dtype, const unsigned char *m,
      unsigned int m_length, const unsigned char *sigbuf,
      unsigned int siglen, const RSA *rsa);
-int RSA_meth_set_verify(RSA_METHOD *rsa,
-                        int (*verify) (int dtype, const unsigned char *m,
+int __cdecl RSA_meth_set_verify(RSA_METHOD *rsa,
+                        int (__cdecl *verify) (int dtype, const unsigned char *m,
                                        unsigned int m_length,
                                        const unsigned char *sigbuf,
                                        unsigned int siglen, const RSA *rsa));
-int (*RSA_meth_get_keygen(const RSA_METHOD *meth))
+int (__cdecl *RSA_meth_get_keygen(const RSA_METHOD *meth))
     (RSA *rsa, int bits, BIGNUM *e, BN_GENCB *cb);
-int RSA_meth_set_keygen(RSA_METHOD *rsa,
-                        int (*keygen) (RSA *rsa, int bits, BIGNUM *e,
+int __cdecl RSA_meth_set_keygen(RSA_METHOD *rsa,
+                        int (__cdecl *keygen) (RSA *rsa, int bits, BIGNUM *e,
                                        BN_GENCB *cb));
-int (*RSA_meth_get_multi_prime_keygen(const RSA_METHOD *meth))
+int (__cdecl *RSA_meth_get_multi_prime_keygen(const RSA_METHOD *meth))
     (RSA *rsa, int bits, int primes, BIGNUM *e, BN_GENCB *cb);
-int RSA_meth_set_multi_prime_keygen(RSA_METHOD *meth,
-                                    int (*keygen) (RSA *rsa, int bits,
+int __cdecl RSA_meth_set_multi_prime_keygen(RSA_METHOD *meth,
+                                    int (__cdecl *keygen) (RSA *rsa, int bits,
                                                    int primes, BIGNUM *e,
                                                    BN_GENCB *cb));
 
diff --git a/include/openssl/safestack.h b/include/openssl/safestack.h
index 38b5578978..0d317b8a56 100644
--- a/include/openssl/safestack.h
+++ b/include/openssl/safestack.h
@@ -21,9 +21,9 @@ extern "C" {
 
 # define SKM_DEFINE_STACK_OF(t1, t2, t3) \
     STACK_OF(t1); \
-    typedef int (*sk_##t1##_compfunc)(const t3 * const *a, const t3 *const *b); \
-    typedef void (*sk_##t1##_freefunc)(t3 *a); \
-    typedef t3 * (*sk_##t1##_copyfunc)(const t3 *a); \
+    typedef int (__cdecl *sk_##t1##_compfunc)(const t3 * const *a, const t3 *const *b); \
+    typedef void (__cdecl *sk_##t1##_freefunc)(t3 *a); \
+    typedef t3 * (__cdecl *sk_##t1##_copyfunc)(const t3 *a); \
     static ossl_unused ossl_inline int sk_##t1##_num(const STACK_OF(t1) *sk) \
     { \
         return OPENSSL_sk_num((const OPENSSL_STACK *)sk); \
diff --git a/include/openssl/sha.h b/include/openssl/sha.h
index 6a1eb0de8b..e2ee74e392 100644
--- a/include/openssl/sha.h
+++ b/include/openssl/sha.h
@@ -38,11 +38,11 @@ typedef struct SHAstate_st {
     unsigned int num;
 } SHA_CTX;
 
-int SHA1_Init(SHA_CTX *c);
-int SHA1_Update(SHA_CTX *c, const void *data, size_t len);
-int SHA1_Final(unsigned char *md, SHA_CTX *c);
-unsigned char *SHA1(const unsigned char *d, size_t n, unsigned char *md);
-void SHA1_Transform(SHA_CTX *c, const unsigned char *data);
+int __cdecl SHA1_Init(SHA_CTX *c);
+int __cdecl SHA1_Update(SHA_CTX *c, const void *data, size_t len);
+int __cdecl SHA1_Final(unsigned char *md, SHA_CTX *c);
+unsigned char * __cdecl SHA1(const unsigned char *d, size_t n, unsigned char *md);
+void __cdecl SHA1_Transform(SHA_CTX *c, const unsigned char *data);
 
 # define SHA256_CBLOCK   (SHA_LBLOCK*4)/* SHA-256 treats input data as a
                                         * contiguous array of 32 bit wide
@@ -59,11 +59,11 @@ int SHA224_Init(SHA256_CTX *c);
 int SHA224_Update(SHA256_CTX *c, const void *data, size_t len);
 int SHA224_Final(unsigned char *md, SHA256_CTX *c);
 unsigned char *SHA224(const unsigned char *d, size_t n, unsigned char *md);
-int SHA256_Init(SHA256_CTX *c);
-int SHA256_Update(SHA256_CTX *c, const void *data, size_t len);
-int SHA256_Final(unsigned char *md, SHA256_CTX *c);
-unsigned char *SHA256(const unsigned char *d, size_t n, unsigned char *md);
-void SHA256_Transform(SHA256_CTX *c, const unsigned char *data);
+int __cdecl SHA256_Init(SHA256_CTX *c);
+int __cdecl SHA256_Update(SHA256_CTX *c, const void *data, size_t len);
+int __cdecl SHA256_Final(unsigned char *md, SHA256_CTX *c);
+unsigned char * __cdecl SHA256(const unsigned char *d, size_t n, unsigned char *md);
+void __cdecl SHA256_Transform(SHA256_CTX *c, const unsigned char *data);
 
 # define SHA224_DIGEST_LENGTH    28
 # define SHA256_DIGEST_LENGTH    32
diff --git a/include/openssl/srp.h b/include/openssl/srp.h
index aaf13558e3..6fbf8aee4d 100644
--- a/include/openssl/srp.h
+++ b/include/openssl/srp.h
@@ -47,7 +47,7 @@ typedef struct SRP_user_pwd_st {
     char *info;
 } SRP_user_pwd;
 
-void SRP_user_pwd_free(SRP_user_pwd *user_pwd);
+void __cdecl SRP_user_pwd_free(SRP_user_pwd *user_pwd);
 
 DEFINE_STACK_OF(SRP_user_pwd)
 
diff --git a/include/openssl/ssl.h b/include/openssl/ssl.h
index 6724ccf2d2..d6717a06d4 100644
--- a/include/openssl/ssl.h
+++ b/include/openssl/ssl.h
@@ -1648,7 +1648,7 @@ __owur int SSL_SESSION_set1_id(SSL_SESSION *s, const unsigned char *sid,
                                unsigned int sid_len);
 __owur int SSL_SESSION_is_resumable(const SSL_SESSION *s);
 
-__owur SSL_SESSION *SSL_SESSION_new(void);
+__owur SSL_SESSION * __cdecl SSL_SESSION_new(void);
 __owur SSL_SESSION *SSL_SESSION_dup(SSL_SESSION *src);
 const unsigned char *SSL_SESSION_get_id(const SSL_SESSION *s,
                                         unsigned int *len);
@@ -1662,7 +1662,7 @@ int SSL_SESSION_print(BIO *fp, const SSL_SESSION *ses);
 int SSL_SESSION_print_keylog(BIO *bp, const SSL_SESSION *x);
 int SSL_SESSION_up_ref(SSL_SESSION *ses);
 void SSL_SESSION_free(SSL_SESSION *ses);
-__owur int i2d_SSL_SESSION(SSL_SESSION *in, unsigned char **pp);
+__owur int __cdecl i2d_SSL_SESSION(SSL_SESSION *in, unsigned char **pp);
 __owur int SSL_set_session(SSL *to, SSL_SESSION *session);
 int SSL_CTX_add_session(SSL_CTX *ctx, SSL_SESSION *session);
 int SSL_CTX_remove_session(SSL_CTX *ctx, SSL_SESSION *session);
@@ -1671,7 +1671,7 @@ __owur int SSL_set_generate_session_id(SSL *s, GEN_SESSION_CB cb);
 __owur int SSL_has_matching_session_id(const SSL *s,
                                        const unsigned char *id,
                                        unsigned int id_len);
-SSL_SESSION *d2i_SSL_SESSION(SSL_SESSION **a, const unsigned char **pp,
+SSL_SESSION * __cdecl d2i_SSL_SESSION(SSL_SESSION **a, const unsigned char **pp,
                              long length);
 
 # ifdef HEADER_X509_H
diff --git a/include/openssl/stack.h b/include/openssl/stack.h
index cfc075057a..e71b68d81a 100644
--- a/include/openssl/stack.h
+++ b/include/openssl/stack.h
@@ -16,12 +16,12 @@ extern "C" {
 
 typedef struct stack_st OPENSSL_STACK; /* Use STACK_OF(...) instead */
 
-typedef int (*OPENSSL_sk_compfunc)(const void *, const void *);
-typedef void (*OPENSSL_sk_freefunc)(void *);
-typedef void *(*OPENSSL_sk_copyfunc)(const void *);
+typedef int (__cdecl *OPENSSL_sk_compfunc)(const void *, const void *);
+typedef void (__cdecl *OPENSSL_sk_freefunc)(void *);
+typedef void *(__cdecl *OPENSSL_sk_copyfunc)(const void *);
 
-int OPENSSL_sk_num(const OPENSSL_STACK *);
-void *OPENSSL_sk_value(const OPENSSL_STACK *, int);
+int __cdecl OPENSSL_sk_num(const OPENSSL_STACK *);
+void * __cdecl OPENSSL_sk_value(const OPENSSL_STACK *, int);
 
 void *OPENSSL_sk_set(OPENSSL_STACK *st, int i, const void *data);
 
@@ -30,7 +30,7 @@ OPENSSL_STACK *OPENSSL_sk_new_null(void);
 OPENSSL_STACK *OPENSSL_sk_new_reserve(OPENSSL_sk_compfunc c, int n);
 int OPENSSL_sk_reserve(OPENSSL_STACK *st, int n);
 void OPENSSL_sk_free(OPENSSL_STACK *);
-void OPENSSL_sk_pop_free(OPENSSL_STACK *st, void (*func) (void *));
+void __cdecl OPENSSL_sk_pop_free(OPENSSL_STACK *st, void (__cdecl *func) (void *));
 OPENSSL_STACK *OPENSSL_sk_deep_copy(const OPENSSL_STACK *,
                                     OPENSSL_sk_copyfunc c,
                                     OPENSSL_sk_freefunc f);
diff --git a/include/openssl/store.h b/include/openssl/store.h
index a40a7339e6..00b9ad2a3a 100644
--- a/include/openssl/store.h
+++ b/include/openssl/store.h
@@ -149,7 +149,7 @@ const char *OSSL_STORE_INFO_type_string(int type);
 /*
  * Free the OSSL_STORE_INFO
  */
-void OSSL_STORE_INFO_free(OSSL_STORE_INFO *info);
+void __cdecl OSSL_STORE_INFO_free(OSSL_STORE_INFO *info);
 
 
 /*-
diff --git a/include/openssl/ts.h b/include/openssl/ts.h
index 3b58aa527e..2fa90dbfea 100644
--- a/include/openssl/ts.h
+++ b/include/openssl/ts.h
@@ -68,216 +68,216 @@ DEFINE_STACK_OF(ESS_CERT_ID_V2)
 
 typedef struct TS_resp_st TS_RESP;
 
-TS_REQ *TS_REQ_new(void);
-void TS_REQ_free(TS_REQ *a);
-int i2d_TS_REQ(const TS_REQ *a, unsigned char **pp);
-TS_REQ *d2i_TS_REQ(TS_REQ **a, const unsigned char **pp, long length);
+TS_REQ * __cdecl TS_REQ_new(void);
+void __cdecl TS_REQ_free(TS_REQ *a);
+int __cdecl i2d_TS_REQ(const TS_REQ *a, unsigned char **pp);
+TS_REQ * __cdecl d2i_TS_REQ(TS_REQ **a, const unsigned char **pp, long length);
 
-TS_REQ *TS_REQ_dup(TS_REQ *a);
+TS_REQ * __cdecl TS_REQ_dup(TS_REQ *a);
 
 #ifndef OPENSSL_NO_STDIO
-TS_REQ *d2i_TS_REQ_fp(FILE *fp, TS_REQ **a);
-int i2d_TS_REQ_fp(FILE *fp, TS_REQ *a);
+TS_REQ * __cdecl d2i_TS_REQ_fp(FILE *fp, TS_REQ **a);
+int __cdecl i2d_TS_REQ_fp(FILE *fp, TS_REQ *a);
 #endif
-TS_REQ *d2i_TS_REQ_bio(BIO *fp, TS_REQ **a);
-int i2d_TS_REQ_bio(BIO *fp, TS_REQ *a);
+TS_REQ * __cdecl d2i_TS_REQ_bio(BIO *fp, TS_REQ **a);
+int __cdecl i2d_TS_REQ_bio(BIO *fp, TS_REQ *a);
 
-TS_MSG_IMPRINT *TS_MSG_IMPRINT_new(void);
-void TS_MSG_IMPRINT_free(TS_MSG_IMPRINT *a);
-int i2d_TS_MSG_IMPRINT(const TS_MSG_IMPRINT *a, unsigned char **pp);
-TS_MSG_IMPRINT *d2i_TS_MSG_IMPRINT(TS_MSG_IMPRINT **a,
+TS_MSG_IMPRINT * __cdecl TS_MSG_IMPRINT_new(void);
+void __cdecl TS_MSG_IMPRINT_free(TS_MSG_IMPRINT *a);
+int __cdecl i2d_TS_MSG_IMPRINT(const TS_MSG_IMPRINT *a, unsigned char **pp);
+TS_MSG_IMPRINT * __cdecl d2i_TS_MSG_IMPRINT(TS_MSG_IMPRINT **a,
                                    const unsigned char **pp, long length);
 
-TS_MSG_IMPRINT *TS_MSG_IMPRINT_dup(TS_MSG_IMPRINT *a);
+TS_MSG_IMPRINT * __cdecl TS_MSG_IMPRINT_dup(TS_MSG_IMPRINT *a);
 
 #ifndef OPENSSL_NO_STDIO
-TS_MSG_IMPRINT *d2i_TS_MSG_IMPRINT_fp(FILE *fp, TS_MSG_IMPRINT **a);
-int i2d_TS_MSG_IMPRINT_fp(FILE *fp, TS_MSG_IMPRINT *a);
+TS_MSG_IMPRINT * __cdecl d2i_TS_MSG_IMPRINT_fp(FILE *fp, TS_MSG_IMPRINT **a);
+int __cdecl i2d_TS_MSG_IMPRINT_fp(FILE *fp, TS_MSG_IMPRINT *a);
 #endif
-TS_MSG_IMPRINT *d2i_TS_MSG_IMPRINT_bio(BIO *bio, TS_MSG_IMPRINT **a);
-int i2d_TS_MSG_IMPRINT_bio(BIO *bio, TS_MSG_IMPRINT *a);
+TS_MSG_IMPRINT * __cdecl d2i_TS_MSG_IMPRINT_bio(BIO *bio, TS_MSG_IMPRINT **a);
+int __cdecl i2d_TS_MSG_IMPRINT_bio(BIO *bio, TS_MSG_IMPRINT *a);
 
-TS_RESP *TS_RESP_new(void);
-void TS_RESP_free(TS_RESP *a);
-int i2d_TS_RESP(const TS_RESP *a, unsigned char **pp);
-TS_RESP *d2i_TS_RESP(TS_RESP **a, const unsigned char **pp, long length);
-TS_TST_INFO *PKCS7_to_TS_TST_INFO(PKCS7 *token);
-TS_RESP *TS_RESP_dup(TS_RESP *a);
+TS_RESP * __cdecl TS_RESP_new(void);
+void __cdecl TS_RESP_free(TS_RESP *a);
+int __cdecl i2d_TS_RESP(const TS_RESP *a, unsigned char **pp);
+TS_RESP * __cdecl d2i_TS_RESP(TS_RESP **a, const unsigned char **pp, long length);
+TS_TST_INFO * __cdecl PKCS7_to_TS_TST_INFO(PKCS7 *token);
+TS_RESP * __cdecl TS_RESP_dup(TS_RESP *a);
 
 #ifndef OPENSSL_NO_STDIO
-TS_RESP *d2i_TS_RESP_fp(FILE *fp, TS_RESP **a);
-int i2d_TS_RESP_fp(FILE *fp, TS_RESP *a);
+TS_RESP * __cdecl d2i_TS_RESP_fp(FILE *fp, TS_RESP **a);
+int __cdecl i2d_TS_RESP_fp(FILE *fp, TS_RESP *a);
 #endif
-TS_RESP *d2i_TS_RESP_bio(BIO *bio, TS_RESP **a);
-int i2d_TS_RESP_bio(BIO *bio, TS_RESP *a);
+TS_RESP * __cdecl d2i_TS_RESP_bio(BIO *bio, TS_RESP **a);
+int __cdecl i2d_TS_RESP_bio(BIO *bio, TS_RESP *a);
 
-TS_STATUS_INFO *TS_STATUS_INFO_new(void);
-void TS_STATUS_INFO_free(TS_STATUS_INFO *a);
-int i2d_TS_STATUS_INFO(const TS_STATUS_INFO *a, unsigned char **pp);
-TS_STATUS_INFO *d2i_TS_STATUS_INFO(TS_STATUS_INFO **a,
+TS_STATUS_INFO * __cdecl TS_STATUS_INFO_new(void);
+void __cdecl TS_STATUS_INFO_free(TS_STATUS_INFO *a);
+int __cdecl i2d_TS_STATUS_INFO(const TS_STATUS_INFO *a, unsigned char **pp);
+TS_STATUS_INFO * __cdecl d2i_TS_STATUS_INFO(TS_STATUS_INFO **a,
                                    const unsigned char **pp, long length);
-TS_STATUS_INFO *TS_STATUS_INFO_dup(TS_STATUS_INFO *a);
+TS_STATUS_INFO * __cdecl TS_STATUS_INFO_dup(TS_STATUS_INFO *a);
 
-TS_TST_INFO *TS_TST_INFO_new(void);
-void TS_TST_INFO_free(TS_TST_INFO *a);
-int i2d_TS_TST_INFO(const TS_TST_INFO *a, unsigned char **pp);
-TS_TST_INFO *d2i_TS_TST_INFO(TS_TST_INFO **a, const unsigned char **pp,
+TS_TST_INFO * __cdecl TS_TST_INFO_new(void);
+void __cdecl TS_TST_INFO_free(TS_TST_INFO *a);
+int __cdecl i2d_TS_TST_INFO(const TS_TST_INFO *a, unsigned char **pp);
+TS_TST_INFO * __cdecl d2i_TS_TST_INFO(TS_TST_INFO **a, const unsigned char **pp,
                              long length);
-TS_TST_INFO *TS_TST_INFO_dup(TS_TST_INFO *a);
+TS_TST_INFO * __cdecl TS_TST_INFO_dup(TS_TST_INFO *a);
 
 #ifndef OPENSSL_NO_STDIO
-TS_TST_INFO *d2i_TS_TST_INFO_fp(FILE *fp, TS_TST_INFO **a);
-int i2d_TS_TST_INFO_fp(FILE *fp, TS_TST_INFO *a);
+TS_TST_INFO * __cdecl d2i_TS_TST_INFO_fp(FILE *fp, TS_TST_INFO **a);
+int __cdecl i2d_TS_TST_INFO_fp(FILE *fp, TS_TST_INFO *a);
 #endif
-TS_TST_INFO *d2i_TS_TST_INFO_bio(BIO *bio, TS_TST_INFO **a);
-int i2d_TS_TST_INFO_bio(BIO *bio, TS_TST_INFO *a);
+TS_TST_INFO * __cdecl d2i_TS_TST_INFO_bio(BIO *bio, TS_TST_INFO **a);
+int __cdecl i2d_TS_TST_INFO_bio(BIO *bio, TS_TST_INFO *a);
 
-TS_ACCURACY *TS_ACCURACY_new(void);
-void TS_ACCURACY_free(TS_ACCURACY *a);
-int i2d_TS_ACCURACY(const TS_ACCURACY *a, unsigned char **pp);
-TS_ACCURACY *d2i_TS_ACCURACY(TS_ACCURACY **a, const unsigned char **pp,
+TS_ACCURACY * __cdecl TS_ACCURACY_new(void);
+void __cdecl TS_ACCURACY_free(TS_ACCURACY *a);
+int __cdecl i2d_TS_ACCURACY(const TS_ACCURACY *a, unsigned char **pp);
+TS_ACCURACY * __cdecl d2i_TS_ACCURACY(TS_ACCURACY **a, const unsigned char **pp,
                              long length);
-TS_ACCURACY *TS_ACCURACY_dup(TS_ACCURACY *a);
+TS_ACCURACY * __cdecl TS_ACCURACY_dup(TS_ACCURACY *a);
 
-ESS_ISSUER_SERIAL *ESS_ISSUER_SERIAL_new(void);
-void ESS_ISSUER_SERIAL_free(ESS_ISSUER_SERIAL *a);
-int i2d_ESS_ISSUER_SERIAL(const ESS_ISSUER_SERIAL *a, unsigned char **pp);
-ESS_ISSUER_SERIAL *d2i_ESS_ISSUER_SERIAL(ESS_ISSUER_SERIAL **a,
+ESS_ISSUER_SERIAL * __cdecl ESS_ISSUER_SERIAL_new(void);
+void __cdecl ESS_ISSUER_SERIAL_free(ESS_ISSUER_SERIAL *a);
+int __cdecl i2d_ESS_ISSUER_SERIAL(const ESS_ISSUER_SERIAL *a, unsigned char **pp);
+ESS_ISSUER_SERIAL * __cdecl d2i_ESS_ISSUER_SERIAL(ESS_ISSUER_SERIAL **a,
                                          const unsigned char **pp,
                                          long length);
-ESS_ISSUER_SERIAL *ESS_ISSUER_SERIAL_dup(ESS_ISSUER_SERIAL *a);
+ESS_ISSUER_SERIAL * __cdecl ESS_ISSUER_SERIAL_dup(ESS_ISSUER_SERIAL *a);
 
-ESS_CERT_ID *ESS_CERT_ID_new(void);
-void ESS_CERT_ID_free(ESS_CERT_ID *a);
-int i2d_ESS_CERT_ID(const ESS_CERT_ID *a, unsigned char **pp);
-ESS_CERT_ID *d2i_ESS_CERT_ID(ESS_CERT_ID **a, const unsigned char **pp,
+ESS_CERT_ID * __cdecl ESS_CERT_ID_new(void);
+void __cdecl ESS_CERT_ID_free(ESS_CERT_ID *a);
+int __cdecl i2d_ESS_CERT_ID(const ESS_CERT_ID *a, unsigned char **pp);
+ESS_CERT_ID * __cdecl d2i_ESS_CERT_ID(ESS_CERT_ID **a, const unsigned char **pp,
                              long length);
-ESS_CERT_ID *ESS_CERT_ID_dup(ESS_CERT_ID *a);
+ESS_CERT_ID * __cdecl ESS_CERT_ID_dup(ESS_CERT_ID *a);
 
-ESS_SIGNING_CERT *ESS_SIGNING_CERT_new(void);
-void ESS_SIGNING_CERT_free(ESS_SIGNING_CERT *a);
-int i2d_ESS_SIGNING_CERT(const ESS_SIGNING_CERT *a, unsigned char **pp);
-ESS_SIGNING_CERT *d2i_ESS_SIGNING_CERT(ESS_SIGNING_CERT **a,
+ESS_SIGNING_CERT * __cdecl ESS_SIGNING_CERT_new(void);
+void __cdecl ESS_SIGNING_CERT_free(ESS_SIGNING_CERT *a);
+int __cdecl i2d_ESS_SIGNING_CERT(const ESS_SIGNING_CERT *a, unsigned char **pp);
+ESS_SIGNING_CERT * __cdecl d2i_ESS_SIGNING_CERT(ESS_SIGNING_CERT **a,
                                        const unsigned char **pp, long length);
-ESS_SIGNING_CERT *ESS_SIGNING_CERT_dup(ESS_SIGNING_CERT *a);
+ESS_SIGNING_CERT * __cdecl ESS_SIGNING_CERT_dup(ESS_SIGNING_CERT *a);
 
-ESS_CERT_ID_V2 *ESS_CERT_ID_V2_new(void);
-void ESS_CERT_ID_V2_free(ESS_CERT_ID_V2 *a);
-int i2d_ESS_CERT_ID_V2(const ESS_CERT_ID_V2 *a, unsigned char **pp);
-ESS_CERT_ID_V2 *d2i_ESS_CERT_ID_V2(ESS_CERT_ID_V2 **a,
+ESS_CERT_ID_V2 * __cdecl ESS_CERT_ID_V2_new(void);
+void __cdecl ESS_CERT_ID_V2_free(ESS_CERT_ID_V2 *a);
+int __cdecl i2d_ESS_CERT_ID_V2(const ESS_CERT_ID_V2 *a, unsigned char **pp);
+ESS_CERT_ID_V2 * __cdecl d2i_ESS_CERT_ID_V2(ESS_CERT_ID_V2 **a,
                                    const unsigned char **pp, long length);
-ESS_CERT_ID_V2 *ESS_CERT_ID_V2_dup(ESS_CERT_ID_V2 *a);
+ESS_CERT_ID_V2 * __cdecl ESS_CERT_ID_V2_dup(ESS_CERT_ID_V2 *a);
 
-ESS_SIGNING_CERT_V2 *ESS_SIGNING_CERT_V2_new(void);
-void ESS_SIGNING_CERT_V2_free(ESS_SIGNING_CERT_V2 *a);
-int i2d_ESS_SIGNING_CERT_V2(const ESS_SIGNING_CERT_V2 *a, unsigned char **pp);
-ESS_SIGNING_CERT_V2 *d2i_ESS_SIGNING_CERT_V2(ESS_SIGNING_CERT_V2 **a,
+ESS_SIGNING_CERT_V2 * __cdecl ESS_SIGNING_CERT_V2_new(void);
+void __cdecl ESS_SIGNING_CERT_V2_free(ESS_SIGNING_CERT_V2 *a);
+int __cdecl i2d_ESS_SIGNING_CERT_V2(const ESS_SIGNING_CERT_V2 *a, unsigned char **pp);
+ESS_SIGNING_CERT_V2 * __cdecl d2i_ESS_SIGNING_CERT_V2(ESS_SIGNING_CERT_V2 **a,
                                              const unsigned char **pp,
                                              long length);
-ESS_SIGNING_CERT_V2 *ESS_SIGNING_CERT_V2_dup(ESS_SIGNING_CERT_V2 *a);
+ESS_SIGNING_CERT_V2 * __cdecl ESS_SIGNING_CERT_V2_dup(ESS_SIGNING_CERT_V2 *a);
 
-int TS_REQ_set_version(TS_REQ *a, long version);
-long TS_REQ_get_version(const TS_REQ *a);
+int __cdecl TS_REQ_set_version(TS_REQ *a, long version);
+long __cdecl TS_REQ_get_version(const TS_REQ *a);
 
-int TS_STATUS_INFO_set_status(TS_STATUS_INFO *a, int i);
-const ASN1_INTEGER *TS_STATUS_INFO_get0_status(const TS_STATUS_INFO *a);
+int __cdecl TS_STATUS_INFO_set_status(TS_STATUS_INFO *a, int i);
+const ASN1_INTEGER * __cdecl TS_STATUS_INFO_get0_status(const TS_STATUS_INFO *a);
 
 const STACK_OF(ASN1_UTF8STRING) *
-TS_STATUS_INFO_get0_text(const TS_STATUS_INFO *a);
+__cdecl TS_STATUS_INFO_get0_text(const TS_STATUS_INFO *a);
 
 const ASN1_BIT_STRING *
-TS_STATUS_INFO_get0_failure_info(const TS_STATUS_INFO *a);
+__cdecl TS_STATUS_INFO_get0_failure_info(const TS_STATUS_INFO *a);
 
-int TS_REQ_set_msg_imprint(TS_REQ *a, TS_MSG_IMPRINT *msg_imprint);
-TS_MSG_IMPRINT *TS_REQ_get_msg_imprint(TS_REQ *a);
+int __cdecl TS_REQ_set_msg_imprint(TS_REQ *a, TS_MSG_IMPRINT *msg_imprint);
+TS_MSG_IMPRINT * __cdecl TS_REQ_get_msg_imprint(TS_REQ *a);
 
-int TS_MSG_IMPRINT_set_algo(TS_MSG_IMPRINT *a, X509_ALGOR *alg);
-X509_ALGOR *TS_MSG_IMPRINT_get_algo(TS_MSG_IMPRINT *a);
+int __cdecl TS_MSG_IMPRINT_set_algo(TS_MSG_IMPRINT *a, X509_ALGOR *alg);
+X509_ALGOR * __cdecl TS_MSG_IMPRINT_get_algo(TS_MSG_IMPRINT *a);
 
-int TS_MSG_IMPRINT_set_msg(TS_MSG_IMPRINT *a, unsigned char *d, int len);
-ASN1_OCTET_STRING *TS_MSG_IMPRINT_get_msg(TS_MSG_IMPRINT *a);
+int __cdecl TS_MSG_IMPRINT_set_msg(TS_MSG_IMPRINT *a, unsigned char *d, int len);
+ASN1_OCTET_STRING * __cdecl TS_MSG_IMPRINT_get_msg(TS_MSG_IMPRINT *a);
 
-int TS_REQ_set_policy_id(TS_REQ *a, const ASN1_OBJECT *policy);
-ASN1_OBJECT *TS_REQ_get_policy_id(TS_REQ *a);
+int __cdecl TS_REQ_set_policy_id(TS_REQ *a, const ASN1_OBJECT *policy);
+ASN1_OBJECT * __cdecl TS_REQ_get_policy_id(TS_REQ *a);
 
-int TS_REQ_set_nonce(TS_REQ *a, const ASN1_INTEGER *nonce);
-const ASN1_INTEGER *TS_REQ_get_nonce(const TS_REQ *a);
+int __cdecl TS_REQ_set_nonce(TS_REQ *a, const ASN1_INTEGER *nonce);
+const ASN1_INTEGER * __cdecl TS_REQ_get_nonce(const TS_REQ *a);
 
-int TS_REQ_set_cert_req(TS_REQ *a, int cert_req);
-int TS_REQ_get_cert_req(const TS_REQ *a);
+int __cdecl TS_REQ_set_cert_req(TS_REQ *a, int cert_req);
+int __cdecl TS_REQ_get_cert_req(const TS_REQ *a);
 
-STACK_OF(X509_EXTENSION) *TS_REQ_get_exts(TS_REQ *a);
-void TS_REQ_ext_free(TS_REQ *a);
-int TS_REQ_get_ext_count(TS_REQ *a);
-int TS_REQ_get_ext_by_NID(TS_REQ *a, int nid, int lastpos);
-int TS_REQ_get_ext_by_OBJ(TS_REQ *a, const ASN1_OBJECT *obj, int lastpos);
-int TS_REQ_get_ext_by_critical(TS_REQ *a, int crit, int lastpos);
-X509_EXTENSION *TS_REQ_get_ext(TS_REQ *a, int loc);
-X509_EXTENSION *TS_REQ_delete_ext(TS_REQ *a, int loc);
-int TS_REQ_add_ext(TS_REQ *a, X509_EXTENSION *ex, int loc);
-void *TS_REQ_get_ext_d2i(TS_REQ *a, int nid, int *crit, int *idx);
+STACK_OF(X509_EXTENSION) * __cdecl TS_REQ_get_exts(TS_REQ *a);
+void __cdecl TS_REQ_ext_free(TS_REQ *a);
+int __cdecl TS_REQ_get_ext_count(TS_REQ *a);
+int __cdecl TS_REQ_get_ext_by_NID(TS_REQ *a, int nid, int lastpos);
+int __cdecl TS_REQ_get_ext_by_OBJ(TS_REQ *a, const ASN1_OBJECT *obj, int lastpos);
+int __cdecl TS_REQ_get_ext_by_critical(TS_REQ *a, int crit, int lastpos);
+X509_EXTENSION * __cdecl TS_REQ_get_ext(TS_REQ *a, int loc);
+X509_EXTENSION * __cdecl TS_REQ_delete_ext(TS_REQ *a, int loc);
+int __cdecl TS_REQ_add_ext(TS_REQ *a, X509_EXTENSION *ex, int loc);
+void * __cdecl TS_REQ_get_ext_d2i(TS_REQ *a, int nid, int *crit, int *idx);
 
 /* Function declarations for TS_REQ defined in ts/ts_req_print.c */
 
-int TS_REQ_print_bio(BIO *bio, TS_REQ *a);
+int __cdecl TS_REQ_print_bio(BIO *bio, TS_REQ *a);
 
 /* Function declarations for TS_RESP defined in ts/ts_resp_utils.c */
 
-int TS_RESP_set_status_info(TS_RESP *a, TS_STATUS_INFO *info);
-TS_STATUS_INFO *TS_RESP_get_status_info(TS_RESP *a);
+int __cdecl TS_RESP_set_status_info(TS_RESP *a, TS_STATUS_INFO *info);
+TS_STATUS_INFO * __cdecl TS_RESP_get_status_info(TS_RESP *a);
 
 /* Caller loses ownership of PKCS7 and TS_TST_INFO objects. */
-void TS_RESP_set_tst_info(TS_RESP *a, PKCS7 *p7, TS_TST_INFO *tst_info);
-PKCS7 *TS_RESP_get_token(TS_RESP *a);
-TS_TST_INFO *TS_RESP_get_tst_info(TS_RESP *a);
+void __cdecl TS_RESP_set_tst_info(TS_RESP *a, PKCS7 *p7, TS_TST_INFO *tst_info);
+PKCS7 * __cdecl TS_RESP_get_token(TS_RESP *a);
+TS_TST_INFO * __cdecl TS_RESP_get_tst_info(TS_RESP *a);
 
-int TS_TST_INFO_set_version(TS_TST_INFO *a, long version);
-long TS_TST_INFO_get_version(const TS_TST_INFO *a);
+int __cdecl TS_TST_INFO_set_version(TS_TST_INFO *a, long version);
+long __cdecl TS_TST_INFO_get_version(const TS_TST_INFO *a);
 
-int TS_TST_INFO_set_policy_id(TS_TST_INFO *a, ASN1_OBJECT *policy_id);
-ASN1_OBJECT *TS_TST_INFO_get_policy_id(TS_TST_INFO *a);
+int __cdecl TS_TST_INFO_set_policy_id(TS_TST_INFO *a, ASN1_OBJECT *policy_id);
+ASN1_OBJECT * __cdecl TS_TST_INFO_get_policy_id(TS_TST_INFO *a);
 
-int TS_TST_INFO_set_msg_imprint(TS_TST_INFO *a, TS_MSG_IMPRINT *msg_imprint);
-TS_MSG_IMPRINT *TS_TST_INFO_get_msg_imprint(TS_TST_INFO *a);
+int __cdecl TS_TST_INFO_set_msg_imprint(TS_TST_INFO *a, TS_MSG_IMPRINT *msg_imprint);
+TS_MSG_IMPRINT * __cdecl TS_TST_INFO_get_msg_imprint(TS_TST_INFO *a);
 
-int TS_TST_INFO_set_serial(TS_TST_INFO *a, const ASN1_INTEGER *serial);
-const ASN1_INTEGER *TS_TST_INFO_get_serial(const TS_TST_INFO *a);
+int __cdecl TS_TST_INFO_set_serial(TS_TST_INFO *a, const ASN1_INTEGER *serial);
+const ASN1_INTEGER * __cdecl TS_TST_INFO_get_serial(const TS_TST_INFO *a);
 
-int TS_TST_INFO_set_time(TS_TST_INFO *a, const ASN1_GENERALIZEDTIME *gtime);
-const ASN1_GENERALIZEDTIME *TS_TST_INFO_get_time(const TS_TST_INFO *a);
+int __cdecl TS_TST_INFO_set_time(TS_TST_INFO *a, const ASN1_GENERALIZEDTIME *gtime);
+const ASN1_GENERALIZEDTIME * __cdecl TS_TST_INFO_get_time(const TS_TST_INFO *a);
 
-int TS_TST_INFO_set_accuracy(TS_TST_INFO *a, TS_ACCURACY *accuracy);
-TS_ACCURACY *TS_TST_INFO_get_accuracy(TS_TST_INFO *a);
+int __cdecl TS_TST_INFO_set_accuracy(TS_TST_INFO *a, TS_ACCURACY *accuracy);
+TS_ACCURACY * __cdecl TS_TST_INFO_get_accuracy(TS_TST_INFO *a);
 
-int TS_ACCURACY_set_seconds(TS_ACCURACY *a, const ASN1_INTEGER *seconds);
-const ASN1_INTEGER *TS_ACCURACY_get_seconds(const TS_ACCURACY *a);
+int __cdecl TS_ACCURACY_set_seconds(TS_ACCURACY *a, const ASN1_INTEGER *seconds);
+const ASN1_INTEGER * __cdecl TS_ACCURACY_get_seconds(const TS_ACCURACY *a);
 
-int TS_ACCURACY_set_millis(TS_ACCURACY *a, const ASN1_INTEGER *millis);
-const ASN1_INTEGER *TS_ACCURACY_get_millis(const TS_ACCURACY *a);
+int __cdecl TS_ACCURACY_set_millis(TS_ACCURACY *a, const ASN1_INTEGER *millis);
+const ASN1_INTEGER * __cdecl TS_ACCURACY_get_millis(const TS_ACCURACY *a);
 
-int TS_ACCURACY_set_micros(TS_ACCURACY *a, const ASN1_INTEGER *micros);
-const ASN1_INTEGER *TS_ACCURACY_get_micros(const TS_ACCURACY *a);
+int __cdecl TS_ACCURACY_set_micros(TS_ACCURACY *a, const ASN1_INTEGER *micros);
+const ASN1_INTEGER * __cdecl TS_ACCURACY_get_micros(const TS_ACCURACY *a);
 
-int TS_TST_INFO_set_ordering(TS_TST_INFO *a, int ordering);
-int TS_TST_INFO_get_ordering(const TS_TST_INFO *a);
+int __cdecl TS_TST_INFO_set_ordering(TS_TST_INFO *a, int ordering);
+int __cdecl TS_TST_INFO_get_ordering(const TS_TST_INFO *a);
 
-int TS_TST_INFO_set_nonce(TS_TST_INFO *a, const ASN1_INTEGER *nonce);
-const ASN1_INTEGER *TS_TST_INFO_get_nonce(const TS_TST_INFO *a);
+int __cdecl TS_TST_INFO_set_nonce(TS_TST_INFO *a, const ASN1_INTEGER *nonce);
+const ASN1_INTEGER * __cdecl TS_TST_INFO_get_nonce(const TS_TST_INFO *a);
 
-int TS_TST_INFO_set_tsa(TS_TST_INFO *a, GENERAL_NAME *tsa);
-GENERAL_NAME *TS_TST_INFO_get_tsa(TS_TST_INFO *a);
+int __cdecl TS_TST_INFO_set_tsa(TS_TST_INFO *a, GENERAL_NAME *tsa);
+GENERAL_NAME * __cdecl TS_TST_INFO_get_tsa(TS_TST_INFO *a);
 
-STACK_OF(X509_EXTENSION) *TS_TST_INFO_get_exts(TS_TST_INFO *a);
-void TS_TST_INFO_ext_free(TS_TST_INFO *a);
-int TS_TST_INFO_get_ext_count(TS_TST_INFO *a);
-int TS_TST_INFO_get_ext_by_NID(TS_TST_INFO *a, int nid, int lastpos);
-int TS_TST_INFO_get_ext_by_OBJ(TS_TST_INFO *a, const ASN1_OBJECT *obj,
+STACK_OF(X509_EXTENSION) * __cdecl TS_TST_INFO_get_exts(TS_TST_INFO *a);
+void __cdecl TS_TST_INFO_ext_free(TS_TST_INFO *a);
+int __cdecl TS_TST_INFO_get_ext_count(TS_TST_INFO *a);
+int __cdecl TS_TST_INFO_get_ext_by_NID(TS_TST_INFO *a, int nid, int lastpos);
+int __cdecl TS_TST_INFO_get_ext_by_OBJ(TS_TST_INFO *a, const ASN1_OBJECT *obj,
                                int lastpos);
-int TS_TST_INFO_get_ext_by_critical(TS_TST_INFO *a, int crit, int lastpos);
-X509_EXTENSION *TS_TST_INFO_get_ext(TS_TST_INFO *a, int loc);
-X509_EXTENSION *TS_TST_INFO_delete_ext(TS_TST_INFO *a, int loc);
-int TS_TST_INFO_add_ext(TS_TST_INFO *a, X509_EXTENSION *ex, int loc);
-void *TS_TST_INFO_get_ext_d2i(TS_TST_INFO *a, int nid, int *crit, int *idx);
+int __cdecl TS_TST_INFO_get_ext_by_critical(TS_TST_INFO *a, int crit, int lastpos);
+X509_EXTENSION * __cdecl TS_TST_INFO_get_ext(TS_TST_INFO *a, int loc);
+X509_EXTENSION * __cdecl TS_TST_INFO_delete_ext(TS_TST_INFO *a, int loc);
+int __cdecl TS_TST_INFO_add_ext(TS_TST_INFO *a, X509_EXTENSION *ex, int loc);
+void * __cdecl TS_TST_INFO_get_ext_d2i(TS_TST_INFO *a, int nid, int *crit, int *idx);
 
 /*
  * Declarations related to response generation, defined in ts/ts_resp_sign.c.
@@ -325,46 +325,46 @@ typedef struct TS_resp_ctx TS_RESP_CTX;
 DEFINE_STACK_OF_CONST(EVP_MD)
 
 /* Creates a response context that can be used for generating responses. */
-TS_RESP_CTX *TS_RESP_CTX_new(void);
-void TS_RESP_CTX_free(TS_RESP_CTX *ctx);
+TS_RESP_CTX * __cdecl TS_RESP_CTX_new(void);
+void __cdecl TS_RESP_CTX_free(TS_RESP_CTX *ctx);
 
 /* This parameter must be set. */
-int TS_RESP_CTX_set_signer_cert(TS_RESP_CTX *ctx, X509 *signer);
+int __cdecl TS_RESP_CTX_set_signer_cert(TS_RESP_CTX *ctx, X509 *signer);
 
 /* This parameter must be set. */
-int TS_RESP_CTX_set_signer_key(TS_RESP_CTX *ctx, EVP_PKEY *key);
+int __cdecl TS_RESP_CTX_set_signer_key(TS_RESP_CTX *ctx, EVP_PKEY *key);
 
-int TS_RESP_CTX_set_signer_digest(TS_RESP_CTX *ctx,
+int __cdecl TS_RESP_CTX_set_signer_digest(TS_RESP_CTX *ctx,
                                   const EVP_MD *signer_digest);
-int TS_RESP_CTX_set_ess_cert_id_digest(TS_RESP_CTX *ctx, const EVP_MD *md);
+int __cdecl TS_RESP_CTX_set_ess_cert_id_digest(TS_RESP_CTX *ctx, const EVP_MD *md);
 
 /* This parameter must be set. */
-int TS_RESP_CTX_set_def_policy(TS_RESP_CTX *ctx, const ASN1_OBJECT *def_policy);
+int __cdecl TS_RESP_CTX_set_def_policy(TS_RESP_CTX *ctx, const ASN1_OBJECT *def_policy);
 
 /* No additional certs are included in the response by default. */
-int TS_RESP_CTX_set_certs(TS_RESP_CTX *ctx, STACK_OF(X509) *certs);
+int __cdecl TS_RESP_CTX_set_certs(TS_RESP_CTX *ctx, STACK_OF(X509) *certs);
 
 /*
  * Adds a new acceptable policy, only the default policy is accepted by
  * default.
  */
-int TS_RESP_CTX_add_policy(TS_RESP_CTX *ctx, const ASN1_OBJECT *policy);
+int __cdecl TS_RESP_CTX_add_policy(TS_RESP_CTX *ctx, const ASN1_OBJECT *policy);
 
 /*
  * Adds a new acceptable message digest. Note that no message digests are
  * accepted by default. The md argument is shared with the caller.
  */
-int TS_RESP_CTX_add_md(TS_RESP_CTX *ctx, const EVP_MD *md);
+int __cdecl TS_RESP_CTX_add_md(TS_RESP_CTX *ctx, const EVP_MD *md);
 
 /* Accuracy is not included by default. */
-int TS_RESP_CTX_set_accuracy(TS_RESP_CTX *ctx,
+int __cdecl TS_RESP_CTX_set_accuracy(TS_RESP_CTX *ctx,
                              int secs, int millis, int micros);
 
 /*
  * Clock precision digits, i.e. the number of decimal digits: '0' means sec,
  * '3' msec, '6' usec, and so on. Default is 0.
  */
-int TS_RESP_CTX_set_clock_precision_digits(TS_RESP_CTX *ctx,
+int __cdecl TS_RESP_CTX_set_clock_precision_digits(TS_RESP_CTX *ctx,
                                            unsigned clock_precision_digits);
 /* At most we accept usec precision. */
 # define TS_MAX_CLOCK_PRECISION_DIGITS   6
@@ -373,50 +373,50 @@ int TS_RESP_CTX_set_clock_precision_digits(TS_RESP_CTX *ctx,
 # define TS_MAX_STATUS_LENGTH   (1024 * 1024)
 
 /* No flags are set by default. */
-void TS_RESP_CTX_add_flags(TS_RESP_CTX *ctx, int flags);
+void __cdecl TS_RESP_CTX_add_flags(TS_RESP_CTX *ctx, int flags);
 
 /* Default callback always returns a constant. */
-void TS_RESP_CTX_set_serial_cb(TS_RESP_CTX *ctx, TS_serial_cb cb, void *data);
+void __cdecl TS_RESP_CTX_set_serial_cb(TS_RESP_CTX *ctx, TS_serial_cb cb, void *data);
 
 /* Default callback uses the gettimeofday() and gmtime() system calls. */
-void TS_RESP_CTX_set_time_cb(TS_RESP_CTX *ctx, TS_time_cb cb, void *data);
+void __cdecl TS_RESP_CTX_set_time_cb(TS_RESP_CTX *ctx, TS_time_cb cb, void *data);
 
 /*
  * Default callback rejects all extensions. The extension callback is called
  * when the TS_TST_INFO object is already set up and not signed yet.
  */
 /* FIXME: extension handling is not tested yet. */
-void TS_RESP_CTX_set_extension_cb(TS_RESP_CTX *ctx,
+void __cdecl TS_RESP_CTX_set_extension_cb(TS_RESP_CTX *ctx,
                                   TS_extension_cb cb, void *data);
 
 /* The following methods can be used in the callbacks. */
-int TS_RESP_CTX_set_status_info(TS_RESP_CTX *ctx,
+int __cdecl TS_RESP_CTX_set_status_info(TS_RESP_CTX *ctx,
                                 int status, const char *text);
 
 /* Sets the status info only if it is still TS_STATUS_GRANTED. */
-int TS_RESP_CTX_set_status_info_cond(TS_RESP_CTX *ctx,
+int __cdecl TS_RESP_CTX_set_status_info_cond(TS_RESP_CTX *ctx,
                                      int status, const char *text);
 
-int TS_RESP_CTX_add_failure_info(TS_RESP_CTX *ctx, int failure);
+int __cdecl TS_RESP_CTX_add_failure_info(TS_RESP_CTX *ctx, int failure);
 
 /* The get methods below can be used in the extension callback. */
-TS_REQ *TS_RESP_CTX_get_request(TS_RESP_CTX *ctx);
+TS_REQ * __cdecl TS_RESP_CTX_get_request(TS_RESP_CTX *ctx);
 
-TS_TST_INFO *TS_RESP_CTX_get_tst_info(TS_RESP_CTX *ctx);
+TS_TST_INFO * __cdecl TS_RESP_CTX_get_tst_info(TS_RESP_CTX *ctx);
 
 /*
  * Creates the signed TS_TST_INFO and puts it in TS_RESP.
  * In case of errors it sets the status info properly.
  * Returns NULL only in case of memory allocation/fatal error.
  */
-TS_RESP *TS_RESP_create_response(TS_RESP_CTX *ctx, BIO *req_bio);
+TS_RESP * __cdecl TS_RESP_create_response(TS_RESP_CTX *ctx, BIO *req_bio);
 
 /*
  * Declarations related to response verification,
  * they are defined in ts/ts_resp_verify.c.
  */
 
-int TS_RESP_verify_signature(PKCS7 *token, STACK_OF(X509) *certs,
+int __cdecl TS_RESP_verify_signature(PKCS7 *token, STACK_OF(X509) *certs,
                              X509_STORE *store, X509 **signer_out);
 
 /* Context structure for the generic verify method. */
@@ -463,23 +463,23 @@ int TS_RESP_verify_signature(PKCS7 *token, STACK_OF(X509) *certs,
 
 typedef struct TS_verify_ctx TS_VERIFY_CTX;
 
-int TS_RESP_verify_response(TS_VERIFY_CTX *ctx, TS_RESP *response);
-int TS_RESP_verify_token(TS_VERIFY_CTX *ctx, PKCS7 *token);
+int __cdecl TS_RESP_verify_response(TS_VERIFY_CTX *ctx, TS_RESP *response);
+int __cdecl TS_RESP_verify_token(TS_VERIFY_CTX *ctx, PKCS7 *token);
 
 /*
  * Declarations related to response verification context,
  */
-TS_VERIFY_CTX *TS_VERIFY_CTX_new(void);
-void TS_VERIFY_CTX_init(TS_VERIFY_CTX *ctx);
-void TS_VERIFY_CTX_free(TS_VERIFY_CTX *ctx);
-void TS_VERIFY_CTX_cleanup(TS_VERIFY_CTX *ctx);
-int TS_VERIFY_CTX_set_flags(TS_VERIFY_CTX *ctx, int f);
-int TS_VERIFY_CTX_add_flags(TS_VERIFY_CTX *ctx, int f);
-BIO *TS_VERIFY_CTX_set_data(TS_VERIFY_CTX *ctx, BIO *b);
-unsigned char *TS_VERIFY_CTX_set_imprint(TS_VERIFY_CTX *ctx,
+TS_VERIFY_CTX * __cdecl TS_VERIFY_CTX_new(void);
+void __cdecl TS_VERIFY_CTX_init(TS_VERIFY_CTX *ctx);
+void __cdecl TS_VERIFY_CTX_free(TS_VERIFY_CTX *ctx);
+void __cdecl TS_VERIFY_CTX_cleanup(TS_VERIFY_CTX *ctx);
+int __cdecl TS_VERIFY_CTX_set_flags(TS_VERIFY_CTX *ctx, int f);
+int __cdecl TS_VERIFY_CTX_add_flags(TS_VERIFY_CTX *ctx, int f);
+BIO * __cdecl TS_VERIFY_CTX_set_data(TS_VERIFY_CTX *ctx, BIO *b);
+unsigned char * __cdecl TS_VERIFY_CTX_set_imprint(TS_VERIFY_CTX *ctx,
                                          unsigned char *hexstr, long len);
-X509_STORE *TS_VERIFY_CTX_set_store(TS_VERIFY_CTX *ctx, X509_STORE *s);
-STACK_OF(X509) *TS_VERIFY_CTS_set_certs(TS_VERIFY_CTX *ctx, STACK_OF(X509) *certs);
+X509_STORE * __cdecl TS_VERIFY_CTX_set_store(TS_VERIFY_CTX *ctx, X509_STORE *s);
+STACK_OF(X509) * __cdecl TS_VERIFY_CTS_set_certs(TS_VERIFY_CTX *ctx, STACK_OF(X509) *certs);
 
 /*-
  * If ctx is NULL, it allocates and returns a new object, otherwise
@@ -497,59 +497,59 @@ STACK_OF(X509) *TS_VERIFY_CTS_set_certs(TS_VERIFY_CTX *ctx, STACK_OF(X509) *cert
  * tsa_name = NULL
  * Important: after calling this method TS_VFY_SIGNATURE should be added!
  */
-TS_VERIFY_CTX *TS_REQ_to_TS_VERIFY_CTX(TS_REQ *req, TS_VERIFY_CTX *ctx);
+TS_VERIFY_CTX * __cdecl TS_REQ_to_TS_VERIFY_CTX(TS_REQ *req, TS_VERIFY_CTX *ctx);
 
 /* Function declarations for TS_RESP defined in ts/ts_resp_print.c */
 
-int TS_RESP_print_bio(BIO *bio, TS_RESP *a);
-int TS_STATUS_INFO_print_bio(BIO *bio, TS_STATUS_INFO *a);
-int TS_TST_INFO_print_bio(BIO *bio, TS_TST_INFO *a);
+int __cdecl TS_RESP_print_bio(BIO *bio, TS_RESP *a);
+int __cdecl TS_STATUS_INFO_print_bio(BIO *bio, TS_STATUS_INFO *a);
+int __cdecl TS_TST_INFO_print_bio(BIO *bio, TS_TST_INFO *a);
 
 /* Common utility functions defined in ts/ts_lib.c */
 
-int TS_ASN1_INTEGER_print_bio(BIO *bio, const ASN1_INTEGER *num);
-int TS_OBJ_print_bio(BIO *bio, const ASN1_OBJECT *obj);
-int TS_ext_print_bio(BIO *bio, const STACK_OF(X509_EXTENSION) *extensions);
-int TS_X509_ALGOR_print_bio(BIO *bio, const X509_ALGOR *alg);
-int TS_MSG_IMPRINT_print_bio(BIO *bio, TS_MSG_IMPRINT *msg);
+int __cdecl TS_ASN1_INTEGER_print_bio(BIO *bio, const ASN1_INTEGER *num);
+int __cdecl TS_OBJ_print_bio(BIO *bio, const ASN1_OBJECT *obj);
+int __cdecl TS_ext_print_bio(BIO *bio, const STACK_OF(X509_EXTENSION) *extensions);
+int __cdecl TS_X509_ALGOR_print_bio(BIO *bio, const X509_ALGOR *alg);
+int __cdecl TS_MSG_IMPRINT_print_bio(BIO *bio, TS_MSG_IMPRINT *msg);
 
 /*
  * Function declarations for handling configuration options, defined in
  * ts/ts_conf.c
  */
 
-X509 *TS_CONF_load_cert(const char *file);
-STACK_OF(X509) *TS_CONF_load_certs(const char *file);
-EVP_PKEY *TS_CONF_load_key(const char *file, const char *pass);
-const char *TS_CONF_get_tsa_section(CONF *conf, const char *section);
-int TS_CONF_set_serial(CONF *conf, const char *section, TS_serial_cb cb,
+X509 * __cdecl TS_CONF_load_cert(const char *file);
+STACK_OF(X509) * __cdecl TS_CONF_load_certs(const char *file);
+EVP_PKEY * __cdecl TS_CONF_load_key(const char *file, const char *pass);
+const char * __cdecl TS_CONF_get_tsa_section(CONF *conf, const char *section);
+int __cdecl TS_CONF_set_serial(CONF *conf, const char *section, TS_serial_cb cb,
                        TS_RESP_CTX *ctx);
 #ifndef OPENSSL_NO_ENGINE
-int TS_CONF_set_crypto_device(CONF *conf, const char *section,
+int __cdecl TS_CONF_set_crypto_device(CONF *conf, const char *section,
                               const char *device);
-int TS_CONF_set_default_engine(const char *name);
+int __cdecl TS_CONF_set_default_engine(const char *name);
 #endif
-int TS_CONF_set_signer_cert(CONF *conf, const char *section,
+int __cdecl TS_CONF_set_signer_cert(CONF *conf, const char *section,
                             const char *cert, TS_RESP_CTX *ctx);
-int TS_CONF_set_certs(CONF *conf, const char *section, const char *certs,
+int __cdecl TS_CONF_set_certs(CONF *conf, const char *section, const char *certs,
                       TS_RESP_CTX *ctx);
-int TS_CONF_set_signer_key(CONF *conf, const char *section,
+int __cdecl TS_CONF_set_signer_key(CONF *conf, const char *section,
                            const char *key, const char *pass,
                            TS_RESP_CTX *ctx);
-int TS_CONF_set_signer_digest(CONF *conf, const char *section,
+int __cdecl TS_CONF_set_signer_digest(CONF *conf, const char *section,
                                const char *md, TS_RESP_CTX *ctx);
-int TS_CONF_set_def_policy(CONF *conf, const char *section,
+int __cdecl TS_CONF_set_def_policy(CONF *conf, const char *section,
                            const char *policy, TS_RESP_CTX *ctx);
-int TS_CONF_set_policies(CONF *conf, const char *section, TS_RESP_CTX *ctx);
-int TS_CONF_set_digests(CONF *conf, const char *section, TS_RESP_CTX *ctx);
-int TS_CONF_set_accuracy(CONF *conf, const char *section, TS_RESP_CTX *ctx);
-int TS_CONF_set_clock_precision_digits(CONF *conf, const char *section,
+int __cdecl TS_CONF_set_policies(CONF *conf, const char *section, TS_RESP_CTX *ctx);
+int __cdecl TS_CONF_set_digests(CONF *conf, const char *section, TS_RESP_CTX *ctx);
+int __cdecl TS_CONF_set_accuracy(CONF *conf, const char *section, TS_RESP_CTX *ctx);
+int __cdecl TS_CONF_set_clock_precision_digits(CONF *conf, const char *section,
                                        TS_RESP_CTX *ctx);
-int TS_CONF_set_ordering(CONF *conf, const char *section, TS_RESP_CTX *ctx);
-int TS_CONF_set_tsa_name(CONF *conf, const char *section, TS_RESP_CTX *ctx);
-int TS_CONF_set_ess_cert_id_chain(CONF *conf, const char *section,
+int __cdecl TS_CONF_set_ordering(CONF *conf, const char *section, TS_RESP_CTX *ctx);
+int __cdecl TS_CONF_set_tsa_name(CONF *conf, const char *section, TS_RESP_CTX *ctx);
+int __cdecl TS_CONF_set_ess_cert_id_chain(CONF *conf, const char *section,
                                   TS_RESP_CTX *ctx);
-int TS_CONF_set_ess_cert_id_digest(CONF *conf, const char *section,
+int __cdecl TS_CONF_set_ess_cert_id_digest(CONF *conf, const char *section,
                                       TS_RESP_CTX *ctx);
 
 #  ifdef  __cplusplus
diff --git a/include/openssl/x509.h b/include/openssl/x509.h
index 39ca0ba575..d2b7862f63 100644
--- a/include/openssl/x509.h
+++ b/include/openssl/x509.h
@@ -401,19 +401,19 @@ RSA *d2i_RSAPrivateKey_fp(FILE *fp, RSA **rsa);
 int i2d_RSAPrivateKey_fp(FILE *fp, RSA *rsa);
 RSA *d2i_RSAPublicKey_fp(FILE *fp, RSA **rsa);
 int i2d_RSAPublicKey_fp(FILE *fp, RSA *rsa);
-RSA *d2i_RSA_PUBKEY_fp(FILE *fp, RSA **rsa);
+RSA * __cdecl d2i_RSA_PUBKEY_fp(FILE *fp, RSA **rsa);
 int i2d_RSA_PUBKEY_fp(FILE *fp, RSA *rsa);
 #  endif
 #  ifndef OPENSSL_NO_DSA
-DSA *d2i_DSA_PUBKEY_fp(FILE *fp, DSA **dsa);
+DSA * __cdecl d2i_DSA_PUBKEY_fp(FILE *fp, DSA **dsa);
 int i2d_DSA_PUBKEY_fp(FILE *fp, DSA *dsa);
-DSA *d2i_DSAPrivateKey_fp(FILE *fp, DSA **dsa);
+DSA * __cdecl d2i_DSAPrivateKey_fp(FILE *fp, DSA **dsa);
 int i2d_DSAPrivateKey_fp(FILE *fp, DSA *dsa);
 #  endif
 #  ifndef OPENSSL_NO_EC
-EC_KEY *d2i_EC_PUBKEY_fp(FILE *fp, EC_KEY **eckey);
+EC_KEY * __cdecl d2i_EC_PUBKEY_fp(FILE *fp, EC_KEY **eckey);
 int i2d_EC_PUBKEY_fp(FILE *fp, EC_KEY *eckey);
-EC_KEY *d2i_ECPrivateKey_fp(FILE *fp, EC_KEY **eckey);
+EC_KEY * __cdecl d2i_ECPrivateKey_fp(FILE *fp, EC_KEY **eckey);
 int i2d_ECPrivateKey_fp(FILE *fp, EC_KEY *eckey);
 #  endif
 X509_SIG *d2i_PKCS8_fp(FILE *fp, X509_SIG **p8);
@@ -423,9 +423,9 @@ PKCS8_PRIV_KEY_INFO *d2i_PKCS8_PRIV_KEY_INFO_fp(FILE *fp,
 int i2d_PKCS8_PRIV_KEY_INFO_fp(FILE *fp, PKCS8_PRIV_KEY_INFO *p8inf);
 int i2d_PKCS8PrivateKeyInfo_fp(FILE *fp, EVP_PKEY *key);
 int i2d_PrivateKey_fp(FILE *fp, EVP_PKEY *pkey);
-EVP_PKEY *d2i_PrivateKey_fp(FILE *fp, EVP_PKEY **a);
+EVP_PKEY * __cdecl d2i_PrivateKey_fp(FILE *fp, EVP_PKEY **a);
 int i2d_PUBKEY_fp(FILE *fp, EVP_PKEY *pkey);
-EVP_PKEY *d2i_PUBKEY_fp(FILE *fp, EVP_PKEY **a);
+EVP_PKEY * __cdecl d2i_PUBKEY_fp(FILE *fp, EVP_PKEY **a);
 # endif
 
 X509 *d2i_X509_bio(BIO *bp, X509 **x509);
@@ -439,19 +439,19 @@ RSA *d2i_RSAPrivateKey_bio(BIO *bp, RSA **rsa);
 int i2d_RSAPrivateKey_bio(BIO *bp, RSA *rsa);
 RSA *d2i_RSAPublicKey_bio(BIO *bp, RSA **rsa);
 int i2d_RSAPublicKey_bio(BIO *bp, RSA *rsa);
-RSA *d2i_RSA_PUBKEY_bio(BIO *bp, RSA **rsa);
+RSA * __cdecl d2i_RSA_PUBKEY_bio(BIO *bp, RSA **rsa);
 int i2d_RSA_PUBKEY_bio(BIO *bp, RSA *rsa);
 #  endif
 #  ifndef OPENSSL_NO_DSA
-DSA *d2i_DSA_PUBKEY_bio(BIO *bp, DSA **dsa);
+DSA * __cdecl d2i_DSA_PUBKEY_bio(BIO *bp, DSA **dsa);
 int i2d_DSA_PUBKEY_bio(BIO *bp, DSA *dsa);
-DSA *d2i_DSAPrivateKey_bio(BIO *bp, DSA **dsa);
+DSA * __cdecl d2i_DSAPrivateKey_bio(BIO *bp, DSA **dsa);
 int i2d_DSAPrivateKey_bio(BIO *bp, DSA *dsa);
 #  endif
 #  ifndef OPENSSL_NO_EC
-EC_KEY *d2i_EC_PUBKEY_bio(BIO *bp, EC_KEY **eckey);
+EC_KEY * __cdecl d2i_EC_PUBKEY_bio(BIO *bp, EC_KEY **eckey);
 int i2d_EC_PUBKEY_bio(BIO *bp, EC_KEY *eckey);
-EC_KEY *d2i_ECPrivateKey_bio(BIO *bp, EC_KEY **eckey);
+EC_KEY * __cdecl d2i_ECPrivateKey_bio(BIO *bp, EC_KEY **eckey);
 int i2d_ECPrivateKey_bio(BIO *bp, EC_KEY *eckey);
 #  endif
 X509_SIG *d2i_PKCS8_bio(BIO *bp, X509_SIG **p8);
@@ -461,17 +461,17 @@ PKCS8_PRIV_KEY_INFO *d2i_PKCS8_PRIV_KEY_INFO_bio(BIO *bp,
 int i2d_PKCS8_PRIV_KEY_INFO_bio(BIO *bp, PKCS8_PRIV_KEY_INFO *p8inf);
 int i2d_PKCS8PrivateKeyInfo_bio(BIO *bp, EVP_PKEY *key);
 int i2d_PrivateKey_bio(BIO *bp, EVP_PKEY *pkey);
-EVP_PKEY *d2i_PrivateKey_bio(BIO *bp, EVP_PKEY **a);
+EVP_PKEY * __cdecl d2i_PrivateKey_bio(BIO *bp, EVP_PKEY **a);
 int i2d_PUBKEY_bio(BIO *bp, EVP_PKEY *pkey);
-EVP_PKEY *d2i_PUBKEY_bio(BIO *bp, EVP_PKEY **a);
-
-X509 *X509_dup(X509 *x509);
-X509_ATTRIBUTE *X509_ATTRIBUTE_dup(X509_ATTRIBUTE *xa);
-X509_EXTENSION *X509_EXTENSION_dup(X509_EXTENSION *ex);
-X509_CRL *X509_CRL_dup(X509_CRL *crl);
-X509_REVOKED *X509_REVOKED_dup(X509_REVOKED *rev);
-X509_REQ *X509_REQ_dup(X509_REQ *req);
-X509_ALGOR *X509_ALGOR_dup(X509_ALGOR *xn);
+EVP_PKEY * __cdecl d2i_PUBKEY_bio(BIO *bp, EVP_PKEY **a);
+
+X509 * __cdecl X509_dup(X509 *x509);
+X509_ATTRIBUTE * __cdecl X509_ATTRIBUTE_dup(X509_ATTRIBUTE *xa);
+X509_EXTENSION * __cdecl X509_EXTENSION_dup(X509_EXTENSION *ex);
+X509_CRL * __cdecl X509_CRL_dup(X509_CRL *crl);
+X509_REVOKED * __cdecl X509_REVOKED_dup(X509_REVOKED *rev);
+X509_REQ * __cdecl X509_REQ_dup(X509_REQ *req);
+X509_ALGOR * __cdecl X509_ALGOR_dup(X509_ALGOR *xn);
 int X509_ALGOR_set0(X509_ALGOR *alg, ASN1_OBJECT *aobj, int ptype,
                     void *pval);
 void X509_ALGOR_get0(const ASN1_OBJECT **paobj, int *pptype,
@@ -479,8 +479,8 @@ void X509_ALGOR_get0(const ASN1_OBJECT **paobj, int *pptype,
 void X509_ALGOR_set_md(X509_ALGOR *alg, const EVP_MD *md);
 int X509_ALGOR_cmp(const X509_ALGOR *a, const X509_ALGOR *b);
 
-X509_NAME *X509_NAME_dup(X509_NAME *xn);
-X509_NAME_ENTRY *X509_NAME_ENTRY_dup(X509_NAME_ENTRY *ne);
+X509_NAME * __cdecl X509_NAME_dup(X509_NAME *xn);
+X509_NAME_ENTRY * __cdecl X509_NAME_ENTRY_dup(X509_NAME_ENTRY *ne);
 
 int X509_cmp_time(const ASN1_TIME *s, time_t *t);
 int X509_cmp_current_time(const ASN1_TIME *s);
@@ -510,19 +510,19 @@ EVP_PKEY *X509_PUBKEY_get0(X509_PUBKEY *key);
 EVP_PKEY *X509_PUBKEY_get(X509_PUBKEY *key);
 int X509_get_pubkey_parameters(EVP_PKEY *pkey, STACK_OF(X509) *chain);
 long X509_get_pathlen(X509 *x);
-int i2d_PUBKEY(EVP_PKEY *a, unsigned char **pp);
-EVP_PKEY *d2i_PUBKEY(EVP_PKEY **a, const unsigned char **pp, long length);
+int __cdecl i2d_PUBKEY(EVP_PKEY *a, unsigned char **pp);
+EVP_PKEY * __cdecl d2i_PUBKEY(EVP_PKEY **a, const unsigned char **pp, long length);
 # ifndef OPENSSL_NO_RSA
-int i2d_RSA_PUBKEY(RSA *a, unsigned char **pp);
-RSA *d2i_RSA_PUBKEY(RSA **a, const unsigned char **pp, long length);
+int __cdecl i2d_RSA_PUBKEY(RSA *a, unsigned char **pp);
+RSA * __cdecl d2i_RSA_PUBKEY(RSA **a, const unsigned char **pp, long length);
 # endif
 # ifndef OPENSSL_NO_DSA
-int i2d_DSA_PUBKEY(DSA *a, unsigned char **pp);
-DSA *d2i_DSA_PUBKEY(DSA **a, const unsigned char **pp, long length);
+int __cdecl i2d_DSA_PUBKEY(DSA *a, unsigned char **pp);
+DSA * __cdecl d2i_DSA_PUBKEY(DSA **a, const unsigned char **pp, long length);
 # endif
 # ifndef OPENSSL_NO_EC
-int i2d_EC_PUBKEY(EC_KEY *a, unsigned char **pp);
-EC_KEY *d2i_EC_PUBKEY(EC_KEY **a, const unsigned char **pp, long length);
+int __cdecl i2d_EC_PUBKEY(EC_KEY *a, unsigned char **pp);
+EC_KEY * __cdecl d2i_EC_PUBKEY(EC_KEY **a, const unsigned char **pp, long length);
 # endif
 
 DECLARE_ASN1_FUNCTIONS(X509_SIG)
@@ -555,8 +555,8 @@ DECLARE_ASN1_FUNCTIONS(X509_CERT_AUX)
     CRYPTO_get_ex_new_index(CRYPTO_EX_INDEX_X509, l, p, newf, dupf, freef)
 int X509_set_ex_data(X509 *r, int idx, void *arg);
 void *X509_get_ex_data(X509 *r, int idx);
-int i2d_X509_AUX(X509 *a, unsigned char **pp);
-X509 *d2i_X509_AUX(X509 **a, const unsigned char **pp, long length);
+int __cdecl i2d_X509_AUX(X509 *a, unsigned char **pp);
+X509 * __cdecl d2i_X509_AUX(X509 **a, const unsigned char **pp, long length);
 
 int i2d_re_X509_tbs(X509 *x, unsigned char **pp);
 
@@ -605,7 +605,7 @@ DECLARE_ASN1_FUNCTIONS(NETSCAPE_SPKAC)
 DECLARE_ASN1_FUNCTIONS(NETSCAPE_CERT_SEQUENCE)
 
 X509_INFO *X509_INFO_new(void);
-void X509_INFO_free(X509_INFO *a);
+void __cdecl X509_INFO_free(X509_INFO *a);
 char *X509_NAME_oneline(const X509_NAME *a, char *buf, int size);
 
 int ASN1_verify(i2d_of_void *i2d, X509_ALGOR *algor1,
diff --git a/include/openssl/x509_vfy.h b/include/openssl/x509_vfy.h
index adb8bce7cb..42f28f2ef7 100644
--- a/include/openssl/x509_vfy.h
+++ b/include/openssl/x509_vfy.h
@@ -258,7 +258,7 @@ X509_OBJECT *X509_OBJECT_retrieve_match(STACK_OF(X509_OBJECT) *h,
                                         X509_OBJECT *x);
 int X509_OBJECT_up_ref_count(X509_OBJECT *a);
 X509_OBJECT *X509_OBJECT_new(void);
-void X509_OBJECT_free(X509_OBJECT *a);
+void __cdecl X509_OBJECT_free(X509_OBJECT *a);
 X509_LOOKUP_TYPE X509_OBJECT_get_type(const X509_OBJECT *a);
 X509 *X509_OBJECT_get0_X509(const X509_OBJECT *a);
 int X509_OBJECT_set1_X509(X509_OBJECT *a, X509 *obj);
@@ -526,7 +526,7 @@ void X509_STORE_CTX_set0_dane(X509_STORE_CTX *ctx, SSL_DANE *dane);
 /* X509_VERIFY_PARAM functions */
 
 X509_VERIFY_PARAM *X509_VERIFY_PARAM_new(void);
-void X509_VERIFY_PARAM_free(X509_VERIFY_PARAM *param);
+void __cdecl X509_VERIFY_PARAM_free(X509_VERIFY_PARAM *param);
 int X509_VERIFY_PARAM_inherit(X509_VERIFY_PARAM *to,
                               const X509_VERIFY_PARAM *from);
 int X509_VERIFY_PARAM_set1(X509_VERIFY_PARAM *to,
diff --git a/include/openssl/x509v3.h b/include/openssl/x509v3.h
index 6c6eca38a5..3713882f86 100644
--- a/include/openssl/x509v3.h
+++ b/include/openssl/x509v3.h
@@ -557,7 +557,7 @@ GENERAL_NAME *v2i_GENERAL_NAME_ex(GENERAL_NAME *out,
                                   const X509V3_EXT_METHOD *method,
                                   X509V3_CTX *ctx, CONF_VALUE *cnf,
                                   int is_nc);
-void X509V3_conf_free(CONF_VALUE *val);
+void __cdecl X509V3_conf_free(CONF_VALUE *val);
 
 X509_EXTENSION *X509V3_EXT_nconf_nid(CONF *conf, X509V3_CTX *ctx, int ext_nid,
                                      const char *value);
diff --git a/ms/applink.c b/ms/applink.c
index 238dbff35b..52cb19477b 100644
--- a/ms/applink.c
+++ b/ms/applink.c
@@ -38,42 +38,42 @@
 # include <io.h>
 # include <fcntl.h>
 
-static void *app_stdin(void)
+static void * __cdecl app_stdin(void)
 {
     return stdin;
 }
 
-static void *app_stdout(void)
+static void * __cdecl app_stdout(void)
 {
     return stdout;
 }
 
-static void *app_stderr(void)
+static void * __cdecl app_stderr(void)
 {
     return stderr;
 }
 
-static int app_feof(FILE *fp)
+static int __cdecl app_feof(FILE *fp)
 {
     return feof(fp);
 }
 
-static int app_ferror(FILE *fp)
+static int __cdecl app_ferror(FILE *fp)
 {
     return ferror(fp);
 }
 
-static void app_clearerr(FILE *fp)
+static void __cdecl app_clearerr(FILE *fp)
 {
     clearerr(fp);
 }
 
-static int app_fileno(FILE *fp)
+static int __cdecl app_fileno(FILE *fp)
 {
     return _fileno(fp);
 }
 
-static int app_fsetmod(FILE *fp, char mod)
+static int __cdecl app_fsetmod(FILE *fp, char mod)
 {
     return _setmode(_fileno(fp), mod == 'b' ? _O_BINARY : _O_TEXT);
 }
diff --git a/ms/uplink.c b/ms/uplink.c
index cd4e96b780..8156952d93 100644
--- a/ms/uplink.c
+++ b/ms/uplink.c
@@ -31,7 +31,7 @@ static void unimplemented(void)
     TerminateProcess(GetCurrentProcess(), 1);
 }
 
-void OPENSSL_Uplink(volatile void **table, int index)
+void __cdecl OPENSSL_Uplink(volatile void **table, int index)
 {
     static HMODULE volatile apphandle = NULL;
     static void **volatile applinktable = NULL;
diff --git a/ms/uplink.h b/ms/uplink.h
index f6cd0380ae..1f0d75cc55 100644
--- a/ms/uplink.h
+++ b/ms/uplink.h
@@ -12,27 +12,27 @@
 
 extern void *OPENSSL_UplinkTable[];
 
-#define UP_stdin  (*(void *(*)(void))OPENSSL_UplinkTable[APPLINK_STDIN])()
-#define UP_stdout (*(void *(*)(void))OPENSSL_UplinkTable[APPLINK_STDOUT])()
-#define UP_stderr (*(void *(*)(void))OPENSSL_UplinkTable[APPLINK_STDERR])()
-#define UP_fprintf (*(int (*)(void *,const char *,...))OPENSSL_UplinkTable[APPLINK_FPRINTF])
-#define UP_fgets  (*(char *(*)(char *,int,void *))OPENSSL_UplinkTable[APPLINK_FGETS])
-#define UP_fread  (*(size_t (*)(void *,size_t,size_t,void *))OPENSSL_UplinkTable[APPLINK_FREAD])
-#define UP_fwrite (*(size_t (*)(const void *,size_t,size_t,void *))OPENSSL_UplinkTable[APPLINK_FWRITE])
-#define UP_fsetmod (*(int (*)(void *,char))OPENSSL_UplinkTable[APPLINK_FSETMOD])
-#define UP_feof   (*(int (*)(void *))OPENSSL_UplinkTable[APPLINK_FEOF])
-#define UP_fclose (*(int (*)(void *))OPENSSL_UplinkTable[APPLINK_FCLOSE])
+#define UP_stdin  (*(void *(__cdecl *)(void))OPENSSL_UplinkTable[APPLINK_STDIN])()
+#define UP_stdout (*(void *(__cdecl *)(void))OPENSSL_UplinkTable[APPLINK_STDOUT])()
+#define UP_stderr (*(void *(__cdecl *)(void))OPENSSL_UplinkTable[APPLINK_STDERR])()
+#define UP_fprintf (*(int (__cdecl *)(void *,const char *,...))OPENSSL_UplinkTable[APPLINK_FPRINTF])
+#define UP_fgets  (*(char *(__cdecl *)(char *,int,void *))OPENSSL_UplinkTable[APPLINK_FGETS])
+#define UP_fread  (*(size_t (__cdecl *)(void *,size_t,size_t,void *))OPENSSL_UplinkTable[APPLINK_FREAD])
+#define UP_fwrite (*(size_t (__cdecl *)(const void *,size_t,size_t,void *))OPENSSL_UplinkTable[APPLINK_FWRITE])
+#define UP_fsetmod (*(int (__cdecl *)(void *,char))OPENSSL_UplinkTable[APPLINK_FSETMOD])
+#define UP_feof   (*(int (__cdecl *)(void *))OPENSSL_UplinkTable[APPLINK_FEOF])
+#define UP_fclose (*(int (__cdecl *)(void *))OPENSSL_UplinkTable[APPLINK_FCLOSE])
 
-#define UP_fopen  (*(void *(*)(const char *,const char *))OPENSSL_UplinkTable[APPLINK_FOPEN])
-#define UP_fseek  (*(int (*)(void *,long,int))OPENSSL_UplinkTable[APPLINK_FSEEK])
-#define UP_ftell  (*(long (*)(void *))OPENSSL_UplinkTable[APPLINK_FTELL])
-#define UP_fflush (*(int (*)(void *))OPENSSL_UplinkTable[APPLINK_FFLUSH])
-#define UP_ferror (*(int (*)(void *))OPENSSL_UplinkTable[APPLINK_FERROR])
-#define UP_clearerr (*(void (*)(void *))OPENSSL_UplinkTable[APPLINK_CLEARERR])
-#define UP_fileno (*(int (*)(void *))OPENSSL_UplinkTable[APPLINK_FILENO])
+#define UP_fopen  (*(void *(__cdecl *)(const char *,const char *))OPENSSL_UplinkTable[APPLINK_FOPEN])
+#define UP_fseek  (*(int (__cdecl *)(void *,long,int))OPENSSL_UplinkTable[APPLINK_FSEEK])
+#define UP_ftell  (*(long (__cdecl *)(void *))OPENSSL_UplinkTable[APPLINK_FTELL])
+#define UP_fflush (*(int (__cdecl *)(void *))OPENSSL_UplinkTable[APPLINK_FFLUSH])
+#define UP_ferror (*(int (__cdecl *)(void *))OPENSSL_UplinkTable[APPLINK_FERROR])
+#define UP_clearerr (*(void (__cdecl *)(void *))OPENSSL_UplinkTable[APPLINK_CLEARERR])
+#define UP_fileno (*(int (__cdecl *)(void *))OPENSSL_UplinkTable[APPLINK_FILENO])
 
-#define UP_open   (*(int (*)(const char *,int,...))OPENSSL_UplinkTable[APPLINK_OPEN])
-#define UP_read   (*(ossl_ssize_t (*)(int,void *,size_t))OPENSSL_UplinkTable[APPLINK_READ])
-#define UP_write  (*(ossl_ssize_t (*)(int,const void *,size_t))OPENSSL_UplinkTable[APPLINK_WRITE])
-#define UP_lseek  (*(long (*)(int,long,int))OPENSSL_UplinkTable[APPLINK_LSEEK])
-#define UP_close  (*(int (*)(int))OPENSSL_UplinkTable[APPLINK_CLOSE])
+#define UP_open   (*(int (__cdecl *)(const char *,int,...))OPENSSL_UplinkTable[APPLINK_OPEN])
+#define UP_read   (*(ossl_ssize_t (__cdecl *)(int,void *,size_t))OPENSSL_UplinkTable[APPLINK_READ])
+#define UP_write  (*(ossl_ssize_t (__cdecl *)(int,const void *,size_t))OPENSSL_UplinkTable[APPLINK_WRITE])
+#define UP_lseek  (*(long (__cdecl *)(int,long,int))OPENSSL_UplinkTable[APPLINK_LSEEK])
+#define UP_close  (*(int (__cdecl *)(int))OPENSSL_UplinkTable[APPLINK_CLOSE])
diff --git a/ssl/s3_lib.c b/ssl/s3_lib.c
index 066bf47221..0162fa70af 100644
--- a/ssl/s3_lib.c
+++ b/ssl/s3_lib.c
@@ -3198,7 +3198,7 @@ static SSL_CIPHER ssl3_scsvs[] = {
     },
 };
 
-static int cipher_compare(const void *a, const void *b)
+static int __cdecl cipher_compare(const void *a, const void *b)
 {
     const SSL_CIPHER *ap = (const SSL_CIPHER *)a;
     const SSL_CIPHER *bp = (const SSL_CIPHER *)b;
diff --git a/ssl/ssl_asn1.c b/ssl/ssl_asn1.c
index b56c5e96c5..0b1371d60b 100644
--- a/ssl/ssl_asn1.c
+++ b/ssl/ssl_asn1.c
@@ -101,7 +101,7 @@ static void ssl_session_sinit(ASN1_OCTET_STRING **dest, ASN1_OCTET_STRING *os,
         *dest = NULL;
 }
 
-int i2d_SSL_SESSION(SSL_SESSION *in, unsigned char **pp)
+int __cdecl i2d_SSL_SESSION(SSL_SESSION *in, unsigned char **pp)
 {
 
     SSL_SESSION_ASN1 as;
@@ -236,7 +236,7 @@ static int ssl_session_memcpy(unsigned char *dst, size_t *pdstlen,
     return 1;
 }
 
-SSL_SESSION *d2i_SSL_SESSION(SSL_SESSION **a, const unsigned char **pp,
+SSL_SESSION * __cdecl d2i_SSL_SESSION(SSL_SESSION **a, const unsigned char **pp,
                              long length)
 {
     long id;
diff --git a/ssl/ssl_cert.c b/ssl/ssl_cert.c
index 9df9fb9677..a704f5ed41 100644
--- a/ssl/ssl_cert.c
+++ b/ssl/ssl_cert.c
@@ -567,7 +567,7 @@ int SSL_CTX_add_client_CA(SSL_CTX *ctx, X509 *x)
     return add_ca_name(&ctx->client_ca_names, x);
 }
 
-static int xname_cmp(const X509_NAME *a, const X509_NAME *b)
+static int __cdecl xname_cmp(const X509_NAME *a, const X509_NAME *b)
 {
     unsigned char *abuf = NULL, *bbuf = NULL;
     int alen, blen, ret;
@@ -591,7 +591,7 @@ static int xname_cmp(const X509_NAME *a, const X509_NAME *b)
     return ret;
 }
 
-static int xname_sk_cmp(const X509_NAME *const *a, const X509_NAME *const *b)
+static int __cdecl xname_sk_cmp(const X509_NAME *const *a, const X509_NAME *const *b)
 {
     return xname_cmp(*a, *b);
 }
@@ -682,7 +682,7 @@ int SSL_add_file_cert_subjects_to_stack(STACK_OF(X509_NAME) *stack,
     X509 *x = NULL;
     X509_NAME *xn = NULL;
     int ret = 1;
-    int (*oldcmp) (const X509_NAME *const *a, const X509_NAME *const *b);
+    int (__cdecl *oldcmp) (const X509_NAME *const *a, const X509_NAME *const *b);
 
     oldcmp = sk_X509_NAME_set_cmp_func(stack, xname_sk_cmp);
 
diff --git a/ssl/ssl_ciph.c b/ssl/ssl_ciph.c
index 27a1b2ec68..1263b04638 100644
--- a/ssl/ssl_ciph.c
+++ b/ssl/ssl_ciph.c
@@ -450,7 +450,7 @@ int ssl_load_ciphers(void)
 
 #ifndef OPENSSL_NO_COMP
 
-static int sk_comp_cmp(const SSL_COMP *const *a, const SSL_COMP *const *b)
+static int __cdecl sk_comp_cmp(const SSL_COMP *const *a, const SSL_COMP *const *b)
 {
     return ((*a)->id - (*b)->id);
 }
@@ -1946,7 +1946,7 @@ STACK_OF(SSL_COMP) *SSL_COMP_set0_compression_methods(STACK_OF(SSL_COMP)
     return old_meths;
 }
 
-static void cmeth_free(SSL_COMP *cm)
+static void __cdecl cmeth_free(SSL_COMP *cm)
 {
     OPENSSL_free(cm);
 }
diff --git a/ssl/ssl_lib.c b/ssl/ssl_lib.c
index ac820cf9fe..a5d417fc31 100644
--- a/ssl/ssl_lib.c
+++ b/ssl/ssl_lib.c
@@ -179,7 +179,7 @@ static void dane_ctx_final(struct dane_ctx_st *dctx)
     dctx->mdmax = 0;
 }
 
-static void tlsa_free(danetls_record *t)
+static void __cdecl tlsa_free(danetls_record *t)
 {
     if (t == NULL)
         return;
@@ -2411,7 +2411,7 @@ long SSL_CTX_callback_ctrl(SSL_CTX *ctx, int cmd, void (*fp) (void))
     }
 }
 
-int ssl_cipher_id_cmp(const SSL_CIPHER *a, const SSL_CIPHER *b)
+int __cdecl ssl_cipher_id_cmp(const SSL_CIPHER *a, const SSL_CIPHER *b)
 {
     if (a->id > b->id)
         return 1;
@@ -2420,7 +2420,7 @@ int ssl_cipher_id_cmp(const SSL_CIPHER *a, const SSL_CIPHER *b)
     return 0;
 }
 
-int ssl_cipher_ptr_id_cmp(const SSL_CIPHER *const *ap,
+int __cdecl ssl_cipher_ptr_id_cmp(const SSL_CIPHER *const *ap,
                           const SSL_CIPHER *const *bp)
 {
     if ((*ap)->id > (*bp)->id)
@@ -2888,7 +2888,7 @@ static unsigned long ssl_session_hash(const SSL_SESSION *a)
  * being able to construct an SSL_SESSION that will collide with any existing
  * session with a matching session ID.
  */
-static int ssl_session_cmp(const SSL_SESSION *a, const SSL_SESSION *b)
+static int __cdecl ssl_session_cmp(const SSL_SESSION *a, const SSL_SESSION *b)
 {
     if (a->ssl_version != b->ssl_version)
         return 1;
diff --git a/ssl/ssl_locl.h b/ssl/ssl_locl.h
index 25875c9f6d..d49523aee1 100644
--- a/ssl/ssl_locl.h
+++ b/ssl/ssl_locl.h
@@ -2263,9 +2263,9 @@ __owur SSL_SESSION *lookup_sess_in_cache(SSL *s, const unsigned char *sess_id,
                                          size_t sess_id_len);
 __owur int ssl_get_prev_session(SSL *s, CLIENTHELLO_MSG *hello);
 __owur SSL_SESSION *ssl_session_dup(SSL_SESSION *src, int ticket);
-__owur int ssl_cipher_id_cmp(const SSL_CIPHER *a, const SSL_CIPHER *b);
+__owur int __cdecl ssl_cipher_id_cmp(const SSL_CIPHER *a, const SSL_CIPHER *b);
 DECLARE_OBJ_BSEARCH_GLOBAL_CMP_FN(SSL_CIPHER, SSL_CIPHER, ssl_cipher_id);
-__owur int ssl_cipher_ptr_id_cmp(const SSL_CIPHER *const *ap,
+__owur int __cdecl ssl_cipher_ptr_id_cmp(const SSL_CIPHER *const *ap,
                                  const SSL_CIPHER *const *bp);
 __owur STACK_OF(SSL_CIPHER) *ssl_create_cipher_list(const SSL_METHOD *ssl_method,
                                                     STACK_OF(SSL_CIPHER) *tls13_ciphersuites,
diff --git a/ssl/ssl_sess.c b/ssl/ssl_sess.c
index 52cfa7ef6d..243dff6c56 100644
--- a/ssl/ssl_sess.c
+++ b/ssl/ssl_sess.c
@@ -62,7 +62,7 @@ void *SSL_SESSION_get_ex_data(const SSL_SESSION *s, int idx)
     return CRYPTO_get_ex_data(&s->ex_data, idx);
 }
 
-SSL_SESSION *SSL_SESSION_new(void)
+SSL_SESSION * __cdecl SSL_SESSION_new(void)
 {
     SSL_SESSION *ss;
 
diff --git a/ssl/statem/statem_lib.c b/ssl/statem/statem_lib.c
index 22e9f0490e..1c9ed9b9cf 100644
--- a/ssl/statem/statem_lib.c
+++ b/ssl/statem/statem_lib.c
@@ -2218,7 +2218,7 @@ int create_synthetic_message_hash(SSL *s, const unsigned char *hashval,
     return 1;
 }
 
-static int ca_dn_cmp(const X509_NAME *const *a, const X509_NAME *const *b)
+static int __cdecl ca_dn_cmp(const X509_NAME *const *a, const X509_NAME *const *b)
 {
     return X509_NAME_cmp(*a, *b);
 }
diff --git a/test/aborttest.c b/test/aborttest.c
index ba5055edff..885734d4bf 100644
--- a/test/aborttest.c
+++ b/test/aborttest.c
@@ -9,7 +9,7 @@
 
 #include <openssl/crypto.h>
 
-int main(int argc, char **argv)
+int __cdecl main(int argc, char **argv)
 {
     OPENSSL_die("Voluntary abort", __FILE__, __LINE__);
     return 0;
diff --git a/test/asynctest.c b/test/asynctest.c
index 9728a37911..2061b76020 100644
--- a/test/asynctest.c
+++ b/test/asynctest.c
@@ -269,7 +269,7 @@ static int test_ASYNC_block_pause(void)
     return 1;
 }
 
-int main(int argc, char **argv)
+int __cdecl main(int argc, char **argv)
 {
     if (!ASYNC_is_capable()) {
         fprintf(stderr,
diff --git a/test/bio_callback_test.c b/test/bio_callback_test.c
index 8a17602d79..6928f40587 100644
--- a/test/bio_callback_test.c
+++ b/test/bio_callback_test.c
@@ -21,7 +21,7 @@ static int         my_param_argi[MAXCOUNT];
 static long        my_param_argl[MAXCOUNT];
 static long        my_param_ret[MAXCOUNT];
 
-static long my_bio_callback(BIO *b, int oper, const char *argp, int argi,
+static long __cdecl my_bio_callback(BIO *b, int oper, const char *argp, int argi,
                             long argl, long ret)
 {
     if (my_param_count >= MAXCOUNT)
diff --git a/test/danetest.c b/test/danetest.c
index 54a79ab51f..ba6ad6fb57 100644
--- a/test/danetest.c
+++ b/test/danetest.c
@@ -100,7 +100,7 @@ static STACK_OF(X509) *load_chain(BIO *fp, int nelem)
     long len;
     char *errtype = 0;                /* if error: cert or pkey? */
     STACK_OF(X509) *chain;
-    typedef X509 *(*d2i_X509_t)(X509 **, const unsigned char **, long);
+    typedef X509 *(__cdecl * d2i_X509_t)(X509 **, const unsigned char **, long);
 
     if (!TEST_ptr(chain = sk_X509_new_null()))
         goto err;
diff --git a/test/dhtest.c b/test/dhtest.c
index 9d5609b943..35606f58a7 100644
--- a/test/dhtest.c
+++ b/test/dhtest.c
@@ -484,7 +484,7 @@ static const unsigned char dhtest_rfc5114_2048_224_bad_y[] = {
 };
 
 typedef struct {
-    DH *(*get_param) (void);
+    DH *(__cdecl *get_param) (void);
     const unsigned char *xA;
     size_t xA_len;
     const unsigned char *yA;
diff --git a/test/evp_test.c b/test/evp_test.c
index abb51384e8..7529cdd862 100644
--- a/test/evp_test.c
+++ b/test/evp_test.c
@@ -106,7 +106,7 @@ struct evp_test_buffer_st {
     int count_set;
 };
 
-static void evp_test_buffer_free(EVP_TEST_BUFFER *db)
+static void __cdecl evp_test_buffer_free(EVP_TEST_BUFFER *db)
 {
     if (db != NULL) {
         OPENSSL_free(db->buf);
@@ -919,7 +919,7 @@ static int mac_test_init(EVP_TEST *t, const char *alg)
 }
 
 /* Because OPENSSL_free is a macro, it can't be passed as a function pointer */
-static void openssl_free(char *m)
+static void __cdecl openssl_free(char *m)
 {
     OPENSSL_free(m);
 }
@@ -1077,7 +1077,7 @@ typedef struct pkey_data_st {
     /* Context for this operation */
     EVP_PKEY_CTX *ctx;
     /* Key operation to perform */
-    int (*keyop) (EVP_PKEY_CTX *ctx,
+    int (__cdecl *keyop) (EVP_PKEY_CTX *ctx,
                   unsigned char *sig, size_t *siglen,
                   const unsigned char *tbs, size_t tbslen);
     /* Input to MAC */
@@ -1094,8 +1094,8 @@ typedef struct pkey_data_st {
  */
 static int pkey_test_init(EVP_TEST *t, const char *name,
                           int use_public,
-                          int (*keyopinit) (EVP_PKEY_CTX *ctx),
-                          int (*keyop)(EVP_PKEY_CTX *ctx,
+                          int (__cdecl *keyopinit) (EVP_PKEY_CTX *ctx),
+                          int (__cdecl *keyop)(EVP_PKEY_CTX *ctx,
                                        unsigned char *sig, size_t *siglen,
                                        const unsigned char *tbs,
                                        size_t tbslen))
diff --git a/test/generate_buildtest.pl b/test/generate_buildtest.pl
index f9a663bea6..dff61939c1 100644
--- a/test/generate_buildtest.pl
+++ b/test/generate_buildtest.pl
@@ -27,7 +27,7 @@ print <<"_____";
 # include <openssl/$name.h>
 #endif
 
-int main(void)
+int __cdecl main(void)
 {
     return 0;
 }
diff --git a/test/lhash_test.c b/test/lhash_test.c
index 162286b7cd..3740062220 100644
--- a/test/lhash_test.c
+++ b/test/lhash_test.c
@@ -39,7 +39,7 @@ static unsigned long int int_hash(const int *p)
     return 3 & *p;      /* To force collisions */
 }
 
-static int int_cmp(const int *p, const int *q)
+static int __cdecl int_cmp(const int *p, const int *q)
 {
     return *p != *q;
 }
diff --git a/test/memleaktest.c b/test/memleaktest.c
index d239bd23b8..6179fa76ed 100644
--- a/test/memleaktest.c
+++ b/test/memleaktest.c
@@ -23,7 +23,7 @@
  * but that is worse than avoiding the test framework's main.
  */
 
-int main(int argc, char *argv[])
+int __cdecl main(int argc, char *argv[])
 {
 #ifndef OPENSSL_NO_CRYPTO_MDEBUG
     char *p;
diff --git a/test/modes_internal_test.c b/test/modes_internal_test.c
index e0f1adf6af..89f7b76696 100644
--- a/test/modes_internal_test.c
+++ b/test/modes_internal_test.c
@@ -127,18 +127,18 @@ typedef struct {
     const char *case_name;
     size_t (*last_blocks_correction)(const unsigned char *in,
                                      unsigned char *out, size_t len);
-    size_t (*encrypt_block)(const unsigned char *in,
+    size_t (__cdecl *encrypt_block)(const unsigned char *in,
                             unsigned char *out, size_t len,
                             const void *key, unsigned char ivec[16],
                             block128_f block);
-    size_t (*encrypt_stream)(const unsigned char *in, unsigned char *out,
+    size_t (__cdecl *encrypt_stream)(const unsigned char *in, unsigned char *out,
                              size_t len, const void *key,
                              unsigned char ivec[16], cbc128_f cbc);
-    size_t (*decrypt_block)(const unsigned char *in,
+    size_t (__cdecl *decrypt_block)(const unsigned char *in,
                             unsigned char *out, size_t len,
                             const void *key, unsigned char ivec[16],
                             block128_f block);
-    size_t (*decrypt_stream)(const unsigned char *in, unsigned char *out,
+    size_t (__cdecl *decrypt_stream)(const unsigned char *in, unsigned char *out,
                              size_t len, const void *key,
                              unsigned char ivec[16], cbc128_f cbc);
 } CTS128_FIXTURE;
diff --git a/test/ossl_shim/ossl_shim.cc b/test/ossl_shim/ossl_shim.cc
index 90d1f1ef40..a38fe0fdc9 100644
--- a/test/ossl_shim/ossl_shim.cc
+++ b/test/ossl_shim/ossl_shim.cc
@@ -1295,6 +1295,6 @@ static int Main(int argc, char **argv) {
 
 }  // namespace bssl
 
-int main(int argc, char **argv) {
+int __cdecl main(int argc, char **argv) {
   return bssl::Main(argc, argv);
 }
diff --git a/test/rsa_complex.c b/test/rsa_complex.c
index fac581254a..55564a2d0a 100644
--- a/test/rsa_complex.c
+++ b/test/rsa_complex.c
@@ -20,7 +20,7 @@
 #include <openssl/rsa.h>
 #include <stdlib.h>
 
-int main(int argc, char *argv[])
+int __cdecl main(int argc, char *argv[])
 {
     /* There are explicitly no run time checks for this one */
     return EXIT_SUCCESS;
diff --git a/test/shlibloadtest.c b/test/shlibloadtest.c
index 86bbfcd849..a4ca1ae484 100644
--- a/test/shlibloadtest.c
+++ b/test/shlibloadtest.c
@@ -294,7 +294,7 @@ end:
  * it to link against libcrypto (which the framework uses). The point of the
  * test is to check dynamic loading and unloading of libcrypto/libssl.
  */
-int main(int argc, char *argv[])
+int __cdecl main(int argc, char *argv[])
 {
     const char *p;
 
diff --git a/test/ssltest_old.c b/test/ssltest_old.c
index 36e6031f3a..4d97ea7bb9 100644
--- a/test/ssltest_old.c
+++ b/test/ssltest_old.c
@@ -872,7 +872,7 @@ static int set_protocol_version(const char *version, SSL *ssl, int setting)
     return 1;
 }
 
-int main(int argc, char *argv[])
+int __cdecl main(int argc, char *argv[])
 {
     const char *CApath = NULL, *CAfile = NULL;
     int badop = 0;
diff --git a/test/ssltestlib.c b/test/ssltestlib.c
index 456afdf471..aec9b1d7f7 100644
--- a/test/ssltestlib.c
+++ b/test/ssltestlib.c
@@ -279,7 +279,7 @@ struct mempacket_st {
     unsigned int type;
 };
 
-static void mempacket_free(MEMPACKET *pkt)
+static void __cdecl mempacket_free(MEMPACKET *pkt)
 {
     if (pkt->data != NULL)
         OPENSSL_free(pkt->data);
diff --git a/test/stack_test.c b/test/stack_test.c
index 680f68d60e..3f8e4f96f5 100644
--- a/test/stack_test.c
+++ b/test/stack_test.c
@@ -41,7 +41,7 @@ DEFINE_SPECIAL_STACK_OF_CONST(uchar, unsigned char)
 DEFINE_STACK_OF(SS)
 DEFINE_STACK_OF_CONST(SU)
 
-static int int_compare(const int *const *a, const int *const *b)
+static int __cdecl int_compare(const int *const *a, const int *const *b)
 {
     if (**a < **b)
         return -1;
@@ -165,7 +165,7 @@ end:
     return testresult;
 }
 
-static int uchar_compare(const unsigned char *const *a,
+static int __cdecl uchar_compare(const unsigned char *const *a,
                          const unsigned char *const *b)
 {
     return **a - (signed int)**b;
@@ -251,7 +251,7 @@ end:
     return testresult;
 }
 
-static SS *SS_copy(const SS *p)
+static SS * __cdecl SS_copy(const SS *p)
 {
     SS *q = OPENSSL_malloc(sizeof(*q));
 
@@ -260,7 +260,7 @@ static SS *SS_copy(const SS *p)
     return q;
 }
 
-static void SS_free(SS *p) {
+static void __cdecl SS_free(SS *p) {
     OPENSSL_free(p);
 }
 
diff --git a/test/testutil/main.c b/test/testutil/main.c
index d3ccdda391..f86bc5dbc5 100644
--- a/test/testutil/main.c
+++ b/test/testutil/main.c
@@ -31,7 +31,7 @@ static void check_arg_usage(void)
         test_printf_stderr("Warning arguments %zu and later unchecked\n", i);
 }
 
-int main(int argc, char *argv[])
+int __cdecl main(int argc, char *argv[])
 {
     int ret = EXIT_FAILURE;
 
diff --git a/test/versions.c b/test/versions.c
index 3ab05ec35d..c9e32f6793 100644
--- a/test/versions.c
+++ b/test/versions.c
@@ -12,7 +12,7 @@
 #include <openssl/crypto.h>
 
 /* A simple helper for the perl function OpenSSL::Test::openssl_versions */
-int main(void)
+int __cdecl main(void)
 {
     printf("Build version: 0x%08lX\n", OPENSSL_VERSION_NUMBER);
     printf("Library version: 0x%08lX\n", OpenSSL_version_num());
diff --git a/test/x509aux.c b/test/x509aux.c
index e41f1f6809..7b80c58e3a 100644
--- a/test/x509aux.c
+++ b/test/x509aux.c
@@ -26,8 +26,8 @@ static int test_certs(int num)
     char *header = 0;
     unsigned char *data = 0;
     long len;
-    typedef X509 *(*d2i_X509_t)(X509 **, const unsigned char **, long);
-    typedef int (*i2d_X509_t)(X509 *, unsigned char **);
+    typedef X509 *(__cdecl * d2i_X509_t)(X509 **, const unsigned char **, long);
+    typedef int (__cdecl * i2d_X509_t)(X509 *, unsigned char **);
     int err = 0;
     BIO *fp = BIO_new_file(test_get_argument(num), "r");
     X509 *reuse = NULL;
diff --git a/util/mkdef.pl b/util/mkdef.pl
index 3ac79821b0..ed05e5584d 100755
--- a/util/mkdef.pl
+++ b/util/mkdef.pl
@@ -297,7 +297,7 @@ if($do_crypto == 1) {
  * to link to all of them. This is *not* intended to be run!
  */
 
-int main()
+int __cdecl main()
 {
 EOF
 	&print_test_file(*STDOUT,"LIBSSL",*ssl_list,$do_ctestall,@ssl_symbols)
diff --git a/crypto/rand/drbg_lib.c b/crypto/rand/drbg_lib.c
index 12bb627a04..e500d67107 100644
--- a/crypto/rand/drbg_lib.c
+++ b/crypto/rand/drbg_lib.c
@@ -100,7 +100,7 @@ static RAND_DRBG *rand_drbg_new(int secure,
  *
  * Returns 1 on success, 0 on failure.
  */
-int RAND_DRBG_set(RAND_DRBG *drbg, int type, unsigned int flags)
+int __cdecl RAND_DRBG_set(RAND_DRBG *drbg, int type, unsigned int flags)
 {
     int ret = 1;
 
@@ -150,7 +150,7 @@ int RAND_DRBG_set(RAND_DRBG *drbg, int type, unsigned int flags)
  *
  * Returns 1 on success, 0 on failure.
  */
-int RAND_DRBG_set_defaults(int type, unsigned int flags)
+int __cdecl RAND_DRBG_set_defaults(int type, unsigned int flags)
 {
     int ret = 1;
 
@@ -247,12 +247,12 @@ static RAND_DRBG *rand_drbg_new(int secure,
     return NULL;
 }
 
-RAND_DRBG *RAND_DRBG_new(int type, unsigned int flags, RAND_DRBG *parent)
+RAND_DRBG * __cdecl RAND_DRBG_new(int type, unsigned int flags, RAND_DRBG *parent)
 {
     return rand_drbg_new(0, type, flags, parent);
 }
 
-RAND_DRBG *RAND_DRBG_secure_new(int type, unsigned int flags, RAND_DRBG *parent)
+RAND_DRBG * __cdecl RAND_DRBG_secure_new(int type, unsigned int flags, RAND_DRBG *parent)
 {
     return rand_drbg_new(1, type, flags, parent);
 }
@@ -260,7 +260,7 @@ RAND_DRBG *RAND_DRBG_secure_new(int type, unsigned int flags, RAND_DRBG *parent)
 /*
  * Uninstantiate |drbg| and free all memory.
  */
-void RAND_DRBG_free(RAND_DRBG *drbg)
+void __cdecl RAND_DRBG_free(RAND_DRBG *drbg)
 {
     if (drbg == NULL)
         return;
@@ -285,7 +285,7 @@ void RAND_DRBG_free(RAND_DRBG *drbg)
  *
  * Returns 1 on success, 0 on failure.
  */
-int RAND_DRBG_instantiate(RAND_DRBG *drbg,
+int __cdecl RAND_DRBG_instantiate(RAND_DRBG *drbg,
                           const unsigned char *pers, size_t perslen)
 {
     unsigned char *nonce = NULL, *entropy = NULL;
@@ -380,7 +380,7 @@ int RAND_DRBG_instantiate(RAND_DRBG *drbg,
  *
  * Returns 1 on success, 0 on failure.
  */
-int RAND_DRBG_uninstantiate(RAND_DRBG *drbg)
+int __cdecl RAND_DRBG_uninstantiate(RAND_DRBG *drbg)
 {
     if (drbg->meth == NULL) {
         drbg->state = DRBG_ERROR;
@@ -404,7 +404,7 @@ int RAND_DRBG_uninstantiate(RAND_DRBG *drbg)
  *
  * Returns 1 on success, 0 on failure.
  */
-int RAND_DRBG_reseed(RAND_DRBG *drbg,
+int __cdecl RAND_DRBG_reseed(RAND_DRBG *drbg,
                      const unsigned char *adin, size_t adinlen,
                      int prediction_resistance)
 {
@@ -574,7 +574,7 @@ int rand_drbg_restart(RAND_DRBG *drbg,
  * Returns 1 on success, 0 on failure.
  *
  */
-int RAND_DRBG_generate(RAND_DRBG *drbg, unsigned char *out, size_t outlen,
+int __cdecl RAND_DRBG_generate(RAND_DRBG *drbg, unsigned char *out, size_t outlen,
                        int prediction_resistance,
                        const unsigned char *adin, size_t adinlen)
 {
@@ -657,7 +657,7 @@ int RAND_DRBG_generate(RAND_DRBG *drbg, unsigned char *out, size_t outlen,
  *
  * Returns 1 on success 0 on failure.
  */
-int RAND_DRBG_bytes(RAND_DRBG *drbg, unsigned char *out, size_t outlen)
+int __cdecl RAND_DRBG_bytes(RAND_DRBG *drbg, unsigned char *out, size_t outlen)
 {
     unsigned char *additional = NULL;
     size_t additional_len;
@@ -700,7 +700,7 @@ int RAND_DRBG_bytes(RAND_DRBG *drbg, unsigned char *out, size_t outlen)
  *
  * Returns 1 on success, 0 on failure.
  */
-int RAND_DRBG_set_callbacks(RAND_DRBG *drbg,
+int __cdecl RAND_DRBG_set_callbacks(RAND_DRBG *drbg,
                             RAND_DRBG_get_entropy_fn get_entropy,
                             RAND_DRBG_cleanup_entropy_fn cleanup_entropy,
                             RAND_DRBG_get_nonce_fn get_nonce,
@@ -725,7 +725,7 @@ int RAND_DRBG_set_callbacks(RAND_DRBG *drbg,
  *
  * Returns 1 on success, 0 on failure.
  */
-int RAND_DRBG_set_reseed_interval(RAND_DRBG *drbg, unsigned int interval)
+int __cdecl RAND_DRBG_set_reseed_interval(RAND_DRBG *drbg, unsigned int interval)
 {
     if (interval > MAX_RESEED_INTERVAL)
         return 0;
@@ -743,7 +743,7 @@ int RAND_DRBG_set_reseed_interval(RAND_DRBG *drbg, unsigned int interval)
  *
  * Returns 1 on success, 0 on failure.
  */
-int RAND_DRBG_set_reseed_time_interval(RAND_DRBG *drbg, time_t interval)
+int __cdecl RAND_DRBG_set_reseed_time_interval(RAND_DRBG *drbg, time_t interval)
 {
     if (interval > MAX_RESEED_TIME_INTERVAL)
         return 0;
@@ -760,7 +760,7 @@ int RAND_DRBG_set_reseed_time_interval(RAND_DRBG *drbg, time_t interval)
  * Returns 1 on success, 0 on failure.
  */
 
-int RAND_DRBG_set_reseed_defaults(
+int __cdecl RAND_DRBG_set_reseed_defaults(
                                   unsigned int _master_reseed_interval,
                                   unsigned int _slave_reseed_interval,
                                   time_t _master_reseed_time_interval,
@@ -849,12 +849,12 @@ int rand_drbg_enable_locking(RAND_DRBG *drbg)
 /*
  * Get and set the EXDATA
  */
-int RAND_DRBG_set_ex_data(RAND_DRBG *drbg, int idx, void *arg)
+int __cdecl RAND_DRBG_set_ex_data(RAND_DRBG *drbg, int idx, void *arg)
 {
     return CRYPTO_set_ex_data(&drbg->ex_data, idx, arg);
 }
 
-void *RAND_DRBG_get_ex_data(const RAND_DRBG *drbg, int idx)
+void * __cdecl RAND_DRBG_get_ex_data(const RAND_DRBG *drbg, int idx)
 {
     return CRYPTO_get_ex_data(&drbg->ex_data, idx);
 }
@@ -1097,7 +1097,7 @@ static int drbg_status(void)
  * Returns pointer to the DRBG on success, NULL on failure.
  *
  */
-RAND_DRBG *RAND_DRBG_get0_master(void)
+RAND_DRBG * __cdecl RAND_DRBG_get0_master(void)
 {
     if (!RUN_ONCE(&rand_drbg_init, do_rand_drbg_init))
         return NULL;
@@ -1109,7 +1109,7 @@ RAND_DRBG *RAND_DRBG_get0_master(void)
  * Get the public DRBG.
  * Returns pointer to the DRBG on success, NULL on failure.
  */
-RAND_DRBG *RAND_DRBG_get0_public(void)
+RAND_DRBG * __cdecl RAND_DRBG_get0_public(void)
 {
     RAND_DRBG *drbg;
 
@@ -1130,7 +1130,7 @@ RAND_DRBG *RAND_DRBG_get0_public(void)
  * Get the private DRBG.
  * Returns pointer to the DRBG on success, NULL on failure.
  */
-RAND_DRBG *RAND_DRBG_get0_private(void)
+RAND_DRBG * __cdecl RAND_DRBG_get0_private(void)
 {
     RAND_DRBG *drbg;
 
@@ -1156,7 +1156,7 @@ RAND_METHOD rand_meth = {
     drbg_status
 };
 
-RAND_METHOD *RAND_OpenSSL(void)
+RAND_METHOD * __cdecl RAND_OpenSSL(void)
 {
     return &rand_meth;
 }
diff --git a/crypto/rand/rand_egd.c b/crypto/rand/rand_egd.c
index da3017df31..7448defedc 100644
--- a/crypto/rand/rand_egd.c
+++ b/crypto/rand/rand_egd.c
@@ -21,17 +21,17 @@ NON_EMPTY_TRANSLATION_UNIT
  */
 
 # if defined(OPENSSL_SYS_WIN32) || defined(OPENSSL_SYS_VMS) || defined(OPENSSL_SYS_MSDOS) || defined(OPENSSL_SYS_VXWORKS) || defined(OPENSSL_SYS_VOS) || defined(OPENSSL_SYS_UEFI)
-int RAND_query_egd_bytes(const char *path, unsigned char *buf, int bytes)
+int __cdecl RAND_query_egd_bytes(const char *path, unsigned char *buf, int bytes)
 {
     return -1;
 }
 
-int RAND_egd(const char *path)
+int __cdecl RAND_egd(const char *path)
 {
     return -1;
 }
 
-int RAND_egd_bytes(const char *path, int bytes)
+int __cdecl RAND_egd_bytes(const char *path, int bytes)
 {
     return -1;
 }
diff --git a/crypto/rand/rand_err.c b/crypto/rand/rand_err.c
index ae4d8559fb..2a49c878d1 100644
--- a/crypto/rand/rand_err.c
+++ b/crypto/rand/rand_err.c
@@ -124,7 +124,7 @@ static const ERR_STRING_DATA RAND_str_reasons[] = {
 
 #endif
 
-int ERR_load_RAND_strings(void)
+int __cdecl ERR_load_RAND_strings(void)
 {
 #ifndef OPENSSL_NO_ERR
     if (ERR_func_error_string(RAND_str_functs[0].error) == NULL) {
diff --git a/crypto/rand/rand_lib.c b/crypto/rand/rand_lib.c
index 91b2652311..1c0ad1450d 100644
--- a/crypto/rand/rand_lib.c
+++ b/crypto/rand/rand_lib.c
@@ -365,7 +365,7 @@ void rand_cleanup_int(void)
  * RAND_close_seed_files() ensures that any seed file descriptors are
  * closed after use.
  */
-void RAND_keep_random_devices_open(int keep)
+void __cdecl RAND_keep_random_devices_open(int keep)
 {
     if (RUN_ONCE(&rand_init, do_rand_init))
         rand_pool_keep_random_devices_open(keep);
@@ -378,7 +378,7 @@ void RAND_keep_random_devices_open(int keep)
  * sources which depend on the operating system and are
  * configurable via the --with-rand-seed configure option.
  */
-int RAND_poll(void)
+int __cdecl RAND_poll(void)
 {
     int ret = 0;
 
@@ -821,7 +821,7 @@ int rand_pool_add_end(RAND_POOL *pool, size_t len, size_t entropy)
     return 1;
 }
 
-int RAND_set_rand_method(const RAND_METHOD *meth)
+int __cdecl RAND_set_rand_method(const RAND_METHOD *meth)
 {
     if (!RUN_ONCE(&rand_init, do_rand_init))
         return 0;
@@ -836,7 +836,7 @@ int RAND_set_rand_method(const RAND_METHOD *meth)
     return 1;
 }
 
-const RAND_METHOD *RAND_get_rand_method(void)
+const RAND_METHOD * __cdecl RAND_get_rand_method(void)
 {
     const RAND_METHOD *tmp_meth = NULL;
 
@@ -867,7 +867,7 @@ const RAND_METHOD *RAND_get_rand_method(void)
 }
 
 #ifndef OPENSSL_NO_ENGINE
-int RAND_set_rand_engine(ENGINE *engine)
+int __cdecl RAND_set_rand_engine(ENGINE *engine)
 {
     const RAND_METHOD *tmp_meth = NULL;
 
@@ -892,7 +892,7 @@ int RAND_set_rand_engine(ENGINE *engine)
 }
 #endif
 
-void RAND_seed(const void *buf, int num)
+void __cdecl RAND_seed(const void *buf, int num)
 {
     const RAND_METHOD *meth = RAND_get_rand_method();
 
@@ -900,7 +900,7 @@ void RAND_seed(const void *buf, int num)
         meth->seed(buf, num);
 }
 
-void RAND_add(const void *buf, int num, double randomness)
+void __cdecl RAND_add(const void *buf, int num, double randomness)
 {
     const RAND_METHOD *meth = RAND_get_rand_method();
 
@@ -913,7 +913,7 @@ void RAND_add(const void *buf, int num, double randomness)
  * the default method, then just call RAND_bytes().  Otherwise make
  * sure we're instantiated and use the private DRBG.
  */
-int RAND_priv_bytes(unsigned char *buf, int num)
+int __cdecl RAND_priv_bytes(unsigned char *buf, int num)
 {
     const RAND_METHOD *meth = RAND_get_rand_method();
     RAND_DRBG *drbg;
@@ -930,7 +930,7 @@ int RAND_priv_bytes(unsigned char *buf, int num)
     return ret;
 }
 
-int RAND_bytes(unsigned char *buf, int num)
+int __cdecl RAND_bytes(unsigned char *buf, int num)
 {
     const RAND_METHOD *meth = RAND_get_rand_method();
 
@@ -951,7 +951,7 @@ int RAND_pseudo_bytes(unsigned char *buf, int num)
 }
 #endif
 
-int RAND_status(void)
+int __cdecl RAND_status(void)
 {
     const RAND_METHOD *meth = RAND_get_rand_method();
 
diff --git a/crypto/rand/randfile.c b/crypto/rand/randfile.c
index ba121eefbf..76c459f1ff 100644
--- a/crypto/rand/randfile.c
+++ b/crypto/rand/randfile.c
@@ -73,7 +73,7 @@ static __FILE_ptr32 (*const vms_fopen)(const char *, const char *, ...) =
  * devices and EGD sockets are handled in rand_unix.c  If |bytes| is
  * -1 read the complete file; otherwise read the specified amount.
  */
-int RAND_load_file(const char *file, long bytes)
+int __cdecl RAND_load_file(const char *file, long bytes)
 {
     /*
      * The load buffer size exceeds the chunk size by the comfortable amount
@@ -171,7 +171,7 @@ int RAND_load_file(const char *file, long bytes)
     return ret;
 }
 
-int RAND_write_file(const char *file)
+int __cdecl RAND_write_file(const char *file)
 {
     unsigned char buf[RAND_BUF_SIZE];
     int ret = -1;
@@ -248,7 +248,7 @@ int RAND_write_file(const char *file)
     return ret;
 }
 
-const char *RAND_file_name(char *buf, size_t size)
+const char * __cdecl RAND_file_name(char *buf, size_t size)
 {
     char *s = NULL;
     size_t len;
diff --git a/include/openssl/rand.h b/include/openssl/rand.h
index 38a2a2718f..4bd308bf40 100644
--- a/include/openssl/rand.h
+++ b/include/openssl/rand.h
@@ -28,40 +28,40 @@ struct rand_meth_st {
     int (*status) (void);
 };
 
-int RAND_set_rand_method(const RAND_METHOD *meth);
-const RAND_METHOD *RAND_get_rand_method(void);
+int __cdecl RAND_set_rand_method(const RAND_METHOD *meth);
+const RAND_METHOD * __cdecl RAND_get_rand_method(void);
 # ifndef OPENSSL_NO_ENGINE
-int RAND_set_rand_engine(ENGINE *engine);
+int __cdecl RAND_set_rand_engine(ENGINE *engine);
 # endif
 
-RAND_METHOD *RAND_OpenSSL(void);
+RAND_METHOD * __cdecl RAND_OpenSSL(void);
 
 # if OPENSSL_API_COMPAT < 0x10100000L
 #   define RAND_cleanup() while(0) continue
 # endif
-int RAND_bytes(unsigned char *buf, int num);
-int RAND_priv_bytes(unsigned char *buf, int num);
+int __cdecl RAND_bytes(unsigned char *buf, int num);
+int __cdecl RAND_priv_bytes(unsigned char *buf, int num);
 DEPRECATEDIN_1_1_0(int RAND_pseudo_bytes(unsigned char *buf, int num))
 
-void RAND_seed(const void *buf, int num);
-void RAND_keep_random_devices_open(int keep);
+void __cdecl RAND_seed(const void *buf, int num);
+void __cdecl RAND_keep_random_devices_open(int keep);
 
 # if defined(__ANDROID__) && defined(__NDK_FPABI__)
 __NDK_FPABI__	/* __attribute__((pcs("aapcs"))) on ARM */
 # endif
-void RAND_add(const void *buf, int num, double randomness);
-int RAND_load_file(const char *file, long max_bytes);
-int RAND_write_file(const char *file);
-const char *RAND_file_name(char *file, size_t num);
-int RAND_status(void);
+void __cdecl RAND_add(const void *buf, int num, double randomness);
+int __cdecl RAND_load_file(const char *file, long max_bytes);
+int __cdecl RAND_write_file(const char *file);
+const char * __cdecl RAND_file_name(char *file, size_t num);
+int __cdecl RAND_status(void);
 
 # ifndef OPENSSL_NO_EGD
-int RAND_query_egd_bytes(const char *path, unsigned char *buf, int bytes);
-int RAND_egd(const char *path);
-int RAND_egd_bytes(const char *path, int bytes);
+int __cdecl RAND_query_egd_bytes(const char *path, unsigned char *buf, int bytes);
+int __cdecl RAND_egd(const char *path);
+int __cdecl RAND_egd_bytes(const char *path, int bytes);
 # endif
 
-int RAND_poll(void);
+int __cdecl RAND_poll(void);
 
 # if defined(_WIN32) && (defined(BASETYPES) || defined(_WINDEF_H))
 /* application has to include <windows.h> in order to use these */
diff --git a/include/openssl/rand_drbg.h b/include/openssl/rand_drbg.h
index 45b731b73c..a5fd7e2a0f 100644
--- a/include/openssl/rand_drbg.h
+++ b/include/openssl/rand_drbg.h
@@ -58,47 +58,47 @@ extern "C" {
 /*
  * Object lifetime functions.
  */
-RAND_DRBG *RAND_DRBG_new(int type, unsigned int flags, RAND_DRBG *parent);
-RAND_DRBG *RAND_DRBG_secure_new(int type, unsigned int flags, RAND_DRBG *parent);
-int RAND_DRBG_set(RAND_DRBG *drbg, int type, unsigned int flags);
-int RAND_DRBG_set_defaults(int type, unsigned int flags);
-int RAND_DRBG_instantiate(RAND_DRBG *drbg,
+RAND_DRBG * __cdecl RAND_DRBG_new(int type, unsigned int flags, RAND_DRBG *parent);
+RAND_DRBG * __cdecl RAND_DRBG_secure_new(int type, unsigned int flags, RAND_DRBG *parent);
+int __cdecl RAND_DRBG_set(RAND_DRBG *drbg, int type, unsigned int flags);
+int __cdecl RAND_DRBG_set_defaults(int type, unsigned int flags);
+int __cdecl RAND_DRBG_instantiate(RAND_DRBG *drbg,
                           const unsigned char *pers, size_t perslen);
-int RAND_DRBG_uninstantiate(RAND_DRBG *drbg);
-void RAND_DRBG_free(RAND_DRBG *drbg);
+int __cdecl RAND_DRBG_uninstantiate(RAND_DRBG *drbg);
+void __cdecl RAND_DRBG_free(RAND_DRBG *drbg);
 
 /*
  * Object "use" functions.
  */
-int RAND_DRBG_reseed(RAND_DRBG *drbg,
+int __cdecl RAND_DRBG_reseed(RAND_DRBG *drbg,
                      const unsigned char *adin, size_t adinlen,
                      int prediction_resistance);
-int RAND_DRBG_generate(RAND_DRBG *drbg, unsigned char *out, size_t outlen,
+int __cdecl RAND_DRBG_generate(RAND_DRBG *drbg, unsigned char *out, size_t outlen,
                        int prediction_resistance,
                        const unsigned char *adin, size_t adinlen);
-int RAND_DRBG_bytes(RAND_DRBG *drbg, unsigned char *out, size_t outlen);
+int __cdecl RAND_DRBG_bytes(RAND_DRBG *drbg, unsigned char *out, size_t outlen);
 
-int RAND_DRBG_set_reseed_interval(RAND_DRBG *drbg, unsigned int interval);
-int RAND_DRBG_set_reseed_time_interval(RAND_DRBG *drbg, time_t interval);
+int __cdecl RAND_DRBG_set_reseed_interval(RAND_DRBG *drbg, unsigned int interval);
+int __cdecl RAND_DRBG_set_reseed_time_interval(RAND_DRBG *drbg, time_t interval);
 
-int RAND_DRBG_set_reseed_defaults(
+int __cdecl RAND_DRBG_set_reseed_defaults(
                                   unsigned int master_reseed_interval,
                                   unsigned int slave_reseed_interval,
                                   time_t master_reseed_time_interval,
                                   time_t slave_reseed_time_interval
                                   );
 
-RAND_DRBG *RAND_DRBG_get0_master(void);
-RAND_DRBG *RAND_DRBG_get0_public(void);
-RAND_DRBG *RAND_DRBG_get0_private(void);
+RAND_DRBG * __cdecl RAND_DRBG_get0_master(void);
+RAND_DRBG * __cdecl RAND_DRBG_get0_public(void);
+RAND_DRBG * __cdecl RAND_DRBG_get0_private(void);
 
 /*
  * EXDATA
  */
 # define RAND_DRBG_get_ex_new_index(l, p, newf, dupf, freef) \
     CRYPTO_get_ex_new_index(CRYPTO_EX_INDEX_DRBG, l, p, newf, dupf, freef)
-int RAND_DRBG_set_ex_data(RAND_DRBG *drbg, int idx, void *arg);
-void *RAND_DRBG_get_ex_data(const RAND_DRBG *drbg, int idx);
+int __cdecl RAND_DRBG_set_ex_data(RAND_DRBG *drbg, int idx, void *arg);
+void * __cdecl RAND_DRBG_get_ex_data(const RAND_DRBG *drbg, int idx);
 
 /*
  * Callback function typedefs
@@ -116,7 +116,7 @@ typedef size_t (*RAND_DRBG_get_nonce_fn)(RAND_DRBG *drbg, unsigned char **pout,
 typedef void (*RAND_DRBG_cleanup_nonce_fn)(RAND_DRBG *drbg,
                                            unsigned char *out, size_t outlen);
 
-int RAND_DRBG_set_callbacks(RAND_DRBG *drbg,
+int __cdecl RAND_DRBG_set_callbacks(RAND_DRBG *drbg,
                             RAND_DRBG_get_entropy_fn get_entropy,
                             RAND_DRBG_cleanup_entropy_fn cleanup_entropy,
                             RAND_DRBG_get_nonce_fn get_nonce,
diff --git a/include/openssl/randerr.h b/include/openssl/randerr.h
index 70d1a17a4c..54e4d0b530 100644
--- a/include/openssl/randerr.h
+++ b/include/openssl/randerr.h
@@ -16,7 +16,7 @@
 # ifdef  __cplusplus
 extern "C"
 # endif
-int ERR_load_RAND_strings(void);
+int __cdecl ERR_load_RAND_strings(void);
 
 /*
  * RAND function codes.
